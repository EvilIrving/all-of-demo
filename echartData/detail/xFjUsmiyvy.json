{"status":0,"data":{"cid":"xFjUsmiyvy","authorUid":"obd-ojnT5tSZJmq6Cighx2Iq8bxB1YZtgDG","authorUserName":"b***u","title":"嵌套饼图-学生评价统计","description":"","latestVersion":2,"alwaysLatest":1,"createTime":"2020-09-11T10:18:15.000Z","lastUpdateTime":"2020-09-11T10:18:15.000Z","auth":2,"uid":"obd-ojnT5tSZJmq6Cighx2Iq8bxB1YZtgDG","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.8.0","versionCreateTime":"2020-09-11T10:19:13.000Z","code":"// 定义学生行为\r\nvar behaviours = {}, std={};\r\nbehaviours['表扬'] = ['帮助他人', '认真读书', '活泼开朗', '一点就通', '热情主动', '举手答问', '入班即静'];\r\nbehaviours['待改进'] = ['上课走神','辱骂同学'];\r\n// 某个学生的行为次数，没有的行为次数为0，与定义的行为一一对应\r\nstd['表扬'] =  [1, 1, 2, 1, 1, 1, 1];\r\nstd['待改进'] = [1,2];\r\n\r\n// 内环数据统计，2种形式的总次数\r\nvar innervalue = [];\r\nfor(let k of Object.keys(behaviours)){\r\n    innervalue.push({\r\n        name: k,\r\n        value: std[k].reduce((acc, cur)=>{ return acc+cur; },0)\r\n    })\r\n}\r\n// 外环数据统计, 各类行为的次数\r\nvar outervalue = [];\r\nvar behaviours_arr = [...behaviours['表扬'], ...behaviours['待改进']];\r\nvar std_arr = [...std['表扬'], ...std['待改进']];\r\nfor(let [k,v] of behaviours_arr.entries()){\r\n    outervalue.push({\r\n        name: v,\r\n        value: std_arr[k]\r\n    })\r\n}\r\n\r\n// 定义好坏颜色，注意：echart文字不支持渐变色，所以外环只能单色\r\ngoodCor = ['#3295FF','#81BEFF'];\r\nbadCor = ['#bf2f2f','#9b2323'];\r\n\r\nlet echartData = {\r\n    inner: innervalue,\r\n    outer: outervalue\r\n};\r\noption = {};\r\noption.color = [\r\n    {\r\n        x: 0,\r\n        y: 0,\r\n        x2: 0,\r\n        y2: 1,\r\n        colorStops: [{\r\n            offset: 0,\r\n            color: goodCor[0] // 0% 处的颜色\r\n        }, {\r\n            offset: 1,\r\n            color: goodCor[1] // 100% 处的颜色\r\n        }],\r\n    }, {\r\n        x: 0,\r\n        y: 0,\r\n        x2: 0,\r\n        y2: 1,\r\n        colorStops: [{\r\n            offset: 0,\r\n            color: badCor[0] // 0% 处的颜色\r\n        }, {\r\n            offset: 1,\r\n            color: badCor[1] // 100% 处的颜色\r\n        }],\r\n    }\r\n];\r\n// option.color = ['#ff6900'];\r\noption.series = [\r\n    {\r\n        type: 'pie',\r\n        radius: [0, '40%'],\r\n        hoverAnimation:1,\r\n        hoverOffset:1,\r\n        selectedMode: 'single',\r\n        selectedOffset:3,\r\n        itemStyle: {\r\n            normal: {\r\n                borderColor: '#fff',\r\n            }\r\n        },\r\n        label: {\r\n            normal: {\r\n                position: 'inner',\r\n                fontSize: 14,\r\n                formatter: params => {\r\n                    return (\r\n                        '{name|' + params.name + '}'\r\n                    );\r\n                },\r\n                rich: {\r\n                    name: {\r\n                        fontSize: 14,\r\n                        padding: [0, 0, 3, 0],\r\n                        color: '#fff',\r\n                        textBorderWidth: 0\r\n                    }\r\n                },\r\n                padding: [0, -130, 25, -130]\r\n            },\r\n        },\r\n        labelLine: {\r\n            normal: {\r\n                show: false\r\n            }\r\n        },\r\n        data: echartData.inner\r\n    },\r\n    {\r\n        type: 'pie',\r\n        radius: ['40%', '60%'],\r\n        hoverAnimation:1,\r\n        hoverOffset:1,\r\n        selectedMode: 'single',\r\n        selectedOffset:3,\r\n        labelLine: {\r\n            normal: {\r\n                length:20,\r\n                length2: 0,\r\n                smooth: 1,\r\n            }\r\n        },\r\n        itemStyle:{\r\n            normal:{\r\n                color: params => {\r\n                    if(behaviours['待改进'].includes(params.name)){\r\n                        // return option.color[1]\r\n                        return badCor[0]\r\n                    }else{\r\n                        return goodCor[1]\r\n                    }\r\n                },\r\n                borderWidth: 0.5,\r\n                borderColor: '#fff'\r\n            }\r\n        },\r\n        label: {\r\n            normal: {\r\n                formatter: params => {\r\n                    return '{name|' + params.name + '}\\n{hr|}\\n{percent|' + params.percent + '%}  {score|' + (behaviours['待改进'].includes(params.name) ? '-':'+') + params.value + '分} '\r\n                },\r\n                distanceToLabelLine: 0,\r\n                padding: [-2, 0, 0, 0],\r\n                rich: {\r\n                    name: {\r\n                        color: \"#656565\",\r\n                        fontSize: 13,\r\n                        padding: [6, 10],\r\n                        align: 'left'\r\n                    },\r\n                    percent: {\r\n                        color: \"#656565\",\r\n                        align: 'center',\r\n                        fontSize: 13,\r\n                        padding: [5, 10]\r\n                    },\r\n                    score:{\r\n                    },\r\n                    hr: {\r\n                        borderColor: '#C8C8C8',\r\n                        width: '100%',\r\n                        borderWidth: 0.5,\r\n                        height: 0,\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        data: echartData.outer\r\n    }\r\n];\r\n","html":"","externalScripts":"","updaterUID":"obd-ojnT5tSZJmq6Cighx2Iq8bxB1YZtgDG","theme":"","layout":"","viewCount":177,"userName":"b***u","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xFjUsmiyvy.png?v=1599819553405","isCustomThumbnail":0,"builtinTags":["category-work","series-pie"],"customTags":["双饼图","嵌套"],"updaterUserName":"b***u"}}