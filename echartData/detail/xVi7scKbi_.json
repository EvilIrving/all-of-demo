{"status":0,"data":{"cid":"xVi7scKbi_","authorUid":"obd-oNSDCqu42JEySyKzZOfcy6UjgFt5dCi","authorUserName":"逆***h","title":"第一版-机具交易量","description":"","latestVersion":3,"alwaysLatest":1,"createTime":"2020-05-13T03:52:54.000Z","lastUpdateTime":"2020-05-13T03:52:54.000Z","auth":2,"uid":"obd-oNSDCqu42JEySyKzZOfcy6UjgFt5dCi","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":3,"parentVersion":1,"echartsVersion":"4.7.0","versionCreateTime":"2020-05-13T09:28:14.000Z","code":"/**\n此版本通过设置geoindex && seriesIndex: [1] 属性来实现geo和map共存，来达到hover散点和区域显示tooltip的效果\n\n默认情况下，map series 会自己生成内部专用的 geo 组件。但是也可以用这个 geoIndex 指定一个 geo 组件。这样的话，map 和 其他 series（例如散点图）就可以共享一个 geo 组件了。并且，geo 组件的颜色也可以被这个 map series 控制，从而用 visualMap 来更改。\n当设定了 geoIndex 后，series-map.map 属性，以及 series-map.itemStyle 等样式配置不再起作用，而是采用 geo 中的相应属性。\n\nhttp://echarts.baidu.com/option.html#series-map.geoIndex\n\n并且加了pin气泡图标以示数值大小\n*/\n\nvar uploadedDataURL = \"/asset/get/s/data-1528971808162-BkOXf61WX.json\";\nmyChart.showLoading();\n$.getJSON(uploadedDataURL, function(geoJson) {\n    echarts.registerMap('china', geoJson);\n    myChart.hideLoading();\n    var geoCoordMap = {\n        '苏州': [120.58, 31.30],\n        '南京': [118.8062, 31.9208],\n        '上海': [121.4648, 31.2891],\n        '杭州': [119.5313, 29.8773],\n        '天津': [117.4219, 39.4189],\n        '北京': [116.4551, 40.2539],\n        \"成都\": [103.9526, 30.7617],\n        \"宁波\": [121.56, 29.86],\n        \"深圳\": [113.12244, 23.009505]\n\n    };\n    var data = [{\n            name: \"北京\",\n            transAmt: 199,\n            serviceRate: 99\n        },\n        {\n            name: \"苏州\",\n            transAmt: 42,\n            serviceRate: 99\n        },\n        {\n            name: \"南京\",\n            transAmt: 102,\n            serviceRate: 99\n        },\n        {\n            name: \"上海\",\n            transAmt: 81,\n           serviceRate: 99  \n        },\n        {\n            name: \"杭州\",\n            transAmt: 47,\n            serviceRate: 99\n        },\n        {\n            name: \"天津\",\n            transAmt: 67,\n            serviceRate: 99\n        },\n        {\n            name: \"成都\",\n            transAmt: 82,\n            serviceRate: 99\n        },\n        {\n            name: \"宁波\",\n            transAmt: 123,\n            serviceRate: 99\n        },\n        {\n            name: \"上海\",\n            transAmt: 24,\n            serviceRate: 99\n        },\n        {\n            name: \"深圳\",\n            transAmt: 92,\n            serviceRate: 99\n        }\n\n    ];\n    var max = 480,\n        min = 9; // todo \n    var maxSize4Pin = 100,\n        minSize4Pin = 20;\n\n    var convertData = function(data) {\n        var res = [];\n        for (var i = 0; i < data.length; i++) {\n            var geoCoord = geoCoordMap[data[i].name];\n            if (geoCoord) {\n                res.push({\n                    name: data[i].name,\n                    value: geoCoord.concat(data[i].transAmt)\n                });\n            }\n        }\n        return res;\n    };\n\n\n\n    option = {\n        backgroundColor: {\n            type: 'linear',\n            x: 0,\n            y: 0,\n            x2: 1,\n            y2: 1,\n            colorStops: [{\n                offset: 0,\n                color: '#0f378f' // 0% 处的颜色\n            }, {\n                offset: 1,\n                color: '#00091a' // 100% 处的颜色\n            }],\n            globalCoord: false // 缺省为 false\n        },\n        title: {\n            top: 20,\n            text: '机具交易量',\n            subtext: '',\n            x: 'center',\n            textStyle: {\n                color: '#ccc'\n            }\n        },\n\n        tooltip: {\n            trigger: 'item',\n            formatter: function(params) {\n                if (typeof(params.value)[2] == \"undefined\") {\n                    return params.name + ' : ' + params.value;\n                } else {\n                    return params.name + ' : ' + params.value[2];\n                }\n            }\n        },\n        /*   legend: {\n               orient: 'vertical',\n               y: 'bottom',\n               x: 'right',\n                data:['pm2.5'],\n               textStyle: {\n                   color: '#fff'\n               }\n           },*/\n        legend: {\n            orient: 'vertical',\n            y: 'bottom',\n            x: 'right',\n            data: ['pm2.5'],\n            textStyle: {\n                color: '#fff'\n            }\n        },\n        visualMap: {\n            show: false,\n            min: 0,\n            max: 500,\n            left: 'left',\n            top: 'bottom',\n            text: ['高', '低'], // 文本，默认为数值文本\n            calculable: true,\n            seriesIndex: [1],\n            inRange: {\n\n            }\n        },\n        geo: {\n            map: 'china',\n            show: true,\n            roam: true,\n            label: {\n                normal: {\n                    show: false\n                },\n                emphasis: {\n                    show: false,\n                }\n            },\n            itemStyle: {\n                normal: {\n                    areaColor: '#3a7fd5',\n                    borderColor: '#0a53e9', //线\n                    shadowColor: '#092f8f', //外发光\n                    shadowBlur: 20\n                },\n                emphasis: {\n                    areaColor: '#0a2dae', //悬浮区背景\n                }\n            }\n        },\n        series: [{\n\n                symbolSize: 5,\n                label: {\n                    normal: {\n                        formatter: '{b}',\n                        position: 'right',\n                        show: true\n                    },\n                    emphasis: {\n                        show: true\n                    }\n                },\n                itemStyle: {\n                    normal: {\n                        color: '#fff'\n                    }\n                },\n                name: 'light',\n                type: 'scatter',\n                coordinateSystem: 'geo',\n                data: convertData(data),\n\n            },\n            {\n                type: 'map',\n                map: 'china',\n                geoIndex: 0,\n                aspectScale: 0.75, //长宽比\n                showLegendSymbol: false, // 存在legend时显示\n                label: {\n                    normal: {\n                        show: false\n                    },\n                    emphasis: {\n                        show: false,\n                        textStyle: {\n                            color: '#fff'\n                        }\n                    }\n                },\n                roam: true,\n                itemStyle: {\n                    normal: {\n                        areaColor: '#031525',\n                        borderColor: '#FFFFFF',\n                    },\n                    emphasis: {\n                        areaColor: '#2B91B7'\n                    }\n                },\n                animation: false,\n                data: data\n            },\n            {\n                name: 'Top 5',\n                type: 'scatter',\n                coordinateSystem: 'geo',\n                symbol: 'pin',\n                symbolSize: [50, 50],\n                label: {\n                    normal: {\n                        show: true,\n                        textStyle: {\n                            color: '#fff',\n                            fontSize: 9,\n                        },\n                        formatter(value) {\n                            return value.data.value[2]\n                        }\n                    }\n                },\n                itemStyle: {\n                    normal: {\n                        color: '#D8BC37', //标志颜色\n                    }\n                },\n                data: convertData(data),\n                showEffectOn: 'render',\n                rippleEffect: {\n                    brushType: 'stroke'\n                },\n                hoverAnimation: true,\n                zlevel: 1\n            },\n\n        ]\n    };\n    myChart.setOption(option);\n});","html":"","externalScripts":"","updaterUID":"obd-oNSDCqu42JEySyKzZOfcy6UjgFt5dCi","theme":"","layout":"","viewCount":751,"userName":"逆***h","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xVi7scKbi_.png?v=1589362094517","isCustomThumbnail":0,"builtinTags":["category-work","geo","legend","series-map","series-scatter","title","tooltip","visualMap"],"customTags":[],"updaterUserName":"逆***h"}}