{"status":0,"data":{"cid":"xH8UwQc2hU","authorUid":"obd-oMN8owbmY0AMpeQVjGwQ2v4fIV7A12R","authorUserName":"e***2","title":"山东","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2020-09-25T08:26:52.000Z","lastUpdateTime":"2020-09-25T08:26:52.000Z","auth":2,"uid":"obd-oMN8owbmY0AMpeQVjGwQ2v4fIV7A12R","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-09-25T08:26:52.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1601021532008-U4ZFkS5F6.json\";\r\n\r\nvar binzhou = \"/asset/get/s/data-1601021540178-NiBsf8MaK.json\";\r\n\r\nvar dezhou = \"/asset/get/s/data-1601021547981-xolcQQS1D.json\";\r\n\r\nvar dongying = \"/asset/get/s/data-1601021556252-ESxdx992q.json\";\r\n\r\nvar heze = \"/asset/get/s/data-1601021563431-m3hYupITe.json\";\r\n\r\nvar jinan = \"/asset/get/s/data-1601021569915-1-ngeLwCt.json\";\r\n\r\nvar jining = \"/asset/get/s/data-1601021577714-cacGjTBsc.json\";\r\n\r\nvar liaocheng = \"/asset/get/s/data-1601021586973-WB2Kffdki.json\";\r\n\r\nvar linyi = \"/asset/get/s/data-1601021594426-EW-H7jDah.json\";\r\n\r\nvar qingdao = \"/asset/get/s/data-1601021607761-cQcitEozj.json\";\r\n\r\nvar rizhao = \"/asset/get/s/data-1601021619254-rPoZAKGBW.json\";\r\n\r\nvar taian = \"/asset/get/s/data-1601021628580-fYXBtMSrC.json\";\r\n\r\nvar weihai = \"/asset/get/s/data-1601021640122-Kr919ft63.json\";\r\n\r\nvar yantai = \"/asset/get/s/data-1601021647171-vp0ep01T5.json\";\r\n\r\nvar yongfang = \"/asset/get/s/data-1601021654936-PLnJUWQZP.json\";\r\n\r\nvar zaozhuang = \"/asset/get/s/data-1601021660971-AJ2g1_9r9.json\";\r\n\r\nvar zibo = \"/asset/get/s/data-1601021666722-_IBRD8nVV.json\";\r\n\r\n$.get(uploadedDataURL, function(geoJson) {\r\n\r\n    myChart.hideLoading();\r\n\r\n    echarts.registerMap('山东', geoJson);\r\n\r\n    var cityMap = {\r\n        '济南市': jinan,\r\n        '菏泽市': heze,\r\n        '德州市': dezhou,\r\n        '聊城市': liaocheng,\r\n        '泰安市': taian,\r\n        '临沂市': linyi,\r\n        '淄博市': zibo,\r\n        '枣庄市': zaozhuang,\r\n        '滨州市': binzhou,\r\n        '潍坊市': yongfang,\r\n        '东营市': dongying,\r\n        '青岛市': qingdao,\r\n        '烟台市': yantai,\r\n        '威海市': weihai,\r\n        '日照市': rizhao,\r\n        '济宁市': jining\r\n    };\r\n\r\n    var gdGeoCoordMap = {\r\n        '济南市': [117.121225, 36.66466],\r\n        '菏泽市': [115.480656, 35.23375],\r\n        '德州市': [116.39, 37.45],\r\n        '聊城市': [115.97, 36.45],\r\n        '泰安市': [117.13, 36.18],\r\n        '临沂市': [118.35, 35.05],\r\n        '淄博市': [118.05, 36.78],\r\n        '枣庄市': [117.57, 34.86],\r\n        '滨州市': [118.03, 37.36],\r\n        '潍坊市': [119.1, 36.62],\r\n        '东营市': [118.49, 37.46],\r\n        '青岛市': [120.3, 36.62],\r\n        '烟台市': [120.9, 37.32],\r\n        '威海市': [122.1, 37.2],\r\n        '日照市': [119.1, 35.62],\r\n        '济宁市': [116.7, 35.42],\r\n    };\r\n    var gdDatas = [\r\n        [{\r\n            name: '济南市',\r\n            value: 10\r\n        }],\r\n        [{\r\n            name: '菏泽市',\r\n            value: 0\r\n        }],\r\n        [{\r\n            name: '德州市',\r\n            value: 0\r\n        }],\r\n        [{\r\n            name: '聊城市',\r\n            value: 0\r\n        }],\r\n        [{\r\n            name: '泰安市',\r\n            value: 1.3\r\n        }],\r\n        [{\r\n            name: '临沂市',\r\n            value: 0.2\r\n        }],\r\n        [{\r\n            name: '淄博市',\r\n            value: 0.4\r\n        }],\r\n        [{\r\n            name: '枣庄市',\r\n            value: 0.6\r\n        }],\r\n        [{\r\n            name: '滨州市',\r\n            value: 0.8\r\n        }],\r\n        [{\r\n            name: '潍坊市',\r\n            value: 0.4\r\n        }],\r\n        [{\r\n            name: '东营市',\r\n            value: 0.8\r\n        }],\r\n        [{\r\n            name: '青岛市',\r\n            value: 0.2\r\n        }],\r\n        [{\r\n            name: '烟台市',\r\n            value: 1.3\r\n        }],\r\n        [{\r\n            name: '威海市',\r\n            value: 0\r\n        }],\r\n        [{\r\n            name: '日照市',\r\n            value: 0\r\n        }],\r\n        [{\r\n            name: '济宁市',\r\n            value: 0\r\n        }]\r\n    ];\r\n\r\n    var dongguandata = [{\r\n        name: \"中国铁路济南局集团有限公司济南供电段\",\r\n        value: [116.98, 36.67, 0.5],\r\n    }]\r\n\r\n    var foshandata = [{\r\n        name: \"菏泽供电公司万福供电所\",\r\n        value: [115.38, 35.28, 0.5],\r\n    }]\r\n\r\n    var guangzhoudata = [{\r\n            name: \"德州袁桥供电所\",\r\n            value: [116.40, 37.44, 0.5],\r\n        },\r\n        {\r\n            name: \"长官供电所\",\r\n            value: [116.92, 37.79, 1],\r\n        },\r\n        {\r\n            name: \"德州赵虎供电所\",\r\n            value: [116.49, 37.51, 1],\r\n        },\r\n        {\r\n            name: \"尚堂供电所\",\r\n            value: [117.41, 37.71, 0.1],\r\n        },\r\n        {\r\n            name: \"尹屯供电所\",\r\n            value: [116.57, 37.13, 0.4],\r\n        }\r\n    ]\r\n\r\n    var zhongshandata = [{\r\n        name: \"聊城供电公司沙镇供电所\",\r\n        value: [115.80, 36.34, 0.5],\r\n    }]\r\n\r\n    var zhuhaidata = [{\r\n            name: \"泰安徂徕供电所\",\r\n            value: [117.28, 36.11, 0.5],\r\n        },\r\n        {\r\n            name: \"泰安道朗供电所\",\r\n            value: [116.92, 36.21, 1],\r\n        },\r\n        {\r\n            name: \"泰安崅峪供电所\",\r\n            value: [117.42, 36.18, 1],\r\n        }\r\n    ]\r\n\r\n    var jiangmendata = [{\r\n            name: \"山东省临沂市蒙阴县野店供电所\",\r\n            value: [118.10, 35.88, 0.5],\r\n        },\r\n        {\r\n            name: \"山东省临沂市蒙阴县岱崮供电所\",\r\n            value: [118.17, 35.95, 1],\r\n        },\r\n        {\r\n            name: \"山东省临沂市兰山区城西供电所\",\r\n            value: [118.31, 35.10, 1],\r\n        }\r\n    ]\r\n\r\n    var yangjiangdata = [{\r\n            name: \"金岭供电所\",\r\n            value: [118.23, 36.80, 0.5],\r\n        },\r\n        {\r\n            name: \"唐坊供电所\",\r\n            value: [118.00, 37.19, 1],\r\n        },\r\n        {\r\n            name: \"博山源泉供电所\",\r\n            value: [118.05, 36.43, 1],\r\n        }\r\n    ]\r\n\r\n    var maomingdata = [{\r\n            name: \"枣庄供电公司\",\r\n            value: [117.32, 34.80, 0.5],\r\n        },\r\n        {\r\n            name: \"国家电网枣庄市中供电\",\r\n            value: [117.55, 34.87, 1],\r\n        }\r\n    ]\r\n\r\n    var qingyuandata = [{\r\n            name: \"滨州无棣县供电公司\",\r\n            value: [117.61, 37.74, 0.5],\r\n        },\r\n        {\r\n            name: \"滨州沾化区供电公司\",\r\n            value: [118.12, 37.69, 1],\r\n        }\r\n    ]\r\n\r\n    var zhanjiangdata = [{\r\n            name: \"潍坊开发区供电所\",\r\n            value: [119.41, 36.82, 0.5],\r\n        },\r\n        {\r\n            name: \"国网潍坊市寒亭区供电\",\r\n            value: [119.20, 36.77, 1],\r\n        }\r\n    ]\r\n\r\n    var yunfudata = [{\r\n            name: \"东营市广北供电所\",\r\n            value: [118.68, 37.26, 0.5],\r\n        },\r\n        {\r\n            name: \"东营港供电\",\r\n            value: [118.92, 38.08, 1],\r\n        }\r\n    ]\r\n\r\n    var zhaoqingdata = [{\r\n            name: \"国网青岛市黄岛区供电公司\",\r\n            value: [120.04, 35.87, 0.5],\r\n        },\r\n        {\r\n            name: \"国网山东省电力公司青岛市黄岛区供电公司\",\r\n            value: [120.04, 35.87, 1],\r\n        }\r\n    ]\r\n\r\n    var shaoguandata = [{\r\n            name: \"国网烟台供电公司\",\r\n            value: [121.40, 37.54, 0.5],\r\n        },\r\n        {\r\n            name: \"烟台开发区供电公司\",\r\n            value: [121.26, 37.56, 1],\r\n        }, {\r\n            name: \"国网烟台市福山区供电公司\",\r\n            value: [121.28, 37.51, 1],\r\n        }\r\n    ]\r\n\r\n    var huizhoudata = [{\r\n            name: \"国网威海供电公司\",\r\n            value: [122.11, 37.51, 0.5],\r\n        },\r\n        {\r\n            name: \"威海乳山市供电公司\",\r\n            value: [121.52, 36.92, 1],\r\n        }\r\n    ]\r\n\r\n    var shenzhendata = [{\r\n            name: \"日照岚山供电营业厅\",\r\n            value: [119.32, 35.12, 0.5],\r\n        },\r\n        {\r\n            name: \"国家电网日照城关供电营业厅\",\r\n            value: [119.44, 35.44, 1],\r\n        }\r\n    ]\r\n\r\n    var heyuandata = [{\r\n            name: \"济宁嘉祥供电营业厅\",\r\n            value: [116.34, 35.41, 0.5],\r\n        },\r\n        {\r\n            name: \"济宁金乡供电营业厅\",\r\n            value: [116.30, 35.08, 1],\r\n        }\r\n    ]\r\n\r\n    var opt = {\r\n        bgColor: '#013954', // 画布背景色\r\n        mapName: '山东', // 地图名\r\n        goDown: true, // 是否下钻\r\n        // 下钻回调\r\n        callback: function(name, option, instance) {\r\n            console.log(name, option, instance);\r\n            if (name == '山东') {\r\n                option.series[0].data = convertData(gdDatas);\r\n                option.series[1].data = gdDatas.map(function(dataItem) {\r\n                    return {\r\n                        name: dataItem[0].name,\r\n                        value: gdGeoCoordMap[dataItem[0].name].concat([dataItem[0].value])\r\n                    };\r\n                });\r\n                myChart.setOption(option, true);\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"济南市\") {\r\n                option.series[0].data = convertData1(dongguandata);\r\n                option.series[1].data = dongguandata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"菏泽市\") {\r\n                option.series[0].data = convertData1(foshandata);\r\n                option.series[1].data = foshandata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"德州市\") {\r\n                option.series[0].data = convertData1(guangzhoudata);\r\n                option.series[1].data = guangzhoudata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"聊城市\") {\r\n                option.series[0].data = convertData1(zhongshandata);\r\n                option.series[1].data = zhongshandata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"泰安市\") {\r\n                option.series[0].data = convertData1(zhuhaidata);\r\n                option.series[1].data = zhuhaidata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"临沂市\") {\r\n                option.series[0].data = convertData1(jiangmendata);\r\n                option.series[1].data = jiangmendata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"淄博市\") {\r\n                option.series[0].data = convertData1(yangjiangdata);\r\n                option.series[1].data = yangjiangdata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"枣庄市\") {\r\n                option.series[0].data = convertData1(maomingdata);\r\n                option.series[1].data = maomingdata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"滨州市\") {\r\n                option.series[0].data = convertData1(qingyuandata);\r\n                option.series[1].data = qingyuandata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"潍坊市\") {\r\n                option.series[0].data = convertData1(zhanjiangdata);\r\n                option.series[1].data = zhanjiangdata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"东营市\") {\r\n                option.series[0].data = convertData1(yunfudata);\r\n                option.series[1].data = yunfudata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"青岛市\") {\r\n                option.series[0].data = convertData1(zhaoqingdata);\r\n                option.series[1].data = zhaoqingdata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"烟台市\") {\r\n                option.series[0].data = convertData1(shaoguandata);\r\n                option.series[1].data = shaoguandata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"威海市\") {\r\n                option.series[0].data = convertData1(huizhoudata);\r\n                option.series[1].data = huizhoudata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"日照市\") {\r\n                option.series[0].data = convertData1(shenzhendata);\r\n                option.series[1].data = shenzhendata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            } else if (name == \"济宁市\") {\r\n                option.series[0].data = convertData1(heyuandata);\r\n                option.series[1].data = heyuandata;\r\n                myChart.setOption(option, true); // 赋值后初始化\r\n                setTimeout(() => { // 定时后启动飞线\r\n                    myChart.setOption(option, true);\r\n                }, 500)\r\n            }\r\n        },\r\n        // 数据展示            \t\r\n        data: []\r\n    };\r\n\r\n\r\n    var levelColorMap = { // level颜色\r\n        '1': '#f44336',\r\n        '2': '#fc9700',\r\n        '3': '#ffde00',\r\n        '4': '#00eaff'\r\n    };\r\n\r\n    var defaultOpt = {\r\n        mapName: 'china', // 地图展示\r\n        goDown: false, // 是否下钻\r\n        bgColor: '#013954', // 画布背景色\r\n        activeArea: [], // 区域高亮,同echarts配置项\r\n        data: [],\r\n        // 下钻回调(点击的地图名、实例对象option、实例对象)\r\n        callback: function(name, option, instance) {}\r\n    };\r\n    if (opt) {\r\n        opt1 = $.extend(defaultOpt, opt);\r\n    }\r\n\r\n    // 层级索引\r\n    var name = [opt1.mapName];\r\n    var idx = 0;\r\n    var pos = { //层级位置\r\n        leftPlus: 55,\r\n        leftCur: 50,\r\n        left: 10,\r\n        top: 10\r\n    };\r\n\r\n    var line = [ //箭头\r\n        [0, 0],\r\n        [8, 11],\r\n        [0, 22]\r\n    ];\r\n\r\n    // style样式\r\n    var style = {\r\n        font: '18px \"Microsoft YaHei\", sans-serif',\r\n        textColor: '#eee',\r\n        lineColor: 'rgba(147, 235, 248, .8)'\r\n    };\r\n\r\n\r\n    var handleEvents = {\r\n        /**\r\n         * i 实例对象\r\n         * o option\r\n         * n 地图名\r\n         **/\r\n        resetOption: function(i, o, n) {\r\n            console.log(i)\r\n            console.log(o)\r\n            console.log(n)\r\n            var breadcrumb = this.createBreadcrumb(n);\r\n\r\n            var j = name.indexOf(n);\r\n            var l = o.graphic.length;\r\n            if (j < 0) {\r\n                console.log('jinru1')\r\n                o.graphic.push(breadcrumb);\r\n                o.graphic[0].children[0].shape.x2 = 195;\r\n                o.graphic[0].children[1].shape.x2 = 195;\r\n                if (o.graphic.length > 2) {\r\n                    for (var x = 0; x < opt1.data.length; x++) {\r\n                        if (n === opt1.data[x].name + '市') {\r\n                            o.series[0].data = handleEvents.initSeriesData(opt1.data[x].data);\r\n                            break;\r\n                        } else o.series[0].data = [];\r\n                    }\r\n                }\r\n                name.push(n);\r\n                idx++;\r\n            } else {\r\n                console.log('jinru2', j)\r\n                o.graphic.splice(j + 2, l);\r\n                if (o.graphic.length <= 2) {\r\n                    o.graphic[0].children[0].shape.x2 = 85;\r\n                    o.graphic[0].children[1].shape.x2 = 85;\r\n                    o.series[0].data = handleEvents.initSeriesData(gdDatas);\r\n                }\r\n                name.splice(j + 1, l);\r\n                idx = j;\r\n                pos.leftCur -= pos.leftPlus * (l - j - 1);\r\n            }\r\n\r\n            o.geo.map = n;\r\n            o.geo.zoom = 1;\r\n            i.clear();\r\n            i.setOption(o);\r\n            this.zoomAnimation();\r\n            opt1.callback(n, o, i);\r\n        },\r\n\r\n        /**\r\n         * name 地图名\r\n         **/\r\n        createBreadcrumb: function(name) {\r\n            var cityToPinyin = {\r\n                \"济南市\": \"jinan\",\r\n                \"菏泽市\": \"heze\",\r\n                \"德州市\": \"dezhou\",\r\n                \"聊城市\": \"liaocheng\",\r\n                \"泰安市\": \"taian\",\r\n                \"临沂市\": \"linyi\",\r\n                \"淄博市\": \"zibo\",\r\n                \"枣庄市\": \"zaozhuang\",\r\n                \"滨州市\": \"binzhou\",\r\n                \"潍坊市\": \"yongfang\",\r\n                \"东营市\": \"dongying\",\r\n                \"青岛市\": \"qingdao\",\r\n                \"烟台市\": \"yantai\",\r\n                \"威海市\": \"weihai\",\r\n                \"日照市\": \"rizhao\",\r\n                \"济宁市\": \"jining\"\r\n            };\r\n            var breadcrumb = {\r\n                type: 'group',\r\n                id: name,\r\n                left: pos.leftCur + pos.leftPlus,\r\n                top: pos.top + 3,\r\n                children: [{\r\n                    type: 'polyline',\r\n                    left: -90,\r\n                    top: -5,\r\n                    shape: {\r\n                        points: line\r\n                    },\r\n                    style: {\r\n                        stroke: '#fff',\r\n                        key: name,\r\n                    },\r\n                    onclick: function() {\r\n                        var name = this.style.key;\r\n                        handleEvents.resetOption(myChart, option, name);\r\n                    }\r\n                }, {\r\n                    type: 'text',\r\n                    left: -68,\r\n                    top: 'middle',\r\n                    style: {\r\n                        text: name,\r\n                        textAlign: 'center',\r\n                        fill: style.textColor,\r\n                        font: style.font\r\n                    },\r\n                    onclick: function() {\r\n                        var name = this.style.text;\r\n                        handleEvents.resetOption(myChart, option, name);\r\n                    }\r\n                }, {\r\n                    type: 'text',\r\n                    left: -68,\r\n                    top: 10,\r\n                    style: {\r\n\r\n                        name: name,\r\n                        text: cityToPinyin[name] ? cityToPinyin[name].toUpperCase() : '',\r\n                        textAlign: 'center',\r\n                        fill: style.textColor,\r\n                        font: '12px \"Microsoft YaHei\", sans-serif',\r\n                    },\r\n                    onclick: function() {\r\n                        // console.log(this.style);\r\n                        var name = this.style.name;\r\n                        handleEvents.resetOption(myChart, option, name);\r\n                    }\r\n                }]\r\n            }\r\n\r\n            pos.leftCur += pos.leftPlus;\r\n\r\n            return breadcrumb;\r\n        },\r\n\r\n        // 设置effectscatter\r\n        initSeriesData: function(data) {\r\n            console.log(data, '22222222222')\r\n            var temp = [];\r\n            for (var i = 0; i < data.length; i++) {\r\n                var geoCoord = gdGeoCoordMap[data[i].name];\r\n                if (geoCoord) {\r\n                    temp.push({\r\n                        name: data[i].name,\r\n                        value: geoCoord.concat(data[i].value, data[i].level)\r\n                    });\r\n                }\r\n            }\r\n            return temp;\r\n        },\r\n\r\n        zoomAnimation: function() {\r\n            var count = null;\r\n            var zoom = function(per) {\r\n                if (!count) count = per;\r\n                count = count + per;\r\n                // console.log(per,count);\r\n                myChart.setOption({\r\n                    geo: {\r\n                        zoom: count\r\n                    }\r\n                });\r\n                if (count < 1) window.requestAnimationFrame(function() {\r\n                    zoom(0.2);\r\n                });\r\n            };\r\n            window.requestAnimationFrame(function() {\r\n                zoom(0.2);\r\n            });\r\n        }\r\n    };\r\n\r\n    var convertData = function(data) {\r\n\r\n        var res = [];\r\n        for (var i = 0; i < data.length; i++) {\r\n            var dataItem = data[i];\r\n            var name = dataItem[0].name\r\n            var fromCoord = gdGeoCoordMap[dataItem[0].name];\r\n            //var toCoord = [113.307649675, 23.1200491021]; //被攻击点坐标\r\n            var toCoord = [117.000923, 36.675807];\r\n            if (fromCoord && toCoord) {\r\n                res.push([{\r\n                    name: name,\r\n                    coord: fromCoord,\r\n                    value: dataItem[0].value\r\n                }, {\r\n                    coord: toCoord,\r\n                }]);\r\n            }\r\n        }\r\n        return res;\r\n    };\r\n\r\n    var convertData1 = function(data) {\r\n        var res = [];\r\n        for (var i = 0; i < data.length; i++) {\r\n            var dataItem = data[i];\r\n            var name = dataItem.name\r\n            var fromCoord = data[0].value.slice(0, 2)\r\n            var toCoord = dataItem.value.slice(0, 2)\r\n            if (fromCoord && toCoord) {\r\n                res.push([{\r\n                    name: name,\r\n                    coord: fromCoord,\r\n                    value: dataItem.value[2],\r\n                }, {\r\n                    coord: toCoord,\r\n                }]);\r\n            }\r\n        }\r\n        return res;\r\n    };\r\n\r\n    var series = [];\r\n    [\r\n        ['济南市', gdDatas]\r\n    ].forEach(function(item, i) {\r\n        console.log(item)\r\n        series.push({\r\n                type: 'lines',\r\n                zlevel: 1,\r\n                effect: {\r\n                    show: true,\r\n                    period: 3, //箭头指向速度，值越小速度越快\r\n                    trailLength: 0.7, //特效尾迹长度[0,1]值越大，尾迹越长重\r\n                    color: '#fff', //箭头图标\r\n                    symbolSize: 3, //图标大小\r\n                },\r\n                lineStyle: {\r\n                    normal: {\r\n                        width: 0.1, //尾迹线条宽度\r\n                        opacity: 0.2, //尾迹线条透明度\r\n                        curveness: 0.3 //尾迹线条曲直度\r\n                    }\r\n                },\r\n                data: convertData(item[1])\r\n            }, {\r\n                type: 'effectScatter',\r\n                coordinateSystem: 'geo',\r\n                zlevel: 2,\r\n                rippleEffect: { //涟漪特效\r\n                    period: 4, //动画时间，值越小速度越快\r\n                    brushType: 'stroke', //波纹绘制方式 stroke, fill\r\n                    scale: 4 //波纹圆环最大限制，值越大波纹越大\r\n                },\r\n                label: {\r\n                    normal: {\r\n                        show: false,\r\n                        position: 'right', //显示位置\r\n                        offset: [5, 0], //偏移设置\r\n                        formatter: function(params) { //圆环显示文字\r\n                            return params.data.name;\r\n                        },\r\n                        fontSize: 19\r\n                    },\r\n                    emphasis: {\r\n                        show: true\r\n                    }\r\n                },\r\n                symbol: 'circle',\r\n                symbolSize: function(val) {\r\n                    return 10 + val[2] * 0; //圆环大小\r\n                },\r\n                itemStyle: {\r\n                    normal: {\r\n                        show: false,\r\n                        color: '#f00'\r\n                    }\r\n                },\r\n                data: item[1].map(function(dataItem) {\r\n                    return {\r\n                        name: dataItem[0].name,\r\n                        value: gdGeoCoordMap[dataItem[0].name].concat([dataItem[0].value])\r\n                    };\r\n                }),\r\n            },\r\n            //被攻击点\r\n            {\r\n                type: 'scatter',\r\n                coordinateSystem: 'geo',\r\n                zlevel: 2,\r\n                rippleEffect: {\r\n                    period: 4,\r\n                    brushType: 'stroke',\r\n                    scale: 4\r\n                },\r\n                label: {\r\n                    normal: {\r\n                        show: false,\r\n                        position: 'right',\r\n                        //offset:[5, 0],\r\n                        color: '#0f0',\r\n                        formatter: '{b}',\r\n                        textStyle: {\r\n                            color: \"#0f0\"\r\n                        }\r\n                    },\r\n                    emphasis: {\r\n                        show: false,\r\n                        color: \"#f60\"\r\n                    }\r\n                },\r\n                // symbol: 'pin',\r\n                // symbolSize: 50,\r\n                // data: [{\r\n                //     name: item[0],\r\n                //     value: gdGeoCoordMap[item[0]].concat([10]),\r\n                // }],\r\n            }\r\n        );\r\n    });\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    option = {\r\n            \"tooltip\": {\r\n                trigger: 'item',\r\n                backgroundColor: 'rgba(0,0,0,0)',\r\n                formatter: function(item) {\r\n                    console.log(item, 'item!!!!')\r\n                    if (item.componentSubType === 'lines') {\r\n                        var tipHtml1 = '';\r\n                        tipHtml1 = '<div style=\"background:#fff;border-radius:10px;padding-top:10px;box-shadow:0 0 10px #666\">' +\r\n                            '<div style=\"color:#fff;height:20px;border-radius:6px;font-size:12px;line-height:20px;background-color:#5861a2;text-align:center;margin:0 2px;\">' + item.data.name + '</div>' +\r\n                            '<div style=\"text-align:center;color:#494949;padding:8px 6px\">' +\r\n                            '<span style=\"font-size:18px;font-weight:bold;\">' + '总测试设备：' + item.data.value + ' ' + '</span>' +\r\n                            '</div>' + '</div>';\r\n                        return tipHtml1;\r\n                    } else if (item.componentSubType === 'effectScatter') {\r\n                        var tipHtml2 = '';\r\n                        tipHtml2 = '<div style=\"background:#fff;border-radius:10px;padding-top:10px;box-shadow:0 0 10px #666\">' +\r\n                            '<div style=\"color:#fff;height:20px;border-radius:6px;font-size:12px;line-height:20px;background-color:#5861a2;text-align:center;margin:0 2px;\">' + item.data.name + '</div>' +\r\n                            '<div style=\"text-align:center;color:#494949;padding:8px 6px\">' +\r\n                            '<span style=\"font-size:18px;font-weight:bold;\">' + '总测试设备：' + item.data.value[2] + ' ' + '</span>' +\r\n                            '</div>' + '</div>';\r\n                        return tipHtml2;\r\n                    } else if (item.componentSubType === 'scatter') {\r\n                        var tipHtml3 = '';\r\n                        tipHtml3 = '<div style=\"background:#fff;border-radius:10px;padding-top:10px;box-shadow:0 0 10px #666\">' +\r\n                            '<div style=\"color:#fff;height:20px;border-radius:6px;font-size:12px;line-height:20px;background-color:#5861a2;text-align:center;margin:0 2px;\">' + item.data.name + '</div>' +\r\n                            '<div style=\"text-align:center;color:#494949;padding:8px 6px\">' +\r\n                            '<span style=\"font-size:18px;font-weight:bold;\">' + '总测试设备：' + item.data.value[2] + ' ' + '</span>' +\r\n                            '</div>' + '</div>';\r\n                        return tipHtml3;\r\n                    }\r\n                }\r\n            },\r\n            backgroundColor: \"#013954\",\r\n            \"graphic\": [{\r\n                type: 'group',\r\n                left: pos.left,\r\n                top: pos.top - 4,\r\n                children: [{\r\n                    type: 'line',\r\n                    left: 0,\r\n                    top: -20,\r\n                    shape: {\r\n                        x1: 0,\r\n                        y1: 0,\r\n                        x2: 85,\r\n                        y2: 0\r\n                    },\r\n                    style: {\r\n                        stroke: style.lineColor,\r\n                    }\r\n                }, {\r\n                    type: 'line',\r\n                    left: 0,\r\n                    top: 20,\r\n                    shape: {\r\n                        x1: 0,\r\n                        y1: 0,\r\n                        x2: 85,\r\n                        y2: 0\r\n                    },\r\n                    style: {\r\n                        stroke: style.lineColor,\r\n                    }\r\n                }]\r\n            }, {\r\n                id: name[idx],\r\n                type: 'group',\r\n                left: pos.left + 2,\r\n                top: pos.top,\r\n                children: [{\r\n                    type: 'polyline',\r\n                    left: 90,\r\n                    top: -12,\r\n                    shape: {\r\n                        points: line\r\n                    },\r\n                    style: {\r\n                        stroke: 'transparent',\r\n                        key: name[0]\r\n                    },\r\n                    onclick: function() {\r\n                        var name = this.style.key;\r\n                        console.log(name, '111111')\r\n                        handleEvents.resetOption(myChart, option, name);\r\n                    }\r\n                }, {\r\n                    type: 'text',\r\n                    left: 0,\r\n                    top: 'middle',\r\n                    style: {\r\n                        text: name[0] === '山东' ? '山东省' : name[0],\r\n                        textAlign: 'center',\r\n                        fill: style.textColor,\r\n                        font: style.font\r\n                    },\r\n                    onclick: function() {\r\n                        handleEvents.resetOption(myChart, option, '山东');\r\n                    }\r\n                }, {\r\n                    type: 'text',\r\n                    left: 0,\r\n                    top: 10,\r\n                    style: {\r\n                        text: 'SHANDONG',\r\n                        textAlign: 'center',\r\n                        fill: style.textColor,\r\n                        font: '12px \"Microsoft YaHei\", sans-serif',\r\n                    },\r\n                    onclick: function() {\r\n                        handleEvents.resetOption(myChart, option, '山东');\r\n                    }\r\n                }]\r\n            }],\r\n            visualMap: { //图例值控制\r\n                min: 0,\r\n                max: 1,\r\n                calculable: true,\r\n                show: false,\r\n                color: ['#f44336', '#fc9700', '#ffde00', '#ffde00', '#00eaff'],\r\n                textStyle: {\r\n                    color: '#fff'\r\n                }\r\n            },\r\n            \"geo\": {\r\n                \"map\": \"山东\",\r\n                \"layoutCenter\": [\"55%\", \"50%\"],\r\n                \"layoutSize\": \"109%\",\r\n                \"label\": {\r\n                    \"normal\": {\r\n                        \"show\": true,\r\n                        \"textStyle\": {\r\n                            \"color\": '#fff'\r\n                        }\r\n                    },\r\n                    \"emphasis\": {\r\n                        \"textStyle\": {\r\n                            \"color\": '#fff'\r\n                        }\r\n                    }\r\n                },\r\n                \"roam\": true, //是否允许缩放\r\n                \"mapLocation\": {\r\n                    \"width\": \"110%\",\r\n                    \"height\": \"97%\"\r\n                },\r\n\r\n                \"itemStyle\": {\r\n                    \"normal\": {\r\n                        borderColor: 'rgba(147, 235, 248, 1)',\r\n                        borderWidth: 1,\r\n                        areaColor: {\r\n                            type: 'radial',\r\n                            x: 0.5,\r\n                            y: 0.5,\r\n                            r: 0.8,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: 'rgba(147, 235, 248, 0)' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: 'rgba(147, 235, 248, .2)' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        },\r\n                        shadowColor: 'rgba(128, 217, 248, 1)',\r\n                        // shadowColor: 'rgba(255, 255, 255, 1)',\r\n                        shadowOffsetX: -2,\r\n                        shadowOffsetY: 2,\r\n                        shadowBlur: 10\r\n                    },\r\n                    \"emphasis\": {\r\n                        itemStyle: {\r\n                            areaColor: '#FFD181',\r\n                            borderColor: '#404a59',\r\n                            borderWidth: 1\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            series: series\r\n        },\r\n        myChart.setOption(option);\r\n    myChart.on('click', function(params) {\r\n        console.log(params)\r\n        var _self = this;\r\n        if (cityMap[params.name]) {\r\n            var url = cityMap[params.name];\r\n            $.get(url, function(response) {\r\n                //console.log(response, 'res');\r\n                curGeoJson = response;\r\n                echarts.registerMap(params.name, response);\r\n                handleEvents.resetOption(_self, option, params.name);\r\n            });\r\n        }\r\n    });\r\n});","html":"","externalScripts":"","updaterUID":"obd-oMN8owbmY0AMpeQVjGwQ2v4fIV7A12R","theme":"","layout":"","viewCount":4281,"userName":"e***2","commentCount":0,"starCount":23,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xH8UwQc2hU.png?v=1601022412854","isCustomThumbnail":0,"builtinTags":["category-work","geo","graphic","series-effectScatter","series-lines","series-scatter","tooltip","visualMap"],"customTags":[],"updaterUserName":"e***2"}}