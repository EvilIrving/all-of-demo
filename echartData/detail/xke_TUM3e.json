{"status":0,"data":{"cid":"xke_TUM3e","authorUid":"bd-1606641265","authorUserName":"你***1","title":"设备简图","description":"数据实时更新","latestVersion":1,"alwaysLatest":1,"createTime":"2020-02-13T09:00:58.000Z","lastUpdateTime":"2020-02-13T09:00:58.000Z","auth":2,"uid":"bd-1606641265","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.4.0","versionCreateTime":"2020-02-13T09:00:58.000Z","code":"var plantCap = [{\n    name: '过渡仓温度',\n    value: '800'\n}, {\n    name: '排料温度',\n    value: '150'\n}, {\n    name: '每小时投料量',\n    value: '10'\n}, {\n    name: '窑尾负压',\n    value: '-55'\n}, {\n    name: '电机转速',\n    value: '760'\n}, {\n    name: '煅烧带温度',\n    value: '500'\n}, {\n    name: '窑头温度',\n    value: '666'\n},{\n    name:'二次风转速',\n    value:\"1100\"\n}];\nvar dataRangeList=[{\n    name:'过渡仓温度',\n    range:[110,1350],\n    unit:'℃',\n    offset: [5, 70]\n}, {\n    name: '排料温度',\n    range: [30, 120],\n    unit:'℃',\n    offset: [38, 15]\n}, {\n    name: '每小时投料量',\n    range:[0, 25],\n    unit:'t/h',\n    offset: [13, 30]\n}, {\n    name: '窑尾负压',\n    range:[-45, -5],\n    unit:'Pa',\n    offset: [20, 100]\n}, {\n    name: '电机转速',\n    range:[650, 1200],\n    unit:'r/min',\n    offset: [70, 17]\n}, {\n    name: '煅烧带温度',\n    range: [110, 1350],\n    unit:'℃',\n    offset: [45, 105]\n}, {\n    name: '窑头温度',\n    range:[500, 1000],\n    unit:'℃',\n    offset: [90, 50]\n},{\n    name:'二次风转速',\n    range:[400,1200],\n    unit:'r/min',\n    offset:[75, 95]\n}]\nvar datas = [];\nvar scatterChangeData=[\n    {\"煅烧带温度\":\"1629.332435\",\"窑头温度\":\"8008.5791066\",\"窑尾温度\":\"889.2533913\",\"窑头负压\":\"-13.05208958\",\"窑尾负压\":\"-27.49793445\",\"过渡仓温度\":\"794.4836498\",\"排料温度\":\"104.8058228\",\"二次风转速\":\"462.6774131\",\"电机转速\":\"860.1908243\",\"每小时投料量\":\"13.20013379\"},\n    {\"煅烧带温度\":\"1148.966078\",\"窑头温度\":\"914.3966791\",\"窑尾温度\":\"1060.840939\",\"窑头负压\":\"-0.370034962\",\"窑尾负压\":\"-44.89323923\",\"过渡仓温度\":\"1141.681524\",\"排料温度\":\"75.78547461\",\"二次风转速\":\"975.280138\",\"电机转速\":\"1165.840343\",\"每小时投料量\":\"8.129950129\"},\n    {\"煅烧带温度\":\"1589.411183\",\"窑头温度\":\"884.2022576\",\"窑尾温度\":\"1182.008457\",\"窑头负压\":\"-4.605446111\",\"窑尾负压\":\"-34.25039165\",\"过渡仓温度\":\"711.5585378\",\"排料温度\":\"63.66215703\",\"二次风转速\":\"967.0480237\",\"电机转速\":\"788.5137323\",\"每小时投料量\":\"6.432888199\"},\n    {\"煅烧带温度\":\"1103.540863\",\"窑头温度\":\"879.7202962\",\"窑尾温度\":\"1134.026109\",\"窑头负压\":\"-2.385525634\",\"窑尾负压\":\"-27.83503472\",\"过渡仓温度\":\"943.1293979\",\"排料温度\":\"34.28524456\",\"二次风转速\":\"896.6131519\",\"电机转速\":\"1039.517157\",\"每小时投料量\":\"15.84427779\"},\n];\nvar outrangeData=[];\nfunction getTime(){     \t//获取时间\n\tvar date=new Date();\n\n\tvar year=date.getFullYear();\n\tvar month=date.getMonth()+1;\n\tvar day=date.getDate();\n\n    var hour=date.getHours();\n    var minute=date.getMinutes();\n    var second=date.getSeconds();\n    if (hour<10) {\n    \thour='0'+hour;\n    }\n    if (minute<10) {\n    \tminute='0'+minute;\n    }\n    if (second<10) {\n    \tsecond='0'+second;\n    }\n\n    var time=year+'/'+month+'/'+day+'/'+hour+':'+minute+':'+second\n    return time;\n    \n}\nfunction getScatterData(data){\n    var _datas=[];\n    for (var i = 0; i < dataRangeList.length; i++) {\n        var item= dataRangeList[i],\n            itemRange = item.range,\n            itemColor,\n            itemOpacity,\n            _data;\n        \n        for(var k in data){\n            if(k == item.name){\n                _data=Number(data[k]).toFixed(2);//value保留两位小数\n                if(_data > itemRange[1] || item.value < itemRange[0]){\n                    //故障\n                    itemColor=\"rgba(0,0,0,0.5)\";\n                    itemOpacity = 0.8;\n                    var _oneFalutData={\n                        time: getTime(),\n                        name: item.name,\n                        data: _data,\n                        range: itemRange\n                    }\n                    outrangeData.push(_oneFalutData)\n                }else{\n                    var _num = (itemRange[1]- itemRange[0])/5\n                    if(item.unit == \"℃\"){\n                            if(itemRange[0]<_data && _data<=itemRange[0]+_num*1){\n                                itemColor = \"#fb6969\"\n                            }else if(itemRange[0]+_num*1<_data && _data<=itemRange[0]+_num*2){\n                                itemColor = \"#f54646\"\n                            }else if(itemRange[0]+_num*2<_data && _data<=itemRange[0]+_num*3){\n                                itemColor=\"#ef4747\"\n                            }else if(itemRange[0]+_num*3<_data && _data<=itemRange[0]+_num*4){\n                                itemColor=\"#e41818\"\n                            }else if(itemRange[0]+_num*4<_data && _data<=itemRange[1]){\n                                itemColor = \"#a90909\"\n                            }\n                    }else{\n                        itemColor=\"rgba(104,184,55, 1)\";\n                        itemOpacity = 0.8\n                    }\n                }\n                _datas.push({\n                    name: _data+item.unit + '\\n' + item.name,\n                    value: item.offset,\n                    symbolSize: 62,\n                    label: {\n                        normal: {\n                            textStyle: {\n                                fontSize: 11\n                            }\n                        }\n                    },\n                    itemStyle: {\n                        normal: {\n                            color: itemColor,\n                            opacity: 0.8,\n                            shadowColor: itemColor,\n                            shadowBlur: 15\n                        }\n                    },\n                })\n            }\n        }    \n    }\n    return _datas\n};\nvar timeName=['正常运行时间：10h','停窑时间：0.5h','停料保温时间：1h','故障时间：0.2h' ]\noption = {\n    \n    backgroundColor:\"#fff\",\n    grid:{\n      top: 0,\n      bottom: 60,\n      left: 50,\n      right: 50\n    },\n    xAxis: [{\n        type:'category',\n        show: false,\n        data: [10, 20, 30, 40, 50, 60, 70, 80, 90]\n    },{\n        show: false,\n        type: 'value',\n        max:100,\n    },{\n        inverse: true,\n        show: false\n    }],\n    yAxis: [{\n        type: 'value',\n        show: false,\n        position:'left',\n        max: 150\n    },{\n        type:'category',\n        position: 'right',\n        inverse: true,\n        show: false\n    }],\n    series: [{\n        name: '窑',\n        type: 'line',\n        xAxisIndex:0,\n        data:[null,80,{\n            name:'窑尾',\n            value: 80,\n            label: {\n                show: true,\n                color:'#fff',\n                formatter: '{b}',\n                offset:[20,14],\n                fontSize:18\n            }\n        }, 79, 78, 77,{\n            name:'窑头',\n            value:76,\n            label:{\n                show: true,\n                color:'#fff',\n                formatter: '{b}',\n                offset:[-20,14],\n                fontSize:18\n            }\n        }],\n        // symbol:'none',\n        symbolSize: 0.01,\n        lineStyle:{\n            width: 40,\n            color: '#e4a618'\n        }\n    },{\n        name:'过渡仓',\n        type: 'line',\n        data:[null, 80,{\n            name:'过渡仓',\n            value: 80,\n            label:{\n                show: true,\n                color:'#fff',\n                formatter: '{b}',\n                offset:[-30, 14],\n                fontSize: 12\n            }\n        }],\n        symbolSize: 0.01,\n        lineStyle:{\n            color:'#4c60ff',\n            width: 40 ,\n        },\n    },{\n        name:'冷却机',\n        type: 'line',\n        data:[null,null,40,41,42,\n        {\n            value: 43,\n            name: '冷却机',\n            label: {\n                show: true,\n                color:'#fff',\n                formatter: '{b}',\n                offset:[-40, 14],\n                fontSize: 18\n            }\n        },44],\n        symbolSize: 0.01,\n        lineStyle:{\n            color:'#e4a618',\n            width: 40 ,\n        },\n    },{\n        type: 'scatter',\n        symbol: 'circle',\n        coordinateSystem: 'cartesian2d',\n        xAxisIndex: 1,\n        symbolSize: 120,\n        label: {\n            normal: {\n                show: true,\n                formatter: '{b}',\n                color: '#fff',\n                textStyle: {\n                    fontSize: '20'\n                }\n            },\n        },\n        itemStyle: {\n            normal: {\n                color: '#00acea'\n            }\n        },\n        animation: false,\n        data:getScatterData(scatterChangeData[0])\n    },{\n        name: '连接线',\n        type: 'lines',\n        coordinateSystem: 'cartesian2d',\n        xAxisIndex:1,\n        lineStyle:{\n            curveness: -0.4,\n            color: '#999',\n            opacity: 1,\n            width:30\n        },\n        data:[{\n            coords:[\n                [69, 42],  \n                [69, 78] \n            ]\n        }]\n    }]\n};\nvar count = 0;\n var t = null;\n    t = setTimeout(time, 1000); //開始运行\n    function time() {\n        clearTimeout(t); //清除定时器\n        count++;\n        if(count >= scatterChangeData.length){\n            count = 0;\n        }\n        var scatterData=scatterChangeData[count];//当前数据\n        option.series[3].data=getScatterData(scatterData)\n        myChart.setOption(option)\n        if(outrangeData.length>0){\n            for(var i=0; i< outrangeData.length;i++){\n                var _one = outrangeData[i],\n                    str='<tr><td width=\"35%\">'+_one.time+'</td><td width=\"30%\">'+_one.name+'</td><td>'+_one.data+'</td><td>'+_one.range+'</td></tr>'\n                $('.broadcast tbody').append(str)\n            }\n        }\n        t = setTimeout(time, 1000); //设定定时器，循环运行\n    }\n\n","html":"","externalScripts":"","updaterUID":"bd-1606641265","theme":"","layout":"","viewCount":325,"userName":"你***1","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xke_TUM3e.png?v=1581584458942","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-line","series-lines","series-scatter"],"customTags":[],"updaterUserName":"你***1"}}