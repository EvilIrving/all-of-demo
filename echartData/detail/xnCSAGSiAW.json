{"status":0,"data":{"cid":"xnCSAGSiAW","authorUid":"bd-2133619855","authorUserName":"小***乖","title":"地图","description":"地图","latestVersion":5,"alwaysLatest":1,"createTime":"2019-09-10T01:53:55.000Z","lastUpdateTime":"2019-09-10T01:53:55.000Z","auth":2,"uid":"bd-2133619855","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":5,"parentVersion":4,"echartsVersion":"4.4.0","versionCreateTime":"2019-11-08T08:38:46.000Z","code":"var mapName = 'china'\nvar huoyueData =[\n{name:\"上海\",value: 7986},\n{name:\"云南\",value: 1320},\n{name:\"内蒙古\",value: 1110},\n{name:\"北京\",value: 246},\n{name:\"吉林\",value: 162},\n{name:\"四川\",value: 2792},\n{name:\"天津\",value: 1851},\n{name:\"安徽\",value: 2037},\n{name:\"山东\",value: 5069},\n{name:\"山西\",value: 1500},\n{name:\"广东\",value: 833},\n{name:\"广西\",value: 131},\n{name:\"新疆\",value: 2213},\n{name:\"江苏\",value: 2251},\n{name:\"江西\",value: 889},\n{name:\"河北\",value: 1176},\n{name:\"河南\",value: 3121},\n{name:\"浙江\",value: 11585},\n{name:\"海南\",value: 7},\n{name:\"湖北\",value: 170},\n{name:\"湖南\",value: 1002},\n{name:\"甘肃\",value: 268},\n{name:\"福建\",value: 952},\n{name:\"西藏\",value: 29},\n{name:\"贵州\",value: 47},\n{name:\"辽宁\",value: 1389},\n{name:\"重庆\",value: 235},\n{name:\"陕西\",value: 377},\n{name:\"黑龙江\",value: 239}\n]\n// 活跃排序\n// 排序\nfunction keysort(key) {\n    return function(a, b) {\n        return Number(b[key] - a[key])\n    }\n}\nhuoyueData.sort(keysort('value')); //按照fev1与fvc的和进行排序\n\nvar geoCoordMap = {};\nvar toolTipData = [ //总数量\n    {\n        name: \"北京\",\n        value: [{\n            name: \"肺悦1\",\n            value: 95\n        }, {\n            name: \"肺悦2\",\n            value: 82\n        }]\n    },\n    {\n        name: \"天津\",\n        value: [{\n            name: \"肺悦1\",\n            value: 22\n        }, {\n            name: \"肺悦2\",\n            value: 20\n        }]\n    },\n    {\n        name: \"河北\",\n        value: [{\n            name: \"肺悦1\",\n            value: 60\n        }, {\n            name: \"肺悦2\",\n            value: 42\n        }]\n    },\n    {\n        name: \"山西\",\n        value: [{\n            name: \"肺悦1\",\n            value: 40\n        }, {\n            name: \"肺悦2\",\n            value: 41\n        }]\n    },\n    {\n        name: \"内蒙古\",\n        value: [{\n            name: \"肺悦1\",\n            value: 23\n        }, {\n            name: \"肺悦2\",\n            value: 24\n        }]\n    },\n    {\n        name: \"辽宁\",\n        value: [{\n            name: \"肺悦1\",\n            value: 39\n        }, {\n            name: \"肺悦2\",\n            value: 28\n        }]\n    },\n    {\n        name: \"吉林\",\n        value: [{\n            name: \"肺悦1\",\n            value: 41\n        }, {\n            name: \"肺悦2\",\n            value: 41\n        }]\n    },\n    {\n        name: \"黑龙江\",\n        value: [{\n            name: \"肺悦1\",\n            value: 35\n        }, {\n            name: \"肺悦2\",\n            value: 31\n        }]\n    },\n    {\n        name: \"上海\",\n        value: [{\n            name: \"肺悦1\",\n            value: 12\n        }, {\n            name: \"肺悦2\",\n            value: 12\n        }]\n    },\n    {\n        name: \"江苏\",\n        value: [{\n            name: \"肺悦1\",\n            value: 47\n        }, {\n            name: \"肺悦2\",\n            value: 45\n        }]\n    },\n    {\n        name: \"浙江\",\n        value: [{\n            name: \"肺悦1\",\n            value: 57\n        }, {\n            name: \"肺悦2\",\n            value: 57\n        }]\n    },\n    {\n        name: \"安徽\",\n        value: [{\n            name: \"肺悦1\",\n            value: 57\n        }, {\n            name: \"肺悦2\",\n            value: 52\n        }]\n    },\n    {\n        name: \"福建\",\n        value: [{\n            name: \"肺悦1\",\n            value: 59\n        }, {\n            name: \"肺悦2\",\n            value: 57\n        }]\n    },\n    {\n        name: \"江西\",\n        value: [{\n            name: \"肺悦1\",\n            value: 49\n        }, {\n            name: \"肺悦2\",\n            value: 42\n        }]\n    },\n    {\n        name: \"山东\",\n        value: [{\n            name: \"肺悦1\",\n            value: 67\n        }, {\n            name: \"肺悦2\",\n            value: 52\n        }]\n    },\n    {\n        name: \"河南\",\n        value: [{\n            name: \"肺悦1\",\n            value: 69\n        }, {\n            name: \"肺悦2\",\n            value: 68\n        }]\n    },\n    {\n        name: \"湖北\",\n        value: [{\n            name: \"肺悦1\",\n            value: 60\n        }, {\n            name: \"肺悦2\",\n            value: 56\n        }]\n    },\n    {\n        name: \"湖南\",\n        value: [{\n            name: \"肺悦1\",\n            value: 62\n        }, {\n            name: \"肺悦2\",\n            value: 52\n        }]\n    },\n    {\n        name: \"重庆\",\n        value: [{\n            name: \"肺悦1\",\n            value: 47\n        }, {\n            name: \"肺悦2\",\n            value: 44\n        }]\n    },\n    {\n        name: \"四川\",\n        value: [{\n            name: \"肺悦1\",\n            value: 65\n        }, {\n            name: \"肺悦2\",\n            value: 60\n        }]\n    },\n    {\n        name: \"贵州\",\n        value: [{\n            name: \"肺悦1\",\n            value: 32\n        }, {\n            name: \"肺悦2\",\n            value: 30\n        }]\n    },\n    {\n        name: \"云南\",\n        value: [{\n            name: \"肺悦1\",\n            value: 42\n        }, {\n            name: \"肺悦2\",\n            value: 41\n        }]\n    },\n    {\n        name: \"西藏\",\n        value: [{\n            name: \"肺悦1\",\n            value: 5\n        }, {\n            name: \"肺悦2\",\n            value: 4\n        }]\n    },\n    {\n        name: \"陕西\",\n        value: [{\n            name: \"肺悦1\",\n            value: 38\n        }, {\n            name: \"肺悦2\",\n            value: 42\n        }]\n    },\n    {\n        name: \"甘肃\",\n        value: [{\n            name: \"肺悦1\",\n            value: 28\n        }, {\n            name: \"肺悦2\",\n            value: 28\n        }]\n    },\n    {\n        name: \"青海\",\n        value: [{\n            name: \"肺悦1\",\n            value: 5\n        }, {\n            name: \"肺悦2\",\n            value: 5\n        }]\n    },\n    {\n        name: \"宁夏\",\n        value: [{\n            name: \"肺悦1\",\n            value: 10\n        }, {\n            name: \"肺悦2\",\n            value: 8\n        }]\n    },\n    {\n        name: \"新疆\",\n        value: [{\n            name: \"肺悦1\",\n            value: 36\n        }, {\n            name: \"肺悦2\",\n            value: 31\n        }]\n    },\n    {\n        name: \"广东\",\n        value: [{\n            name: \"肺悦1\",\n            value: 63\n        }, {\n            name: \"肺悦2\",\n            value: 60\n        }]\n    },\n    {\n        name: \"广西\",\n        value: [{\n            name: \"肺悦1\",\n            value: 29\n        }, {\n            name: \"肺悦2\",\n            value: 30\n        }]\n    },\n    {\n        name: \"海南\",\n        value: [{\n            name: \"肺悦1\",\n            value: 8\n        }, {\n            name: \"肺悦2\",\n            value: 6\n        }]\n    },\n    {\n        name: \"香港\",\n        value: [{\n            name: \"肺悦1\",\n            value: 0\n        }, {\n            name: \"肺悦2\",\n            value: 0\n        }]\n    },\n    {\n        name: \"澳门\",\n        value: [{\n            name: \"肺悦1\",\n            value: 0\n        }, {\n            name: \"肺悦2\",\n            value: 0\n        }]\n    },\n    {\n        name: \"台湾\",\n        value: [{\n            name: \"肺悦1\",\n            value: 0\n        }, {\n            name: \"肺悦2\",\n            value: 0\n        }]\n    },\n];\n/*获取地图数据*/\nvar mapFeatures = echarts.getMap(mapName).geoJson.features;\nmapFeatures.forEach(function(v) {\n    // 地区名称\n    var name = v.properties.name;\n    // 地区经纬度\n    geoCoordMap[name] = v.properties.cp;\n});\n// console.log(\"============geoCoordMap===================\")\n// console.log(geoCoordMap)\n// console.log(\"================data======================\")\n// console.log(data)\n// console.log(toolTipData)\nvar max = 480, //设置的气泡等大小的系数\n    min = 9; // todo //设置的气泡等大小的系数\nvar maxSize4Pin = 100, //设置的气泡等大小的系数\n    minSize4Pin = 20; //设置的气泡等大小的系数\n\nvar convertData = function(dt) {// 处理覆盖上面的点，得有经纬度，所以下面的value有经纬度\n    var res = [];\n    for (var i = 0; i < dt.length; i++) {\n        var geoCoord = geoCoordMap[dt[i].name];\n        if (geoCoord) {\n            res.push({\n                name: dt[i].name,\n                value: geoCoord.concat(dt[i].value),//这里把经纬度\n            });\n        }\n    }\n    return res;\n};\noption = {\n\n    backgroundColor:'#fff',\n    title: {\n        text: \"各省肺悦检测人数统计\",\n        // subtext: \"数据来自朔茂科技\",\n        x: 'center',\n        textStyle: {\n            color: \"#000\",\n            fontSize: 36,\n            fontWeight: 'normal'\n        },\n        subtextStyle: {\n            fontSize: 14,\n        }\n    },\n    tooltip: {\n        trigger: 'item',\n        formatter: function(params) {\n            // console.log(typeof(params.value)[2])\n            if (typeof(params.value)[2] == \"undefined\" || typeof(params.value)[2] == 'object') {\n                var toolTiphtml = ''\n                for (var i = 0; i < toolTipData.length; i++) {\n                    if (params.name == toolTipData[i].name) {\n                        toolTiphtml += toolTipData[i].name + '（设备覆盖情况）<br>'\n                        for (var j = 0; j < toolTipData[i].value.length; j++) {\n                            toolTiphtml += toolTipData[i].value[j].name + '：' + toolTipData[i].value[j].value + \"<br>\"\n                        }\n                    }\n                }\n                // console.log(toolTiphtml)\n                // console.log(convertData(data))\n                return toolTiphtml;\n            } else {\n                var toolTiphtml = ''\n                // for(var i = 0;i<toolTipData.length;i++){\n                //     if(params.name==toolTipData[i].name){\n                //         toolTiphtml += toolTipData[i].name+'：<br>'\n                //         for(var j = 0;j<toolTipData[i].value.length;j++){\n                //             toolTiphtml+=toolTipData[i].value[j].name+'：'+toolTipData[i].value[j].value+\"<br>\"\n                //         }\n                //     }\n                // }\n                toolTiphtml += params.name + '：<br>';\n                toolTiphtml += '活跃数：' + params.data.value[2];\n                // console.log(toolTiphtml)\n                // console.log(convertData(data))\n                return toolTiphtml;\n            }\n        }\n    },\n    // legend: {\n    //     orient: 'vertical',\n    //     y: 'bottom',\n    //     x: 'right',\n    //     data: ['credit_pm2.5'],\n    //     textStyle: {\n    //         color: '#fff'\n    //     }\n    // },\n    visualMap: {\n        show: true, //去掉层级过滤显示\n        min: 0,\n        // max: 200,//取活跃值最高的当上限\n        max: huoyueData[0].value, //取活跃值最高的当上限\n        left: 'left',\n        top: 'bottom',\n        text: ['高', '低'], // 文本，默认为数值文本\n        calculable: true,\n        seriesIndex: [1],\n        textStyle: {\n            color: '#C8D3FF',\n        },\n        inRange: {\n            // color: ['#3B5077', '#031525'] // 蓝黑\n            // color: ['#ffc0cb', '#800080'] // 红紫\n            // color: ['#3C3B3F', '#605C3C'] // 黑绿\n            // color: ['#0f0c29', '#302b63', '#24243e'] // 黑紫黑\n            // color: ['#23074d', '#cc5333'] // 紫红\n      \n            // color: ['#1488CC', '#031525'] // 浅蓝\n            color: ['#f5eca9', '#be4750'] // 蓝绿\n            // color: ['#5474F6', '#3652D5', '#2542AF', '#1D1663']\n        }\n    },\n    /*工具按钮组*/\n    // toolbox: {\n    //     show: true,\n    //     orient: 'vertical',\n    //     left: 'right',\n    //     top: 'center',\n    //     feature: {\n    //         dataView: {\n    //             readOnly: false\n    //         },\n    //         restore: {},\n    //         saveAsImage: {}\n    //     }\n    // },\n    geo: {\n        show: true,\n        map: mapName,\n        label: {\n            normal: {\n                show: false\n            },\n            emphasis: {\n                show: false,\n            }\n        },\n        layoutCenter: [\"50%\", \"50%\"],\n        layoutSize: \"120%\",\n        roam: false, //是否可以放大缩小\n        itemStyle: {\n            normal: {\n                // areaColor: '#031525',//所有地图区块默认的\n                // areaColor: '#3764FF', //所有地图区块默认的\n                // borderColor: '#3B5077',\n            },\n            emphasis: {\n                // areaColor: '#2B91B7',//省份放上去的颜色\n                areaColor: 'rgba(55, 100, 255, 0.5)', //省份放上去的颜色\n            }\n        }\n    },\n    series: [{\n            name: '散点', //省份的名称以及名称旁边的，根据数据来显示：有数据就显示没有数据就不显示\n            type: 'scatter',\n            coordinateSystem: 'geo',\n            data: convertData(toolTipData),\n            symbolSize: function(val) {\n                if (Number(val[2].value) + Number(val[3].value) > 0) {\n                    return 20; //固定\n                } else {\n                    return 0; //不显示\n                }\n                console.log(val)\n                // return val[2] / 10;//根据数据自适应大小\n\n            },\n            label: {\n                normal: {\n                    formatter: '{b}',\n                    position: 'right',\n                    show: true\n                },\n                emphasis: {\n                    show: true\n                }\n            },\n            itemStyle: {\n                normal: {\n                    color: '#05C3F9'\n                }\n            }\n        },\n        {\n            type: 'map',\n            map: mapName,\n            geoIndex: 0,\n            aspectScale: 0.75, //长宽比\n            showLegendSymbol: false, // 存在legend时显示\n            label: {\n                normal: {\n                    show: true\n                },\n                emphasis: {\n                    show: false,\n                    textStyle: {\n                        color: '#fff'\n                    }\n                }\n            },\n            roam: true,\n            itemStyle: {\n                normal: {\n                    areaColor: '#031525',\n                    borderColor: '#3B5077',\n                },\n                emphasis: {\n                    areaColor: '#2B91B7'\n                }\n            },\n            animation: false,\n            data: huoyueData\n        },\n        // 这里注释的是总数的分布\n        // {\n        //     name: '点',\n        //     type: 'scatter',\n        //     coordinateSystem: 'geo',\n        //     symbol: 'pin', //气泡\n        //     symbolSize: function(val) {\n        //         var a = (maxSize4Pin - minSize4Pin) / (max - min);\n        //         var b = minSize4Pin - a * min;\n        //         b = maxSize4Pin - a * max;\n        //         return a * val[2] + b;//气泡的大小随之数据变化\n        //     },\n        //     label: {\n        //         normal: {\n        //             show: true,\n        //             formatter: function(params) {\n        //                 return params.data.value[2]\n        //             },\n        //             textStyle: {\n        //                 color: '#fff',\n        //                 fontSize: 9,\n        //             }\n        //         }\n        //     },\n        //     itemStyle: {\n        //         normal: {\n        //             color: '#F62157', //标志颜色.气泡颜色\n        //         }\n        //     },\n        //     zlevel: 6,\n        //     data: convertData(data),\n        // },\n        // 这里的是活跃的分布\n        {\n            name: '点',\n            type: 'scatter',\n            coordinateSystem: 'geo',\n            symbol: 'pin', //气泡\n            symbolSize: function(val) {\n                var a = (maxSize4Pin - minSize4Pin) / (max - min);\n                var b = minSize4Pin - a * min;\n                b = maxSize4Pin - a * max;\n                // 没有活跃度的不显示气泡有的才显示\n                return 70\n\n            },\n            label: {\n                normal: {\n                    show: true,\n                    formatter: function(params) {\n                        return params.data.value[2]\n                    },\n                    textStyle: {\n                        color: '#fff',\n                        fontSize: 15,\n                    }\n                }\n            },\n            itemStyle: {\n                normal: {\n                    color: '#F62157', //标志颜色.气泡颜色\n                }\n            },\n            zlevel: 6,\n            data: convertData(huoyueData),\n        },\n        // {\n        //     name: 'Top 5',\n        //     type: 'effectScatter',\n        //     coordinateSystem: 'geo',\n        //     data: convertData(huoyueData.sort(function(a, b) {\n        //         return b.value - a.value;\n        //     }).slice(0, 5)),\n        //     symbolSize: function(val) {\n        //         return val[2] / 10 > 10 ? val[2] / 10 : 10; //自适应大小\n        //     },\n        //     showEffectOn: 'render',\n        //     rippleEffect: {\n        //         period: 10, //涟漪动画周期\n        //         brushType: 'stroke'\n        //     },\n        //     hoverAnimation: false,\n        //     label: {\n        //         normal: {\n        //             formatter: '{b}',\n        //             position: 'right',\n        //             show: true\n        //         }\n        //     },\n        //     itemStyle: {\n        //         normal: {\n        //             color: 'yellow',\n        //             shadowBlur: 10,\n        //             shadowColor: 'yellow'\n        //         }\n        //     },\n        //     zlevel: 1\n        // },\n    ]\n};\nmyChart.setOption(option);\n\n        myChart.on('click',function(t){\n            alert(t.name)\n        })","html":"","externalScripts":"https://gallery.echartsjs.com/dep/echarts/map/js/china.js","updaterUID":"bd-2133619855","theme":"","layout":"","viewCount":1242,"userName":"小***乖","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xnCSAGSiAW.png?v=1573202326910","isCustomThumbnail":0,"builtinTags":["category-work","geo","series-map","series-scatter","title","tooltip","visualMap"],"customTags":[],"updaterUserName":"小***乖"}}