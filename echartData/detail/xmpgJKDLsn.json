{"status":0,"data":{"cid":"xmpgJKDLsn","authorUid":"obd-oClnpNK0w_ICc6mwYE-JOmpLT6VW53W","authorUserName":"c***流","title":"批量修改","description":"由于业务需求，单个数据拖动修改不能满足","latestVersion":1,"alwaysLatest":0,"createTime":"2021-08-25T12:21:39.000Z","lastUpdateTime":"2021-08-25T12:21:39.000Z","auth":2,"uid":"obd-oClnpNK0w_ICc6mwYE-JOmpLT6VW53W","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"5.1.2","versionCreateTime":"2021-08-25T12:21:39.000Z","code":"// var seriesData = [[], [1, 820], [2, 932], [3, 901], [4, 934], [5, 1290], [6, 1330], [7, 1320]];\n// var seriesData = [[0, 820], [1, 932], [2, 901], [3, 934], [4, 1290], [5, 1330], [6, 1320]];\n\nvar seriesData = [820, 932, 901, 934, 1290, 1330, 1320];\nvar seriesData2 = [];\n\nvar top = 50, left = 100, bottom = 50, right = 50;\n\noption = {\n    grid:[{\n        top: top,\n        left: left,\n        bottom: bottom,\n        right: right\n    }],\n    xAxis: [\n        {\n            type: 'category',\n            data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],\n            axisTick: {\n                alignWithLabel: true\n            }\n        }\n    ],\n    tooltip: {\n        trigger: 'axis',\n    },\n    yAxis: {\n        type: 'value'\n    },\n    series: [{\n        id: 'bb',\n        data: seriesData,\n        type: 'line',\n        symbolSize: 20\n    }],\n    graphic: [{\n        id: 'aa',\n        type: 'polyline',\n        shape: {\n            points: []\n        }\n    }]\n};\nvar moveFn;\nlet initDownX = '';\nvar xAxisItem = null;\nvar pointsArr = [];\nvar arr = [];\nvar myChartWidth = myChart.getWidth() - left - right;\nvar myChartHeight = myChart.getHeight() - top - bottom;\nmyChart.getZr().on('mousedown', params => {\n    initDownX = xAxisItem = params.offsetX;\n    pointsArr = [];\n    arr = [];\n    myChart.getZr().on('mousemove', moveFn);\n});\n\nfunction moveFn(params){\n    if(!initDownX) return;\n    if(Math.abs(params.offsetX - xAxisItem) >= 5){\n        xAxisItem = params.offsetX;\n        pointsArr.push([params.offsetX, params.offsetY]);\n        let decimal = (params.offsetX - left) / myChartWidth * seriesData.length;\n        var yItemData = myChart.convertFromPixel('grid', [params.offsetX, params.offsetY])[1];\n        let json = {\n            x: decimal,\n            y: yItemData\n        };\n        arr.push(json);\n        let distanceLeft = params.offsetX - initDownX;\n        \n        if(params.offsetX < initDownX){\n            distanceLeft = initDownX - params.offsetX;\n        }\n        if(distanceLeft >= myChartWidth / seriesData.length){\n            myChart.setOption({\n                graphic:[{\n                    id: 'aa',\n                    shape: {\n                        points: pointsArr,\n                    },\n                    style: {\n                        stroke: 'red'\n                    }\n                }]\n            });\n        }\n    }\n}\nmyChart.getZr().on('mouseup', params => {\n\tmyChart.getZr().off('mousemove', moveFn);\n\tif(!initDownX || !arr.length) return;\n\tinitDownX = '';\n\tif(arr[0].x > arr[arr.length - 1].x){\n\t    arr.reverse();\n\t}\n\tlet x = parseInt(arr[0].x);\n\tlet dataIndexEnd = parseInt(arr[arr.length - 1].x);\n\t\n    while(x <= dataIndexEnd){\n        let xNum = x + 0.5;\n        for(var i = 0; i < arr.length; i++){\n            if(!arr[i + 1]) break;\n            if(arr[i].x <= xNum && xNum <= arr[i + 1].x){\n                var yData = ((arr[i].y + arr[i + 1].y) / 2).toFixed(2);\n                seriesData[x] = yData;\n                break;\n            }\n        }\n        x++;\n    }\n\tmyChart.setOption({\n\t    series:[{\n\t        id: 'bb',\n\t        data: seriesData\n\t    }],\n\t    graphic:[{\n            id: 'aa',\n            shape: {\n                points: [],\n            },\n        }]\n\t});\n});\n","html":"","externalScripts":"","updaterUID":"obd-oClnpNK0w_ICc6mwYE-JOmpLT6VW53W","theme":"","layout":"","viewCount":0,"userName":"c***流","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xmpgJKDLsn.png?v=1629894099559","isCustomThumbnail":0,"builtinTags":["category-work","graphic","grid","series-line","tooltip"],"customTags":["批量修改"],"updaterUserName":"c***流"}}