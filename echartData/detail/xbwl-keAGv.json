{"status":0,"data":{"cid":"xbwl-keAGv","authorUid":"bd-541990002","authorUserName":"张***炫","title":"疫情","description":"data from PM25.in","latestVersion":3,"alwaysLatest":1,"createTime":"2020-03-19T15:13:56.000Z","lastUpdateTime":"2020-03-19T15:13:56.000Z","auth":2,"uid":"bd-541990002","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":3,"parentVersion":2,"echartsVersion":"4.7.0","versionCreateTime":"2020-03-24T00:40:28.000Z","code":"var data = [\n    { name: \"上海\", value: 29780},\n    { name: \"珠海\", value: 2186},\n    { name: \"三亚\", value: 1135},\n    { name: \"惠州\", value: 1973},\n    { name: \"海口\", value: 2568},\n    { name: \"合肥\", value: 4039},\n    { name: \"南京\", value: 6959},\n    { name: \"杭州\", value: 5632},\n    { name: \"苏州\", value: 6707},\n    { name: \"无锡\", value: 3393},\n    { name: \"昆山\", value: 1894},\n    { name: \"广州\", value: 15769},\n    { name: \"深圳\", value: 8259},\n    { name: \"佛山\", value: 5741},\n    { name: \"东莞\", value: 3030},\n    { name: \"福州\", value: 4542},\n    { name: \"厦门\", value: 3329},\n    { name: \"南宁\", value: 3157},\n    { name: \"郑州\", value: 6690},\n    { name: \"武汉\", value: 8678},\n    { name: \"长沙\", value: 5303},\n    { name: \"南昌\", value: 3025},\n    { name: \"北京\", value: 20259},\n    { name: \"长春\", value: 3016},\n    { name: \"大连\", value: 3202},\n    { name: \"沈阳\", value: 4540},\n    { name: \"哈尔滨\", value: 3141},\n    { name: \"天津\", value: 8626},\n    { name: \"济南\", value: 4361},\n    { name: \"青岛\", value: 6667},\n    { name: \"太原\", value: 4080},\n    { name: \"石家庄\", value: 6137},\n    { name: \"西安\", value: 6991},\n    { name: \"成都\", value: 13873},\n    { name: \"重庆\", value: 13283},\n    { name: \"昆明\", value: 4633},\n\n\n];\n\nvar geoCoordMap = {\n    \"上海\": [121.48, 31.22],\n    \"珠海\": [113.52, 22.3],\n    \"三亚\": [109.31, 18.14],\n    \"惠州\": [114.4, 23.09],\n    \"海口\": [110.35, 20.02],\n    \"合肥\": [117.27, 31.86],\n    \"南京\": [118.78, 32.04],\n    \"杭州\": [120.19, 30.26],\n    \"苏州\": [120.62, 31.32],\n    \"无锡\": [120.29, 31.59],\n    \"昆山\": [120.95, 31.39],\n    \"广州\": [113.23, 23.16],\n    \"深圳\": [114.07, 22.62],\n    \"佛山\": [113.11, 23.05],\n    \"东莞\": [113.75, 23.04],\n    \"福州\": [119.3, 26.08],\n    \"厦门\": [118.1, 24.46],\n    \"南宁\": [108.33, 22.84],\n    \"郑州\": [113.65, 34.76],\n    \"武汉\": [114.31, 30.52],\n    \"长沙\": [113, 28.21],\n    \"南昌\": [115.89, 28.68],\n    \"北京\": [116.46, 39.92],\n    \"长春\": [125.35, 43.88],\n    \"大连\": [121.62, 38.92],\n    \"沈阳\": [123.38, 41.8],\n    \"哈尔滨\": [126.63, 45.75],\n    \"天津\": [117.2, 39.13],\n    \"济南\": [117, 36.65],\n    \"青岛\": [120.33, 36.07],\n    \"太原\": [112.53, 37.87],\n    \"石家庄\": [114.48, 38.03],\n    \"西安\": [108.95, 34.27],\n    \"成都\": [104.06, 30.67],\n    \"重庆\": [106.54, 29.59],\n    \"昆明\": [102.73, 25.04],\n};\n\nvar convertData = function(data) {\n    var res = [];\n    for (var i = 0; i < data.length; i++) {\n        var geoCoord = geoCoordMap[data[i].name];\n        if (geoCoord) {\n            res.push({\n                name: data[i].name,\n                value: geoCoord.concat(data[i].value)\n            });\n        }\n    }\n    return res;\n};\n\nvar convertedData = [\n    convertData(data),\n    convertData(data.sort(function(a, b) {\n        return b.value - a.value;\n    }).slice(0, 6))\n];\ndata.sort(function(a, b) {\n    return a.value - b.value;\n})\n\nvar selectedItems = [];\nvar categoryData = [];\nvar barData = [];\n//   var maxBar = 30;\nvar sum = 0;\nvar count = data.length;\nfor (var i = 0; i < data.length; i++) {\n    categoryData.push(data[i].name);\n    barData.push(data[i].value);\n    sum += data[i].value;\n}\nconsole.log(categoryData);\nconsole.log(sum + \"   \" + count)\noption = {\n    backgroundColor: '#404a59',\n    animation: true,\n    animationDuration: 1000,\n    animationEasing: 'cubicInOut',\n    animationDurationUpdate: 1000,\n    animationEasingUpdate: 'cubicInOut',\n    title: [{\n        text: '全国疫情数',\n        link: 'http://pages.anjuke.com/expert/newexpert.html',\n        subtext: 'data from Anjuke',\n        sublink: 'http://pages.anjuke.com/expert/newexpert.html',\n        left: 'center',\n        textStyle: {\n            color: '#fff'\n        }\n    }, {\n        id: 'statistic',\n        text: count ? '平均: ' + parseInt((sum / count).toFixed(4)) : '',\n        right: 120,\n        top: 40,\n        width: 100,\n        textStyle: {\n            color: '#fff',\n            fontSize: 16\n        }\n    }],\n    toolbox: {\n        iconStyle: {\n            normal: {\n                borderColor: '#fff'\n            },\n            emphasis: {\n                borderColor: '#b1e4ff'\n            }\n        },\n        feature: {\n            dataZoom: {},\n            brush: {\n                type: ['rect', 'polygon', 'clear']\n            },\n            saveAsImage: {\n                show: true\n            }\n        }\n    },\n    brush: {\n        outOfBrush: {\n            color: '#abc'\n        },\n        brushStyle: {\n            borderWidth: 2,\n            color: 'rgba(0,0,0,0.2)',\n            borderColor: 'rgba(0,0,0,0.5)',\n        },\n        seriesIndex: [0, 1],\n        throttleType: 'debounce',\n        throttleDelay: 300,\n        geoIndex: 0\n    },\n    geo: {\n        map: 'china',\n        left: '10',\n        right: '35%',\n        center: [117.98561551896913, 31.205000490896193],\n        zoom: 1.5,\n        label: {\n            emphasis: {\n                show: false\n            }\n        },\n        roam: true,\n        itemStyle: {\n            normal: {\n                areaColor: '#323c48',\n                borderColor: '#111'\n            },\n            emphasis: {\n                areaColor: '#2a333d'\n            }\n        }\n    },\n    tooltip: {\n        trigger: 'item'\n    },\n    grid: {\n        right: 40,\n        top: 100,\n        bottom: 40,\n        width: '30%'\n    },\n    xAxis: {\n        type: 'value',\n        scale: true,\n        position: 'top',\n        boundaryGap: false,\n        splitLine: {\n            show: false\n        },\n        axisLine: {\n            show: false\n        },\n        axisTick: {\n            show: false\n        },\n        axisLabel: {\n            margin: 2,\n            textStyle: {\n                color: '#aaa'\n            }\n        },\n    },\n    yAxis: {\n        type: 'category',\n        //  name: 'TOP 20',\n        nameGap: 16,\n        axisLine: {\n            show: true,\n            lineStyle: {\n                color: '#ddd'\n            }\n        },\n        axisTick: {\n            show: false,\n            lineStyle: {\n                color: '#ddd'\n            }\n        },\n        axisLabel: {\n            interval: 0,\n            textStyle: {\n                color: '#ddd'\n            }\n        },\n        data: categoryData\n    },\n    series: [{\n        // name: 'pm2.5',\n        type: 'scatter',\n        coordinateSystem: 'geo',\n        data: convertedData[0],\n        symbolSize: function(val) {\n            return Math.max(val[2] / 300, 8);\n        },\n        label: {\n            normal: {\n                formatter: '{b}',\n                position: 'right',\n                show: false\n            },\n            emphasis: {\n                show: true\n            }\n        },\n        itemStyle: {\n            normal: {\n                color: '#FF8C00',\n                position: 'right',\n                show: true\n            }\n        }\n    }, {\n        //  name: 'Top 5',\n        type: 'effectScatter',\n        coordinateSystem: 'geo',\n        data: convertedData[0],\n        symbolSize: function(val) {\n            return Math.max(val[2] / 500, 8);\n        },\n        showEffectOn: 'render',\n        rippleEffect: {\n            brushType: 'stroke'\n        },\n        hoverAnimation: true,\n        label: {\n            normal: {\n                formatter: '{b}',\n                position: 'right',\n                show: true\n            }\n        },\n        itemStyle: {\n            normal: {\n                color: '#f4e925',\n                shadowBlur: 50,\n                shadowColor: '#EE0000'\n            }\n        },\n        zlevel: 1\n    }, {\n        id: 'bar',\n        zlevel: 2,\n        type: 'bar',\n        symbol: 'none',\n        itemStyle: {\n            normal: {\n                color: '#ddb926'\n            }\n        },\n\n        data: data\n    }]\n};\n\n\n\nfunction renderBrushed(params) {\n    var mainSeries = params.batch[0].selected[0];\n\n    var selectedItems = [];\n    var categoryData = [];\n    var barData = [];\n    var maxBar = 30;\n    var sum = 0;\n    var count = 0;\n\n    for (var i = 0; i < mainSeries.dataIndex.length; i++) {\n        var rawIndex = mainSeries.dataIndex[i];\n        var dataItem = convertedData[0][rawIndex];\n        var pmValue = dataItem.value[2];\n\n        sum += pmValue;\n        count++;\n\n        selectedItems.push(dataItem);\n    }\n\n    selectedItems.sort(function(a, b) {\n        //   return b.value[2] - a.value[2];\n        return a.value - b.value;\n    });\n\n    for (var i = 0; i < Math.min(selectedItems.length, maxBar); i++) {\n        categoryData.push(selectedItems[i].name);\n        barData.push(selectedItems[i].value[2]);\n    }\n\n    this.setOption({\n        yAxis: {\n            data: categoryData\n        },\n        xAxis: {\n            axisLabel: {\n                show: !!count\n            }\n        },\n        title: {\n            id: 'statistic',\n            text: count ? '平均: ' + (sum / count).toFixed(4) : ''\n        },\n        series: {\n            id: 'bar',\n            //        sort:'descending',\n            data: barData\n        }\n    });\n}","html":"","externalScripts":"/dep/echarts/map/js/china.js","updaterUID":"bd-541990002","theme":"","layout":"","viewCount":408,"userName":"张***炫","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xbwl-keAGv.png?v=1585010429167","isCustomThumbnail":0,"builtinTags":["brush","category-work","dataZoom","geo","grid","series-bar","series-effectScatter","series-scatter","title","toolbox","tooltip"],"customTags":[],"updaterUserName":"张***炫"}}