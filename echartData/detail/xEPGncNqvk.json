{"status":0,"data":{"cid":"xEPGncNqvk","authorUid":"bd-4198402328","authorUserName":"a***3","title":"渐变色饼图","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2020-12-03T06:40:12.000Z","lastUpdateTime":"2020-12-03T06:40:12.000Z","auth":2,"uid":"bd-4198402328","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-12-03T06:40:12.000Z","code":"const startAlpha = 1;\nconst endAlpha = 1;\n\nconst color = [{\n        r: 252,\n        g: 208,\n        b: 149\n    },\n    {\n        r: 152,\n        g: 246,\n        b: 246\n    },\n    {\n        r: 195,\n        g: 248,\n        b: 181\n    },\n    {\n        r: 238,\n        g: 186,\n        b: 255\n    },\n    {\n        r: 240,\n        g: 108,\n        b: 162\n    },\n    {\n        r: 103,\n        g: 186,\n        b: 243\n    }\n]\n\nconst color1 = [{\n        r: 143,\n        g: 89,\n        b: 43\n    },\n    {\n        r: 98,\n        g: 182,\n        b: 182\n    },\n    {\n        r: 108,\n        g: 208,\n        b: 89\n    },\n    {\n        r: 131,\n        g: 87,\n        b: 157\n    },\n    {\n        r: 190,\n        g: 48,\n        b: 117\n    },\n    {\n        r: 73,\n        g: 56,\n        b: 126\n    }\n]\n\nfunction getCoordinates(startArc, endArc) {\n    const posi = [\n        Math.sin(startArc),\n        -Math.cos(startArc),\n        Math.sin(endArc),\n        -Math.cos(endArc)\n    ]\n    const dx = posi[2] - posi[0]\n    const dy = posi[3] - posi[1]\n\n    return getLocation(dx, dy)\n}\n\nfunction getLocation(dx, dy) {\n    const tanV = dx / dy\n    const directSign = Math.abs(tanV) < 1\n    const t = directSign ? tanV : 1 / tanV\n\n    const sign1 = t > 0 ? 1 : -1\n    const sign2 = dx > 0 ? 1 : -1\n    const sign = directSign ? sign1 * sign2 : sign2\n\n    const group1 = [0.5 - sign * t / 2, 0.5 + sign * t / 2]\n    const group2 = sign > 0 ? [0, 1] : [1, 0]\n    const group = [...group1, ...group2]\n    const keys = directSign ? ['x', 'x2', 'y', 'y2'] : ['y', 'y2', 'x', 'x2']\n\n    let res = {}\n    keys.forEach((k, idx) => {\n        res[k] = group[idx]\n    })\n    return res\n}\n\n\nfunction setGradientColorInItemSyle(datas, colorlist, colorlist1, startAlpha, endAlpha) {\n    for (let i = 0; i < datas.length; i++) {\n        const color = colorlist[i];\n        const color1 = colorlist1[i];\n\n        const startArc = datas[i]._startArc;\n        const endArc = datas[i]._endArc;\n        // 这里计算了 线性渐变的起止方向\n        const coordinates = getCoordinates(startArc, endArc);\n        datas[i].itemStyle = {\n            color: {\n                ...coordinates,\n                \"type\": \"linear\",\n                \"global\": false,\n                // 这里给了 线性渐变的起止颜色\n                \"colorStops\": [{\n                    offset: 0,\n                    color: `rgba(${color.r}, ${color.g}, ${color.b}, ${startAlpha})`\n                }, {\n                    offset: 1,\n                    color: `rgba(${color1.r}, ${color1.g}, ${color1.b}, ${endAlpha})`\n                }]\n            }\n        }\n    }\n    return datas\n}\n\nconst dataArr = [{\n        value: 10,\n        name: '问题1',\n        \"_startArc\": 0,\n        \"_endArc\": 1,\n    },\n    {\n        value: 20,\n        name: '问题2',\n        \"_startArc\": 0,\n        \"_endArc\": 1,\n    },\n    {\n        value: 30,\n        name: '问题3',\n        \"_startArc\": 0,\n        \"_endArc\": 1,\n    },\n    {\n        value: 40,\n        name: '问题4',\n        \"_startArc\": 0,\n        \"_endArc\": 1,\n    },\n    {\n        value: 50,\n        name: '问题5',\n        \"_startArc\": 0,\n        \"_endArc\": 1,\n    },\n    {\n        value: 60,\n        name: '问题6',\n        \"_startArc\": 0,\n        \"_endArc\": 1,\n    }\n]\n\noption = {\n    tooltip: {\n        trigger: 'item',\n        formatter: \"{b} : {c} ({d}%)\"\n    },\n    backgroundColor: \"rgba(73,129,173,.2)\",\n    legend: {\n        orient: 'vertical',\n        x: '70%',\n        y: \"center\",\n        itemWidth: 30,\n        itemHeight: 10,\n        formatter: function(name) {\n            const oa = option.series[0].data;\n            const num = oa.reduce((prev, curr) => {\n                return prev + curr.value\n            }, 0)\n            for (let i = 0; i < option.series[0].data.length; i++) {\n                if (name == oa[i].name) {\n                    return name + '   ' + ((oa[i].value / num * 100).toFixed(1)) + '%';\n                }\n            }\n        },\n        textStyle: {\n            color: \"#FFFFFF\",\n            fontSize: 18,\n            lineHeight: 20\n        }\n    },\n    title: {\n        x: \"30%\",\n        y: \"center\",\n        text: \"每日问题\\n发现情况\",\n        textStyle: {\n            color: \"#FFFFFF\",\n            fontSize: 30,\n            lineHeight: 40\n        }\n    },\n    series: [{\n        name: '',\n        type: 'pie',\n        radius: ['55%', '70%'],\n        center: ['35%', '50%'],\n        data: setGradientColorInItemSyle(dataArr, color, color1, startAlpha, endAlpha),\n        itemStyle: {\n            normal: {\n                label: {\n                    show: false,\n                    formatter: '{c} ({d}%)'\n                }\n            },\n            labelLine: {\n                show: true\n            }\n        }\n    }]\n}","html":"","externalScripts":"","updaterUID":"bd-4198402328","theme":"","layout":"","viewCount":76,"userName":"a***3","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xEPGncNqvk.png?v=1606977612570","isCustomThumbnail":0,"builtinTags":["category-work","legend","series-pie","title","tooltip"],"customTags":["pie"],"updaterUserName":"a***3"}}