{"status":0,"data":{"cid":"x-lGLrUnsr","authorUid":"obd-o2LT5SPsRm62u1sF90rM6cs58MmkP66","authorUserName":"j***9","title":"","description":"","latestVersion":1,"alwaysLatest":0,"createTime":"2021-09-16T08:32:32.000Z","lastUpdateTime":"2021-09-16T08:32:32.000Z","auth":2,"uid":"obd-o2LT5SPsRm62u1sF90rM6cs58MmkP66","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"5.2.0","versionCreateTime":"2021-09-16T08:32:32.000Z","code":"// mock 数据\nconst dataArr = {\n    xdata: ['01-01', '01-02', '01-03', '01-04', '01-05', '01-06', '01-07'],\n    result: [\n        { name: '天河', data: [320, 435, 490, 340, 320, 270, 360] },\n        { name: '海珠', data: [150, 220, 210, 310, 140, 180, 288] },\n        { name: '荔湾', data: [250, 120, 240, 280, 240, 180, 188] },\n        { name: '黄埔', data: [180, 420, 370, 250, 210, 180, 228] },\n        { name: '越秀', data: [130, 210, 340, 240, 220, 180, 218] },\n        { name: '白云', data: [210, 260, 230, 220, 260, 180, 388] },\n    ]\n}\n// 头部菱形\nconst diamondData = dataArr.result.reduce((pre, cur, index) => {\n    pre[index] = cur.data.map((el, id) => el + ( pre[index - 1] ? pre[index - 1][id] : 0))\n    return pre\n}, [])\n\n// color\nconst color = [\n    [{ offset: 0, color: \"#dc0707\", }, { offset: 0.5, color: \"#dc0707\", }, { offset: 0.5, color: \"#af0808\", }, { offset: 1, color: \"#af0808\", }],\n    [{ offset: 0, color: \"#f67c20\", }, { offset: 0.5, color: \"#f67c20\", }, { offset: 0.5, color: \"#cc681e\", }, { offset: 1, color: \"#cc681e\", }],\n    [{ offset: 0, color: \"#efff37\", }, { offset: 0.5, color: \"#efff37\", }, { offset: 0.5, color: \"#d5e700\", }, { offset: 1, color: \"#d5e700\", }],\n    [{ offset: 0, color: \"#32ffee\", }, { offset: 0.5, color: \"#32ffee\", }, { offset: 0.5, color: \"#00e8d5\", }, { offset: 1, color: \"#00e8d5\", }],\n    [{ offset: 0, color: \"#46c9ff\", }, { offset: 0.5, color: \"#46c9ff\", }, { offset: 0.5, color: \"#00b4ff\", }, { offset: 1, color: \"#00b4ff\", }],\n    [{ offset: 0, color: \"#54a0ff\", }, { offset: 0.5, color: \"#54a0ff\", }, { offset: 0.5, color: \"#1f83ff\", }, { offset: 1, color: \"#1f83ff\", }],\n]\n\n// series\nlet series = dataArr.result.reduce((p, c, i, array) => {\n    p.push({\n        z: i + 1,\n        stack: '总量',\n        type: 'bar',\n        name: c.name,\n        barGap: '-100%',\n        barWidth: 30,\n        data: c.data,\n        itemStyle:{ color: { type: 'linear', x: 0, x2: 1, y: 0, y2: 0, colorStops: color[i] } },\n    },{\n        z: i + 10,\n        type: 'pictorialBar',\n        symbolPosition: 'end',\n        symbol: 'diamond',\n        symbolOffset: [0, '-50%'],\n        symbolSize: [30, 10],\n        data: diamondData[i],\n        itemStyle: { color: { type: 'linear', x: 0, x2: 1, y: 0, y2: 0, colorStops: color[i] } },\n        tooltip: { show: false },\n    })\n\n    // 是否最后一个了？\n    if (p.length  === (array.length) * 2) {\n        p.push({\n            z: array.length * 2,\n            type: \"pictorialBar\",\n            symbolPosition: \"start\",\n            data: dataArr.result[0].data,\n            symbol: \"diamond\",\n            symbolOffset: [\"0%\", \"50%\"],\n            symbolSize: [30, 10],\n            itemStyle: { color: { type: 'linear', x: 0, x2: 1, y: 0, y2: 0, colorStops: color[0]} },\n            tooltip: { show: false },\n        })\n        return p\n    }\n\n    return p\n}, [])\n\n// tooltip\nconst tooltip = { trigger: \"axis\" }\n\n// legend\nconst legend = {\n    data: dataArr.result.map(item => item.name),\n    textStyle: { fontSize: 14, color: '#fff'},\n    itemWidth: 25,\n    itemHeight: 15,\n    itemGap: 15,\n    bottom: '5%',\n}\n// grid\nconst grid = { top: '10%', left: '10%', right: '3%', bottom: '15%'}\n\n// xAxis\nconst xAxis = { \n    axisTick: { show: true },\n    axisLine: { lineStyle: { color: 'rgba(255,255,255, .2)' } },\n    axisLabel: { textStyle: { fontSize: 12, color: '#fff'  }, },\n    data: dataArr.xdata\n}\n\n// yAxis\nconst yAxis = [{ \n    splitLine: { lineStyle: { color: 'rgba(255,255,255, .05)' } },\n    axisLine: { show: false, },\n    axisLabel: { textStyle: { fontSize: 16, color: '#fff' } }\n}]\n\n// 渲染\noption = { tooltip, xAxis, yAxis, series, grid, legend, backgroundColor:'rgba(0, 0, 0, .8)' }","html":"","externalScripts":"","updaterUID":"obd-o2LT5SPsRm62u1sF90rM6cs58MmkP66","theme":"","layout":"","viewCount":0,"userName":"j***9","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x-lGLrUnsr.png?v=1631781152721","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","series-pictorialBar","tooltip"],"customTags":[],"updaterUserName":"j***9"}}