{"status":0,"data":{"cid":"xU5ds_OmJe","authorUid":"bd-2588117573","authorUserName":"阳***末","title":"大连市甘井子区各街道","description":"大连市甘井子区各街道","latestVersion":2,"alwaysLatest":1,"createTime":"2018-12-19T07:31:23.000Z","lastUpdateTime":"2018-12-19T07:31:23.000Z","auth":2,"uid":"bd-2588117573","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.2.0","versionCreateTime":"2018-12-21T11:21:32.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1545202313337-zYXnvpxc4.json\";\r\n\r\n// var uploadedDataURL = \"/asset/get/s/data-1545203419609-2nu6-7sFU.json\";\r\n\r\n// var uploadedDataURL = \"/asset/get/s/data-1545202981279-LwA1FRrtY.json\";\r\n/**\r\n此版本通过设置geoindex && seriesIndex: [1] 属性来实现geo和map共存，来达到hover散点和区域显示tooltip的效果\r\n\r\n默认情况下，map series 会自己生成内部专用的 geo 组件。但是也可以用这个 geoIndex 指定一个 geo 组件。这样的话，map 和 其他 series（例如散点图）就可以共享一个 geo 组件了。并且，geo 组件的颜色也可以被这个 map series 控制，从而用 visualMap 来更改。\r\n当设定了 geoIndex 后，series-map.map 属性，以及 series-map.itemStyle 等样式配置不再起作用，而是采用 geo 中的相应属性。\r\n\r\nhttp://echarts.baidu.com/option.html#series-map.geoIndex\r\n\r\n并且加了pin气泡图标以示数值大小\r\n*/\r\n\r\nmyChart.showLoading();\r\n$.getJSON(uploadedDataURL, function(geoJson) {\r\n    echarts.registerMap('dalian', geoJson);\r\n    myChart.hideLoading();\r\n\r\n    var allData = {\r\n        \"citys\": [{\r\n            \"name\": \"甘井子\",\r\n            \"value\": [121.64855, 38.983202,20],\r\n            \"symbolSize\": 25\r\n        }, {\r\n            \"name\": \"革镇堡街道\",\r\n            \"value\": [121.539085, 39.01541,20],\r\n            \"symbolSize\": 20\r\n        }, {\r\n            \"name\": \"甘井子街道\",\r\n            \"value\": [121.63855, 38.973202,20],\r\n            \"symbolSize\": 15\r\n        }, {\r\n            \"name\": \"周水子街道\",\r\n            \"value\": [121.587912, 38.963776,20],\r\n            \"symbolSize\": 10\r\n        }, {\r\n            \"name\": \"营城子街道\",\r\n            \"value\": [121.39958, 38.993063,20],\r\n            \"symbolSize\": 8\r\n        }, {\r\n            \"name\": \"辛寨子街道\",\r\n            \"value\": [121.496914, 38.983146,20],\r\n            \"symbolSize\": 6\r\n        }, {\r\n            \"name\": \"红旗街道\",\r\n            \"value\": [121.554134, 38.930041,20],\r\n            \"symbolSize\": 1\r\n        }, {\r\n            \"name\": \"大连湾街道\",\r\n            \"value\": [121.713963, 39.040674,20],\r\n            \"symbolSize\": 2\r\n        }, {\r\n            \"name\": \"南关岭街道\",\r\n            \"value\": [121.604106, 39.022726],\r\n            \"symbolSize\": 3\r\n        }, {\r\n            \"name\": \"椒金山街道\",\r\n            \"value\": [121.617448, 38.979161],\r\n            \"symbolSize\": 4\r\n        }, {\r\n            \"name\": \"中华路街道\",\r\n            \"value\": [121.585795, 38.990505],\r\n            \"symbolSize\": 4\r\n        }],\r\n        \"moveLines\": [{\r\n            \"fromName\": \"甘井子\",\r\n            \"toName\": \"甘井子街道\",\r\n            \"coords\": [\r\n                [121.64855, 38.983202],\r\n                [121.63855, 38.973202]\r\n            ]\r\n        },{\r\n            \"fromName\": \"甘井子\",\r\n            \"toName\": \"周水子街道\",\r\n            \"coords\": [\r\n                [121.64855, 38.983202],\r\n                [121.587912, 38.963776]\r\n            ]\r\n        },{\r\n            \"fromName\": \"甘井子\",\r\n            \"toName\": \"革镇堡街道\",\r\n            \"coords\": [\r\n                [121.64855, 38.983202],\r\n                [121.539085, 39.01541]\r\n            ]\r\n        },{\r\n            \"fromName\": \"甘井子\",\r\n            \"toName\": \"营城子街道\",\r\n            \"coords\": [\r\n                [121.64855, 38.983202],\r\n                [121.39958, 38.993063]\r\n            ]\r\n        },{\r\n            \"fromName\": \"甘井子\",\r\n            \"toName\": \"辛寨子街道\",\r\n            \"coords\": [\r\n                [121.64855, 38.983202],\r\n                [121.496914, 38.983146]\r\n            ]\r\n        },{\r\n            \"fromName\": \"甘井子\",\r\n            \"toName\": \"红旗街道\",\r\n            \"coords\": [\r\n                [121.64855, 38.983202],\r\n                [121.554134, 38.930041]\r\n            ]\r\n        }\r\n        ]\r\n    };\r\n     var allData1 = {\r\n        \"citys\": [{\r\n            \"name\": \"甘井子\",\r\n            \"value\": [121.64855, 38.883202,20],\r\n            \"symbolSize\": 50\r\n        }, {\r\n            \"name\": \"兴华街道\",\r\n            \"value\": [121.585881, 38.977074],\r\n            \"symbolSize\": 40\r\n        }],\r\n        \"moveLines\": [{\r\n            \"fromName\": \"甘井子\",\r\n            \"toName\": \"革镇堡街道\",\r\n            \"coords\": [\r\n                [121.64855, 38.883202],\r\n                [121.585881, 38.977074]\r\n            ]\r\n        }]\r\n    };\r\n    var max = 480,\r\n        min = 9; // todo \r\n    var maxSize4Pin = 100,\r\n        minSize4Pin = 20;\r\n\r\n    var convertData = function(data) {\r\n        var res = [];\r\n        for (var i = 0; i < data.length; i++) {\r\n            var geoCoord = geoCoordMap[data[i].name];\r\n            if (geoCoord) {\r\n                res.push({\r\n                    name: data[i].name,\r\n                    value: geoCoord.concat(data[i].value)\r\n                });\r\n            }\r\n        }\r\n        return res;\r\n    };\r\n\r\n\r\n    option = {\r\n    backgroundColor: '#404a59',\r\n        title: {\r\n            text: '大连市甘井子区组织机构分布',\r\n            subtext: '',\r\n            x: 'center',\r\n            textStyle: {\r\n                color: '#ccc'\r\n            }\r\n        },\r\n        tooltip: {\r\n            trigger: 'item',\r\n            formatter: function(params) {\r\n                if (typeof(params.value)[2] == \"undefined\") {\r\n                    return params.name;\r\n                } else {\r\n                    return params.name + ' : ' + params.value[2];\r\n                }\r\n            }\r\n        },\r\n        legend: {\r\n            orient: 'vertical',\r\n            y: 'bottom',\r\n            x: 'right',\r\n            data: ['党组织', '线路'],  \r\n            selected: {  \r\n                    '党组织' : true,  \r\n                    '线路' : true,  \r\n                    //不想显示的都设置成false  \r\n            },\r\n            textStyle: {\r\n                color: '#0f0c29'\r\n            }\r\n        },\r\n        visualMap: {\r\n            show: false,\r\n            min: 0,\r\n            max: 500,\r\n            left: 'left',\r\n            top: 'bottom',\r\n            calculable: true,\r\n            seriesIndex: [1],\r\n            inRange: {\r\n                // color: ['#3B5077', '#031525'] // 蓝黑\r\n                // color: ['#fb4f5e', '#fb4f5e'] // 红紫\r\n                // color: ['#3C3B3F', '#605C3C'] // 黑绿\r\n                // color: ['#0f0c29', '#302b63', '#24243e'] // 黑紫黑\r\n                // color: ['#23074d', '#cc5333'] // 紫红\r\n                color: ['#00467F', '#A5CC82'] // 蓝绿\r\n                // color: ['#1488CC', '#2B32B2'] // 浅蓝\r\n                // color: ['#00467F', '#A5CC82'] // 蓝绿\r\n\r\n            }\r\n        },\r\n        // toolbox: {\r\n        //     show: true,\r\n        //     orient: 'vertical',\r\n        //     left: 'right',\r\n        //     top: 'center',\r\n        //     feature: {\r\n        //             dataView: {readOnly: false},\r\n        //             restore: {},\r\n        //             saveAsImage: {}\r\n        //             }\r\n        // },\r\n        geo: {\r\n            show: true,\r\n            map: 'dalian',\r\n            label: {\r\n                normal: {\r\n                    show: false\r\n                },\r\n                emphasis: {\r\n                    show: false,\r\n                }\r\n            },\r\n            roam: true,\r\n            zoom: 6,\r\n            center: [121.496914, 38.963146],\r\n            itemStyle: {\r\n                normal: {\r\n                    areaColor: '#323c48',\r\n                    borderColor: '#404a59'\r\n                },\r\n                emphasis: {\r\n                    areaColor: '#2a333d'\r\n                }\r\n            }\r\n        },\r\n        series: [{\r\n            name: '党组织',\r\n            // geoIndex: 0,\r\n            type: 'effectScatter',\r\n            legendHoverLink: true,\r\n            coordinateSystem: 'geo',\r\n            zlevel: 2,\r\n            rippleEffect: {\r\n                brushType: 'stroke'\r\n            },\r\n            label: {\r\n                emphasis: {\r\n                    show: true,\r\n                    position: 'right',\r\n                    formatter: '{b}'\r\n                }\r\n            },\r\n            symbolSize: function(val) {\r\n                console.log('symbolSize-d:', val)\r\n                return val;\r\n            },\r\n            showEffectOn: 'render',\r\n            itemStyle: {\r\n                normal: {\r\n                    color: '#46bee9'\r\n                }\r\n            },\r\n            data: allData.citys\r\n        }, {\r\n        name: '线路',\r\n        type: 'lines',\r\n        coordinateSystem: 'geo',\r\n        zlevel: 2,\r\n        large: true,\r\n        effect: {\r\n            show: true,\r\n            constantSpeed: 120,\r\n            symbol: 'pin',\r\n            symbolSize: 5,\r\n            trailLength: 0,\r\n        },\r\n        lineStyle: {\r\n            normal: {\r\n                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                    offset: 0,\r\n                    color: '#58B3CC'\r\n                }, {\r\n                    offset: 1,\r\n                    color: '#F58158'\r\n                }], false),\r\n                width: 1,\r\n                opacity: 0.2,\r\n                curveness: 0.1\r\n            }\r\n        },\r\n        data: allData.moveLines\r\n    }]\r\n    };\r\n    \r\n    myChart.setOption(option);\r\n//     setTimeout(function() {\r\n          \r\n//     // option.series[0].data.shift();\r\n//     option.series[0].data.push({\r\n//             \"name\": \"兴华街道\",\r\n//             \"value\": [121.585881, 38.977074],\r\n//             \"symbolSize\": 40\r\n//         })\r\n//     option.series[1].data.push({\r\n//             \"fromName\": \"甘井子\",\r\n//             \"toName\": \"兴华街道\",\r\n//             \"coords\": [\r\n//                 [121.64855, 38.983202],\r\n//                 [121.585881, 38.977074]\r\n//             ]\r\n//         })\r\n// myChart.setOption(option);\r\n//     }, 3000);\r\n});","html":"","externalScripts":"","updaterUID":"bd-2588117573","theme":"default","layout":"","viewCount":706,"userName":"阳***末","commentCount":0,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xU5ds_OmJe.png?v=1545391292230","isCustomThumbnail":0,"builtinTags":["category-work","geo","legend","series-effectScatter","series-lines","title","tooltip","visualMap"],"customTags":[],"updaterUserName":"阳***末"}}