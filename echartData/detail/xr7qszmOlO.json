{"status":0,"data":{"cid":"xr7qszmOlO","authorUid":"obd-olRfFA5IF-Y7H92oEjE6M2poQh6UA08","authorUserName":"逍***心","title":"可拖拽的折线柱状图","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2020-08-15T02:30:57.000Z","lastUpdateTime":"2020-08-15T02:30:57.000Z","auth":2,"uid":"obd-olRfFA5IF-Y7H92oEjE6M2poQh6UA08","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-08-15T02:30:57.000Z","code":"let listN = '温度';\r\nlet unit = '°C';\r\nlet xAxisData = ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '31/00']\r\nlet yAxisData = [20, 21, 20, 23, 26, 25, 26, 25, 28, 29, 30, 29, 28, 27, 26, 25, 24, 23, 23, 21, 20, 21, 22, 23]\r\n\r\noption = {\r\n    grid: {\r\n        left: '10%',\r\n        top: '30%',\r\n        right: '10%',\r\n        bottom: '30%'\r\n    },\r\n    tooltip: {\r\n        triggerOn: 'none',\r\n        formatter: function(params) {\r\n            return 'X: ' + params.name + '<br>Y: ' + params.data;\r\n        }\r\n    },\r\n    dataZoom: {\r\n        bottom: '20%',\r\n        end: 50\r\n    },\r\n    xAxis: {\r\n        type: 'category',\r\n        data: xAxisData\r\n    },\r\n    yAxis: {\r\n        type: 'value',\r\n        min: 0,\r\n        max: 100,\r\n        name: `${listN}${unit}`,\r\n        nameGap: 35,\r\n        splitLine: {\r\n            lineStyle: {\r\n                color: '#DBDBDB',\r\n                type: 'dashed'\r\n            }\r\n        },\r\n        axisLine: {\r\n            show: false\r\n        },\r\n        axisTick: {\r\n            show: false\r\n        }\r\n    },\r\n    series: [{\r\n            id: 'aaa',\r\n            name: listN,\r\n            type: 'line',\r\n            color: '#EC5176',\r\n            smooth: true,\r\n            symbolSize: 10,\r\n            areaStyle: {\r\n                color: {\r\n                    type: 'linear',\r\n                    x: 0,\r\n                    y: 0,\r\n                    x2: 0,\r\n                    y2: 1,\r\n                    colorStops: [{\r\n                        offset: 0,\r\n                        color: 'rgba(255, 204, 99, 1)' // 0% 处的颜色\r\n                    }, {\r\n                        offset: 1,\r\n                        color: 'rgba(242, 198, 106, 0)' // 100% 处的颜色\r\n                    }],\r\n                    globalCoord: false\r\n                }\r\n            },\r\n            data: yAxisData\r\n        },\r\n        {\r\n            id: 'bbb',\r\n            type: 'bar',\r\n            color: '#EC5176',\r\n            label: {\r\n                normal: {\r\n                    show: true,\r\n                    position: 'inside'\r\n                }\r\n            },\r\n            areaStyle: {\r\n                color: {\r\n                    type: 'linear',\r\n                    x: 0,\r\n                    y: 0,\r\n                    x2: 0,\r\n                    y2: 1,\r\n                    colorStops: [{\r\n                        offset: 0,\r\n                        color: 'rgba(255, 204, 99, 1)' // 0% 处的颜色\r\n                    }, {\r\n                        offset: 1,\r\n                        color: 'rgba(242, 198, 106, 0)' // 100% 处的颜色\r\n                    }],\r\n                    globalCoord: false\r\n                }\r\n            },\r\n            data: yAxisData\r\n        }\r\n    ]\r\n}\r\n\r\n// 拖拽\r\nsetTimeout(function() {\r\n    myChart.setOption({\r\n        graphic: echarts.util.map(yAxisData, function(item, dataIndex) {\r\n            let position = myChart.convertToPixel({\r\n                seriesIndex: 0\r\n            }, [dataIndex, item]);\r\n            return {\r\n                id: dataIndex,\r\n                type: 'circle',\r\n                position: position,\r\n                shape: {\r\n                    r: 5\r\n                },\r\n                invisible: true,\r\n                draggable: true,\r\n                ondrag: echarts.util.curry(onPointDragging, dataIndex),\r\n                onmousemove: echarts.util.curry(showTooltip, dataIndex),\r\n                onmouseout: echarts.util.curry(hideTooltip, dataIndex),\r\n                ondragend: echarts.util.curry(onPointDragEnd, dataIndex),\r\n                z: 100\r\n            };\r\n        })\r\n    });\r\n}, 0);\r\nwindow.addEventListener('resize', updatePosition);\r\nmyChart.on('dataZoom', updatePosition);\r\n\r\nfunction updatePosition() {\r\n    myChart.setOption({\r\n        graphic: echarts.util.map(yAxisData, function(item, dataIndex) {\r\n            return {\r\n                position: myChart.convertToPixel({\r\n                    seriesIndex: 0\r\n                }, [dataIndex, item])\r\n            };\r\n        })\r\n    });\r\n}\r\n\r\nfunction showTooltip(dataIndex) {\r\n    myChart.dispatchAction({\r\n        type: 'showTip',\r\n        seriesIndex: 0,\r\n        dataIndex: dataIndex\r\n    });\r\n}\r\n\r\nfunction hideTooltip(dataIndex) {\r\n    myChart.dispatchAction({\r\n        type: 'hideTip'\r\n    });\r\n}\r\n\r\nfunction onPointDragging(dataIndex, dx, dy) {\r\n    if ((myChart.convertFromPixel('grid', this.position)[1]) >= 0 && (myChart.convertFromPixel('grid', this.position)[1]) <= 100) {\r\n        yAxisData[dataIndex] = Math.round(myChart.convertFromPixel({\r\n            seriesIndex: 0\r\n        }, this.position)[1]);\r\n        myChart.setOption({\r\n            series: [{\r\n                id: 'aaa',\r\n                data: yAxisData\r\n            }, {\r\n                id: 'bbb',\r\n                data: yAxisData\r\n            }]\r\n        });\r\n    } else {\r\n\r\n    }\r\n}\r\n\r\nfunction onPointDragEnd(dataIndex, dx, dy) {\r\n    myChart.setOption({\r\n        graphic: echarts.util.map(yAxisData, function(item, dataIndex) {\r\n            return {\r\n                id: dataIndex,\r\n                position: myChart.convertToPixel({\r\n                    seriesIndex: 0\r\n                }, [dataIndex, item])\r\n            }\r\n        })\r\n    })\r\n}","html":"","externalScripts":"","updaterUID":"obd-olRfFA5IF-Y7H92oEjE6M2poQh6UA08","theme":"","layout":"","viewCount":167,"userName":"逍***心","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xr7qszmOlO.png?v=1597458658102","isCustomThumbnail":0,"builtinTags":["category-work","dataZoom","graphic","grid","series-bar","series-line","tooltip"],"customTags":[],"updaterUserName":"逍***心"}}