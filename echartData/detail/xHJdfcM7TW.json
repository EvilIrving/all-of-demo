{"status":0,"data":{"cid":"xHJdfcM7TW","authorUid":"bd-4010221838","authorUserName":"lihonghua168","title":"环形图图列点击隐藏时图中百分比不变","description":"环形图图列点击隐藏时图中百分比不变的解决方案。通过追加其他 选项来保证环形图的完整性","latestVersion":5,"alwaysLatest":1,"createTime":"2017-10-17T05:50:07.000Z","lastUpdateTime":"2017-10-17T05:50:07.000Z","auth":2,"uid":"bd-4010221838","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":5,"parentVersion":4,"echartsVersion":"3.7.2","versionCreateTime":"2017-10-17T07:12:18.000Z","code":"// echarts 3\napp.title = '环形图';\nvar $legendData = ['直接访问','邮件营销','联盟广告','视频广告','搜索引擎'];\nvar $legendSelected = {'直接访问':false};\nvar $seriesData = [\n    {value:335, name:'直接访问'},\n    {value:310, name:'邮件营销'},\n    {value:234, name:'联盟广告'},\n    {value:135, name:'视频广告'},\n    {value:1548, name:'搜索引擎'}\n];\n\n\nvar option = {\n        tooltip: {\n            trigger: 'item',\n            formatter: \"{a} <br/>{b}: {c} ({d}%)\"\n        },\n        legend: {\n            orient: 'vertical',\n            x: 'left',\n            data:$legendData,\n            selected:$legendSelected\n\n        },\n        series: [\n            {\n                name:'访问来源',\n                type:'pie',\n                radius: ['50%', '70%'],\n                avoidLabelOverlap: false,\n                label: {\n                    normal: {\n                        show: false,\n                        position: 'center'\n                    },\n                    emphasis: {\n                        show: true,\n                        textStyle: {\n                            fontSize: '30',\n                            fontWeight: 'bold'\n                        }\n                    }\n                },\n                labelLine: {\n                    normal: {\n                        show: false\n                    }\n                },\n                data:$seriesData\n            }\n        ]\n    };\nmyChart.on('legendselectchanged', function (params) {\n    if (!$seriesData || $seriesData.length <= 0) return\n    var legendData = []\n    var seriesData = []\n    var selected = params.selected;\n    var selectedMode = false;\n    for (var i in params.selected) {\n        if( params.selected[i] && (i != '其他' && i != '全部')){\n            selectedMode = true;\n        }\n    }\n    console.log('params');\n    console.log(params);\n\n\n    var v = null;\n    for (var i = 0; i < $seriesData.length; i++) {\n        var item = $seriesData[i]\n        console.log(params.selected[item.name]);\n        if( !params.selected[item.name] ){\n            if( v === null ){\n                v = item.value;\n            }else{\n                v += item.value;\n            }\n        }\n        if(item.name == '其他' || item.name == '全部'){\n            continue;\n        }\n\n        legendData.push(item.name)\n        seriesData.push({ value: item.value, name: item.name, })\n    }\n    \n    if( v !== null ){\n        if( !selectedMode ){\n            legendData.push('全部');\n            selected['全部'] = true;\n            seriesData.push({ value: v, name: '全部'})\n        }else{\n            legendData.push('其他');\n            selected['其他'] = true;\n            seriesData.push({ value: v, name: '其他'})\n        }\n    }\n    console.log(legendData);\n    console.log(seriesData);\n\n    var $option = option\n    $option.legend.data = legendData\n    $option.legend.selected = selected\n    //$option.legend.selectedMode = selectedMode\n    $option.series[0].data = seriesData\n    myChart.clear()\n\n    console.log(option);\n    myChart.setOption(option)\n\n});","html":"","externalScripts":"","updaterUID":"bd-4010221838","theme":"","layout":"","viewCount":465,"userName":"lihonghua168","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xHJdfcM7TW.png?v=1508224338562","isCustomThumbnail":0,"builtinTags":["category-work","legend","series-pie","tooltip"],"customTags":["legend","series"],"updaterUserName":"lihonghua168"}}