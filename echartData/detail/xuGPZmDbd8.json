{"status":0,"data":{"cid":"xuGPZmDbd8","authorUid":"obd-oAD1HbaVk-tYIjzXgiXqh-eo0g6cS7m","authorUserName":"173******76","title":"pv -> cart -> buy 漏斗图","description":"自定义 toolbox 点击切换data 绘制用户行为路径","latestVersion":1,"alwaysLatest":1,"createTime":"2020-10-23T06:15:49.000Z","lastUpdateTime":"2020-10-23T06:15:49.000Z","auth":2,"uid":"obd-oAD1HbaVk-tYIjzXgiXqh-eo0g6cS7m","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-10-23T06:15:49.000Z","code":"var data = [{\n        name: '点击总人数',\n        value: 18492966,\n        label: \"100%\"\n    },\n    {\n        name: '购买人数',\n        value: 245829,\n        label: \"1.329%\"\n    }\n];\nvar data2 = [{\n        name: '点击总人数',\n        value: 18492966,\n        label: \"100%\"\n    },\n    {\n        name: '点击，收藏人数',\n        value: 309560,\n        label: \"1.674%\"\n    },\n    {\n        name: '点击，收藏，购买人数',\n        value: 23256,\n        label: \"7.513%\"\n    }\n];\nvar data3 = [{\n        name: '点击总人数',\n        value: 18492966,\n        label: \"100%\"\n    },\n    {\n        name: '点击，加购人数',\n        value: 688761,\n        label: \"3.724%\"\n    },\n    {\n        name: '点击，加购，购买人数',\n        value: 66683,\n        label: \"9.682%\"\n    }\n];\nvar data4 = [{\n        name: '点击总人数',\n        value: 18492966,\n        label: \"100%\"\n    },\n    {\n        name: '点击，收藏并加购人数',\n        value: 22052,\n        label: \"0.119%\"\n    },\n    {\n        name: '点击，收藏并加购，购买人数',\n        value: 3502,\n        label: \"15.881%\"\n    }\n];\n\nfunction space_arr(data) {\n    var space = [];\n    data.forEach((item, index) => {\n        space.push((18492966 - item.value) / 2);\n    });\n    return space;\n}\ndata_space = space_arr(data);\n\ngetArrByKey = (data, k) => {\n    let key = k || \"value\";\n    let res = [];\n    if (data) {\n        data.forEach(function(t) {\n            res.push(t[key]);\n        });\n    }\n    return res;\n};\n\noption = {\n    title: {\n        text: 'pv -> buy 漏斗图'\n    },\n    toolbox: {\n        show: true,\n        iconStyle: {\n            color: '#666',\n            borderWidth: 0\n        },\n        emphasis: {\n            iconStyle: {\n                textFill: '#666',\n                textPadding: 10\n            },\n        },\n        left: 0,\n        top: 30,\n        itemSize: 20,\n        itemGap: 20,\n        feature: {\n            myTool1: {\n                show: true,\n                title: 'pv -> buy',\n                icon: 'path://M0 26h32v4h-32zM4 18h4v6h-4zM10 10h4v14h-4zM16 16h4v8h-4zM22 4h4v20h-4z',\n                onclick: function() {\n                    option.series[0].data = space_arr(data);\n                    option.series[1].data = data;\n                    option.series[2].data = space_arr(data);\n                    option.yAxis[0].data = getArrByKey(data, 'name');\n                    option.title.text = 'pv -> buy 漏斗图';\n                    myChart.setOption(option);\n                }\n            },\n            myTool2: {\n                show: true,\n                title: 'pv -> fav -> buy',\n                icon: 'path://M0 26h32v4h-32zM4 18h4v6h-4zM10 10h4v14h-4zM16 16h4v8h-4zM22 4h4v20h-4z',\n                onclick: function() {\n                    option.series[0].data = space_arr(data2);\n                    option.series[1].data = data2;\n                    option.series[2].data = space_arr(data2);\n                    option.yAxis[0].data = getArrByKey(data2, 'name');\n                    option.title.text = 'pv -> fav -> buy 漏斗图';\n                    myChart.setOption(option);\n                }\n            },\n            myTool3: {\n                show: true,\n                title: 'pv -> cart -> buy',\n                icon: 'path://M0 26h32v4h-32zM4 18h4v6h-4zM10 10h4v14h-4zM16 16h4v8h-4zM22 4h4v20h-4z',\n                onclick: function() {\n                    option.series[0].data = space_arr(data3);\n                    option.series[1].data = data3;\n                    option.series[2].data = space_arr(data3);\n                    option.yAxis[0].data = getArrByKey(data3, 'name');\n                    option.title.text = 'pv -> cart -> buy 漏斗图';\n                    myChart.setOption(option);\n                }\n            },\n            myTool4: {\n                show: true,\n                title: 'pv -> fav,cart -> buy',\n                icon: 'path://M0 26h32v4h-32zM4 18h4v6h-4zM10 10h4v14h-4zM16 16h4v8h-4zM22 4h4v20h-4z',\n                onclick: function() {\n                    option.series[0].data = space_arr(data4);\n                    option.series[1].data = data4;\n                    option.series[2].data = space_arr(data4);\n                    option.yAxis[0].data = getArrByKey(data4, 'name');\n                    option.title.text = 'pv -> fav,cart -> buy 漏斗图';\n                    myChart.setOption(option);\n                }\n            },\n        }\n    },\n    grid: {\n        top: '30%',\n        bottom: '30%',\n        right: 30,\n        left: 30,\n        containLabel: true\n    },\n    tooltip: {\n        show: false,\n        formatter: '{b} : {c}%'\n    },\n    xAxis: {\n        show: false\n    },\n    yAxis: [{\n        show: true,\n        inverse: true,\n        data: getArrByKey(data, 'name'),\n        axisLine: {\n            show: false\n        },\n        splitLine: {\n            show: false\n        },\n        axisTick: {\n            show: false\n        },\n        axisLabel: {\n            fontSize: 16,\n        },\n        max: 3.5\n    }],\n    series: [{\n        name: '百分比条',\n        stack: 'data',\n        type: 'bar',\n        data: data_space,\n        itemStyle: {\n            opacity: 0.03\n        },\n    }, {\n        name: '百分比条',\n        stack: 'data',\n        type: 'bar',\n        yAxisIndex: 0,\n        data: data,\n        barWidth: 35,\n        label: {\n            normal: {\n                show: true,\n                position: 'right',\n                textStyle: {\n                    fontSize: 14,\n                    lineHeight: 18\n                },\n                formatter: function(a) {\n                    return a.data.value + '\\n' + a.data.label;\n                }\n            }\n        },\n    }, {\n        name: '百分比条',\n        stack: 'data',\n        type: 'bar',\n        data: data_space,\n        itemStyle: {\n            opacity: 0.03\n        }\n    }]\n};","html":"","externalScripts":"","updaterUID":"obd-oAD1HbaVk-tYIjzXgiXqh-eo0g6cS7m","theme":"","layout":"","viewCount":82,"userName":"173******76","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xuGPZmDbd8.png?v=1603433750004","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-bar","title","toolbox","tooltip"],"customTags":["funnel"],"updaterUserName":"173******76"}}