{"status":0,"data":{"cid":"xelBBd_iFR","authorUid":"obd-o2SuPEDc7-KceAolI-ZY5c4qqYB60BH","authorUserName":"b***0","title":"3D地图柱图可点击可以高亮选中","description":"地图区块上有两立体柱，点击区块可获取对应series的data，可选中高亮。","latestVersion":2,"alwaysLatest":0,"createTime":"2021-10-29T17:03:25.000Z","lastUpdateTime":"2021-10-29T17:13:34.000Z","auth":2,"uid":"obd-o2SuPEDc7-KceAolI-ZY5c4qqYB60BH","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"5.2.1","versionCreateTime":"2021-10-29T17:13:34.000Z","code":"var zjJsonUrl = '/asset/get/s/data-1635335079817-DwAy4Tzuv.json';\n\n// 测试数据\nvar originalDatas = {\n    dataMap: [\n        { name: '目标数', field: 'mbs', unit: '万人' },\n        { name: '完成数', field: 'wcs', unit: '万人' },\n    ],\n    datas: [\n        {\n            adcode: 330100,\n            name: '杭州市',\n            lng: '119.053576',\n            lat: '29.887459',\n            wcs: 10,\n            mbs: 50,\n            wcl: 100,\n        },\n        {\n            adcode: 330200,\n            name: '宁波市',\n            lng: '121.549792',\n            lat: '29.630000',\n            wcs: 10,\n            mbs: 20,\n            wcl: 80,\n        },\n        {\n            adcode: 330300,\n            name: '温州市',\n            lng: '120.672111',\n            lat: '28.000575',\n            wcs: 10,\n            mbs: 30,\n            wcl: 100,\n        },\n        {\n            adcode: 330400,\n            name: '嘉兴市',\n            lng: '120.750865',\n            lat: '30.662653',\n            wcs: 10,\n            mbs: 40,\n            wcl: 100,\n        },\n        {\n            adcode: 330500,\n            name: '湖州市',\n            lng: '120.000398',\n            lat: '30.867198',\n            wcs: 10,\n            mbs: 20,\n            wcl: 90,\n        },\n        {\n            adcode: 330600,\n            name: '绍兴市',\n            lng: '120.582112',\n            lat: '29.997117',\n            wcs: 10,\n            mbs: 20,\n            wcl: 100,\n        },\n        {\n            adcode: 330700,\n            name: '金华市',\n            lng: '119.649506',\n            lat: '29.189524',\n            wcs: 10,\n            mbs: 20,\n            wcl: 100,\n        },\n        {\n            adcode: 330800,\n            name: '衢州市',\n            lng: '118.602630',\n            lat: '28.941708',\n            wcs: 10,\n            mbs: 20,\n            wcl: 100,\n        },\n        {\n            adcode: 330900,\n            name: '舟山市',\n            lng: '122.106863',\n            lat: '30.016028',\n            wcs: 10,\n            mbs: 20,\n            wcl: 100,\n        },\n        {\n            adcode: 331000,\n            name: '台州市',\n            lng: '121.128599',\n            lat: '28.861378',\n            wcs: 10,\n            mbs: 20,\n            wcl: 100,\n        },\n        {\n            adcode: 331100,\n            name: '丽水市',\n            lng: '119.321786',\n            lat: '28.051993',\n            wcs: 10,\n            mbs: 20,\n            wcl: 100,\n        },\n    ],\n};\n\n$.get(zjJsonUrl, (res) => {\n    echarts.registerMap('map', res);\n\n    var series = [\n        {\n            type: 'map3D',\n            map: 'map',\n            // 设置为透明\n            itemStyle: {\n                color: [1, 1, 1, 0],\n            },\n            emphasis: {\n                itemStyle: {\n                    color: [1, 1, 1, 0],\n                },\n            },\n            data: originalDatas.datas,\n\n            viewControl: {\n                beta: 45, //x轴旋转\n                alpha: 45, //Y轴旋转\n            }\n        },\n    ];\n\n    $.each(originalDatas.dataMap, function (i, seriesItem) {\n        series.push({\n            name: seriesItem.name,\n            type: 'bar3D',\n            coordinateSystem: 'geo3D',\n            shading: 'lambert',\n            label: {\n                show: true,\n                position: 'top',\n                formatter: (params) => {\n                    return params.value[2];\n                },\n            },\n            data: originalDatas.datas.map((item) => {\n                item.value = [\n                    i == 0 ? item.lng - 0 + 0.05 : item.lng - 0.05,\n                    item.lat,\n                    item[seriesItem.field],\n                    seriesItem.unit,\n                ];\n                return JSON.parse(JSON.stringify(item));\n            }),\n            barSize: 2,\n            minHeight: 1,\n            itemStyle: {\n                color: i == 0 ? '#FFB239' : '#5E5FFF',\n            },\n            emphasis: {\n                label: { show: true },\n            },\n            // zlevel: i\n        });\n    });\n\n    option = {\n        tooltip: {\n            trigger: 'item',\n            formatter: function (params) {\n                if (params.seriesType == 'bar3D') {\n                    return [params.seriesName, params.name + '：' + params.value[2] + (params.value[3] || '')].join(\n                        '<br />'\n                    );\n                }\n            },\n        },\n        geo3D: {\n            show: true,\n            map: 'map',\n\n            viewControl: {\n                beta: 45, //x轴旋转\n                alpha: 45, //Y轴旋转\n                panMouseButton: 'right', //平移操作使用的鼠标按键\n                rotateMouseButton: 'left', //旋转操作使用的鼠标按键\n            },\n            light: {\n                main: {\n                    color: '#ffffff',\n                    intensity: 1,\n                    shadow: false,\n                },\n            },\n            itemStyle: {\n                color: '#4D96FA',\n                borderWidth: 1,\n                borderColor: '#fff',\n                opcity: 1,\n            },\n\n            shading: 'realistic',\n            label: {\n                show: true,\n                color: '#fff',\n                distance: 5,\n            },\n            emphasis: {\n                label: { show: true },\n                itemStyle: { color: '#36A8FF' },\n            },\n            groundPlane: false,\n            data: originalDatas.datas,\n            // 将geo3d放在最底层\n            zlevel:-1\n        },\n        series: series,\n    };\n\n    myChart.setOption(option);\n    myChart.off('click');\n    myChart.on('click', function (params) {\n        // 点击获取data中的数据\n        console.log(params);\n        // 设置选中高亮\n        let regions = [\n            {\n                itemStyle: { color: '#36A8FF', opacity: 1 },\n                label: { show: true },\n            },\n        ];\n        regions[0].name = params.name;\n        option.geo3D.regions = regions;\n        myChart.setOption(option);\n    });\n});\n","html":"","externalScripts":"https://cdn.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js","updaterUID":"obd-o2SuPEDc7-KceAolI-ZY5c4qqYB60BH","theme":"","layout":"","viewCount":0,"userName":"b***0","commentCount":0,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xelBBd_iFR.png?v=1635527614281","isCustomThumbnail":0,"builtinTags":["category-work","geo3D","series-bar3D","series-map3D","tooltip"],"customTags":[],"updaterUserName":"b***0"}}