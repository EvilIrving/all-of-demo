{"status":0,"data":{"cid":"x7tcvzoCNQ","authorUid":"bd-3780279729","authorUserName":"水***宝","title":"圆环1","description":"","latestVersion":1,"alwaysLatest":0,"createTime":"2021-08-26T05:40:07.000Z","lastUpdateTime":"2021-08-26T05:40:07.000Z","auth":2,"uid":"bd-3780279729","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"5.1.2","versionCreateTime":"2021-08-26T05:40:07.000Z","code":"//颜色16进制换算rgba\nfunction hexToRgba(hex, opacity) {\n    return (\n        'rgba(' +\n        parseInt('0x' + hex.slice(1, 3)) +\n        ',' +\n        parseInt('0x' + hex.slice(3, 5)) +\n        ',' +\n        parseInt('0x' + hex.slice(5, 7)) +\n        ',' +\n        opacity +\n        ')'\n    );\n}\n\nbackgroundColor = 'rgba(0,0,0,1)';\n\nchartdata = [\n    {\n        name: '竞争性谈判',\n        value: 30,\n    },\n    {\n        name: '公开招标',\n        value: 50,\n    },\n];\nradius = ['30%', '34%'];\ncolor = ['#16d6cd', '#027aff'];\nlabelshow = true;\ncenterimg = true;\nlineshow = false;\nlet color1 = [];\nlet color2 = [];\n// 设置每层圆环颜色和添加间隔的颜色\ncolor.forEach((item) => {\n    color1.push(hexToRgba(item, 0.4), 'transparent');\n    color2.push(hexToRgba(item, 0.7), 'transparent');\n});\nlet data1 = [];\nlet sum = 0;\n// 根据总值设置间隔值大小\nchartdata.forEach((item) => {\n    sum += Number(item.value);\n});\n// 给每个数据后添加特定的透明的数据形成间隔\nchartdata.forEach((item) => {\n    data1.push(item, {\n        name: '',\n        value: sum / 50,\n        labelLine: {\n            show: false,\n            lineStyle: {\n                color: 'transparent',\n            },\n        },\n        itemStyle: {\n            color: 'transparent',\n        },\n    });\n});\n// 每层圆环大小\nlet radius2 = [Number(radius[1].split('%')[0]) + 0 + '%', Number(radius[1].split('%')[0]) + 4 + '%'];\nlet radius3 = [Number(radius[1].split('%')[0]) + 4 + '%', Number(radius[1].split('%')[0]) + 8 + '%'];\noption = {\n    backgroundColor: backgroundColor,\n    grid: {\n        top: 0,\n        bottom: 0,\n        left: 0,\n        right: 0,\n        containLabel: true,\n    },\n    tooltip: {\n        formatter: (params) => {\n            if (params.name != '') {\n                return params.name + ' : ' + params.value + '\\n' + '(' + params.percent + '%)';\n            }\n        },\n    },\n    series: [\n        {\n            type: 'pie',\n            radius: radius3,\n            center: ['50%', '50%'],\n            color: color,\n            hoverAnimation: false,\n            startAngle: 90,\n            selectedMode: 'single',\n            selectedOffset: 0,\n            itemStyle: {\n                normal: {\n                    // shadowColor:'#3C3C3C',\n                    //  borderRadius:10,\n                },\n            },\n            label: {\n                show: true,\n                position: 'outside',\n                formatter: (params) => {\n                    let zzb = 0;\n                    data1.forEach((item, index) => {\n                        // 当前值一半加上前面的值是否大于50%（判断label朝向）\n                        if (index <= params.dataIndex && item.name != '') {\n                            if (index == params.dataIndex) {\n                                zzb += Number(item.value) / 2;\n                            } else {\n                                zzb += Number(item.value);\n                            }\n                        }\n                    });\n                    if (params.name != '') {\n                        // 若当前值一半加上前面的值的占比大于0.5三角形朝右，相反朝左\n                        if (zzb / sum > 0.5) {\n                            return '{txt|' + ((params.value * 100) / sum).toFixed(0) + '%}' + '\\n{san|▶}';\n                        } else {\n                            return '{txt|' + ((params.value * 100) / sum).toFixed(0) + '%}' + '\\n{san|◀}';\n                        }\n                    }\n                },\n                align: 'left',\n                padding: [0, -50, 10, -60],\n                rich: {\n                    txt: {\n                        color: '#fff',\n                        width: 10,\n                        height: 10,\n                        padding: [10, 10, 0, 24],\n                    },\n                    san: {\n                        padding: [12, -3, -20, 10],\n                    },\n                },\n            },\n            labelLine: {\n                show: true,\n                length: 15,\n                length2: 60,\n                lineStyle: {\n                    color: '#fff',\n                    width: 2,\n                },\n            },\n            data: data1,\n            z: 666,\n        },\n        {\n            type: 'pie',\n            radius: radius2,\n            center: ['50%', '50%'],\n            // color: color2,\n            hoverAnimation: false,\n            startAngle: 90,\n            selectedMode: 'single',\n            selectedOffset: 0,\n            itemStyle: {\n                normal: {\n                    color: (params) => {\n                        return color2[params.dataIndex];\n                    },\n                },\n            },\n            label: {\n                show: false,\n                formatter: '{b}' + ' ' + '{c}',\n            },\n            data: data1,\n            z: 666,\n        },\n        {\n            type: 'pie',\n            radius: radius,\n            center: ['50%', '50%'],\n            color: color1,\n            hoverAnimation: false,\n            startAngle: 90,\n            selectedMode: 'single',\n            selectedOffset: 0,\n            itemStyle: {\n                normal: {\n                    color: (params) => {\n                        return color1[params.dataIndex];\n                    },\n                },\n            },\n            label: {\n                show: false,\n                formatter: '{b}' + ' ' + '{c}',\n            },\n            data: data1,\n            z: 666,\n        },\n    ],\n};\n","html":"","externalScripts":"","updaterUID":"bd-3780279729","theme":"","layout":"","viewCount":0,"userName":"水***宝","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x7tcvzoCNQ.png?v=1629956407723","isCustomThumbnail":0,"builtinTags":["category-work","series-pie","tooltip"],"customTags":[],"updaterUserName":"水***宝"}}