{"status":0,"data":{"cid":"xxp3JQXBWe","authorUid":"obd-oNlOavm5mIyDmHx5vL644Fy6r7YbdCs","authorUserName":"林***影","title":"柱状图+则线图","description":"柱状图+则线图","latestVersion":1,"alwaysLatest":0,"createTime":"2021-07-07T02:32:20.000Z","lastUpdateTime":"2021-07-07T02:32:20.000Z","auth":2,"uid":"obd-oNlOavm5mIyDmHx5vL644Fy6r7YbdCs","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"5.1.2","versionCreateTime":"2021-07-07T02:32:20.000Z","code":"const payload = {\n    id: 'age-structure',\n    color: {\n        bar: [['rgba(0, 119, 255, 1)', 'rgba(0, 191, 255, 0)']],\n        line: ['rgba(252, 209, 83, 1)', 'rgba(71, 214, 14, 1)'],\n    },\n    title: { bar: ['人数'], line: ['总人数占比', '本单位人数占比'] },\n    unit: { bar: '单位：人', line: '单位：%' },\n    wordNum: 3,\n    data: {\n        bar1: ['616', '681', '623', '416', '406', '464', '571'],\n        line1: [16, 18, 16, 11, 10, 12, 15],\n        line2: [],\n        x: ['55岁以上', '50-54岁', '45-49岁', '40-44岁', '35-39岁', '30-34岁', '29岁及以下'],\n    },\n};\n\nconst formatter = (params, wordNum) => {\n    if (!wordNum) return params\n    let newParamsName = ''\n    const paramsNameNumber = params.length\n    const provideNumber = wordNum\n    const rowNumber = Math.ceil(paramsNameNumber / provideNumber)\n    if (paramsNameNumber > provideNumber) {\n        for (let p = 0; p < rowNumber; p++) {\n            let tempStr = ''\n            const start = p * provideNumber\n            const end = start + provideNumber\n            if (p === rowNumber - 1) {\n                tempStr = params.substring(start, paramsNameNumber)\n            } else {\n                tempStr = params.substring(start, end) + '\\n'\n            }\n            newParamsName += tempStr\n        }\n    } else {\n        newParamsName = params\n    }\n    return newParamsName\n}\n\nconst wordNum = payload.wordNum;\n\nconst bar1 = [];\nconst bar2 = [];\nconst bar3 = [];\nconst line1 = [];\nconst line2 = [];\nconst line3 = [];\n\nconst color = ['#F9CA3C', '#F97A3C', '#F63048', '#6151F1', '#2E5CF2', '#2F7DF2', '#2FD9F2', '#34E9A3', '#A9DB32'];\n\npayload.data.x.forEach((item, index) => {\n    if (payload.data.bar1 && payload.data.bar1.length > 0)\n        bar1.push({ value: payload.data.bar1[index], name: item, label: { color: color[index] } });\n    if (payload.data.bar2 && payload.data.bar2.length > 0)\n        bar2.push({ value: payload.data.bar2[index], name: item, label: { color: color[index] } });\n    if (payload.data.bar3 && payload.data.bar3.length > 0)\n        bar3.push({ value: payload.data.bar3[index], name: item, label: { color: color[index] } });\n    if (payload.data.line1 && payload.data.line1.length > 0)\n        line1.push({ value: payload.data.line1[index], name: item, label: { color: color[index] } });\n    if (payload.data.line2 && payload.data.line2.length > 0)\n        line2.push({ value: payload.data.line2[index], name: item, label: { color: color[index] } });\n    if (payload.data.line3 && payload.data.line3.length > 0)\n        line3.push({ value: payload.data.line3[index], name: item, label: { color: color[index] } });\n});\n\noption = {\n    tooltip: {\n        // 触发类型  经过轴触发axis  经过轴触发item\n        trigger: 'axis',\n        backgroundColor: 'rgba(9, 30, 60, 0.6)',\n        extraCssText: 'box-shadow: 0 0 8px rgba(0, 128, 255, 0.27) inset;',\n        borderWidth: 0,\n        confine: false,\n        appendToBody: true,\n        textStyle: {\n            color: '#fff',\n            fontSize: 10,\n        },\n        // 轴触发提示才有效\n        axisPointer: {\n            type: 'shadow',\n        },\n        shadowStyle: {\n            color: 'rgba(157, 168, 245, 0.1)',\n        },\n        formatter: (data) => {\n            var tip = '<h5 class=\"echarts-tip-h5\">' + data[0].name + '</h5>';\n            data.forEach((item, index) => {\n                tip += '<div class=\"echarts-tip-div\">';\n                tip += '<div class=\"left\">' + item.marker + item.seriesName + '：</div>';\n                tip += '<div class=\"right\">' + item.value + (item.seriesType === 'line' ? '%' : '') + '</div>';\n                tip += '</div>';\n\n                if (payload.data.tipList) {\n                    payload.data.tipList.forEach((sub_item) => {\n                        tip += '<div class=\"echarts-tip-div\">';\n                        tip += '<div class=\"left\">' + item.marker + payload.data.tipTitle[index] + '：</div>';\n                        tip += '<div class=\"right\">' + sub_item[item.dataIndex] + '</div>';\n                        tip += '</div>';\n                    });\n                }\n            });\n            return tip;\n        },\n    },\n    grid: {\n        // 距离 上右下左 的距离\n        left: 15,\n        right: 15,\n        bottom: 2,\n        top: 45,\n        // 是否包含文本\n        containLabel: true,\n    },\n    legend: {\n        type: 'scroll',\n        itemWidth: 10,\n        itemHeight: 3,\n        itemGap: 10,\n        left: 'center',\n        itemStyle: {\n            color: 'inherit',\n        },\n        textStyle: {\n            color: '#2CD3FD',\n            fontSize: 12,\n        },\n    },\n    // 字体\n    textStyle: {\n        fontSize: 10,\n        color: '#4176a3',\n    },\n    xAxis: {\n        type: 'category',\n        data: payload.data.x,\n        axisLine: {\n            lineStyle: {\n                type: 'solid',\n                color: '#4176a3',\n                width: '0.5', //坐标线的宽度\n            },\n        },\n        axisTick: {\n            show: false,\n        },\n        //坐标轴斜着显示\n        axisLabel: {\n            interval: 0,\n            rotate: 0,\n            color: '#96cbfa',\n            fontSize: 12,\n            formatter(params) {\n                return formatter(params, wordNum);\n            },\n        },\n    },\n    yAxis: [\n        {\n            name: payload.unit.bar,\n            nameGap: 10,\n            nameTextStyle: {\n                align: 'left',\n                fontSize: 11,\n                color: '#4176a3',\n            },\n            minInterval: 1,\n            type: 'value',\n            axisLine: {\n                lineStyle: {\n                    type: 'solid',\n                    color: '#4176a3', //左边线的颜色\n                    width: '1', //坐标线的宽度\n                },\n                color: '#4176a3',\n                minInterval: 1,\n            },\n            axisLabel: {\n                fontSize: 12,\n            },\n            //   刻度\n            axisTick: {\n                show: false,\n            },\n            //   y轴线\n            splitLine: {\n                show: true,\n                lineStyle: {\n                    color: 'rgba(65, 118, 163, 0.3)',\n                    width: 1,\n                    type: 'solid',\n                },\n            },\n        },\n        {\n            name: payload.unit.line,\n            axisLabel: {\n                //align: 'right',\n                formatter: '{value} %',\n                fontSize: 12,\n            },\n            nameGap: 10,\n            nameTextStyle: {\n                align: 'right',\n                fontSize: 11,\n                color: '#4176a3',\n            },\n            minInterval: 1,\n            type: 'value',\n            axisLine: {\n                lineStyle: {\n                    type: 'solid',\n                    color: '#4176a3', //左边线的颜色\n                    width: '1', //坐标线的宽度\n                },\n                color: '#4176a3',\n                minInterval: 1,\n            },\n            //   刻度\n            axisTick: {\n                show: false,\n            },\n            //   y轴线\n            splitLine: {\n                show: true,\n                lineStyle: {\n                    color: 'rgba(65, 118, 163, 0.3)',\n                    width: 1,\n                    type: 'solid',\n                },\n            },\n        },\n    ],\n    series: [],\n};\n\nconst getBar = (name, color, data) => {\n    return {\n        yAxisIndex: 0,\n        showBackground: false,\n        barMaxWidth: 8,\n        name,\n        data,\n        type: 'bar',\n        itemStyle: {\n            borderRadius: [4, 4, 0, 0],\n            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [\n                {\n                    offset: 0,\n                    color: color[0], // 0% 处的颜色\n                },\n                {\n                    offset: 1,\n                    color: color[1], // 100% 处的颜色\n                },\n            ]),\n        },\n    };\n};\nconst getLine = (name, color, data) => {\n    return {\n        yAxisIndex: 1,\n        name,\n        data,\n        type: 'line',\n        smooth: false,\n        itemStyle: {\n            color,\n        },\n        lineStyle: {\n            width: 1,\n            color,\n            shadowColor: 'rgba(0, 0, 0, .3)',\n            shadowBlur: 0,\n            shadowOffsetY: 5,\n            shadowOffsetX: 5,\n        },\n    };\n};\n\nif (bar1.length > 0) {\n    option.series.push(getBar(payload.title.bar[0], payload.color.bar[0], bar1));\n}\nif (bar2.length > 0) {\n    option.series.push(getBar(payload.title.bar[1], payload.color.bar[1], bar2));\n}\nif (bar3.length > 0) {\n    option.series.push(getBar(payload.title.bar[2], payload.color.bar[2], bar3));\n}\nif (line1.length > 0) {\n    option.series.push(getLine(payload.title.line[0], payload.color.line[0], line1));\n}\nif (line2.length > 0) {\n    option.series.push(getLine(payload.title.line[1], payload.color.line[1], line2));\n}\nif (line3.length > 0) {\n    option.series.push(getLine(payload.title.line[2], payload.color.line[2], line3));\n}\n","html":"","externalScripts":"","updaterUID":"obd-oNlOavm5mIyDmHx5vL644Fy6r7YbdCs","theme":"","layout":"","viewCount":0,"userName":"林***影","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xxp3JQXBWe.png?v=1625625140456","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","series-line","tooltip"],"customTags":[],"updaterUserName":"林***影"}}