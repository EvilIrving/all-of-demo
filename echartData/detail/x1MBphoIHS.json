{"status":0,"data":{"cid":"x1MBphoIHS","authorUid":"obd-o2LyExlQoQYD8sm_-3sG5kWvXTqBFBe","authorUserName":"k***5","title":"小清新复合条饼图","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2020-09-30T08:20:28.000Z","lastUpdateTime":"2020-09-30T08:20:28.000Z","auth":2,"uid":"obd-o2LyExlQoQYD8sm_-3sG5kWvXTqBFBe","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-09-30T08:20:28.000Z","code":"let getData = [{\r\n        value: 4360,\r\n        name: '新疆金风',\r\n        itemStyle: {\r\n            color: '#fff'\r\n        }\r\n    },\r\n\r\n    {\r\n        value: 20588,\r\n        name: '江阴远景',\r\n        itemStyle: {\r\n            color: '#fff'\r\n        }\r\n    },\r\n\r\n    {\r\n        value: 2118,\r\n        name: '国电龙源',\r\n        itemStyle: {\r\n            color: '#fff'\r\n        }\r\n    },\r\n    {\r\n        value: 3512,\r\n        name: '山东中车',\r\n        itemStyle: {\r\n            color: '#fff'\r\n        }\r\n    },\r\n    {\r\n        value: 6006,\r\n        name: '浙江运达',\r\n        itemStyle: {\r\n            color: '#fff'\r\n        }\r\n    },\r\n    // {\r\n    //     value: 2541,\r\n    //     name: '三一重能',\r\n    //     itemStyle: {\r\n    //         color: '#fff'\r\n    //     }\r\n    // },\r\n    // {\r\n    //     value: 4336,\r\n    //     name: '东方电气',\r\n    //     itemStyle: {\r\n    //         color: '#fff'\r\n    //     }\r\n    // },\r\n    // {\r\n    //     value: 1206,\r\n    //     name: '中车株洲',\r\n    //     itemStyle: {\r\n    //         color: '#fff'\r\n    //     }\r\n    // },\r\n\r\n]\r\n\r\n\r\nvar calcData = [{\r\n        value: 2541,\r\n        name: '三一重能',\r\n    },\r\n    {\r\n        value: 4336,\r\n        name: '东方电气',\r\n    },\r\n    {\r\n        value: 1206,\r\n        name: '中车株洲',\r\n    },\r\n]\r\n\r\n\r\n\r\nlet forceUseData = new Array(calcData.length).fill();\r\n(function() {\r\n    let a = calcData.map(item => item.value).reduce((prev, val) => {\r\n        prev += val;\r\n        return prev;\r\n    })\r\n    // console.log(a)\r\n    let tmpData = {\r\n        value: a,\r\n        name: '合计',\r\n        itemStyle: {\r\n            color: '#fff'\r\n        }\r\n    }\r\n\r\n    getData.splice(0, 0, tmpData)\r\n    console.log(getData)\r\n\r\n})()\r\n\r\noption = {\r\n    grid: [ //control bar's position\r\n   \r\n         {left: '60%'},\r\n      \r\n    ],\r\n    color: ['#f79646', '#fd79aa', '#feb63b', '#987292'], //, '#bfcfd1'],\r\n    backgroundColor: '#fff',\r\n    title: {\r\n        text: '小清新复合条饼图',\r\n        x: 'center',\r\n        y: '5%',\r\n        textStyle: {\r\n            fontSize: 30,\r\n        }\r\n    },\r\n    tooltip: {\r\n        trigger: 'item',\r\n        formatter: \"{b}: {c} ({d}%)\"\r\n    },\r\n    legend: {\r\n        show: true,\r\n       \r\n        y: 'bottom',\r\n      \r\n        data: getData.map(item => item.name)\r\n    },\r\n    // bar settings start\r\n    xAxis: {\r\n        type: 'category',\r\n        axisLine: {\r\n            show: false\r\n        },\r\n        axisTick: {\r\n            show: false\r\n        },\r\n        axisLabel: {\r\n            show: false,\r\n            margin: 20,\r\n        },\r\n        data: ['bar']\r\n    },\r\n    yAxis: {\r\n        type: 'value',\r\n        show: false\r\n    },\r\n\r\n\r\n    // bar over,\r\n    series: [{\r\n            name: '外圈',\r\n            type: 'pie',\r\n            radius: ['0%', '50%'],\r\n            center: ['35%', 'center'], //饼图位置控制\r\n            startAngle:35,\r\n            label: {\r\n                normal: {\r\n                    show: true,\r\n                    position: 'inside',\r\n                    // distance: 40,\r\n                    color: '#fff',\r\n                    formatter: (params) => {\r\n                        // return params.value / 100 + '%'\r\n                        // return params.name + ', ' + params.value\r\n                        return params.value\r\n                    },\r\n                },\r\n            \r\n            },\r\n            itemStyle: {\r\n                normal: {\r\n                    borderWidth: 5,\r\n                    borderColor: '#fff',\r\n                }\r\n            },\r\n            labelLine: {\r\n                normal: {\r\n                    show: false\r\n                }\r\n            },\r\n            data: getData.map(item => {\r\n                return {\r\n                    value: item.value,\r\n                    name: item.name\r\n                }\r\n            })\r\n        },\r\n   \r\n        {\r\n            data: [{\r\n                value: calcData[0].value,\r\n                name: calcData[0].name\r\n            }],\r\n            type: 'bar',\r\n            stack: 'one', //堆叠\r\n            barWidth: 100,\r\n            // seriesLayoutBy: 'row',\r\n            itemStyle: {\r\n                // color: '#47b9b3',\r\n                barWidth: 30,\r\n            },\r\n            label: {\r\n                show: true,\r\n                position: 'right',\r\n                distance: 20,\r\n                // borderColor:  data.color,\r\n                // borderWidth: 2,\r\n                color: '#000',\r\n                // fontWeight: 'bolder',\r\n                formatter: (params) => {\r\n                    // return params.name + params.value\r\n                    return params.value\r\n                }\r\n            },\r\n        },\r\n        {\r\n            data: [{\r\n                value: calcData[1].value,\r\n                name: calcData[1].name\r\n            }],\r\n            type: 'bar',\r\n            stack: 'one', //堆叠\r\n            barWidth: 100,\r\n            // seriesLayoutBy: 'row',\r\n            itemStyle: {\r\n                // color: '#47b9b3',\r\n                barWidth: 30,\r\n            },\r\n            label: {\r\n                show: true,\r\n                position: 'right',\r\n                distance: 20,\r\n                // borderColor: data.color,\r\n                // borderWidth: 2,\r\n                color: '#000',\r\n                // fontWeight: 'bolder',\r\n                formatter: (params) => {\r\n                    // return params.name + params.value\r\n                    return params.value\r\n                }\r\n            },\r\n        },\r\n        {\r\n            data: [{\r\n                value: calcData[2].value,\r\n                name: calcData[2].name\r\n            }],\r\n            type: 'bar',\r\n            stack: 'one', //堆叠\r\n            barWidth: 100,\r\n            // seriesLayoutBy: 'row',\r\n            itemStyle: {\r\n                // color: '#47b9b3',\r\n                barWidth: 30,\r\n            },\r\n            label: {\r\n                show: true,\r\n                position: 'right',\r\n                distance: 20,\r\n                // borderColor: data.color,\r\n                // borderWidth: 2,\r\n                color: '#000',\r\n                // fontWeight: 'bolder',\r\n                formatter: (params) => {\r\n                    // return params.name + params.value\r\n                    return params.value\r\n                }\r\n            },\r\n        },\r\n\r\n        //bar end\r\n    ]\r\n};\r\n\r\n\r\n\r\n\r\nmyChart.setOption(option);\r\n\r\n\r\n\r\n(function() {\r\n    var zr = myChart.getZr();\r\n    // zr.on('click', params => {\r\n    //     console.log('X:' + params.offsetX + ' Y:' + params.offsetY)\r\n\r\n    // })\r\n\r\n\r\n    var line1;\r\n\r\n    line1 = new echarts.graphic.Line({\r\n        shape: {\r\n            x1: zr.getWidth() / 1.8,\r\n            y1: zr.getHeight() / 2.55,\r\n            x2: zr.getWidth() / 1.55,\r\n            y2: zr.getHeight() / 3\r\n        },\r\n        style: {\r\n            stroke: '#dbdbdb',\r\n            lineWidth: 5\r\n        }\r\n    });\r\n    line2 = new echarts.graphic.Line({\r\n        shape: {\r\n            x1: zr.getWidth() / 1.8,\r\n            y1: zr.getHeight() / 1.65,\r\n            x2: zr.getWidth() / 1.55,\r\n            y2: zr.getHeight() / 1.5\r\n        },\r\n        style: {\r\n            stroke: '#dbdbdb',\r\n            lineWidth: 5\r\n        }\r\n    });\r\n\r\n    zr.add(line1)\r\n    zr.add(line2)\r\n\r\n})();\r\n\r\n","html":"","externalScripts":"","updaterUID":"obd-o2LyExlQoQYD8sm_-3sG5kWvXTqBFBe","theme":"","layout":"","viewCount":256,"userName":"k***5","commentCount":0,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x1MBphoIHS.png?v=1601454028662","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","series-pie","title","tooltip"],"customTags":[],"updaterUserName":"k***5"}}