{"status":0,"data":{"cid":"xryZmn6Axg","authorUid":"bd-3913038789","authorUserName":"装醉猫","title":"模拟迁徙","description":"数据纯属虚构","latestVersion":3,"alwaysLatest":1,"createTime":"2016-11-08T03:52:56.000Z","lastUpdateTime":"2016-11-08T03:52:56.000Z","auth":2,"uid":"bd-3913038789","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":3,"parentVersion":2,"echartsVersion":"3.3.0","versionCreateTime":"2016-11-09T06:26:24.000Z","code":"var geoCoordMap = {\n    '北京': [116.4551, 40.2539],\n    '天津': [117.4219, 39.4189],\n    '河北': [114.4995, 38.1006],\n    '山西': [112.3352, 37.9413],\n    '内蒙古': [111.4124, 40.4901],\n    '辽宁': [123.1238, 42.1216],\n    '吉林': [125.8154, 44.2584],\n    '黑龙江': [127.9688, 45.368],\n    '上海': [121.4648, 31.2891],\n    '江苏': [118.8062, 31.9208],\n    '浙江': [119.5313, 29.8773],\n    '安徽': [117.29, 32.0581],\n    '福建': [119.4543, 25.9222],\n    '江西': [116.0046, 28.6633],\n    '山东': [117.1582, 36.8701],\n    '河南': [113.4668, 34.6234],\n    '湖北': [114.3896, 30.6628],\n    '湖南': [113.0823, 28.2568],\n    '广东': [113.5107, 23.2196],\n    '广西': [108.479, 23.1152],\n    '海南': [110.3893, 19.8516],\n    '重庆': [107.7539, 30.1904],\n    '四川': [103.9526, 30.7617],\n    '贵州': [106.6992, 26.7682],\n    '云南': [102.9199, 25.4663],\n    '西藏': [91.1865, 30.1465],\n    '陕西': [109.1162, 34.2004],\n    '甘肃': [103.5901, 36.3043],\n    '青海': [101.4038, 36.8207],\n    '宁夏': [106.3586, 38.1775],\n    '新疆': [87.9236, 43.5883],\n    '新疆兵团': [85.42, 41.82]\n};\n\nvar list = [\n    { name: '北京',cons:100,apct:100},\n    { name: '天津',cons:30,apct:30}, \n    { name: '河北',cons:30,apct:30}, \n    { name: '山西',cons:30,apct:30}, \n    { name: '内蒙古',cons:30,apct:30}, \n    { name: '辽宁',cons:30,apct:30}, \n    { name: '吉林',cons:30,apct:30}, \n    { name: '黑龙江',cons:30,apct:30}, \n    { name: '上海',cons:30,apct:30}, \n    { name: '江苏',cons:30,apct:30}, \n    { name: '浙江',cons:30,apct:30}, \n    { name: '安徽',cons:30,apct:30},\n    { name: '福建',cons:30,apct:30},\n    { name: '江西',cons:30,apct:30},\n    { name: '山东',cons:30,apct:30},\n    { name: '河南',cons:30,apct:30},\n    { name: '湖北',cons:30,apct:30},\n    { name: '湖南',cons:30,apct:30},\n    { name: '广东',cons:30,apct:30},\n    { name: '广西',cons:30,apct:30},\n    { name: '海南',cons:30,apct:30},\n    { name: '重庆',cons:30,apct:30},\n    { name: '四川',cons:30,apct:30},\n    { name: '贵州',cons:30,apct:30},\n    { name: '云南',cons:30,apct:30},\n    { name: '西藏',cons:30,apct:30},\n    { name: '陕西',cons:30,apct:30},\n    { name: '甘肃',cons:30,apct:30},\n    { name: '青海',cons:30,apct:30},\n    { name: '宁夏',cons:30,apct:30},\n    { name: '新疆',cons:30,apct:30}, \n    { name: '新疆兵团',cons:30,apct:30}\n];\n\nvar convertData = function (data) {\n    var res = [];\n    res = data.map(function (dataItem) {\n            var res = {};\n            var fromCoord = geoCoordMap[dataItem.name];\n            var toCoord = geoCoordMap['北京'];\n            var b = fromCoord && toCoord;\n            if (fromCoord && toCoord) {\n                return {\n                    fromName: dataItem.name,\n                    toName: '北京',\n                    coords: [fromCoord, toCoord]\n                };\n            }\n            return res;\n        })\n    return res;\n};\n\nvar color = ['#5E7AA9', '#1e90ff', '#46bee9'];\nvar series = [];\nvar key = ['cons','acpt'];\nvar keyname = ['建设项目','验收项目'];\nfor(var i=0;i<key.length;i++){\n    series.push(\n        {\n            name: keyname[i],\n            type: 'lines',\n            zlevel: 2,\n            effect: {\n                show: true,\n                period: 6,\n                constantSpeed: 100,\n                trailLength: 0.4,\n                color: '#F9FAFD',\n                symbolSize: 5\n            },\n            lineStyle: {\n                normal: {\n                    color: color[i],\n                    width: 0,\n                    curveness: 0.2\n                }\n            },\n            data: convertData(list) \n        },\n        {\n            name: keyname[i],\n            type: 'lines',\n            zlevel: 1,\n            effect: {\n                show: true,\n                period: 6,\n                trailLength: 0,\n                symbol: 'image://',\n                symbolSize: 15\n            },\n            label: {\n                emphasis: {\n                    show: true,\n                    \n                }\n            },\n            lineStyle: {\n                normal: {\n                    color: color[i],\n                    width: 2,\n                    opacity: 0.8,\n                    curveness: 0.2\n                },\n                emphasis:{\n                    color: color[i],\n                    shadowColor: 'rgba(0, 0, 0, 0.5)',\n                    shadowBlur: 10,\n                    width: 6\n                }\n            },\n            data: convertData(list)\n        },\n        {\n            name: keyname[i],\n            type: 'effectScatter',\n            coordinateSystem: 'geo',\n            zlevel: 2,\n            rippleEffect: {\n                period: 5,\n                scale: 8,\n                brushType: 'stroke'\n            },\n            symbolSize: function (val) {\n                if([val[0],val[1]].toString()==geoCoordMap['北京'].toString()){\n                    return 13;\n                }\n                return 5;\n            },\n            itemStyle: {\n                normal: {\n                    color: color[i]\n                }\n            },\n            data: list.map(function (dataItem) {\n                return {\n                    name: dataItem.name,\n                    value: geoCoordMap[dataItem.name].concat([dataItem[key[i]]])\n                };\n            })\n        },\n        {\n        \tname: keyname[i],\n            type: 'map',\n            mapType: 'china',\n            zlevel: 0,\n            roam: false,\n            zoom: 1.2,\n            selectedMode : 'single',\n            label: {\n                normal: {\n                    show: false\n                },\n                emphasis: {\n                    show: false\n                }\n        \t},\n        \titemStyle: {\n                normal: {\n                    areaColor: '#F0F2F5',\n                    borderColor: 'red'\n                },\n                emphasis: {\n                    areaColor: '#F79092'\n                }\n            },\n        \tdata:list.map(function (dataItem) {\n                return {\n                    name: dataItem.name,\n                    value: dataItem[key[i]]\n                };\n            })\n        }\n    );\n}\n\nconsole.log(series);\noption = {\n    title : {\n        text: '模拟迁徙',\n        subtext: '数据纯属虚构',\n        left: 'center',\n        textStyle : {\n            color: '#fff'\n        }\n    },\n    tooltip : {\n        trigger: 'item',\n        formatter: function(params){\n            var res = params.seriesName+'<br/>';\n            if(params.seriesType=='lines'){\n                res += params.data.fromName+' > '+params.data.toName;\n                var myseries = option.series;\n                for (var i = 0; i < myseries.length; i++) { \n                    if(myseries[i].name==params.seriesName && \n                        myseries[i].type=='effectScatter'){\n                        for (var j = 0; j < myseries[i].data.length; j++) {\n                            if(myseries[i].data[j].name==params.data.fromName){\n                                res += '：'+myseries[i].data[j].value[2]+'个';\n                            }\n                        }\n                    }\n                }\n            }else if(params.seriesType=='effectScatter'){\n                res += params.data.name+'：'+params.data.value[2]+'个'; \n            }else if(params.seriesType=='map'){\n            \tres += params.data.name+'：'+params.data.value+'个';\n            }\n            //console.log(params);\n            return res;\n        },\n    },\n    legend: {\n        orient: 'vertical',\n        top: 'bottom',\n        left: 'right',\n        data:['建设项目','验收项目'],\n        textStyle: {\n            color: '#fff'\n        },\n        selectedMode: 'single'\n    },\n    geo: {\n        map: 'china',\n        label: {\n            emphasis: {\n                show: false\n            }\n        },\n        roam: false,\n        zoom:1.2,\n        itemStyle: {\n            normal: {\n                areaColor: '#F0F2F5',\n                borderColor: 'red'\n            },\n            emphasis: {\n                areaColor: '#F79092'\n            }\n        }\n    },\n    series: series\n};\n\nmyChart.on('mapselectchanged', function (params) {\n    var provinceName = \"\";\n\tvar selectedMap = params.selected;\n\tfor (var key in selectedMap) {\n        if(selectedMap[key]){\n            provinceName = key;\n        }  \n    } \n    console.log('选择的省份是：'+provinceName);\n    console.log(params);\n});\n\nvar a=0\nsetInterval(function (){\n    var i = a % 2;\n    var aa = ['建设项目','验收项目']\n    myChart.dispatchAction({type: 'legendSelect',name: aa[i]});\n    a++;\n}, 2100);\n\n\n","html":"","externalScripts":"/dep/echarts/map/js/china.js","updaterUID":"bd-3913038789","theme":"roma","layout":"","viewCount":5298,"userName":"装醉猫","commentCount":1,"starCount":8,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xryZmn6Axg.png?v=1478672785181","isCustomThumbnail":0,"builtinTags":["category-work","geo","legend","series-effectScatter","series-lines","series-map","title","tooltip"],"customTags":[],"updaterUserName":"装醉猫"}}