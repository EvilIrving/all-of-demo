{"status":0,"data":{"cid":"xwMNq61kJx","authorUid":"bd-1832650076","authorUserName":"凌***殇","title":"饼图-有合计","description":"图例选择会改变合计值","latestVersion":5,"alwaysLatest":1,"createTime":"2020-09-01T07:05:09.000Z","lastUpdateTime":"2020-09-01T07:05:09.000Z","auth":2,"uid":"bd-1832650076","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":5,"parentVersion":4,"echartsVersion":"4.8.0","versionCreateTime":"2021-04-01T06:14:45.000Z","code":"let dataArr = [{\r\n        name: \"测试1\",\r\n        value: 20\r\n    },\r\n    {\r\n        name: \"测试2\",\r\n        value: 30\r\n    }, {\r\n        name: \"测试3\",\r\n        value: 40\r\n    }, {\r\n        name: \"测试4\",\r\n        value: 50\r\n    }, {\r\n        name: \"测试5\",\r\n        value: 60\r\n    }, {\r\n        name: \"测试6\",\r\n        value: 70\r\n    }, {\r\n        name: \"测试7\",\r\n        value: 80\r\n    }, {\r\n        name: \"测试8\",\r\n        value: 90\r\n    }, {\r\n        name: \"测试9\",\r\n        value: 100\r\n    }, {\r\n        name: \"测试10\",\r\n        value: 110\r\n    }, {\r\n        name: \"测试11\",\r\n        value: 120\r\n    }, {\r\n        name: \"测试12\",\r\n        value: 130\r\n    }, {\r\n        name: \"测试13\",\r\n        value: 140\r\n    }, {\r\n        name: \"测试14\",\r\n        value: 150\r\n    }, {\r\n        name: \"测试15\",\r\n        value: 160\r\n    }, {\r\n        name: \"测试16\",\r\n        value: 170\r\n    }, {\r\n        name: \"测试17\",\r\n        value: 180\r\n    }\r\n];\r\nlet total = 0; //合计总数\r\nfor (var totalIndex = 0; totalIndex < dataArr.length; totalIndex++) {\r\n    total += dataArr[totalIndex].value\r\n}\r\nif (total === 0) { //当值为0时 不显示 改为字符串可显示\r\n    total = \"0\"\r\n}\r\n\r\nlet colorsArr = ['#0098fe', '#fe7270', '#ff9a65', '#6bb7b2', '#9bcd35', '#db4e36', '#01a758', '#8c53e6', '#5ed9a8', '#49c2e8', '#e7bcf1', '#5f58da', '#b88350', '#50bb5e', '#fc47ff', '#b0b0b0', '#f19d11'];\r\noption = {\r\n     backgroundColor:'#dbf6e9',\r\n    title: [{\r\n            text: '合计',\r\n            x: 'center',\r\n            y: '22%',\r\n            textStyle: {\r\n                color: '#000',\r\n                fontSize: 16\r\n            },\r\n            subtext: total,\r\n            subtextStyle: {\r\n                color: '#000',\r\n                fontSize: 24,\r\n                fontWeight: 'bold'\r\n            }\r\n\r\n        },\r\n        {\r\n\r\n            text: '标题二',\r\n            x: '20',\r\n            y: '50%',\r\n            textStyle: {\r\n                color: '#000',\r\n                fontSize: 14\r\n            },\r\n        }\r\n    ],\r\n    tooltip: {\r\n        trigger: 'item',\r\n        borderColor: 'rgba(255,255,255,.3)',\r\n        backgroundColor: 'rgba(13,5,30,.6)',\r\n        borderWidth: 1,\r\n        padding: 5,\r\n        formatter: function(parms) { //hover显示内容\r\n            var str = parms.marker + \"\" + parms.data.name + \"</br>\" +\r\n                \"数量：\" + parms.data.value + \"</br>\" +\r\n                \"占比：\" + parms.percent + \"%\";\r\n            return str;\r\n        },\r\n        textStyle: {\r\n            fontSize: 14\r\n        }\r\n    },\r\n    legend: {\r\n\r\n        orient: 'vertical', //纵向图例\r\n        left: 'center',\r\n        itemWidth: 15,\r\n        itemHeight: 15,\r\n        icon: 'circle',\r\n        top: '55%',\r\n        itemGap: 25, //图例item间距\r\n        textStyle: {\r\n            color: '#000',\r\n            fontSize: 14\r\n        },\r\n        data: dataArr,\r\n        formatter: function(name) { //图表名称+数值\r\n            if (dataArr && dataArr.length) {\r\n                for (var index = 0; index < dataArr.length; index++) {\r\n                    if (name === dataArr[index].name) {\r\n                        return (\r\n                            name + \"  ： \" + dataArr[index].value\r\n                        )\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n    },\r\n    series: [{\r\n        type: 'pie',\r\n        center: ['50%', '25%'],\r\n        radius: ['25%', '40%'],\r\n        clockwise: true,\r\n        avoidLabelOverlap: true,\r\n        hoverOffset: 2,\r\n        itemStyle: {\r\n            normal: {\r\n                color: function(params) {\r\n                    return colorsArr[params.dataIndex]\r\n                }\r\n            }\r\n        },\r\n        label: {\r\n            show: true,\r\n            position: 'outside',\r\n            formatter: '{d}%',\r\n            fontSize: 10,\r\n        },\r\n        labelLine: {\r\n            normal: {\r\n                length: 5,\r\n                length2: 8,\r\n                lineStyle: {\r\n                    width: 1\r\n                }\r\n            }\r\n        },\r\n        data: dataArr\r\n    }]\r\n};\r\n\r\n\r\n// 图例改变事件\r\nmyChart.on('legendselectchanged', function(params) {\r\n    var option_reset = this.getOption();\r\n    let select_value = Object.values(params.selected);\r\n    let total_reset = 0; //  重置合计\r\n    if (select_value && select_value.length) {\r\n        for (var index = 0; index < select_value.length; index++) {\r\n            if (select_value[index] !== false) {\r\n                total_reset += dataArr[index].value\r\n            }\r\n        }\r\n    }\r\n    option_reset.title[0].subtext = total_reset; //修改合计值为修改后的值\r\n    this.setOption(option_reset);\r\n});","html":"","externalScripts":"","updaterUID":"bd-1832650076","theme":"","layout":"","viewCount":1156,"userName":"凌***殇","commentCount":0,"starCount":5,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xwMNq61kJx.png?v=1617257686136","isCustomThumbnail":0,"builtinTags":["category-work","legend","series-pie","title","tooltip"],"customTags":[],"updaterUserName":"凌***殇"}}