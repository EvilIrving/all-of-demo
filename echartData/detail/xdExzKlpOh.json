{"status":0,"data":{"cid":"xdExzKlpOh","authorUid":"bd-3931679992","authorUserName":"我***_","title":"地图formatter,effectScatter使用实例","description":"通过formatter，effectScatter实现效果，可更改多种，具体看要求","latestVersion":8,"alwaysLatest":1,"createTime":"2019-08-12T08:04:49.000Z","lastUpdateTime":"2019-08-12T08:04:49.000Z","auth":2,"uid":"bd-3931679992","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":8,"parentVersion":7,"echartsVersion":"4.2.1","versionCreateTime":"2019-08-29T09:37:51.000Z","code":"\r\nvar namedata = [{name:'张'},{name:'刘'},{name:'李'},{name:'邓'},{name:'熊'},{name:'田'},{name:'周'},{name:'赵'},{name:'钱'},{name:'孙'},\r\n                {name:'吴'},{name:'郑'},{name:'王'},{name:'冯'},{name:'陈'},{name:'杨'},{name:'朱'},{name:'秦'},{name:'许'},{name:'徐'},\r\n                {name:'何'},{name:'曹'},{name:'陶'},{name:'邹'},{name:'苏'},{name:'范'},{name:'彭'},{name:'鲁'},{name:'马'},{name:'方'},\r\n                {name:'唐'},{name:'顾'}];\r\nvar option = null;\r\nvar geoCoordMap = {\r\n    '上海': [119.1803, 31.2891],\r\n\t\"福建\": [119.4543, 25.9222],\r\n\t\"重庆\": [108.384366, 30.439702],\r\n\t'北京': [116.4551, 40.2539],\r\n\t\"辽宁\": [123.1238, 42.1216],\r\n\t\"河北\": [114.4995, 38.1006],\r\n\t\"天津\": [117.4219, 39.4189],\r\n\t\"山西\": [112.3352, 37.9413],\r\n\t\"陕西\": [109.1162, 34.2004],\r\n\t\"甘肃\": [103.5901, 36.3043],\r\n\t\"宁夏\": [106.3586, 38.1775],\r\n\t\"青海\": [101.4038, 36.8207],\r\n\t\"新疆\": [87.9236, 43.5883],\r\n\t\"西藏\": [91.11, 29.97],\r\n\t\"四川\": [103.9526, 30.7617],\r\n\t\"吉林\": [125.8154, 44.2584],\r\n\t\"山东\": [117.1582, 36.8701],\r\n\t\"河南\": [113.4668, 34.6234],\r\n\t\"江苏\": [118.8062, 31.9208],\r\n\t\"安徽\": [117.29, 32.0581],\r\n\t\"湖北\": [114.3896, 30.6628],\r\n\t\"浙江\": [119.5313, 29.8773],\r\n\t'内蒙古': [110.3467, 41.4899],\r\n\t\"江西\": [116.0046, 28.6633],\r\n\t\"湖南\": [113.0823, 28.2568],\r\n\t\"贵州\": [106.6992, 26.7682],\r\n\t\"云南\": [102.9199, 25.4663],\r\n\t\"广东\": [113.12244, 23.009505],\r\n\t\"广西\": [108.479, 23.1152],\r\n\t\"海南\": [110.3893, 19.8516],\r\n\t'黑龙江': [127.9688, 45.368],\r\n\t'台湾': [121.4648, 25.5630]\r\n};\r\nvar chinaDatas = [\r\n    {\r\n\t\tname: '北京',\r\n\t\tvalue: 86\r\n\t},\r\n\t{\r\n\t\tname: '福建',\r\n\t\tvalue: 65\r\n\t},\r\n\t{\r\n\t\tname: '广东',\r\n\t\tvalue: 53\r\n\t},\r\n\t{\r\n\t\tname: '上海',\r\n\t\tvalue: 48\r\n\t},\r\n\t\r\n\t{\r\n\t\tname: '河北',\r\n\t\tvalue: 2\r\n\t},\r\n\t{\r\n\t\tname: '天津',\r\n\t\tvalue: 6\r\n\t},\r\n\t{\r\n\t\tname: '山西',\r\n\t\tvalue: 12\r\n\t},\r\n\t{\r\n\t\tname: '陕西',\r\n\t\tvalue: 2\r\n\t},\r\n\t{\r\n\t\tname: '甘肃',\r\n\t\tvalue: 4\r\n\t},\r\n\t{\r\n\t\tname: '宁夏',\r\n\t\tvalue: 5\r\n\t},\r\n\t{\r\n\t\tname: '青海',\r\n\t\tvalue: 3\r\n\t},\r\n\t{\r\n\t\tname: '新疆',\r\n\t\tvalue: 0.4\r\n\t},\r\n\t{\r\n\t\tname: '西藏',\r\n\t\tvalue: 0.3\r\n\t},\r\n\t{\r\n\t\tname: '四川',\r\n\t\tvalue: 22\r\n\t},\r\n\t{\r\n\t\tname: '重庆',\r\n\t\tvalue: 12\r\n\t},\r\n\t{\r\n\t\tname: '山东',\r\n\t\tvalue: 9\r\n\t},\r\n\t{\r\n\t\tname: '河南',\r\n\t\tvalue: 0.9\r\n\t},\r\n\t{\r\n\t\tname: '江苏',\r\n\t\tvalue: 24\r\n\t},\r\n\t{\r\n\t\tname: '安徽',\r\n\t\tvalue: 15\r\n\t},\r\n\t{\r\n\t\tname: '湖北',\r\n\t\tvalue: 6\r\n\t},\r\n\t{\r\n\t\tname: '浙江',\r\n\t\tvalue: 15\r\n\t},\r\n\t{\r\n\t\tname: '内蒙古',\r\n\t\tvalue: 0.3\r\n\t},\r\n\t{\r\n\t\tname: '江西',\r\n\t\tvalue: 34\r\n\t},\r\n\t{\r\n\t\tname: '湖南',\r\n\t\tvalue: 12\r\n\t},\r\n\t{\r\n\t\tname: '贵州',\r\n\t\tvalue: 0.8\r\n\t},\r\n\t{\r\n\t\tname: '广西',\r\n\t\tvalue: 16\r\n\t},\r\n\t{\r\n\t\tname: '海南',\r\n\t\tvalue: 37\r\n\t},\r\n\t{\r\n\t\tname: '辽宁',\r\n\t\tvalue: 0.2\r\n\t},\r\n\t{\r\n\t\tname: '吉林',\r\n\t\tvalue: 0.4\r\n\t},\r\n\t{\r\n\t\tname: '云南',\r\n\t\tvalue: 34\r\n\t},\r\n\t{\r\n\t\tname: '黑龙江',\r\n\t\tvalue: 5\r\n\t},\r\n\t{\r\n\t\tname: '台湾',\r\n\t\tvalue: 43\r\n\t}\r\n];\r\nvar convertData = function(data, type) {\r\n\t/*type:1 地图参数；type:2数据参数*/\r\n\tvar res = [];\r\n\tfor (var i = 0; i < data.length; i++) {\r\n\t\tvar geoCoord = geoCoordMap[data[i].name];\r\n\t\tif (geoCoord) {\r\n\t\t\tif (type == 2) {\r\n\t\t\t\tres.push({\r\n\t\t\t\t\tname: data[i].name,\r\n\t\t\t\t\tvalue: geoCoord.concat(data[i].value),\r\n\t\t\t\t\tusername: data[i].username,\r\n\t\t\t\t\ttelphone: data[i].telphone,\r\n\t\t\t\t\taddress: data[i].address\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tres.push({\r\n\t\t\t\t\tname: data[i].name,\r\n\t\t\t\t\tvalue: geoCoord.concat(data[i].value)\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t//console.log(res);\r\n\treturn res;\r\n};\r\nvar yData = [];\r\nvar barData = chinaDatas;\r\nbarData = barData.sort(function(a,b){\r\n    return b.value-a.value;\r\n});\r\nfor(var j =0;j<barData.length;j++){\r\n    if(j<10){\r\n        yData.push('0'+j + barData[j].name);\r\n    }else{\r\n        yData.push(j + barData[j].name);\r\n    }\r\n}\r\n\r\noption = {\r\n\tbackgroundColor: '#00013a',\r\n\ttitle: [{\r\n        show: true,\r\n        text: '2019年度销售排行',\r\n        subtext: '单位：万辆',\r\n        subtextStyle:{\r\n            color:'#ffffff',\r\n            lineHeight:20\r\n        },\r\n        textStyle: {\r\n            color: '#fff',\r\n            fontSize: 18\r\n        },\r\n        right: 140,\r\n        top: 20\r\n    }],\r\n    grid: {\r\n        right: 10,\r\n        top: 80,\r\n        bottom: 20,\r\n        width: '200'\r\n    },\r\n    xAxis: {\r\n        show: false\r\n    },\r\n    yAxis: {\r\n        type: 'category',\r\n        inverse: true,\r\n        nameGap: 16,\r\n        axisLine: {\r\n            show: false,\r\n            lineStyle: {\r\n                color: '#ddd'\r\n            }\r\n        },\r\n        axisTick: {\r\n            show: false,\r\n            lineStyle: {\r\n                color: '#ddd'\r\n            }\r\n        },\r\n        axisLabel: {\r\n            interval: 0,\r\n            margin: 85,\r\n            textStyle: {\r\n                color: '#fff',\r\n                align: 'left',\r\n                fontSize: 14\r\n            },\r\n            rich: {\r\n                a: {\r\n                    color: '#fff',\r\n                    backgroundColor: '#f0515e',\r\n                    width: 20,\r\n                    height: 20,\r\n                    align: 'center',\r\n                    borderRadius: 2\r\n                },\r\n                b: {\r\n                    color: '#fff',\r\n                    backgroundColor: '#24a5cd',\r\n                    width: 20,\r\n                    height: 20,\r\n                    align: 'center',\r\n                    borderRadius: 2\r\n                }\r\n            },\r\n            formatter: function(params) {\r\n                if (parseInt(params.slice(0, 2)) < 3) {\r\n                    return [\r\n                        '{a|' + (parseInt(params.slice(0, 2)) + 1) + '}' + '  ' + params.slice(2)\r\n                    ].join('\\n')\r\n                } else {\r\n                    return [\r\n                        '{b|' + (parseInt(params.slice(0, 2)) + 1) + '}' + '  ' + params.slice(2)\r\n                    ].join('\\n')\r\n                }\r\n            }\r\n        },\r\n        data: yData\r\n    },\r\n\tgeo: {\r\n\t\tmap: 'china',\r\n\t\tlabel: {\r\n\t\t\tshow: true,\r\n\t\t\tcolor: '#ffffff',\r\n\t\t\temphasis: {\r\n\t\t\t\tcolor: 'white',\r\n\t\t\t\tshow: false\r\n\t\t\t}\r\n\t\t},\r\n\t\troam: false,//是否允许缩放\r\n    \ttop: 100,\r\n    \tleft: 'left',\r\n        right: '300',\r\n    \tzoom: 1, //默认显示级别\r\n    \tscaleLimit: {\r\n    \t\tmin: 0,\r\n    \t\tmax: 3\r\n    \t}, //缩放级别\r\n\t\titemStyle: {\r\n\t\t\tnormal: {\r\n\t\t\t\tborderColor: 'rgba(26,82,231, 1)',\r\n\t\t\t\tborderWidth: 1,\r\n\t\t\t\tareaColor: {\r\n\t\t\t\t\ttype: 'radial',\r\n\t\t\t\t\tx: 0.5,\r\n\t\t\t\t\ty: 0.5,\r\n\t\t\t\t\tr: 0.8,\r\n\t\t\t\t\tcolorStops: [{\r\n\t\t\t\t\t\toffset: 0,\r\n\t\t\t\t\t\tcolor: 'rgba(14, 101, 247, .1)' // 0% 处的颜色\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\toffset: 1,\r\n\t\t\t\t\t\tcolor: 'rgba(125, 183, 252, .1)' // 100% 处的颜色\r\n\t\t\t\t\t}],\r\n\t\t\t\t\tglobalCoord: false // 缺省为 false\r\n\t\t\t\t},\r\n\t\t\t\tshadowColor: 'rgba(255, 255, 255, 0)',\r\n\t\t\t\tshadowOffsetX: -2,\r\n\t\t\t\tshadowOffsetY: 2,\r\n\t\t\t\tshadowBlur: 10\r\n\t\t\t},\r\n\t\t\temphasis: {\r\n\t\t\t\tareaColor: 'rgba(249,157,51, .)',\r\n\t\t\t\tborderWidth: 0\r\n\t\t\t}\r\n\t\t},\r\n\t\t//是否显示南海诸岛\r\n\t\t/*regions: [{\r\n\t\t\tname: \"南海诸岛\",\r\n\t\t\tvalue: 0,\r\n\t\t\titemStyle: {\r\n\t\t\t\tnormal: {\r\n\t\t\t\t\topacity: 0,\r\n\t\t\t\t\tlabel: {\r\n\t\t\t\t\t\tshow: false\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}],*/\r\n\t\ttooltip: {\r\n\t\t\tshow: false\r\n\t\t}\r\n\t},\r\n\tseries: [\r\n\t\t{\r\n\t\t\ttype: 'effectScatter',\r\n\t\t\tcoordinateSystem: 'geo',\r\n\t\t\tz: 1,\r\n\t\t\tdata: [],\r\n\t\t\tsymbolSize: 14,\r\n\t\t\tlabel: {\r\n\t\t\t\tnormal: {\r\n\t\t\t\t\tshow: true,\r\n\t\t\t\t\tformatter: function(params) {\r\n\t\t\t\t\t\treturn '{fline|客户：'+params.data.username+'  '+params.data.telphone+'}\\n{tline|'+params.data.address+'}';\r\n\t\t\t\t\t},\r\n\t\t\t\t\tposition: 'top',\r\n\t\t\t\t\tbackgroundColor: 'rgba(254,174,33,.8)',\r\n\t\t\t\t\tpadding: [0, 0],\r\n\t\t\t\t\tborderRadius: 3,\r\n\t\t\t\t\tlineHeight: 32,\r\n\t\t\t\t\tcolor: '#f7fafb',\r\n\t\t\t\t\trich:{\r\n\t\t\t\t\t\tfline:{\r\n\t\t\t\t\t\t\tpadding: [0, 10, 10, 10],\r\n\t\t\t\t\t\t\tcolor:'#ffffff'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttline:{\r\n\t\t\t\t\t\t\tpadding: [10, 10, 0, 10],\r\n\t\t\t\t\t\t\tcolor:'#ffffff'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\temphasis: {\r\n\t\t\t\t\tshow: true\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\titemStyle: {\r\n\t\t\t\tcolor: '#feae21',\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'effectScatter',\r\n\t\t\tcoordinateSystem: 'geo',\r\n\t\t\tz: 1,\r\n\t\t\tdata: [],\r\n\t\t\tsymbolSize: 14,\r\n\t\t\tlabel: {\r\n\t\t\t\tnormal: {\r\n\t\t\t\t\tshow: true,\r\n\t\t\t\t\tformatter: function(params) {\r\n\t\t\t\t\t\treturn '{fline|客户：'+params.data.username+'  '+params.data.telphone+'}\\n{tline|'+params.data.address+'}';\r\n\t\t\t\t\t},\r\n\t\t\t\t\tposition: 'top',\r\n\t\t\t\t\tbackgroundColor: 'rgba(233,63,66,.9)',\r\n\t\t\t\t\tpadding: [0, 0],\r\n\t\t\t\t\tborderRadius: 3,\r\n\t\t\t\t\tlineHeight: 32,\r\n\t\t\t\t\tcolor: '#ffffff',\r\n\t\t\t\t\trich:{\r\n\t\t\t\t\t\tfline:{\r\n\t\t\t\t\t\t\tpadding: [0, 10, 10, 10],\r\n\t\t\t\t\t\t\tcolor:'#ffffff'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttline:{\r\n\t\t\t\t\t\t\tpadding: [10, 10, 0, 10],\r\n\t\t\t\t\t\t\tcolor:'#ffffff'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\temphasis: {\r\n\t\t\t\t\tshow: true\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\titemStyle: {\r\n\t\t\t\tcolor: '#e93f42',\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'effectScatter',\r\n\t\t\tcoordinateSystem: 'geo',\r\n\t\t\tz: 1,\r\n\t\t\tdata: [],\r\n\t\t\tsymbolSize: 14,\r\n\t\t\tlabel: {\r\n\t\t\t\tnormal: {\r\n\t\t\t\t\tshow: true,\r\n\t\t\t\t\tformatter: function(params) {\r\n\t\t\t\t\t\treturn '{fline|客户：'+params.data.username+'  '+params.data.telphone+'}\\n{tline|'+params.data.address+'}';\r\n\t\t\t\t\t},\r\n\t\t\t\t\tposition: 'top',\r\n\t\t\t\t\tbackgroundColor: 'rgba(8,186,236,.9)',\r\n\t\t\t\t\tpadding: [0, 0],\r\n\t\t\t\t\tborderRadius: 3,\r\n\t\t\t\t\tlineHeight: 32,\r\n\t\t\t\t\tcolor: '#ffffff',\r\n\t\t\t\t\trich:{\r\n\t\t\t\t\t\tfline:{\r\n\t\t\t\t\t\t\tpadding: [0, 10, 10, 10],\r\n\t\t\t\t\t\t\tcolor:'#ffffff'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttline:{\r\n\t\t\t\t\t\t\tpadding: [10, 10, 0, 10],\r\n\t\t\t\t\t\t\tcolor:'#ffffff'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\temphasis: {\r\n\t\t\t\t\tshow: true\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\titemStyle: {\r\n\t\t\t\tcolor: '#08baec',\r\n\t\t\t}\r\n\t\t},\r\n\t\t//地图\r\n\t\t{\r\n\t\t\ttype: 'map',\r\n\t\t\tmapType: 'china',\r\n\t\t\tgeoIndex: 0,\r\n\t\t\tz: 0,\r\n\t\t\tdata: convertData(chinaDatas, 1)\r\n\t\t},\r\n\t\t{\r\n        name: 'barSer',\r\n        type: 'bar',\r\n        roam: false,\r\n        visualMap: false,\r\n        zlevel: 2,\r\n        barMaxWidth: 16,\r\n        barGap: 0,\r\n        itemStyle: {\r\n            normal: {\r\n                color: function(params) {\r\n                    var colorList = [{\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#f0515e'\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#ef8554'\r\n                            }]\r\n                        },\r\n                        {\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#3c38e4'\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#24a5cd'\r\n                            }]\r\n                        }\r\n                    ];\r\n                    if (params.dataIndex < 3) {\r\n                        return colorList[0]\r\n                    } else {\r\n                        return colorList[1]\r\n                    }\r\n                },\r\n                barBorderRadius: [0,15,15,0]\r\n            }\r\n        },\r\n        label:{\r\n            normal: {\r\n                show: true,\r\n                textBorderColor: '#333',\r\n                textBorderWidth: 2\r\n            }\r\n        },\r\n        data: barData.sort((a,b)=>{\r\n            return b.value-a.value;\r\n        })\r\n    }]\r\n};\r\nif (option && typeof option === \"object\") {\r\n\tmyChart.setOption(option, true);\r\n}\r\nfunction getTel(){\r\n    var n = 2,telstr = '1';\r\n    while(n<12){\r\n        if(n<3){\r\n            while(1){\r\n                var nums = Math.floor(Math.random()*10);\r\n                if(nums!==0&&nums!==1&&nums!==2&&nums!==3&&nums!==4&&nums!==6){\r\n                    telstr+=nums;\r\n                    break;\r\n                }\r\n            }\r\n            \r\n        }else if(n>3&&n<8){\r\n            telstr+='*';\r\n        }else{\r\n            telstr+=Math.floor(Math.random()*10);\r\n        }\r\n        n++;\r\n    }\r\n    return telstr;\r\n}\r\nfunction getName(type){\r\n    var name = '';\r\n    var roundnum = Math.floor(Math.random()*32);\r\n    switch (type) {\r\n        case 1:\r\n            name = namedata[roundnum].name+'先生';\r\n            break;\r\n        case 2:\r\n            name = namedata[roundnum].name+'女士';\r\n            break;\r\n        default:\r\n            name = namedata[roundnum].name+'先生';\r\n            break;\r\n    }\r\n    return name;\r\n}\r\nfunction getAddress(num,type){\r\n    var addstr = '';\r\n    switch (type) {\r\n        case 1:\r\n            addstr = '在'+chinaDatas[num].name+'-保时捷4S店购买车辆';\r\n            break;\r\n        case 2:\r\n            addstr = '在'+chinaDatas[num].name+'-奔驰4S店购买车辆';\r\n            break;\r\n        default:\r\n            addstr = '在'+chinaDatas[num].name+'-法拉利4S店购买车辆';\r\n            break;\r\n    }\r\n    return addstr;\r\n}\r\nvar timer = setInterval(()=>{\r\n    \r\n    //数据情况重绘，清除formatter移动效果，也可根据自身需求是否需要，删除这两行代码\r\n    /*option.series[seriesjson[runidx].createType-1].data = [];\r\n    myChart.setOption(option, true);*/\r\n    var runidx = Math.floor(Math.random()*3);\r\n    var typeidx = Math.floor(Math.random()*3);\r\n    var dataidx = Math.floor(Math.random()*32);\r\n    var ranval = Math.floor(Math.random()*10);\r\n    chinaDatas[dataidx].value = chinaDatas[dataidx].value+ranval;\r\n    var valarr = geoCoordMap[chinaDatas[dataidx].name];\r\n    valarr.push(ranval);\r\n    option.series[typeidx].data = [{\r\n        name:'',\r\n        username: getName(runidx),\r\n\t\ttelphone: getTel(),\r\n\t\taddress: getAddress(dataidx,typeidx),\r\n\t\tvalue: valarr\r\n    }];\r\n    option.series[4].data = option.series[4].data.sort(function(a,b){\r\n        return b.value-a.value;\r\n    });\r\n    myChart.setOption(option, true);\r\n},3000);","html":"","externalScripts":"/dep/echarts/map/js/china.js","updaterUID":"bd-3931679992","theme":"","layout":"","viewCount":60795,"userName":"我***_","commentCount":18,"starCount":197,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xdExzKlpOh.png?v=1567071471616","isCustomThumbnail":0,"builtinTags":["category-work","geo","grid","series-bar","series-effectScatter","series-map","title"],"customTags":[],"updaterUserName":"我***_"}}