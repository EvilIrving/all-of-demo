{"status":0,"data":{"cid":"xvT9pYy1PD","authorUid":"bd-2401441673","authorUserName":"h***景","title":"烟草省内外流","description":"数据流向","latestVersion":2,"alwaysLatest":1,"createTime":"2019-01-08T02:25:02.000Z","lastUpdateTime":"2019-01-08T02:25:02.000Z","auth":1,"uid":"bd-2401441673","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.2.0","versionCreateTime":"2019-01-08T02:25:38.000Z","code":"\r\n\r\nvar uploadedDataURL = \"/asset/get/s/data-1509940365453-SkScnUTCW.json\";\r\nmyChart.showLoading();\r\n$.getJSON(uploadedDataURL, function(geoJson) {\r\n    echarts.registerMap('jiangxi', geoJson);\r\n    myChart.hideLoading();\r\n    var geoCoordMap = {\r\n        '赣州市': [114.940278, 25.85097],\r\n        '吉安市': [114.986373, 27.111699],\r\n        '上饶市': [117.971185, 28.44442],\r\n        '九江市': [115.992811, 29.712034],\r\n        '抚州市': [116.358351, 27.98385],\r\n        '宜春市': [114.391136, 27.8043],\r\n        '南昌市': [115.892151, 28.676493],\r\n        '景德镇市': [117.214664, 29.29256],\r\n        '萍乡市': [113.852186, 27.622946],\r\n        '鹰潭市': [117.033838, 28.238638],\r\n        '新余市': [114.930835, 27.810834],\r\n    };\r\n    var SXData = [\r\n        [{\r\n            name: '赣州市'\r\n        }, {\r\n            name: '吉安市',\r\n            value: 1\r\n        }],\r\n        [{\r\n            name: '南昌市'\r\n        }, {\r\n            name: '上饶市',\r\n            value: 90\r\n        }],\r\n        [{\r\n            name: '九江市'\r\n        }, {\r\n            name: '赣州市',\r\n            value: 80\r\n        }],\r\n        [{\r\n            name: '赣州市'\r\n        }, {\r\n            name: '抚州市',\r\n            value: 70\r\n        }],\r\n        [{\r\n            name: '赣州市'\r\n        }, {\r\n            name: '宜春市',\r\n            value: 60\r\n        }],\r\n        [{\r\n            name: '赣州市'\r\n        }, {\r\n            name: '九江市',\r\n            value: 50\r\n        }],\r\n        [{\r\n            name: '赣州市'\r\n        }, {\r\n            name: '南昌市',\r\n            value: 50\r\n        }],\r\n        [{\r\n            name: '赣州市'\r\n        }, {\r\n            name: '景德镇市',\r\n            value: 40\r\n        }],\r\n        [{\r\n            name: '赣州市'\r\n        }, {\r\n            name: '萍乡市',\r\n            value: 30\r\n        }],\r\n        [{\r\n            name: '赣州市'\r\n        }, {\r\n            name: '鹰潭市',\r\n            value: 20\r\n        }],\r\n        [{\r\n            name: '赣州市'\r\n        }, {\r\n            name: '新余市',\r\n            value: 10\r\n        }]\r\n    ];\r\n\r\n    var HMData = [\r\n        [{\r\n            name: '南昌市'\r\n        }, {\r\n            name: '吉安市',\r\n            value: 95\r\n        }],\r\n        [{\r\n            name: '南昌市'\r\n        }, {\r\n            name: '上饶市',\r\n            value: 90\r\n        }],\r\n        [{\r\n            name: '南昌市'\r\n        }, {\r\n            name: '九江市',\r\n            value: 80\r\n        }],\r\n        [{\r\n            name: '南昌市'\r\n        }, {\r\n            name: '抚州市',\r\n            value: 70\r\n        }],\r\n        [{\r\n            name: '南昌市'\r\n        }, {\r\n            name: '宜春市',\r\n            value: 60\r\n        }],\r\n        [{\r\n            name: '南昌市'\r\n        }, {\r\n            name: '赣州市',\r\n            value: 50\r\n        }],\r\n        [{\r\n            name: '南昌市'\r\n        }, {\r\n            name: '景德镇市',\r\n            value: 40\r\n        }],\r\n        [{\r\n            name: '鹰潭市'\r\n        }, {\r\n            name: '南昌市',\r\n            value: 10\r\n        }],\r\n        [{\r\n            name: '南昌市'\r\n        }, {\r\n            name: '鹰潭市',\r\n            value: 20\r\n        }],\r\n        [{\r\n            name: '南昌市'\r\n        }, {\r\n            name: '新余市',\r\n            value: 10\r\n        }]\r\n    ];\r\n\r\n    var ZLData = [\r\n        [{\r\n            name: '吉安市'\r\n        }, {\r\n            name: '南昌市',\r\n            value: 100\r\n        }],\r\n        [{\r\n            name: '吉安市'\r\n        }, {\r\n            name: '上饶市',\r\n            value: 90\r\n        }],\r\n        [{\r\n            name: '吉安市'\r\n        }, {\r\n            name: '九江市',\r\n            value: 80\r\n        }],\r\n        [{\r\n            name: '吉安市'\r\n        }, {\r\n            name: '抚州市',\r\n            value: 70\r\n        }],\r\n        [{\r\n            name: ''\r\n        }, {\r\n            name: '宜春市',\r\n            value: 60\r\n        }],\r\n        [{\r\n            name: '赣州市'\r\n        }, {\r\n            name: '吉安市',\r\n            value: 50\r\n        }],\r\n        [{\r\n            name: '吉安市'\r\n        }, {\r\n            name: '景德镇市',\r\n            value: 40\r\n        }],\r\n        [{\r\n            name: '吉安市'\r\n        }, {\r\n            name: '萍乡市',\r\n            value: 30\r\n        }],\r\n        [{\r\n            name: '吉安市'\r\n        }, {\r\n            name: '鹰潭市',\r\n            value: 20\r\n        }],\r\n        [{\r\n            name: '吉安市'\r\n        }, {\r\n            name: '赣州市',\r\n            value: 20\r\n        }],\r\n        [{\r\n            name: '吉安市'\r\n        }, {\r\n            name: '新余市',\r\n            value: 10\r\n        }]\r\n    ];\r\n\r\n    var convertData = function(data) {\r\n        console.log(data);\r\n        var res = [];\r\n        for (var i = 0; i < data.length; i++) {\r\n            var dataItem = data[i];\r\n            var fromCoord = geoCoordMap[dataItem[0].name];\r\n            var toCoord = geoCoordMap[dataItem[1].name];\r\n            if (fromCoord && toCoord) {\r\n                res.push({\r\n                    fromName: dataItem[0].name,\r\n                    toName: dataItem[1].name,\r\n                    coords: [fromCoord, toCoord],\r\n                    value: dataItem[1].value\r\n                });\r\n            }\r\n        }\r\n        return res;\r\n    };\r\n    var color = ['#a6c84c', '#ffa022', '#46bee9'];\r\n    var series = [];\r\n    [\r\n        ['双喜(软经典)', SXData],\r\n        ['真龙(巴马天成)', ZLData],\r\n        ['红梅(软黄)', HMData]\r\n    ].forEach(function(item, i) {\r\n        //console.log(item,i);\r\n        series.push({\r\n            name: item[0],\r\n            type: 'lines',\r\n            zlevel: 1,\r\n            effect: {\r\n                show: true,\r\n                period: 6,\r\n                trailLength: 0.7,\r\n                color: '#fff',\r\n                symbolSize: 3\r\n            },\r\n            lineStyle: {\r\n                normal: {\r\n                    color: color[i],\r\n                    width: 0,\r\n                    curveness: 0.2\r\n                }\r\n            },\r\n            data: convertData(item[1])\r\n        }, {\r\n            name: item[0],\r\n            type: 'lines',\r\n            zlevel: 2,\r\n            symbol: ['none', 'arrow'],\r\n            symbolSize: 10,\r\n            effect: {\r\n                show: true,\r\n                period: 6,\r\n                trailLength: 0,\r\n                symbol: 'arrow',\r\n                symbolSize: 8\r\n            },\r\n            lineStyle: {\r\n                normal: {\r\n                    color: color[i],\r\n                    width: 1,\r\n                    opacity: 0.6,\r\n                    curveness: 0.2\r\n                }\r\n            },\r\n            data: convertData(item[1])\r\n        }, {\r\n            name: item[0],\r\n            type: 'effectScatter',\r\n            coordinateSystem: 'geo',\r\n            zlevel: 2,\r\n            rippleEffect: {\r\n                brushType: 'stroke'\r\n            },\r\n            label: {\r\n                normal: {\r\n                    show: true,\r\n                    position: 'right',\r\n                    formatter: '{b}'\r\n                }\r\n            },\r\n            symbolSize: function(val) {\r\n                return val[2] / 8;\r\n            },\r\n            itemStyle: {\r\n                normal: {\r\n                    color: color[i]\r\n                }\r\n            },\r\n            data: item[1].map(function(dataItem) {\r\n                return {\r\n                    name: dataItem[1].name,\r\n                    value: geoCoordMap[dataItem[1].name].concat([dataItem[1].value])\r\n                };\r\n            })\r\n        });\r\n    });\r\n    console.log(series)\r\n    option = {\r\n        backgroundColor: '#404a59',\r\n        title: {\r\n            text: '烟草省内外流',\r\n            subtext: '数据流向',\r\n            left: 'center',\r\n            textStyle: {\r\n                color: '#fff'\r\n            }\r\n        },\r\n        tooltip: {\r\n            trigger: 'item',\r\n            formatter: function(params, ticket, callback) {\r\n                console.log(params);\r\n                if (params.seriesType == \"effectScatter\") {\r\n                    return \"线路：\" + params.data.name + \"\" + params.data.value[2];\r\n                } else if (params.seriesType == \"lines\") {\r\n                    return params.data.fromName + \">\" + params.data.toName + \"<br />\" + params.data.value + '条';\r\n                } else {\r\n                    return params.name;\r\n                }\r\n            }\r\n        },\r\n        legend: {\r\n            orient: 'vertical',\r\n            top: 'bottom',\r\n            left: 'right',\r\n            data: ['双喜(软经典)', '真龙(巴马天成)', '红梅(软黄)'],\r\n            textStyle: {\r\n                color: '#fff'\r\n            },\r\n            selectedMode: 'single',\r\n        },\r\n        geo: {\r\n            show: true,\r\n            map: 'jiangxi',\r\n            label: {\r\n                emphasis: {\r\n                    show: true,\r\n                    color: '#fff'\r\n                }\r\n            },\r\n            roam: true,\r\n            itemStyle: {\r\n                normal: {\r\n                    areaColor: '#323c48',\r\n                    borderColor: '#404a59'\r\n                },\r\n                emphasis: {\r\n                    areaColor: '#2a333d'\r\n                }\r\n            }\r\n        },\r\n\r\n        series: series\r\n\r\n    };\r\n    myChart.setOption(option);\r\n});","html":"","externalScripts":"","updaterUID":"bd-2401441673","theme":"","layout":"","viewCount":452,"userName":"h***景","commentCount":2,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xvT9pYy1PD.png?v=1546914338397","isCustomThumbnail":0,"builtinTags":["category-work","geo","legend","series-effectScatter","series-lines","title","tooltip"],"customTags":[],"updaterUserName":"h***景"}}