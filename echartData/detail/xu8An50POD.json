{"status":0,"data":{"cid":"xu8An50POD","authorUid":"bd-927643697","authorUserName":"N***4","title":"自定义渲染-容器分层展示","description":"使用 custom 简单实现的容器分层展示","latestVersion":1,"alwaysLatest":1,"createTime":"2019-08-16T08:59:32.000Z","lastUpdateTime":"2019-08-16T08:59:32.000Z","auth":2,"uid":"bd-927643697","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.2.1","versionCreateTime":"2019-08-16T08:59:32.000Z","code":"\r\n//获取X轴偏移量\r\nvar getOffsetW = function(y,bh,xv,minxv){\r\n    var rev;\r\n    if(rev == undefined&&y>=bh){rev = 0;}\r\n    if(rev == undefined){\r\n        rev=(xv-minxv)/2 - y/bh*(xv-minxv)/2;\r\n    }\r\n    return rev;\r\n}\r\n\r\nvar option = {\r\n    title: {\r\n        text: '自定义渲染-容器分层展示'\r\n    },\r\n    tooltip: {},\r\n    xAxis: {\r\n        min:0,\r\n        max:20,\r\n        offset:20,\r\n        axisLabel:{show:false},\r\n        splitLine:{show:false},\r\n        axisTick:{show:false,length:20},\r\n        axisLine:{show:false}\r\n    },\r\n    yAxis: {\r\n        min:0,\r\n        max:10,\r\n        offset:20,\r\n        splitLine:{show:false},\r\n        axisTick:{show:true,length:20},\r\n        axisLine:{show:false}\r\n    },\r\n    series: [\r\n        {\r\n            z:1,\r\n            type: 'custom',\r\n            name:\"容器\",\r\n            itemStyle:{color:\"#eeeeee\",opacity: 1,borderWidth:4,borderColor:\"#cccccc\"},\r\n            emphasis:{itemStyle: {color:\"#cccccc\",opacity: 1,borderWidth:4,borderColor:\"#000000\"}},\r\n            encode: {\r\n                x:[0],\r\n                y:[1],\r\n                seriesName: [2]\r\n            },\r\n            data:[[20,10,\"容器\"]],\r\n            renderItem: function(params, api){\r\n                var xv = 20;\r\n                var bh = 2;\r\n                var minxv = 10;\r\n                var offset = getOffsetW(0,bh,xv,minxv);\r\n                var x1 =0,x2=xv,y1=0,y2=10;\r\n                var ps = [\r\n                    [x1+offset,0],[0,2],[0, y2],\r\n                    [x2,y2],[x2,2],[x2-offset,y1]\r\n                ].map(api.coord);\r\n                //ps.forEach((item,i)=>item[0])\r\n                var style = api.style()\r\n                return {\r\n                    type: 'polygon',\r\n                    shape: {\r\n                        points:ps\r\n                    }\r\n                    ,style:api.style()\r\n                    ,styleEmphasis:api.styleEmphasis()\r\n                }\r\n            }\r\n        },\r\n        {\r\n            z:2,\r\n            type: 'custom',\r\n            tooltip:{\r\n                formatter:function(arg){\r\n                    return `${arg.seriesName}-${arg.data.toString()}`\r\n                }\r\n            },\r\n            name:\"物资\",\r\n            itemStyle: {\r\n                color:\"#000000\",\r\n                opacity: 0.5\r\n            },\r\n            emphasis:{\r\n                itemStyle: {\r\n                    color:\"#00ff00\",\r\n                    opacity: 0.3\r\n                }\r\n            },\r\n            encode: {\r\n                x:[0],\r\n                y: [1, 2],\r\n                seriesName: [3,4]\r\n            },\r\n            data: [\r\n                [20,0,1.5,\"分区1\",\"#ff0000\"],\r\n                [20,1.5,4,\"分区2\",\"#00ff00\"],\r\n                [20,4,8,\"分区3\",\"#0000ff\"],\r\n                [20,8,9,\"分区4\",\"#ffff00\"]\r\n            ],\r\n            renderItem: function(params, api){\r\n                var xv = 20;\r\n                var bh = 2;\r\n                var minxv = 10;\r\n\r\n                var y1 = api.value(1);\r\n                var y2 = api.value(2);\r\n                var x1 = 0;\r\n                var x2 = xv;\r\n                var offsetx1 = getOffsetW(y1,bh,xv,minxv);\r\n                var offsetx2 = getOffsetW(y2,bh,xv,minxv);\r\n                var text = api.value(3);\r\n                var color = api.value(4);\r\n                var p_txt = api.coord([xv, (y1+y2)/2]);\r\n                p_txt[1]-=7;\r\n\r\n                var ps;\r\n                if(y1<2&&y2>2){\r\n                    ps = [[x1+offsetx1, y1],[0,2],[x1+offsetx2, y2],[x2-offsetx2,y2],[x2,2],[x2-offsetx1,y1]].map(api.coord);\r\n                }else{\r\n                    ps = [[x1+offsetx1, y1],[x1+offsetx2, y2],[x2-offsetx2,y2],[x2-offsetx1,y1]].map(api.coord);\r\n                }\r\n\r\n                \r\n                return {\r\n                    type:\"group\",\r\n                    children:[\r\n                        {\r\n                            type: 'text',\r\n                            style:{\r\n                                opacity:0.3,\r\n                                text:text,\r\n                                x:p_txt[0]+25,\r\n                                y:p_txt[1],\r\n                                textAlign:\"center\",\r\n                                font:'12px \"microsoft yahei\", sans-serif'\r\n                            }\r\n                            ,styleEmphasis:{opacity:1}\r\n                        },{\r\n                            type: 'polygon',\r\n                            shape: {\r\n                                points:ps\r\n                            }\r\n                            ,style: Object.assign({},api.style(),{fill:color,opacity:0.3})\r\n                            ,styleEmphasis: Object.assign({},api.styleEmphasis(),{fill:color,opacity:0.6})\r\n                        }\r\n                    ]\r\n                }\r\n            }\r\n        }\r\n    ]\r\n}","html":"","externalScripts":"","updaterUID":"bd-927643697","theme":"","layout":"","viewCount":34,"userName":"N***4","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xu8An50POD.png?v=1565945972955","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-custom","title","tooltip"],"customTags":[],"updaterUserName":"N***4"}}