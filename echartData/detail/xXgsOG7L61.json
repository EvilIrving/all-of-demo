{"status":0,"data":{"cid":"xXgsOG7L61","authorUid":"bd-2132094589","authorUserName":"鬼***钢","title":"不定长度的字符串占用相同的长度","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2021-03-22T07:51:28.000Z","lastUpdateTime":"2021-03-22T07:51:28.000Z","auth":2,"uid":"bd-2132094589","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2021-03-22T07:51:28.000Z","code":"// ie上字体有兼容问题\r\n\r\nlet data = [\r\n  { name: '测试', value: 123 },\r\n  { name: 'test11', value: 14123 },\r\n  { name: '测试测试', value: 353453 },\r\n  { name: 'iiii', value: 45454 },\r\n  { name: 'MMMM', value: 15 },\r\n];\r\n\r\ndata = setNameEqualLength(data);\r\n\r\nconst legendData = data.map((d) => d.name);\r\n\r\noption = {\r\n  title: {\r\n    text: '不定长度的字符串占用相同的长度',\r\n  },\r\n  legend: {\r\n    type: 'scroll',\r\n    orient: 'vertical',\r\n    right: '2%',\r\n    top: 'center',\r\n    data: legendData,\r\n    textStyle: {\r\n      fontFamily: 'monospace'\r\n      // fontFamily: \"Courier New\"\r\n      // fontFamily: \"Consolas\"\r\n      // 下面这些字体电脑没有\r\n      // fontFamily: \"Monaco\"\r\n      // fontFamily: \"Menlo\"\r\n      // fontFamily: \"Ubuntu Mono\"\r\n      // fontFamily: \"Source Code Pro\"\r\n    },\r\n    formatter(name) {\r\n      const tmp = data.find((d) => d.name === name)\r\n      return name + '   ' + tmp.value;\r\n    },\r\n  },\r\n  series: [\r\n    {\r\n      type: 'pie',\r\n      label: {\r\n        show: false,\r\n      },\r\n      data,\r\n    },\r\n  ],\r\n};\r\n\r\nfunction setNameEqualLength(data) {\r\n  const maxlength = data.reduce((max, cur) => {\r\n    const l = getCharLength(cur.name);\r\n    max = l > max ? l : max;\r\n    return max;\r\n  }, 0);\r\n\r\n  return data.map((d) => {\r\n    const l = getCharLength(d.name);\r\n    d.name += Array.from({ length: maxlength - l })\r\n      .fill(' ')\r\n      .join('');\r\n\r\n    return d;\r\n  });\r\n}\r\n\r\n// 获取字符串长度，一个中文字符串的长度为2\r\nfunction getCharLength(str) {\r\n  let i = 0;\r\n  let c = 0;\r\n  let unicode = 0;\r\n\r\n  if (str == null || str == '') {\r\n    return 0;\r\n  }\r\n  const len = str.length;\r\n  for (i = 0; i < len; i++) {\r\n    unicode = str.charCodeAt(i);\r\n    // 判断是单字符还是双字符\r\n    if (unicode < 127) {\r\n      c += 1;\r\n    } else {\r\n      // chinese\r\n      c += 2;\r\n    }\r\n  }\r\n  return c;\r\n}\r\n","html":"","externalScripts":"","updaterUID":"bd-2132094589","theme":"","layout":"","viewCount":34,"userName":"鬼***钢","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xXgsOG7L61.png?v=1616399489250","isCustomThumbnail":0,"builtinTags":["category-work","legend","series-pie","title"],"customTags":[],"updaterUserName":"鬼***钢"}}