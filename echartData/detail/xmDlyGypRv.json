{"status":0,"data":{"cid":"xmDlyGypRv","authorUid":"bd-540836030","authorUserName":"霸***y","title":"限制lenged个数","description":"限制lenged个数","latestVersion":5,"alwaysLatest":1,"createTime":"2021-10-19T09:58:24.000Z","lastUpdateTime":"2021-10-19T10:02:04.000Z","auth":2,"uid":"bd-540836030","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":5,"parentVersion":4,"echartsVersion":"5.2.1","versionCreateTime":"2021-10-19T10:02:04.000Z","code":"/* 本图主要效果：折线图最多显示三条，柱状图随便显示与否 */\n\n/* 移除数组中某个元素 */\nArray.prototype.remove = function (val) {\n    var index = this.indexOf(val);\n    if (index > -1) {\n        this.splice(index, 1);\n    }\n};\nvar obj = {};\nvar text_data = [\n    'http://www.baidu.com',\n    'https://www.sogou.com',\n    'http://www.333.com',\n    'http://www.444.com',\n    'http://www.555.com',\n    'http://www.666.com',\n    'http://www.777.com',\n    'http://www.888.com',\n    'http://www.999.com',\n    '外部链接总计',\n];\nfor (var i = 0; i < text_data.length; i++) {\n    if (i > 2 && i < text_data.length - 1) {\n        obj[text_data[i]] = false;\n    } else {\n        obj[text_data[i]] = true;\n    }\n}\nobj[text_data[text_data.length - 1]] = true;\nmyChart ? myChart.clear() : '';\nmyChart.setOption({\n    tooltip: {\n        trigger: 'axis',\n        backgroundColor: 'rgba(255,255,255,0.8)',\n        axisPointer: {\n            // 坐标轴指示器，坐标轴触发有效\n            type: 'shadow', // 默认为直线，可选为：'line' | 'shadow'\n            shadowStyle: {\n                color: 'rgba(150,150,150,0.2)',\n            },\n        },\n        textStyle: {\n            color: '#666',\n            fontSize: '14px',\n        },\n        extraCssText: 'width:220px;height:200px;padding:0;box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);\"',\n        formatter: function (params) {\n            var htmlStr = '';\n            for (var i = 0; i < params.length; i++) {\n                var tem = params[i].name;\n                var val = params[i].value;\n                if (tem.indexOf('/') < 0) {\n                    tem > 9 ? (tem = tem + ':00 - ' + tem + ':59') : (tem = '0' + tem + ':00 - ' + '0' + tem + ':59');\n                }\n                val > 0 ? (val = val) : (val = '--');\n                htmlStr +=\n                    '<div style=\"height:26px;line-height:26px;overflow:hidden;padding:6px 8px;\">' +\n                    '<span style=\"float:left;max-width:160px;overflow:hidden;text-overflow: ellipsis;white-space: nowrap;\">' +\n                    '<span style=\"margin-right:5px;display:inline-block;width:10px;height:10px;border-radius:5px;background-color:' +\n                    params[i].color +\n                    ';\"></span>' +\n                    params[i].seriesName +\n                    '</span>' +\n                    '<span style=\"float:right\">' +\n                    val +\n                    '</span>' +\n                    '</div>';\n            }\n            var res =\n                '<div><div style=\"height:40px;line-height:40px;padding:0 8px;background:rgba(237,233,233,0.4)\">' +\n                tem +\n                '<span style=\"float:right;\">' +\n                $('.table-echarts ul.group li.cur').text() +\n                '</span>' +\n                htmlStr +\n                '</div></div>';\n            return res;\n        },\n    },\n    textStyle: {\n        color: 'rgb(120, 122, 125)',\n    },\n    color: [\n        '#4fa8f9',\n        '#6ec71e',\n        '#f56e6a',\n        '#fc8b40',\n        '#818af8',\n        '#31c9d7',\n        '#f35e7a',\n        '#ab7aee',\n        '#14d68b',\n        '#cde5ff',\n    ],\n    grid: {\n        top: 30, //越大越靠下，默认60\n        bottom: 70,\n    },\n    legend: {\n        bottom: 1,\n        itemGap: 15,\n        itemWidth: 9,\n        itemHeight: 10,\n        textStyle: {\n            padding: [0, 0, 0, 8],\n        },\n        formatter: function (name) {\n            return name.length > 14 ? name.slice(0, 14) + '...' : name;\n        },\n        selected: obj,\n        data: text_data,\n    },\n    xAxis: [\n        {\n            type: 'category',\n            // boundaryGap: false,//坐标轴两边留白策略\n            axisTick: {\n                alignWithLabel: true,\n            },\n            axisLabel: {\n                interval: 2,\n            },\n            axisLine: {\n                lineStyle: {\n                    color: '#ddd',\n                },\n            },\n            data: [\n                '0',\n                '1',\n                '2',\n                '3',\n                '4',\n                '5',\n                '6',\n                '7',\n                '8',\n                '9',\n                '10',\n                '11',\n                '12',\n                '13',\n                '14',\n                '15',\n                '16',\n                '17',\n                '18',\n                '19',\n                '20',\n                '21',\n                '22',\n                '23',\n            ],\n        },\n    ],\n    yAxis: [\n        {\n            type: 'value',\n            axisLine: {\n                lineStyle: {\n                    color: 'transparent',\n                },\n            },\n            splitLine: {\n                lineStyle: {\n                    color: '#eee',\n                },\n            },\n        },\n    ],\n    series: [\n        {\n            name: 'http://www.baidu.com',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: '5',\n            data: [8, 1, 1, 0, 0, 3, 2, 0, 6, 3, 1, 4, 7, 3, 7, 15, 11, 3, 8, 3, 2, 5, 4, 7],\n        },\n        {\n            name: 'https://www.sogou.com',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: '5',\n            data: [1, 1, 0, 0, 2, 1, 0, 1, 3, 1, 0, 0, 1, 0, 1, 1, 1, 0, 2, 2, 0, 4, 2, 4],\n        },\n        {\n            name: 'http://www.333.com',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: '5',\n            data: [1, 3, 0, 0, 0, 1, 1, 0, 0, 1, 2, 1, 3, 1, 1, 1, 1, 0, 2, 0, 2, 1, 1, 1],\n        },\n        {\n            name: 'http://www.444.com',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: '5',\n            data: [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 2, 3, 0, 0, 0, 3, 1, 0, 2, 0, 1, 0, 0],\n        },\n        {\n            name: 'http://www.555.com',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: '5',\n            data: [0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 2, 0, 1, 1, 2, 0],\n        },\n        {\n            name: 'http://www.666.com',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: '5',\n            data: [0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 0, 2, 0, 0, 1, 0, 0],\n        },\n        {\n            name: 'http://www.777.com',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: '5',\n            data: [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1],\n        },\n        {\n            name: 'http://www.888.com',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: '5',\n            data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0],\n        },\n        {\n            name: 'http://www.999.com',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: '5',\n            data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],\n        },\n        {\n            name: '外部链接总计',\n            type: 'bar',\n            barWidth: '60%',\n            data: [14, 6, 1, 0, 2, 5, 4, 1, 11, 8, 6, 7, 15, 5, 11, 21, 21, 6, 17, 7, 7, 14, 9, 14],\n        },\n    ],\n});\n\nlet lengthSelectedArr = ['http://www.baidu.com', 'https://www.sogou.com', 'http://www.333.com'];\nlengthSelectedArr.reverse();\nmyChart.on('legendselectchanged', function (params) {\n    if (['外部链接总计'].includes(params.name)) return false;\n\n    let selected = [];\n    console.log(201, params);\n\n    if (params.selected[params.name]) {\n        lengthSelectedArr.remove(params.name);\n        lengthSelectedArr.unshift(params.name);\n        if (lengthSelectedArr.length > 3) {\n            lengthSelectedArr.length = 3;\n        }\n    } else {\n        lengthSelectedArr.remove(params.name);\n    }\n    let legend_option = this.getOption();\n    for (let key in params.selected) {\n        if (!['外部链接总计'].includes(key)) {\n            if (lengthSelectedArr.includes(key)) {\n                legend_option.legend[0].selected[key] = true;\n            } else {\n                legend_option.legend[0].selected[key] = false;\n            }\n        }\n        if (params.selected[key] && !['外部链接总计'].includes(key)) {\n            selected.push(key);\n        }\n    }\n    if (selected.length < 1) {\n        legend_option.legend[0].selected[params.name] = true;\n        lengthSelectedArr.unshift(params.name);\n    }\n    this.setOption(legend_option);\n});\nwindow.onresize = () => (myChart ? myChart.resize() : '');\n\n\n\n/* 参考地址\nlegend限制显示个数，溢出显示省略号，修改默认样式，tooltip动态高度(2019-08-14)\nhttps://www.cnblogs.com/wiliam/p/11351518.html\n\nEcharts控制至少选中一个图例(2020-12-11)\nhttps://blog.csdn.net/DZY_12/article/details/110957084\n\n官网：事件与行为\nhttps://echarts.apache.org/handbook/zh/concepts/event \n*/\n\n\n","html":"","externalScripts":"","updaterUID":"bd-540836030","theme":"","layout":"","viewCount":0,"userName":"霸***y","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xmDlyGypRv.png?v=1634637724445","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","series-line","tooltip"],"customTags":[],"updaterUserName":"霸***y"}}