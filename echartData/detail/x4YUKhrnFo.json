{"status":0,"data":{"cid":"x4YUKhrnFo","authorUid":"bd-2013481626","authorUserName":"じ***ゞ","title":"折线图+阈值+图例","description":"该案例已应用在小程序中","latestVersion":2,"alwaysLatest":1,"createTime":"2021-06-09T02:38:39.000Z","lastUpdateTime":"2021-06-09T02:38:39.000Z","auth":2,"uid":"bd-2013481626","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"5.1.2","versionCreateTime":"2021-06-10T03:09:08.000Z","code":"// 多图表配置\nconst ecoption = {\n  type: 'winds10',\n  title: '10m风速风向（m/s）',\n  series: { type: 'line', color: '#F49729' },\n};\n\n// 数据\nconst resdata = {\n  date:[\"08日\\n17时\",\"08日\\n18时\",\"08日\\n19时\",\"08日\\n20时\",\"08日\\n21时\",\"08日\\n22时\",\"08日\\n23时\",\"09日\\n00时\",\"09日\\n01时\",\"09日\\n02时\",\"09日\\n03时\",\"09日\\n04时\",\"09日\\n05时\",\"09日\\n06时\",\"09日\\n07时\",\"09日\\n08时\",\"09日\\n09时\",\"09日\\n10时\",\"09日\\n11时\",\"09日\\n12时\",\"09日\\n13时\",\"09日\\n14时\",\"09日\\n15时\",\"09日\\n16时\",\"09日\\n17时\",\"09日\\n18时\",\"09日\\n19时\",\"09日\\n20时\",\"09日\\n21时\",\"09日\\n22时\",\"09日\\n23时\",\"10日\\n00时\",\"10日\\n01时\",\"10日\\n02时\",\"10日\\n03时\",\"10日\\n04时\",\"10日\\n05时\",\"10日\\n06时\",\"10日\\n07时\",\"10日\\n08时\",\"10日\\n09时\",\"10日\\n10时\",\"10日\\n11时\",\"10日\\n12时\",\"10日\\n13时\",\"10日\\n14时\",\"10日\\n15时\",\"10日\\n16时\",\"10日\\n17时\",\"10日\\n18时\",\"10日\\n19时\",\"10日\\n20时\",\"10日\\n21时\",\"10日\\n22时\",\"10日\\n23时\"],\n  winds10: [\"6.1\",\"6.9\",\"7.0\",\"7.2\",\"6.7\",\"6.6\",\"6.9\",\"6.5\",\"6.6\",\"6.3\",\"6.0\",\"5.6\",\"6.6\",\"6.4\",\"7.0\",\"6.5\",\"6.5\",\"5.7\",\"6.3\",\"6.9\",\"7.0\",\"7.4\",\"7.9\",\"9.0\",\"9.1\",\"9.3\",\"10.6\",\"11.7\",\"11.6\",\"11.4\",\"10.9\",\"10.3\",\"10.2\",\"9.2\",\"9.4\",\"8.3\",\"8.4\",\"8.8\",\"7.1\",\"6.4\",\"5.5\",\"5.2\",\"4.6\",\"3.4\",\"1.9\",\"1.7\",\"4.3\",\"5.2\",\"4.2\",\"3.1\",\"4.7\",\"5.2\",\"4.4\",\"6.0\",\"5.3\"],\n  windd10: [\"119.5\",\"114.3\",\"113.1\",\"118.6\",\"107.4\",\"100.3\",\"110.4\",\"113.2\",\"116.3\",\"128.8\",\"119.7\",\"113.4\",\"107.6\",\"107.1\",\"101.0\",\"106.9\",\"104.9\",\"108.4\",\"112.3\",\"116.5\",\"120.3\",\"127.9\",\"126.7\",\"134.9\",\"141.3\",\"141.8\",\"143.5\",\"144.6\",\"150.3\",\"148.8\",\"153.7\",\"153.5\",\"150.7\",\"146.5\",\"143.0\",\"147.3\",\"149.6\",\"152.0\",\"148.5\",\"141.8\",\"142.8\",\"138.0\",\"138.5\",\"145.0\",\"183.1\",\"310.5\",\"6.8\",\"26.6\",\"47.7\",\"36.5\",\"343.0\",\"334.8\",\"322.1\",\"321.2\",\"333.1\"]\n};\n// 阈值\nconst _threshold = 6;\n\n// 风速无负数\nlet minValue = calMin(resdata.winds10) < 0 ? 0 : calMin(resdata.winds10);\nlet maxValue = calMax(resdata.winds10);\n// 间隔\nlet splitNumber = 5;\n\noption = {\n  title: {\n    text: ecoption.title,\n    left: 8,\n    top: 8,\n    textStyle: { color: '#fff', fontSize: 14, fontWeight: 'normal' },\n  },\n  grid: {\n    left: '8%',\n    right: '8%',\n    top: 46,\n    bottom: 74,\n  },\n  dataZoom: [\n    {\n      type: 'slider',\n      height: 24,\n      bottom: 12,\n      start: 0,\n      end: 100,\n    },\n  ],\n  xAxis: {\n    type: 'category',\n    boundaryGap: ecoption.boundaryGap || false,\n    axisTick: { show: false },\n    axisLabel: { textStyle: { color: '#b9b8ce' } },\n    axisLine: { lineStyle: { color: '#cccccc' } },\n    data: resdata.date,\n  },\n  yAxis: {\n    x: 'center',\n    type: 'value',\n    splitLine: { lineStyle: { type: 'dashed' } },\n    min: minValue,\n    max: maxValue,\n    splitNumber: splitNumber,\n    interval: (maxValue - minValue) / splitNumber,\n  },\n  visualMap: {\n    show: false,\n    pieces: [\n      {\n        gt: _threshold,\n        lte: maxValue,\n        color: '#FF6464'\n      },\n      {\n        value: _threshold,\n        color: '#FF6464'\n      }\n    ],\n    outOfRange: { color: ecoption.series.color },\n  },\n  series: [\n    {\n      name: ecoption.series.title,\n      type: ecoption.series.type,\n      smooth: true,\n      color: ecoption.series.color,\n      showAllSymbol: false, // 随主轴标签间隔隐藏策略\n      label: {\n        show: true,\n        position: 'top',\n        textStyle: { color: 'inherit' }, // 设置为 'inherit'，则为视觉映射得到的颜色，如系列色。\n      },\n      markLine: {\n        data: [\n          {\n            name: '阈值',\n            yAxis: _threshold,\n            lineStyle: { color: '#FF6464' },\n            label: { color: '#FF6464' },\n          },\n        ],\n      },\n      data: getWindSeries(resdata.winds10, resdata.windd10),\n    },\n  ],\n};\n\n// 计算最大值\nfunction calMax(arr) {\n  let min = Math.min.apply(null, arr);\n  let max = Math.max.apply(null, arr);\n  let interval = (max - min) / 5; // 平均值\n  max = Math.ceil(max + interval); // 向上取整\n  // console.log(min, max, interval);\n  return max;\n}\n// 计算最小值\nfunction calMin(arr) {\n  let min = Math.min.apply(null, arr);\n  let max = Math.max.apply(null, arr);\n  let interval = (max - min) / 5; // 平均值\n  min = min === 0 ? min : Math.floor(min - interval); // 向下取整\n  // console.log(min, max, interval);\n  return min;\n}\n\nfunction getWindSeries(winds, windd) {\n  let windSeries = [];\n  for (let i = 0; i < winds.length; i++) {\n    windSeries.push({\n      value: parseFloat(winds[i]),\n      symbol: getWindPic(windd[i]),\n      symbolSize: 15,\n    });\n  }\n  return windSeries;\n}\n\nfunction getWindPic(winddirection) {\n  let windPic = '';\n  //0 45 90 ... 按此为风的中线划分区间\n  if (winddirection <= 22.5 || winddirection > 337.5)\n    // arrow_north     ↓\n     windPic = 'path://M31.9304 1.13712L17.0147 33.7651L2.99726 1.05765L17.7764 8.44721L18.0074 8.56272L18.2353 8.44118L31.9304 1.13712Z';\n  else if (22.5 < winddirection && winddirection <= 67.5)\n    // arrow_northeast ↙\n    windPic = 'path://M34.3599 21.9681L0.741488 34.4926L13.9573 1.45304L19.1825 17.1287L19.2642 17.3737L19.5113 17.4489L34.3599 21.9681Z';\n  else if (67.5 < winddirection && winddirection <= 112.5)\n    // arrow_east      ←\n    windPic = 'path://M33.8629 31.9304L1.23488 17.0147L33.9424 2.99726L26.5528 17.7764L26.4373 18.0074L26.5588 18.2353L33.8629 31.9304Z';\n  else if (112.5 < winddirection && winddirection <= 157.5)\n    // arrow_southeast ↖\n    windPic = 'path://M14.0319 34.3599L1.50743 0.741488L34.547 13.9573L18.8713 19.1825L18.6263 19.2642L18.5511 19.5113L14.0319 34.3599Z';\n  else if (157.5 < winddirection && winddirection <= 202.5)\n    // arrow_south     ↑\n    windPic = 'path://M3.06959 33.8629L17.9853 1.23488L32.0027 33.9424L17.2236 26.5528L16.9926 26.4373L16.7647 26.5588L3.06959 33.8629Z';\n  else if (202.5 < winddirection && winddirection <= 247.5)\n    // arrow_southwest ↗\n    windPic = 'path://M1.64007 14.0319L35.2585 1.50743L22.0427 34.547L16.8175 18.8713L16.7358 18.6263L16.4887 18.5511L1.64007 14.0319Z';\n  else if (247.5 < winddirection && winddirection <= 292.5)\n    // arrow_west      →\n    windPic = 'path://M1.13712 3.06959L33.7651 17.9853L1.05765 32.0027L8.44721 17.2236L8.56272 16.9926L8.44118 16.7647L1.13712 3.06959Z';\n  else if (292.5 < winddirection && winddirection <= 337.5)\n    // arrow_northwest ↘\n    windPic = 'path://M21.9681 1.64007L34.4926 35.2585L1.45304 22.0427L17.1287 16.8175L17.3737 16.7358L17.4489 16.4887L21.9681 1.64007Z';\n  return windPic;\n}\n","html":"","externalScripts":"","updaterUID":"bd-2013481626","theme":"dark","layout":"","viewCount":0,"userName":"じ***ゞ","commentCount":0,"starCount":6,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x4YUKhrnFo.png?v=1623206319431","isCustomThumbnail":1,"builtinTags":["category-work","dataZoom","grid","markLine","series-line","title","visualMap"],"customTags":[],"updaterUserName":"じ***ゞ"}}