{"status":0,"data":{"cid":"xJo5vaUdq9","authorUid":"obd-oFbxvYoSWxSLUyDt5qcvCYwk1vh505o","authorUserName":"情***6","title":"极坐标柱图+旭日图条纹背景","description":"极坐标柱图+旭日图条纹背景","latestVersion":5,"alwaysLatest":0,"createTime":"2021-08-27T06:23:05.000Z","lastUpdateTime":"2021-09-24T05:38:14.000Z","auth":2,"uid":"obd-oFbxvYoSWxSLUyDt5qcvCYwk1vh505o","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":5,"parentVersion":4,"echartsVersion":"5.2.1","versionCreateTime":"2021-09-24T05:38:14.000Z","code":"// 颜色16进制转rgba\nfunction hexToRgba(hex, opacity) {\n    return (\n        'rgba(' +\n        parseInt('0x' + hex.slice(1, 3)) +\n        ',' +\n        parseInt('0x' + hex.slice(3, 5)) +\n        ',' +\n        parseInt('0x' + hex.slice(5, 7)) +\n        ',' +\n        opacity +\n        ')'\n    );\n}\nvar cw = document.body.clientHeight / 70;\n//饼图等的用这个\nvar tooltipAxis = {\n    trigger: 'axis',\n    padding: 10,\n    borderRadius: 4,\n    textStyle: {\n        fontSize: 12,\n    },\n    axisPointer: {\n        type: 'none',\n    },\n    formatter: (params) => {\n        let param = params[2];\n        if (param) {\n            return param.name + ':' + param.value;\n        } else {\n            return '';\n        }\n    },\n};\n\nvar datalist = [\n    {\n        value: 670,\n        name: '环境资源',\n    },\n    {\n        value: 111,\n        name: '安保资源',\n    },\n    {\n        value: 270,\n        name: '消防资源',\n    },\n    {\n        value: 550,\n        name: '监控资源',\n    },\n    {\n        value: 190,\n        name: '物联网设备',\n    },\n    {\n        value: 190,\n        name: '应急资源',\n    },\n];\nlet data2 = [];\nlet data3 = [];\nlet data4 = [],\n    data5 = [],\n    data6 = [];\nlet total = 0;\nlet valueArr = [];\nlet dataArr = JSON.parse(JSON.stringify(datalist));\nfor (var j = 0; j < datalist.length; j++) {\n    dataArr.push({\n        value: 0,\n        name: '',\n    });\n    valueArr.push(datalist[j].value);\n    total += datalist[j].value;\n}\nlet max = Math.max.apply(null, valueArr);\nlet min = Math.min.apply(null, valueArr);\n// 柱图模拟边框数据\nvalueArr.forEach((item,index) => {\n    data2.push(max / 14);\n    data3.push(max / 30);\n    data6.push(max / 10);\n    data4.push(total - item);\n    data5.push(\n    {\n        value: 1,\n        name: '111',\n        index:index\n    }\n);\n});\n// 旭日图数据（一半透明）\ndata5.push(\n    {\n        value: valueArr.length,\n        name: '',\n        itemStyle: {\n            color: 'transparent',\n        },\n    }\n);\n\nlet child = {\n    name: '',\n    value: 1,\n};\nlet n = 0;\n// 旭日图条纹，\nfunction xun(obj, n, type) {\n    n++;\n    if (n > 11) {\n        return;\n    }\n    if (obj.itemStyle) {\n        obj.children = [\n            {\n                name: '',\n                value: 1,\n            },\n        ];\n    } else {\n        obj.children = [\n            {\n                name: '',\n                value: 1,\n                itemStyle: {\n                    color: 'rgba(141, 192, 235, 0.1)',\n                },\n            },\n        ];\n    }\n    xun(obj.children[0], n);\n}\nxun(child, n);\ndata5.forEach((item) => {\n    if (item.name) {\n        item.children = [child];\n    }\n});\nlet color = ['#00ffff', '#008cff', '#8400ff', '#00ff2a', '#d9ff00', '#ffd000', '#ff5100'];\nlet serlist = [\n    {\n        type: 'bar',\n        data: data3,\n        coordinateSystem: 'polar',\n        barWidth: '96%',\n        name: '领用总量',\n        stack: 'a',\n        itemStyle: {\n            color: (params) => {\n                return color[params.dataIndex];\n            },\n        },\n        z: 0,\n    },\n    {\n        type: 'bar',\n        data: data6,\n        coordinateSystem: 'polar',\n        name: '领用总量',\n        stack: 'a',\n        itemStyle: {\n            color: 'transparent',\n        },\n        z: 0,\n    },\n    {\n        type: 'bar',\n        data: dataArr,\n        coordinateSystem: 'polar',\n        name: '存储总量',\n        stack: 'a',\n        // color: \"rgba(37,213,232,1)\",\n        itemStyle: {\n            color: (params) => {\n                if (params.name != '') {\n                    return hexToRgba(color[params.dataIndex], 0.4);\n                } else {\n                    return 'transparent';\n                }\n            },\n        },\n        z: 5,\n    },\n    {\n        type: 'bar',\n        data: data2,\n        coordinateSystem: 'polar',\n        name: '领用总量',\n        stack: 'a',\n        itemStyle: {\n            color: (params) => {\n                return color[params.dataIndex];\n            },\n        },\n        z: 5,\n    },\n    {\n        type: 'bar',\n        data: data4,\n        coordinateSystem: 'polar',\n        name: '总量',\n        stack: 'a',\n        itemStyle: {\n            color: (params) => {\n                return 'rgba(255,255,255,0.07)';\n            },\n        },\n        z: 5,\n    },\n    {\n        type: 'sunburst',\n        startAngle: 0,\n        nodeClick: false, //是否允许旭日图点击 默认可以点击\n        center: ['50%', '60%'],\n        radius: ['10%', '58%'],\n        data: data5,\n        // 占据的位置 文字设置\n        label: {\n            show: false,\n            color: '#fff',\n            fontSize: 14,\n            rotate:'number',\n            position:'top',\n            formatter:(params)=>{\n                if(params.data.name=='111'){\n                   return (dataArr[params.data.index].value*100/total).toFixed(1)+'%'\n                }\n            }\n        },\n        // 旭日图的分割线\n        itemStyle: {\n            color: 'rgba(255,255,255,0)',\n            borderWidth: 2,\n            borderColor: 'rgba(0,0,0,0)',\n        },\n        z: -1,\n    },\n];\noption = {\n    backgroundColor: 'rgba(0,0,0,1)',\n    tooltip: tooltipAxis,\n    grid: {\n        top: 0,\n        bottom: 0,\n    },\n    angleAxis: {\n        type: 'category',\n        startAngle: 180,\n        data: dataArr,\n        splitLine: {\n            // 分隔线\n            show: false, // 默认显示，属性show控制显示与否\n            // onGap: null,\n            lineStyle: {\n                // 属性lineStyle（详见lineStyle）\n                // [\"rgba(207,238,252,0.2)\"],\n                width: 1,\n                type: 'solid',\n            },\n        },\n        axisLine: {\n            // 坐标轴线\n            show: false, // 默认显示，属性show控制显示与否\n            lineStyle: {\n                // 属性lineStyle控制线条样式\n                color: 'rgba(207,238,252,0.2)',\n                width: 1,\n                type: 'solid',\n            },\n        },\n        axisTick: {\n            // 坐标轴小标记\n            show: false, // 属性show控制显示与否，默认不显示\n            inside: false, // 控制小标记是否在grid里\n            length: 5, // 属性length控制线长\n            lineStyle: {\n                // 属性lineStyle控制线条样式\n                color: 'transparent',\n                width: 1,\n            },\n        },\n        axisLabel: {\n            show: true,\n            formatter: (value, index) => {\n                if (index <= datalist.length - 1) {\n                    return ((value * 100) / total).toFixed(1) + '%';\n                } else {\n                    return '';\n                }\n            },\n            color:'#fff',\n            margin: -30,\n            fontSize: 16,\n        },\n    },\n\n    radiusAxis: {\n        axisLine: {\n            show: false,\n        },\n        splitLine: {\n            show: false,\n            lineStyle: {\n                type: 'solid',\n            },\n        },\n        axisLabel: {\n            show: false,\n            color: '#fff',\n            fontSize: 1.2 * cw,\n        },\n        axisTick: {\n            // 坐标轴小标记\n            show: false, // 属性show控制显示与否，默认不显示\n            inside: false, // 控制小标记是否在grid里\n            length: 5, // 属性length控制线长\n            lineStyle: {\n                // 属性lineStyle控制线条样式\n                color: 'transparent',\n                width: 1,\n            },\n        },\n    },\n\n    polar: {\n        z: 0,\n        center: ['50%', '60%'],\n        radius: ['10%', '70%'],\n    },\n    series: serlist,\n};\n","html":"","externalScripts":"","updaterUID":"obd-oFbxvYoSWxSLUyDt5qcvCYwk1vh505o","theme":"","layout":"","viewCount":0,"userName":"情***6","commentCount":0,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xJo5vaUdq9.png?v=1632461894533","isCustomThumbnail":0,"builtinTags":["category-work","polar","series-bar","series-sunburst","tooltip"],"customTags":["bar","polar","sunburst"],"updaterUserName":"情***6"}}