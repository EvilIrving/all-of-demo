{"status":0,"data":{"cid":"xqbY0rC7y","authorUid":"bd-3324025757","authorUserName":"天***斋","title":"动态旋转","description":"","latestVersion":3,"alwaysLatest":1,"createTime":"2019-11-01T13:06:31.000Z","lastUpdateTime":"2019-11-01T13:06:31.000Z","auth":2,"uid":"bd-3324025757","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":3,"parentVersion":2,"echartsVersion":"4.4.0","versionCreateTime":"2019-11-04T10:16:26.000Z","code":"\r\nvar dataStyle = {\r\n    normal: {\r\n        label: {\r\n            show: false\r\n        },\r\n        labelLine: {\r\n            show: false\r\n        },\r\n        shadowBlur: 40,\r\n        shadowColor: 'rgba(0, 0, 0,0.8)',\r\n    }\r\n};\r\nvar data = [ \r\n                 \r\n                 \r\n                {\r\n                    value: 2.1,\r\n                    name: '资产负债',\r\n                      selected:false\r\n                },\r\n                {\r\n                    value: 1.8,\r\n                    name: '社交网络服务'\r\n                ,\r\n                      selected:false},\r\n                {\r\n                    value: 1.7,\r\n                    name: '支付结算'\r\n               ,\r\n                      selected:false },\r\n                {\r\n                    value: 2.95,\r\n                    name: '其他'\r\n               ,\r\n                      selected:false }\r\n            ];\r\ngetBackgroundImage()\r\n\r\nlet angle = 0;//角度，用来做简单的动画效果的\r\n\r\noption = {\r\n    //backgroundColor: \"transparent\",\r\n    title: {\r\n        text: \"9%\",\r\n        textAlign: 'center',\r\n        textBaseline: 'middle',\r\n        textStyle:{\r\n            color:\"white\",\r\n            fontSize:40\r\n        },\r\n        left:\"50%\",\r\n        top:\"50%\"\r\n        \r\n    },\r\n    grid:{\r\n        left:\"0%\",\r\n        top:\"0%\",\r\n        right:\"0%\",\r\n        bottom:\"0%\",\r\n    },\r\n     \r\n    series: [{\r\n            name: '访问来源',\r\n            type: 'pie',\r\n            radius: ['58%', '35%'],\r\n            avoidLabelOverlap: false,\r\n            color: [\"#0066ff\", \"#ff9c00\", \"#00fcff\", \"#00bc73\", \"#f33887\", \"#5e66ff\", \"#f0d700\"],\r\n            label: {\r\n                show: false\r\n            },\r\n             itemStyle: dataStyle,\r\n            data: data,\r\n            silent: true\r\n        },{\r\n            name: \"ring4\",\r\n            type: 'custom',\r\n            coordinateSystem: \"none\",\r\n            renderItem: function(params, api) {\r\n                return {\r\n                    type: 'arc',\r\n                    shape: {\r\n                        cx: api.getWidth() / 2,\r\n                        cy: api.getHeight() / 2,\r\n                        r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.85,\r\n                        startAngle: (0+-angle) * Math.PI / 180,\r\n                        endAngle: (90+-angle) * Math.PI / 180\r\n                    },\r\n                    style: {\r\n                        stroke: \"rgb(255, 255, 255,0.2)\",\r\n                        fill: \"transparent\"\r\n                    },\r\n                    silent: true\r\n                };\r\n            },\r\n            data: [0]\r\n        }, {\r\n            name: \"ring5\",\r\n            type: 'custom',\r\n            coordinateSystem: \"none\",\r\n            renderItem: function(params, api) {\r\n                \r\n                return {\r\n                    type: 'arc',\r\n                    shape: {\r\n                        cx: api.getWidth() / 2,\r\n                        cy: api.getHeight() / 2,\r\n                        r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.85,\r\n                        startAngle: (180+-angle) * Math.PI / 180,\r\n                        endAngle: (270+-angle) * Math.PI / 180\r\n                    },\r\n                    style: {\r\n                        stroke: \"rgb(255, 255, 255,0.2)\",\r\n                        fill: \"transparent\"\r\n                    },\r\n                    silent: true\r\n                };\r\n            },\r\n            data: [0]\r\n        }, {\r\n            name: \"ring4\",\r\n            type: 'custom',\r\n            coordinateSystem: \"none\",\r\n            renderItem: function(params, api) {\r\n                return {\r\n                    type: 'ring',\r\n                    shape: {\r\n                        cx: api.getWidth() / 2,\r\n                        cy: api.getHeight() / 2,\r\n                        r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.8,\r\n                        r0: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.58\r\n                    },\r\n                    style: {\r\n                        stroke: \"transparent\",\r\n                        fill: new echarts.graphic.LinearGradient(0, 0.58, 0, 0.8, [{\r\n                                // 0% 处的颜色   \r\n                                offset: 0,\r\n                                color: 'rgb(255, 255, 255,0.1)'\r\n                            },\r\n                            {\r\n                                // 100% 处的颜色\r\n                                offset: 1,\r\n                                color: 'transparent'\r\n                            }\r\n                        ]),\r\n                    },\r\n                    silent: true\r\n                };\r\n            },\r\n            data: [0]\r\n        }, {\r\n            name: \"ring5\",\r\n            type: 'custom',\r\n            coordinateSystem: \"none\",\r\n            renderItem: function(params, api) {\r\n                return {\r\n                    type: 'arc',\r\n                    shape: {\r\n                        cx: api.getWidth() / 2,\r\n                        cy: api.getHeight() / 2,\r\n                        r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.6,\r\n                        startAngle: (0+angle) * Math.PI / 180,\r\n                        endAngle: (90+angle) * Math.PI / 180\r\n                    },\r\n                    style: {\r\n                        stroke: \"#086d9f\",\r\n                        fill: \"transparent\",\r\n                        lineWidth: 1.5\r\n                    },\r\n                    silent: true\r\n                };\r\n            },\r\n            data: [0]\r\n        }, {\r\n            name: \"ring5\",\r\n            type: 'custom',\r\n            coordinateSystem: \"none\",\r\n            renderItem: function(params, api) {\r\n                return {\r\n                    type: 'arc',\r\n                    shape: {\r\n                        cx: api.getWidth() / 2,\r\n                        cy: api.getHeight() / 2,\r\n                        r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.6,\r\n                        startAngle: (180+angle) * Math.PI / 180,\r\n                        endAngle: (270+angle) * Math.PI / 180\r\n                    },\r\n                    style: {\r\n                        stroke: \"#086d9f\",\r\n                        fill: \"transparent\",\r\n                        lineWidth: 1.5\r\n                    },\r\n                    silent: true\r\n                };\r\n            },\r\n            data: [0]\r\n        }, {\r\n            name: \"ring5\",\r\n            type: 'custom',\r\n            coordinateSystem: \"none\",\r\n            renderItem: function(params, api) {\r\n                return {\r\n                    type: 'arc',\r\n                    shape: {\r\n                        cx: api.getWidth() / 2,\r\n                        cy: api.getHeight() / 2,\r\n                        r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.65,\r\n                        startAngle: (270+-angle) * Math.PI / 180,\r\n                        endAngle: (40+-angle) * Math.PI / 180\r\n                    },\r\n                    style: {\r\n                        stroke: \"#883d20\",\r\n                        fill: \"transparent\",\r\n                        lineWidth: 1.5\r\n                    },\r\n                    silent: true\r\n                };\r\n            },\r\n            data: [0]\r\n        }, {\r\n            name: \"ring5\",\r\n            type: 'custom',\r\n            coordinateSystem: \"none\",\r\n            renderItem: function(params, api) {\r\n                return {\r\n                    type: 'arc',\r\n                    shape: {\r\n                        cx: api.getWidth() / 2,\r\n                        cy: api.getHeight() / 2,\r\n                        r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.65,\r\n                        startAngle: (90+-angle) * Math.PI / 180,\r\n                        endAngle: (220+-angle) * Math.PI / 180\r\n                    },\r\n                    style: {\r\n                        stroke: \"#883d20\",\r\n                        fill: \"transparent\",\r\n                        lineWidth: 1.5\r\n                    },\r\n                    silent: true\r\n                };\r\n            },\r\n            data: [0]\r\n        }, {\r\n            name: \"ring5\",\r\n            type: 'custom',\r\n            coordinateSystem: \"none\",\r\n            renderItem: function(params, api) {\r\n                let x0 = api.getWidth() / 2;\r\n                let y0 = api.getHeight() / 2;\r\n                let r = Math.min(api.getWidth(), api.getHeight()) / 2 * 0.65;\r\n                let point = getCirlPoint(x0, y0, r, (90+-angle))\r\n                return {\r\n                    type: 'circle',\r\n                    shape: {\r\n                        cx: point.x,\r\n                        cy: point.y,\r\n                        r: 4\r\n                    },\r\n                    style: {\r\n                        stroke: \"#883d20\",\r\n                        fill: \"#883d20\"\r\n                    },\r\n                    silent: true\r\n                };\r\n            },\r\n            data: [0]\r\n        }, {\r\n            name: \"ring5\",\r\n            type: 'custom',\r\n            coordinateSystem: \"none\",\r\n            renderItem: function(params, api) {\r\n                let x0 = api.getWidth() / 2;\r\n                let y0 = api.getHeight() / 2;\r\n                let r = Math.min(api.getWidth(), api.getHeight()) / 2 * 0.65;\r\n                let point = getCirlPoint(x0, y0, r, (270+-angle))\r\n                return {\r\n                    type: 'circle',\r\n                    shape: {\r\n                        cx: point.x,\r\n                        cy: point.y,\r\n                        r: 4\r\n                    },\r\n                    style: {\r\n                        stroke: \"#883d20\",\r\n                        fill: \"#883d20\"\r\n                    },\r\n                    silent: true\r\n                };\r\n            },\r\n            data: [0]\r\n        }, \r\n        {\r\n            name: \"ring1\",\r\n            type: 'custom',\r\n            coordinateSystem: \"none\",\r\n            renderItem: function(params, api) {\r\n                return {\r\n                    type: 'ring',\r\n                    shape: {\r\n                        cx: api.getWidth() / 2,\r\n                        cy: api.getHeight() / 2,\r\n                        r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.37\r\n                    },\r\n                    style: {\r\n                        stroke: \"rgba(255,255,255,0.4)\",\r\n                        fill: \"transparent\"\r\n                    },\r\n                    silent: true\r\n                };\r\n            },\r\n            data: [0]\r\n        },\r\n         \r\n        {\r\n            name: \"ring2\",\r\n            type: 'custom',\r\n            coordinateSystem: \"none\",\r\n            renderItem: function(params, api) {\r\n                return {\r\n                    type: 'ring',\r\n                    shape: {\r\n                        cx: api.getWidth() / 2,\r\n                        cy: api.getHeight() / 2,\r\n                        r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.30\r\n                    },\r\n                    style: {\r\n                        stroke: \"#0885b5\",\r\n                        fill: \"transparent\",\r\n                        lineWidth: 2,\r\n                        lineDash: [15, 10]\r\n                    },\r\n                    silent: true\r\n                };\r\n            },\r\n            data: [0]\r\n        },\r\n        {\r\n            name: \"ring3\",\r\n            type: 'custom',\r\n            coordinateSystem: \"none\",\r\n            renderItem: function(params, api) {\r\n                return {\r\n                    type: 'ring',\r\n                    shape: {\r\n                        cx: api.getWidth() / 2,\r\n                        cy: api.getHeight() / 2,\r\n                        r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.28\r\n                    },\r\n                    style: {\r\n                        stroke: \"rgba(16, 81, 167,.5)\",\r\n                        fill: \"transparent\"\r\n                    },\r\n                    silent: true\r\n                };\r\n            },\r\n            data: [0]\r\n        },\r\n        {\r\n            name: \"ring4\",\r\n            type: 'custom',\r\n            coordinateSystem: \"none\",\r\n            renderItem: function(params, api) {\r\n                return {\r\n                    type: 'ring',\r\n                    shape: {\r\n                        cx: api.getWidth() / 2,\r\n                        cy: api.getHeight() / 2,\r\n                        r: Math.min(api.getWidth(), api.getHeight()) / 2 * 0.2\r\n                    },\r\n                    style: {\r\n                        stroke: \"#873c20\",\r\n                        fill: \"transparent\",\r\n                        //shadowColor:\"#ddd\",\r\n                        //shadowOffsetX:0,\r\n                        //shadowBlur:4\r\n                    },\r\n                    silent: true\r\n                };\r\n            },\r\n            data: [0]\r\n        }\r\n    ]\r\n};\r\n\r\n//获取圆上面某点的坐标(x0,y0表示坐标，r半径，angle角度)\r\nfunction getCirlPoint(x0, y0, r, angle) {\r\n    let x1 = x0 + r * Math.cos(angle * Math.PI / 180)\r\n    let y1 = y0 + r * Math.sin(angle * Math.PI / 180)\r\n    return {\r\n        x: x1,\r\n        y: y1\r\n    }\r\n}\r\n\r\n\r\n//设置背景图片\r\nfunction getBackgroundImage() {\r\n    let panel = document.getElementById(\"chart-panel\")\r\n    let bgImgSrc = \"http://i2.hdslb.com/bfs/archive/2da1ff7cd9e88497116a78146b39e73e967fb25e.jpg\";\r\n    panel.style.backgroundImage = \"url(\" + bgImgSrc + \")\";\r\n    panel.style.backgroundSize = \"cover\";\r\n}\r\n \r\n function draw(){\r\n    angle = angle+3\r\n    myChart.setOption(option, true)\r\n   //window.requestAnimationFrame(draw);\r\n}\r\n//draw()\r\n\r\nsetInterval(function() {\r\n    //用setInterval做动画感觉有问题\r\n    draw()\r\n    times++;\r\n    if(times >= 20){\r\n        times = 0;\r\n        changeSelect();\r\n    }\r\n}, 100);\r\n\r\n var times = 0;\r\nvar count = 0;\r\n \r\nfunction changeSelect() {\r\n    var r = count % data.length;\r\n    option.series[0].data[r].selected = false;\r\n    \r\n    count++;\r\n    var s = count % data.length;\r\n    option.series[0].data[s].selected = true;\r\n    option.title.text = option.series[0].data[s].value + \"%\";\r\n    myChart.setOption(option, true);\r\n} ","html":"","externalScripts":"","updaterUID":"bd-3324025757","theme":"","layout":"","viewCount":474,"userName":"天***斋","commentCount":0,"starCount":4,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xqbY0rC7y.png?v=1572862586969","isCustomThumbnail":0,"builtinTags":["category-work","series-custom","series-pie","title"],"customTags":[],"updaterUserName":"天***斋"}}