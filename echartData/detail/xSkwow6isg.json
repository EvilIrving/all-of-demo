{"status":0,"data":{"cid":"xSkwow6isg","authorUid":"bd-1412566899","authorUserName":"范勒个二","title":"全国36城无人区占该城市所有小区比例","description":"data from Anjuke (%),比例越高圆圈越大颜色越深","latestVersion":2,"alwaysLatest":1,"createTime":"2017-03-19T08:55:58.000Z","lastUpdateTime":"2017-03-19T08:55:58.000Z","auth":2,"uid":"bd-1412566899","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"3.4.0","versionCreateTime":"2017-03-19T08:57:27.000Z","code":"\r\nvar data = [\r\n        { name: \"上海\", value: 88.6},\r\n        { name: \"珠海\", value: 91.5},\r\n        { name: \"三亚\", value: 98.4},\r\n        { name: \"惠州\", value: 92.8},\r\n        { name: \"海口\", value: 99.6},\r\n        { name: \"合肥\", value: 87.2},\r\n        { name: \"南京\", value: 94.8},\r\n        { name: \"杭州\", value: 93.9},\r\n        { name: \"苏州\", value: 90.5},\r\n        { name: \"无锡\", value: 95.4},\r\n        { name: \"昆山\", value: 91.8},\r\n        { name: \"广州\", value: 97.0},\r\n        { name: \"深圳\", value: 87.7},\r\n        { name: \"佛山\", value: 98.6},\r\n        { name: \"东莞\", value: 94.9},\r\n        { name: \"福州\", value: 95.2},\r\n        { name: \"厦门\", value: 89.6},\r\n        { name: \"南宁\", value: 98.6},\r\n        { name: \"郑州\", value: 94.7},\r\n        { name: \"武汉\", value: 97.4},\r\n        { name: \"长沙\", value: 95.5},\r\n        { name: \"南昌\", value: 97.9},\r\n        { name: \"北京\", value: 92.1},\r\n        { name: \"长春\", value: 93.0},\r\n        { name: \"大连\", value: 87.9},\r\n        { name: \"沈阳\", value: 97.4},\r\n        { name: \"哈尔滨\", value: 97.7},\r\n        { name: \"天津\", value: 94.9},\r\n        { name: \"济南\", value: 93.2},\r\n        { name: \"青岛\", value: 95.4},\r\n        { name: \"太原\", value: 98.4},\r\n        { name: \"石家庄\", value: 95.1},\r\n        { name: \"西安\", value: 95.6},\r\n        { name: \"成都\", value: 96.3},\r\n        { name: \"重庆\", value: 98.0},\r\n        { name: \"昆明\", value: 98.4},\r\n\r\n\r\n];\r\n\r\nvar geoCoordMap = {\r\n    \"上海\": [121.48, 31.22],\r\n    \"珠海\": [113.52, 22.3],\r\n    \"三亚\": [109.31, 18.14],\r\n    \"惠州\": [114.4, 23.09],\r\n    \"海口\": [110.35, 20.02],\r\n    \"合肥\": [117.27, 31.86],\r\n    \"南京\": [118.78, 32.04],\r\n    \"杭州\": [120.19, 30.26],\r\n    \"苏州\": [120.62, 31.32],\r\n    \"无锡\": [120.29, 31.59],\r\n    \"昆山\": [120.95, 31.39],\r\n    \"广州\": [113.23, 23.16],\r\n    \"深圳\": [114.07, 22.62],\r\n    \"佛山\": [113.11, 23.05],\r\n    \"东莞\": [113.75, 23.04],\r\n    \"福州\": [119.3, 26.08],\r\n    \"厦门\": [118.1, 24.46],\r\n    \"南宁\": [108.33, 22.84],\r\n    \"郑州\": [113.65, 34.76],\r\n    \"武汉\": [114.31, 30.52],\r\n    \"长沙\": [113, 28.21],\r\n    \"南昌\": [115.89, 28.68],\r\n    \"北京\": [116.46, 39.92],\r\n    \"长春\": [125.35, 43.88],\r\n    \"大连\": [121.62, 38.92],\r\n    \"沈阳\": [123.38, 41.8],\r\n    \"哈尔滨\": [126.63, 45.75],\r\n    \"天津\": [117.2, 39.13],\r\n    \"济南\": [117, 36.65],\r\n    \"青岛\": [120.33, 36.07],\r\n    \"太原\": [112.53, 37.87],\r\n    \"石家庄\": [114.48, 38.03],\r\n    \"西安\": [108.95, 34.27],\r\n    \"成都\": [104.06, 30.67],\r\n    \"重庆\": [106.54, 29.59],\r\n    \"昆明\": [102.73, 25.04],\r\n};\r\n\r\nvar convertData = function(data) {\r\n    var res = [];\r\n    for (var i = 0; i < data.length; i++) {\r\n        var geoCoord = geoCoordMap[data[i].name];\r\n        if (geoCoord) {\r\n            res.push({\r\n                name: data[i].name,\r\n                value: geoCoord.concat(data[i].value)\r\n            });\r\n        }\r\n    }\r\n    return res;\r\n};\r\n\r\nvar convertedData = [\r\n    convertData(data),\r\n    convertData(data.sort(function(a, b) {\r\n        return b.value - a.value;\r\n    }).slice(0, 6))\r\n];\r\ndata.sort(function(a, b) {\r\n    return a.value - b.value;\r\n})\r\n\r\nvar selectedItems = [];\r\nvar categoryData = [];\r\nvar barData = [];\r\n//   var maxBar = 30;\r\nvar sum = 0;\r\nvar count = data.length;\r\nfor (var i = 0; i < data.length; i++) {\r\n    categoryData.push(data[i].name);\r\n    barData.push(data[i].value);\r\n    sum += data[i].value;\r\n}\r\nconsole.log(categoryData);\r\nconsole.log(sum + \"   \" + count)\r\noption = {\r\n    backgroundColor: '#404a59',\r\n    animation: true,\r\n    animationDuration: 1000,\r\n    animationEasing: 'cubicInOut',\r\n    animationDurationUpdate: 1000,\r\n    animationEasingUpdate: 'cubicInOut',\r\n    title: [{\r\n        text: '全国36城无人区占该城市所有小区比例',\r\n        subtext: 'data from Anjuke (%),比例越高圆圈越大颜色越深',\r\n        left: 'center',\r\n        textStyle: {\r\n            color: '#fff'\r\n        }\r\n    }, {\r\n        id: 'statistic',\r\n        text: count ? '平均: ' + parseInt((sum / count).toFixed(4)) : '',\r\n        right: 120,\r\n        top: 40,\r\n        width: 100,\r\n        textStyle: {\r\n            color: '#fff',\r\n            fontSize: 16\r\n        }\r\n    }],\r\n    toolbox: {\r\n        iconStyle: {\r\n            normal: {\r\n                borderColor: '#fff'\r\n            },\r\n            emphasis: {\r\n                borderColor: '#b1e4ff'\r\n            }\r\n        },\r\n        feature: {\r\n            dataZoom: {},\r\n            brush: {\r\n                type: ['rect', 'polygon', 'clear']\r\n            },\r\n            saveAsImage: {\r\n                show: true\r\n            }\r\n        }\r\n    },\r\n    brush: {\r\n        outOfBrush: {\r\n            color: '#abc'\r\n        },\r\n        brushStyle: {\r\n            borderWidth: 2,\r\n            color: 'rgba(0,0,0,0.2)',\r\n            borderColor: 'rgba(0,0,0,0.5)',\r\n        },\r\n        seriesIndex: [0, 1],\r\n        throttleType: 'debounce',\r\n        throttleDelay: 300,\r\n        geoIndex: 0\r\n    },\r\n    geo: {\r\n        map: 'china',\r\n        left: '10',\r\n        right: '35%',\r\n        center: [117.98561551896913, 31.205000490896193],\r\n        zoom: 1.5,\r\n        label: {\r\n            emphasis: {\r\n                show: false\r\n            }\r\n        },\r\n        roam: true,\r\n        itemStyle: {\r\n            normal: {\r\n                areaColor: '#323c48',\r\n                borderColor: '#111'\r\n            },\r\n            emphasis: {\r\n                areaColor: '#2a333d'\r\n            }\r\n        }\r\n    },\r\n    tooltip: {\r\n        trigger: 'item'\r\n    },\r\n    grid: {\r\n        right: 40,\r\n        top: 100,\r\n        bottom: 40,\r\n        width: '30%'\r\n    },\r\n    xAxis: {\r\n        type: 'value',\r\n        scale: true,\r\n        position: 'top',\r\n        boundaryGap: false,\r\n        splitLine: {\r\n            show: false\r\n        },\r\n        axisLine: {\r\n            show: false\r\n        },\r\n        axisTick: {\r\n            show: false\r\n        },\r\n        axisLabel: {\r\n            margin: 2,\r\n            textStyle: {\r\n                color: '#aaa'\r\n            }\r\n        },\r\n    },\r\n    yAxis: {\r\n        type: 'category',\r\n        //  name: 'TOP 20',\r\n        nameGap: 16,\r\n        axisLine: {\r\n            show: true,\r\n            lineStyle: {\r\n                color: '#ddd'\r\n            }\r\n        },\r\n        axisTick: {\r\n            show: false,\r\n            lineStyle: {\r\n                color: '#ddd'\r\n            }\r\n        },\r\n        axisLabel: {\r\n            interval: 0,\r\n            textStyle: {\r\n                color: '#ddd'\r\n            }\r\n        },\r\n        data: categoryData\r\n    },\r\n    series: [{\r\n        type: 'scatter',\r\n        coordinateSystem: 'geo',\r\n        data: convertedData[0],\r\n        symbolSize: function(val) {\r\n            return Math.max(val[2] / 5, 8);\r\n        },\r\n        label: {\r\n            normal: {\r\n                formatter: '{b}',\r\n                position: 'right',\r\n                show: false\r\n            },\r\n            emphasis: {\r\n                show: true\r\n            }\r\n        },\r\n        itemStyle: {\r\n            normal: {\r\n                color: '#FF3030',\r\n                position: 'right',\r\n                show: true\r\n            }\r\n        }\r\n    }, {\r\n        //  name: 'Top 5',\r\n        type: 'effectScatter',\r\n        coordinateSystem: 'geo',\r\n        data: convertedData[0],\r\n        symbolSize: function(val) {\r\n            return Math.max(val[2] / 5);\r\n        },\r\n        showEffectOn: 'render',\r\n        rippleEffect: {\r\n            brushType: 'stroke'\r\n        },\r\n        hoverAnimation: true,\r\n        label: {\r\n            normal: {\r\n                formatter: '{b}',\r\n                position: 'right',\r\n                show: true\r\n            }\r\n        },\r\n        itemStyle: {\r\n            normal: {\r\n                color: '#f4e925',\r\n                shadowBlur: 50,\r\n                shadowColor: '#FF3030'\r\n            }\r\n        },\r\n        zlevel: 1\r\n    }, {\r\n        id: 'bar',\r\n        zlevel: 2,\r\n        type: 'bar',\r\n        symbol: 'none',\r\n        itemStyle: {\r\n            normal: {\r\n                color: '#ddb926'\r\n            }\r\n        },\r\n\r\n        data: data\r\n    }]\r\n};\r\n\r\n\r\n\r\nfunction renderBrushed(params) {\r\n    var mainSeries = params.batch[0].selected[0];\r\n\r\n    var selectedItems = [];\r\n    var categoryData = [];\r\n    var barData = [];\r\n    var maxBar = 30;\r\n    var sum = 0;\r\n    var count = 0;\r\n\r\n    for (var i = 0; i < mainSeries.dataIndex.length; i++) {\r\n        var rawIndex = mainSeries.dataIndex[i];\r\n        var dataItem = convertedData[0][rawIndex];\r\n        var pmValue = dataItem.value[2];\r\n\r\n        sum += pmValue;\r\n        count++;\r\n\r\n        selectedItems.push(dataItem);\r\n    }\r\n\r\n    selectedItems.sort(function(a, b) {\r\n        //   return b.value[2] - a.value[2];\r\n        return a.value - b.value;\r\n    });\r\n\r\n    for (var i = 0; i < Math.min(selectedItems.length, maxBar); i++) {\r\n        categoryData.push(selectedItems[i].name);\r\n        barData.push(selectedItems[i].value[2]);\r\n    }\r\n\r\n    this.setOption({\r\n        yAxis: {\r\n            data: categoryData\r\n        },\r\n        xAxis: {\r\n            axisLabel: {\r\n                show: !!count\r\n            }\r\n        },\r\n        title: {\r\n            id: 'statistic',\r\n            text: count ? '平均: ' + (sum / count).toFixed(4) : ''\r\n        },\r\n        series: {\r\n            id: 'bar',\r\n            //        sort:'descending',\r\n            data: barData\r\n        }\r\n    });\r\n}","html":"","externalScripts":"/dep/echarts/map/js/china.js","updaterUID":"bd-1412566899","theme":"","layout":"","viewCount":1506,"userName":"范勒个二","commentCount":0,"starCount":5,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xSkwow6isg.png?v=1489913847795","isCustomThumbnail":0,"builtinTags":["brush","category-work","dataZoom","geo","grid","series-bar","series-effectScatter","series-scatter","title","toolbox","tooltip"],"customTags":[],"updaterUserName":"范勒个二"}}