{"status":0,"data":{"cid":"x7rk_-y1Yd","authorUid":"bd-3981586930","authorUserName":"健***角","title":"将图片为圆形并填充关系节点","description":"针对网上的有关圆形图片型关系节点需求，制作了此示例。其中基本关系图来自于http://gallery.echartsjs.com/editor.html?c=xr1PF1dquf","latestVersion":23,"alwaysLatest":1,"createTime":"2018-12-11T08:04:24.000Z","lastUpdateTime":"2018-12-11T08:04:24.000Z","auth":1,"uid":"bd-3981586930","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":23,"parentVersion":22,"echartsVersion":"4.8.0","versionCreateTime":"2021-01-09T08:20:15.000Z","code":"//初始化数据，图片处理见最后面的方法\r\noption = {\r\n    backgroundColor: '#1a4377',\r\n    title: {\r\n        text: '圆形图片作为关系节点'\r\n    },\r\n    tooltip: {},\r\n    animationDurationUpdate: 1500,\r\n    animationEasingUpdate: 'quinticInOut',\r\n    color: ['#83e0ff', '#45f5ce', '#b158ff'],\r\n    legend: {\r\n        show: false,\r\n        data: [{\r\n                name: '核心节点',\r\n                textStyle: {\r\n                    color: '#fff'\r\n                }\r\n            },\r\n            {\r\n                name: '属性',\r\n                textStyle: {\r\n                    color: '#fff'\r\n                }\r\n            },\r\n            {\r\n                name: '属性值',\r\n                textStyle: {\r\n                    color: '#fff'\r\n                }\r\n            }\r\n        ]\r\n    },\r\n    series: [{\r\n        type: 'graph',\r\n        layout: 'force',\r\n        force: {\r\n            repulsion: 1000,\r\n            edgeLength: 50\r\n        },\r\n        symbolSize: 50,\r\n        roam: true,\r\n        label: {\r\n            normal: {\r\n                show: true\r\n            }\r\n        },\r\n        edgeSymbolSize: [4, 10],\r\n        edgeLabel: {\r\n            normal: {\r\n                show: true,\r\n                textStyle: {\r\n                    fontSize: 13\r\n                },\r\n                formatter: \"{c}\"\r\n            }\r\n        },\r\n\r\n        data: [],\r\n        links: [{\r\n                source: '李守江',\r\n                target: '分管',\r\n                value: '',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#e0f55a' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#639564' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            {\r\n                source: '李守江',\r\n                target: '政府关系',\r\n                value: '',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#e0f55a' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#639564' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                }\r\n\r\n            },\r\n            {\r\n                source: '李守江',\r\n                target: '山东滨州',\r\n                value: '籍贯',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#eda553' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#7c785b' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            {\r\n                source: '李守江',\r\n                target: '毕业院校',\r\n                value: '',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#e0f55a' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#639564' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                }\r\n\r\n            },\r\n            {\r\n                source: '毕业院校',\r\n                target: '山东大学',\r\n                value: '',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#e0f55a' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#639564' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            {\r\n                source: '毕业院校',\r\n                target: '中国人民大学',\r\n                value: '',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#e0f55a' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#639564' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            {\r\n                source: '李守江',\r\n                target: '李四',\r\n                value: '同学',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#e0f55a' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#639564' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            {\r\n                source: '李守江',\r\n                target: '王五',\r\n                value: '下属',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#e0f55a' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#639564' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            {\r\n                source: '政府关系',\r\n                target: '县委书记',\r\n                value: '',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#e0f55a' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#639564' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            {\r\n                source: '王五',\r\n                target: '信息处处长',\r\n                value: '政府关系',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#e0f55a' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#639564' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            {\r\n                source: '分管',\r\n                target: '经济',\r\n                value: '',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#e0f55a' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#639564' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            {\r\n                source: '分管',\r\n                target: '教育',\r\n                value: '',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#e0f55a' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#639564' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                }\r\n\r\n            },\r\n            {\r\n                source: '李四',\r\n                target: '山东滨州',\r\n                value: '籍贯',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#e0f55a' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#639564' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            {\r\n                source: '王五',\r\n                target: '河北沧州',\r\n                value: '籍贯',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#e0f55a' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#639564' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            {\r\n                source: '李四',\r\n                target: '山东大学',\r\n                value: '毕业院校',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#df6f30' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#915034' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                },\r\n            },\r\n            {\r\n                source: '王五',\r\n                target: '河北大学',\r\n                value: '毕业院校',\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: {\r\n                            type: 'linear',\r\n                            x: 0,\r\n                            y: 0,\r\n                            x2: 0,\r\n                            y2: 1,\r\n                            colorStops: [{\r\n                                offset: 0,\r\n                                color: '#df6f30' // 0% 处的颜色\r\n                            }, {\r\n                                offset: 1,\r\n                                color: '#915034' // 100% 处的颜色\r\n                            }],\r\n                            globalCoord: false // 缺省为 false\r\n                        }\r\n                    }\r\n                },\r\n            }\r\n        ],\r\n        lineStyle: {\r\n            normal: {\r\n                opacity: 0.9,\r\n                width: 5,\r\n                curveness: 0\r\n            }\r\n        },\r\n        categories: [{\r\n                name: '人'\r\n            },\r\n            {\r\n                name: '属性'\r\n            },\r\n            {\r\n                name: '属性值'\r\n            }\r\n        ]\r\n    }]\r\n}\r\n//定义抠图方法\r\nfunction getImgData(imgSrc, radius, center = {\r\n    x: 0,\r\n    y: 0\r\n}) {\r\n    return new Promise((resolve) => {\r\n        const canvas = document.createElement('canvas');\r\n        const contex = canvas.getContext('2d');\r\n        const img = new Image();\r\n        img.crossOrigin = '';\r\n        const diameter = 2 * radius;\r\n        img.onload = function() {\r\n            canvas.width = diameter;\r\n            canvas.height = diameter;\r\n            contex.clearRect(0, 0, diameter, diameter);\r\n            contex.save();\r\n            contex.beginPath();\r\n            contex.arc(radius, radius, radius, 0, 2 * Math.PI); //画出圆\r\n            contex.clip(); //裁剪上面的圆形\r\n            contex.drawImage(img, center.x - radius, center.y - radius, diameter, diameter, 0, 0, diameter, diameter); // 在刚刚裁剪的园上画图\r\n            contex.restore(); // 还原状态\r\n            resolve(canvas.toDataURL('image/png', 1))\r\n        }\r\n        img.src = imgSrc;\r\n    })\r\n}\r\n\r\nlet p1 = getImgData('https://i.loli.net/2018/12/11/5c0f26233b7c9.jpeg', 60, {\r\n    x: 150,\r\n    y: 80\r\n});\r\nlet p2 = getImgData('https://i.loli.net/2018/12/11/5c0f5d927472d.jpeg', 300, {\r\n    x: 400,\r\n    y: 500\r\n});\r\n//当处理的图片数据量比较大时，可由后端来处理这个过程\r\nPromise.all([p1, p2]).then((images) => {\r\n    myChart.setOption({\r\n        series: [{\r\n            data: [{\r\n                    tooltip: {\r\n                        trigger: 'item',\r\n                        formatter: '{b} <br/>性别：男<br/>出生年月：19951114<br/>星座：处女座'\r\n                    },\r\n                    name: '李守江',\r\n                    symbol: `image://${images[1]}`,\r\n                    symbolSize: 100,\r\n\r\n                    draggable: true,\r\n                    category: 1,\r\n                    itemStyle: {\r\n                        normal: {\r\n                            borderColor: '#04f2a7',\r\n                            borderWidth: 6,\r\n                            shadowBlur: 20,\r\n                            shadowColor: '#04f2a7',\r\n                            color: '#001c43',\r\n                        }\r\n                    }\r\n                },\r\n                {\r\n                    name: '分管',\r\n                    symbolSize: 70,\r\n                    itemStyle: {\r\n                        normal: {\r\n                            borderColor: '#04f2a7',\r\n                            borderWidth: 4,\r\n                            shadowBlur: 10,\r\n                            shadowColor: '#04f2a7',\r\n                            color: '#001c43',\r\n                        }\r\n                    },\r\n                    category: 1,\r\n\r\n                },\r\n                {\r\n                    name: '政府关系',\r\n                    symbolSize: 70,\r\n                    itemStyle: {\r\n                        normal: {\r\n                            borderColor: '#04f2a7',\r\n                            borderWidth: 4,\r\n                            shadowBlur: 10,\r\n                            shadowColor: '#04f2a7',\r\n                            color: '#001c43',\r\n                        }\r\n                    },\r\n                    category: 1,\r\n\r\n                },\r\n                {\r\n                    name: '毕业院校',\r\n                    symbolSize: 70,\r\n                    itemStyle: {\r\n                        normal: {\r\n                            borderColor: '#04f2a7',\r\n                            borderWidth: 4,\r\n                            shadowBlur: 10,\r\n                            shadowColor: '#04f2a7',\r\n                            color: '#001c43',\r\n                        }\r\n                    },\r\n                    category: 1,\r\n\r\n                },\r\n                {\r\n                    name: '山东滨州',\r\n                    symbolSize: 70,\r\n                    category: 1,\r\n                    itemStyle: {\r\n                        normal: {\r\n                            borderColor: '#04f2a7',\r\n                            borderWidth: 4,\r\n                            shadowBlur: 10,\r\n                            shadowColor: '#04f2a7',\r\n                            color: '#001c43',\r\n                        }\r\n                    },\r\n\r\n                },\r\n                {\r\n                    name: '河北沧州',\r\n                    symbolSize: 70,\r\n                    category: 1,\r\n                    itemStyle: {\r\n                        normal: {\r\n                            borderColor: '#04f2a7',\r\n                            borderWidth: 4,\r\n                            shadowBlur: 10,\r\n                            shadowColor: '#04f2a7',\r\n                            color: '#001c43',\r\n                        }\r\n                    },\r\n\r\n                },\r\n                {\r\n                    name: '信息处处长',\r\n                    symbolSize: 70,\r\n                    category: 1,\r\n                    itemStyle: {\r\n                        normal: {\r\n                            borderColor: '#04f2a7',\r\n                            borderWidth: 4,\r\n                            shadowBlur: 10,\r\n                            shadowColor: '#04f2a7',\r\n                            color: '#001c43',\r\n                        }\r\n                    },\r\n\r\n                },\r\n                {\r\n                    name: '李四',\r\n                    symbol: `image://${images[1]}`,\r\n                    symbolSize: 70,\r\n                    category: 0,\r\n                    itemStyle: {\r\n                        normal: {\r\n                            borderColor: '#82dffe',\r\n                            borderWidth: 4,\r\n                            shadowBlur: 10,\r\n                            shadowColor: '#04f2a7',\r\n                            color: '#001c43',\r\n                        }\r\n                    },\r\n\r\n                },\r\n                {\r\n                    name: '王五',\r\n                    symbol: `image://${images[1]}`,\r\n                    symbolSize: 70,\r\n                    category: 0,\r\n                    itemStyle: {\r\n                        normal: {\r\n                            borderColor: '#82dffe',\r\n                            borderWidth: 4,\r\n                            shadowBlur: 10,\r\n                            shadowColor: '#04f2a7',\r\n                            color: '#001c43',\r\n                        }\r\n                    },\r\n\r\n                },\r\n                {\r\n                    name: '山东大学',\r\n                    category: 0,\r\n                    itemStyle: {\r\n                        normal: {\r\n                            borderColor: '#82dffe',\r\n                            borderWidth: 4,\r\n                            shadowBlur: 10,\r\n                            shadowColor: '#04f2a7',\r\n                            color: '#001c43',\r\n                        }\r\n                    },\r\n\r\n                },\r\n                {\r\n                    name: '中国人民大学',\r\n                    category: 2,\r\n                    itemStyle: {\r\n                        normal: {\r\n                            borderColor: '#b457ff',\r\n                            borderWidth: 4,\r\n                            shadowBlur: 10,\r\n                            shadowColor: '#b457ff',\r\n                            color: '#001c43'\r\n                        }\r\n                    },\r\n\r\n                },\r\n                {\r\n                    name: '河北大学',\r\n                    category: 2,\r\n                    itemStyle: {\r\n                        normal: {\r\n                            borderColor: '#b457ff',\r\n                            borderWidth: 4,\r\n                            shadowBlur: 10,\r\n                            shadowColor: '#b457ff',\r\n                            color: '#001c43'\r\n                        }\r\n                    },\r\n\r\n                },\r\n                {\r\n                    name: '县委书记',\r\n                    category: 0,\r\n                    itemStyle: {\r\n                        normal: {\r\n                            borderColor: '#82dffe',\r\n                            borderWidth: 4,\r\n                            shadowBlur: 10,\r\n                            shadowColor: '#04f2a7',\r\n                            color: '#001c43',\r\n                        }\r\n                    },\r\n\r\n                },\r\n                {\r\n                    name: '经济',\r\n                    category: 0,\r\n                    itemStyle: {\r\n                        normal: {\r\n                            borderColor: '#82dffe',\r\n                            borderWidth: 4,\r\n                            shadowBlur: 10,\r\n                            shadowColor: '#04f2a7',\r\n                            color: '#001c43',\r\n                        }\r\n                    },\r\n\r\n                },\r\n                {\r\n                    name: '教育',\r\n                    category: 2,\r\n                    itemStyle: {\r\n                        normal: {\r\n                            borderColor: '#b457ff',\r\n                            borderWidth: 4,\r\n                            shadowBlur: 10,\r\n                            shadowColor: '#b457ff',\r\n                            color: '#001c43'\r\n                        }\r\n                    },\r\n\r\n                }\r\n            ]\r\n        }]\r\n    })\r\n})","html":"","externalScripts":"","updaterUID":"obd-oAt5KjFlr4_KsQx6S9eg87ZF8bZzw7v","theme":"","layout":"","viewCount":6568,"userName":"健***角","commentCount":3,"starCount":14,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x7rk_-y1Yd.png?v=1610180415939","isCustomThumbnail":0,"builtinTags":["category-work","legend","series-graph","title","tooltip"],"customTags":["graph"],"updaterUserName":"H***n"}}