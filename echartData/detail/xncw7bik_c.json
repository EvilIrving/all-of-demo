{"status":0,"data":{"cid":"xncw7bik_c","authorUid":"obd-oMuVydhiODz9BKaEZQuuoCN7tfXO42L","authorUserName":"s***m","title":"柱状图（占比）","description":"","latestVersion":6,"alwaysLatest":1,"createTime":"2020-12-08T06:28:35.000Z","lastUpdateTime":"2020-12-08T06:28:35.000Z","auth":2,"uid":"obd-oMuVydhiODz9BKaEZQuuoCN7tfXO42L","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":6,"parentVersion":5,"echartsVersion":"4.8.0","versionCreateTime":"2020-12-09T05:16:43.000Z","code":"var caption = ['增值税', '消费税', '营业税', '关税', '所得税'];\r\nvar data_total = [220, 182, 191, 234, 290];\r\nvar data_curr = [210, 170, 161, 160, 150];\r\nvar data_percent = [];\r\nvar line = [];\r\nvar selectA = [];\r\nvar selectB = [];\r\nfor (var i = 0; i < data_total.length; i++) {\r\n    var j = (data_curr[i] / data_total[i]) * 100;\r\n    data_percent.push(j);\r\n    line.push(0);\r\n    selectA.push('');\r\n    selectB.push('');\r\n}\r\nvar checkName = '';\r\nvar checkIndex = -1;\r\n\r\n    option = {\r\n        grid: {\r\n            bottom: '20%',\r\n        },\r\n        legend: {\r\n            show: true,\r\n            left: \"center\",\r\n            orient: \"horizontal\",\r\n            textStyle: {\r\n                color: '#E7F8FB',\r\n                fontSize: 16,\r\n            },\r\n            itemGap: 40\r\n        },\r\n        xAxis: {\r\n            data: caption,\r\n            axisTick: {\r\n                show: false\r\n            },\r\n            axisLine: {\r\n                show: true,\r\n                lineStyle: {\r\n                    color: \"#696969\",\r\n                    width: 2\r\n                }\r\n            },\r\n            axisLabel: {\r\n                show: true,\r\n                fontSize: 22,\r\n                margin: 40,\r\n                textStyle: {\r\n                    color: function(value, index) {\r\n                        if (checkIndex == index) {\r\n                            return '#FFF45C';\r\n                        } else {\r\n                            return '#fff';\r\n                        }\r\n                    }\r\n                }\r\n\r\n            }\r\n        },\r\n        yAxis: {\r\n            show: true,\r\n            type: 'value',\r\n            min: 0,\r\n            axisLine: {\r\n                show: false\r\n            },\r\n            axisTick: {\r\n                show: false\r\n            },\r\n            axisLabel: {\r\n                show: false\r\n            },\r\n            splitLine: {\r\n                show: true,\r\n                lineStyle: {\r\n                    color: \"rgba(105,105,105,0.5)\",\r\n                    width: 2,\r\n                    type: \"solid\"\r\n                }\r\n            }\r\n        },\r\n        series: [{\r\n                type: 'line',\r\n                data: line,\r\n                label: {\r\n                    show: true,\r\n                    position: \"bottom\",\r\n                    formatter: function(params) {\r\n                        var curr = option.series[1].data[params.dataIndex];\r\n                        var total = option.series[2].data[params.dataIndex];\r\n                        var val3 = (curr / total) * 100;\r\n                        return val3.toFixed(0) + '%';\r\n                    },\r\n                    fontSize: 22,\r\n                    distance: 8,\r\n                    color: '#FFF45C',\r\n                },\r\n                lineStyle: {\r\n                    color: \"rgba(255, 0, 0, 0)\"\r\n                },\r\n                itemStyle: {\r\n                    color: \"#088B50\"\r\n                },\r\n                symbol: \"rect\",\r\n                silent: true,\r\n                animation: false\r\n            },\r\n            {\r\n                name: '已完成',\r\n                type: 'bar',\r\n                //stack: \"1\",\r\n\r\n                itemStyle: {\r\n                    color: {\r\n                        type: 'linear',\r\n                        x: 0,\r\n                        y: 0,\r\n                        x2: 0,\r\n                        y2: 1,\r\n                        colorStops: [{\r\n                            offset: 0,\r\n                            color: 'rgba(7,173,98, 1)' // 0% 处的颜色\r\n                        }, {\r\n                            offset: 1,\r\n                            color: 'rgba(7,173,98, 0)' // 100% 处的颜色\r\n                        }],\r\n                        global: false // 缺省为 false\r\n                    },\r\n                    //borderColor: \"#088B50\",\r\n                    //borderWidth: 3,\r\n                },\r\n                label: {\r\n                    show: true,\r\n                    position: \"insideTop\",\r\n                    formatter: '{c}',\r\n                    fontSize: 18,\r\n                    color: '#fff',\r\n                },\r\n                barWidth: \"50%\",\r\n                data: data_curr\r\n            },\r\n            {\r\n                name: '总量',\r\n                type: 'bar',\r\n                //stack: \"1\",//堆积\r\n                barGap: '-100%', //重叠\r\n                itemStyle: {\r\n                    color: \"rgba(255, 0, 0, 0)\",\r\n                    borderColor: \"#088B50\",\r\n                    borderWidth: 6,\r\n\r\n                },\r\n                label: {\r\n                    show: true,\r\n                    position: \"top\",\r\n                    /*formatter: function(params){\r\n                        var val1 = params.value;\r\n                        var val2 = option.series[1].data[params.dataIndex];\r\n                        var val3 = val1+val2;\r\n                        return val3;\r\n                    },*/\r\n                    formatter: '{c}',\r\n                    fontSize: 18,\r\n                    color: '#fff',\r\n                },\r\n                barWidth: \"50%\",\r\n                data: data_total\r\n            },\r\n            {\r\n                //name: '已完成选中',\r\n                type: 'bar',\r\n                //stack: \"1\",\r\n\r\n                itemStyle: {\r\n                    color: {\r\n                        type: 'linear',\r\n                        x: 0,\r\n                        y: 0,\r\n                        x2: 0,\r\n                        y2: 1,\r\n                        colorStops: [{\r\n                            offset: 0,\r\n                            color: 'rgba(173,167,7, 1)' // 0% 处的颜色\r\n                        }, {\r\n                            offset: 1,\r\n                            color: 'rgba(173,167,7, 0)' // 100% 处的颜色\r\n                        }],\r\n                        global: false // 缺省为 false\r\n                    },\r\n                    //borderColor: \"#088B50\",\r\n                    //borderWidth: 3,\r\n                },\r\n                label: {\r\n                    show: true,\r\n                    formatter: function(params) {\r\n                        if (checkName == params.name) {\r\n                            return params.value;\r\n                        } else {\r\n                            return '';\r\n                        }\r\n                    },\r\n                    position: \"insideTop\",\r\n                    fontSize: 18,\r\n                    color: '#fff',\r\n                },\r\n                barWidth: \"50%\",\r\n                data: selectA,\r\n                silent: true,\r\n                animation: false\r\n            },\r\n            {\r\n                //name: '总量选中',\r\n                type: 'bar',\r\n                //stack: \"1\",//堆积\r\n                barGap: '-100%', //重叠\r\n                itemStyle: {\r\n                    color: \"rgba(255, 0, 0, 0)\",\r\n                    borderColor: \"#ADA707\",\r\n                    borderWidth: 6,\r\n\r\n                },\r\n                label: {\r\n                    show: false\r\n                },\r\n                barWidth: \"50%\",\r\n                data: selectA,\r\n                silent: true,\r\n                animation: false\r\n            }\r\n        ]\r\n\r\n    };\r\n\r\nmyChart.on('click', function(params) {\r\n    //点击的柱子的名称\r\n    checkName = params.name;\r\n    console.log(params);\r\n    checkIndex = params.dataIndex;\r\n    for (var i = 0; i < data_total.length; i++) {\r\n        if (i == checkIndex) {\r\n            selectA[i] = data_total[checkIndex];\r\n        } else {\r\n            selectA[i] = '';\r\n        }\r\n        if (i == checkIndex) {\r\n            selectB[i] = data_curr[checkIndex];\r\n        } else {\r\n            selectB[i] = '';\r\n        }\r\n    }\r\n    option.series[4].data = selectA;\r\n    option.series[3].data = selectB;\r\n    //柱形图重构\r\n    myChart.setOption(option);\r\n});","html":"","externalScripts":"","updaterUID":"obd-oMuVydhiODz9BKaEZQuuoCN7tfXO42L","theme":"dark","layout":"","viewCount":180,"userName":"s***m","commentCount":0,"starCount":6,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xncw7bik_c.png?v=1607491004009","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","series-line"],"customTags":[],"updaterUserName":"s***m"}}