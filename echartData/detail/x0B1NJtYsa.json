{"status":0,"data":{"cid":"x0B1NJtYsa","authorUid":"bd-572211633","authorUserName":"y***4","title":"甘特图","description":"gantt","latestVersion":1,"alwaysLatest":1,"createTime":"2019-08-07T07:29:29.000Z","lastUpdateTime":"2019-08-07T07:29:29.000Z","auth":2,"uid":"bd-572211633","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.2.1","versionCreateTime":"2019-08-07T07:29:29.000Z","code":"// @ts-ignore\r\nDate.prototype.Format = function (fmt) {\r\n  var o = {\r\n    \"M+\": this.getMonth() + 1,                 //月份   \r\n    \"d+\": this.getDate(),                    //日   \r\n    \"h+\": this.getHours(),                   //小时   \r\n    \"m+\": this.getMinutes(),                 //分   \r\n    \"s+\": this.getSeconds(),                 //秒   \r\n    \"q+\": Math.floor((this.getMonth() + 3) / 3), //季度   \r\n    \"S\": this.getMilliseconds()             //毫秒   \r\n  };\r\n  if (/(y+)/.test(fmt))\r\n    fmt = fmt.replace(RegExp.$1, (this.getFullYear() + \"\").substr(4 - RegExp.$1.length));\r\n  for (var k in o)\r\n    if (new RegExp(\"(\" + k + \")\").test(fmt))\r\n      fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : ((\"00\" + o[k]).substr((\"\" + o[k]).length)));\r\n  return fmt;\r\n}\r\n\r\nfunction formart (date) {\r\n  const d = date ? new Date(date) : new Date();\r\n  // @ts-ignore\r\n  return d.Format('yyyy-MM-dd');\r\n}\r\n\r\n\r\nconst day = 1000 * 60 * 60 * 24;\r\n\r\nvar data = [];\r\n\r\nvar dataCount = 10;\r\nvar types = [\r\n  { name: 'JS Heap', color: '#7b9ce1' },\r\n  { name: 'Documents', color: '#bd6d6c' },\r\n  { name: 'Nodes', color: '#75d874' },\r\n  { name: 'Listeners', color: '#e0bc78' },\r\n  { name: 'GPU Memory', color: '#dc77dc' },\r\n  { name: 'GPU', color: '#72b362' }\r\n];\r\n\r\n\r\nvar categories = [\r\n  'categoryA', 'categoryB', 'categoryC', 'categoryD', 'categoryE', 'categoryF',\r\n  'categoryA', 'categoryB', 'categoryC', 'categoryD', 'categoryE', 'categoryF'\r\n];\r\n\r\nvar startTime = +new Date(formart());\r\n\r\n\r\n\r\n// Generate mock data\r\n// @ts-ignore\r\necharts.util.each(categories, function (category, index) {\r\n  var baseTime = startTime;\r\n  for (var i = 0; i < dataCount; i++) {\r\n    var typeItem = types[Math.round(Math.random() * (types.length - 1))];\r\n    var duration = Math.round(Math.random() * 10000);\r\n    data.push({\r\n      name: typeItem.name,\r\n      value: [\r\n        index,\r\n        baseTime,\r\n        baseTime += (day * (Math.random() * 3 | 0)),\r\n        duration\r\n      ],\r\n      itemStyle: {\r\n        normal: {\r\n          color: typeItem.color\r\n        }\r\n      }\r\n    });\r\n    baseTime += (day * (Math.random() * 3 | 0))\r\n  }\r\n});\r\n\r\ndata.forEach((item, index) => {\r\n  item.value[1] = formart(item.value[1])//'2019-08-0' + (6 + index + 1)\r\n  item.value[2] = formart(item.value[2])//'2019-08-0' + (6 + index + 2)\r\n})\r\n\r\nfunction renderItem(params, api) {\r\n\r\n      var categoryIndex = api.value(0);\r\n      var start = api.coord([api.value(1), categoryIndex]);\r\n      var end = api.coord([api.value(2), categoryIndex]);\r\n      var height = api.size([0, 1])[1] * 0.6;\r\n\r\n      debugger\r\n\r\n      var rectShape = echarts.graphic.clipRectByRect({\r\n        x: start[0],\r\n        y: start[1], // - height / 2,\r\n        width: end[0]-start[0],\r\n        height: 10\r\n      }, {\r\n          x: params.coordSys.x,\r\n          y: params.coordSys.y,\r\n          width: params.coordSys.width,\r\n          height: params.coordSys.height\r\n        });\r\n\r\n\r\n      const result = rectShape && {\r\n        type: 'rect',\r\n        shape: rectShape,\r\n        style: api.style(),\r\n        styleEmphasis: {\r\n          textStroke: null\r\n        }\r\n      };\r\n\r\n      result.style.text = \"sdfdsaf\"\r\n      result.style.textFill = '#000'\r\n      result.style.textStroke = null\r\n      // result.style.textOffset = [0, -10]\r\n      result.style.textPosition = 'top'\r\n      return result\r\n    }\r\n\r\n\r\noption = {\r\n      tooltip: {\r\n        formatter: function (params) {\r\n          return params.marker + params.name + ': ' + params.value[3] + ' ms';\r\n        }\r\n      },\r\n      title: {\r\n        text: 'Profile',\r\n        left: 'center'\r\n      },\r\n    \r\n      xAxis: {\r\n        boundaryGap : false,\r\n        data: Array(30).fill(0).map((item, index) => {\r\n          return formart(startTime + day * index)\r\n        })\r\n      },\r\n      yAxis: {\r\n        data: categories\r\n      },\r\n      series: [{\r\n        type: 'custom',\r\n        renderItem: renderItem,\r\n        itemStyle: {\r\n          normal: {\r\n            opacity: 0.8\r\n          }\r\n        },\r\n        encode: {\r\n          x: [1, 2],\r\n          y: 0\r\n        },\r\n        data: data\r\n      }]\r\n    };\r\n\r\n","html":"","externalScripts":"","updaterUID":"bd-572211633","theme":"","layout":"","viewCount":1640,"userName":"y***4","commentCount":0,"starCount":4,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x0B1NJtYsa.png?v=1565162970052","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-custom","title","tooltip"],"customTags":["gantt"],"updaterUserName":"y***4"}}