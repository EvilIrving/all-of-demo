{"status":0,"data":{"cid":"xKQ9NRjxy5","authorUid":"bd-1499308274","authorUserName":"安***贡","title":"力导向拓扑图","description":"力导向图","latestVersion":2,"alwaysLatest":1,"createTime":"2019-01-21T07:10:33.000Z","lastUpdateTime":"2019-01-21T07:10:33.000Z","auth":2,"uid":"bd-1499308274","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.2.1","versionCreateTime":"2019-02-28T07:44:00.000Z","code":" var nodes = [{\r\n         name: '服务器',\r\n         img: 'data-1547632686885-o5Rfi3tyk.png',\r\n         alarm: '产生告警了哦'\r\n     },\r\n     {\r\n         name: '存储设备1',\r\n         img: 'data-1547633192258-2EYYUDdcd.png'\r\n     },\r\n     {\r\n         name: '存储设备2',\r\n         img: 'data-1547633192258-2EYYUDdcd.png'\r\n     },\r\n     {\r\n         name: '防火墙',\r\n         img: 'data-1547633094304-08Q_2YEvH.png'\r\n     },\r\n     {\r\n         name: '网络设备1',\r\n         img: 'data-1547632915872-WZMUphq72.png',\r\n         alarm: '产生告警了哦'\r\n     },\r\n     {\r\n         name: '网络设备2',\r\n         img: 'data-1547632915872-WZMUphq72.png'\r\n     }\r\n ]\r\n var links = [{\r\n         source: '存储设备2',\r\n         target: '服务器',\r\n         name: '数据传输'\r\n     }, {\r\n         source: '存储设备1',\r\n         target: '服务器',\r\n         name: '数据传输'\r\n     },\r\n     {\r\n         source: '服务器',\r\n         target: '防火墙',\r\n         name: '访问'\r\n     },\r\n     {\r\n         source: '防火墙',\r\n         target: '网络设备1',\r\n         name: '访问'\r\n     },\r\n     {\r\n         source: '防火墙',\r\n         target: '网络设备2',\r\n         name: '访问'\r\n     }\r\n ]\r\n var charts = {\r\n     nodes: [],\r\n     links: []\r\n }\r\n for (var j = 0; j < nodes.length; j++) {\r\n     var node = {\r\n         name: nodes[j].name,\r\n         alarm: nodes[j].alarm,\r\n         symbol: 'image:///asset/get/s/' + nodes[j].img,\r\n         itemStyle: {\r\n             normal: {\r\n                 color: '#12b5d0',\r\n             }\r\n         }\r\n     }\r\n     charts.nodes.push(node)\r\n }\r\n for (var i = 0; i < links.length; i++) {\r\n     var link = {\r\n         source: links[i].source,\r\n         target: links[i].target,\r\n         label: {\r\n             normal: {\r\n                 show: true,\r\n                 formatter: links[i].name\r\n             }\r\n         },\r\n         lineStyle: {\r\n             normal: {\r\n                 color: '#17FFF3'\r\n             }\r\n         }\r\n     }\r\n     charts.links.push(link)\r\n }\r\n option = {\r\n     backgroundColor: '#000033',\r\n     title: {\r\n         text: '力导向拓扑图',\r\n         textStyle: {\r\n            fontWeight: 'normal',\r\n            color: \"rgb(255,224,0)\",\r\n        }\r\n     },\r\n     tooltip: {\r\n         formatter: function(x) {\r\n             return x.data.des;\r\n         }\r\n     },\r\n     series: [{\r\n         type: 'graph',\r\n         layout: 'force',\r\n         symbolSize: 50,\r\n         edgeSymbol: ['circle', 'arrow'],\r\n         force: {\r\n             repulsion: 1000,\r\n             edgeLength: [150, 200],\r\n             layoutAnimation: false\r\n         },\r\n         draggable: true,\r\n         edgeLabel: {\r\n             normal: {\r\n                 show: true,\r\n                 formatter: function(x) {\r\n                     return x.data.name;\r\n                 }\r\n             }\r\n         },\r\n         label: {\r\n             normal: {\r\n                 show: true,\r\n                 position: 'bottom',\r\n                 color: '#17FFF3'\r\n             }\r\n         },\r\n         lineStyle: {\r\n             normal: {\r\n                 width: 2,\r\n                 shadowColor: 'none'\r\n             }\r\n         },\r\n         data: charts.nodes,\r\n         links: charts.links,\r\n         itemStyle: {\r\n             normal: {\r\n                 label: {\r\n                     show: true,\r\n                     formatter: function(item) {\r\n                         return item.data.name\r\n                     }\r\n                 }\r\n             }\r\n         }\r\n     }]\r\n };\r\n // 用于告警的动态效果\r\n setInterval(() => {\r\n     var dataI = []\r\n     for (var n = 0; n < nodes.length; n++) {\r\n         var alarm = nodes[n].alarm\r\n         if (alarm !== null && alarm !== '' && alarm !== undefined) {\r\n             option.series[0].data[n].symbolSize = 60\r\n             option.series[0].data[n].label = {\r\n                 normal: {\r\n                     color: 'rgb(255,224,0)'\r\n                 }\r\n             }\r\n             option.series[0].itemStyle.normal.label.formatter = function(item) {\r\n                 if (item.data.alarm !== undefined) {\r\n                     return item.data.name + '\\n[ ' + item.data.alarm + ' ]'\r\n                 } else {\r\n                     return item.data.name\r\n                 }\r\n             }\r\n             dataI.push(n)\r\n         }\r\n     }\r\n     myChart.setOption(option)\r\n     setTimeout(() => {\r\n         for (var m = 0; m < dataI.length; m++) {\r\n             option.series[0].data[dataI[m]].symbolSize = 50\r\n             option.series[0].data[dataI[m]].label = {\r\n                 normal: {\r\n                     color: '#17FFF3'\r\n                 }\r\n             }\r\n             option.series[0].itemStyle.normal.label.formatter = function(item) {\r\n                 return item.data.name\r\n             }\r\n         }\r\n         myChart.setOption(option)\r\n     }, 500)\r\n }, 1000)","html":"","externalScripts":"","updaterUID":"bd-1499308274","theme":"","layout":"","viewCount":15778,"userName":"安***贡","commentCount":12,"starCount":59,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xKQ9NRjxy5.png?v=1551339840137","isCustomThumbnail":0,"builtinTags":["category-work","series-graph","title","tooltip"],"customTags":[],"updaterUserName":"安***贡"}}