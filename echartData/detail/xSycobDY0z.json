{"status":0,"data":{"cid":"xSycobDY0z","authorUid":"bd-575768103","authorUserName":"黯***殇","title":"“空气简报” - 湖北省","description":"内容不全，修改中...","latestVersion":7,"alwaysLatest":1,"createTime":"2018-05-16T07:45:38.000Z","lastUpdateTime":"2018-05-16T07:45:38.000Z","auth":2,"uid":"bd-575768103","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":7,"parentVersion":6,"echartsVersion":"4.1.0","versionCreateTime":"2018-05-18T09:00:46.000Z","code":"/**\r\n此版本通过设置geoindex && seriesIndex: [1] 属性来实现geo和map共存，来达到hover散点和区域显示tooltip的效果\r\n\r\n默认情况下，map series 会自己生成内部专用的 geo 组件。但是也可以用这个 geoIndex 指定一个 geo 组件。这样的话，map 和 其他 series（例如散点图）就可以共享一个 geo 组件了。并且，geo 组件的颜色也可以被这个 map series 控制，从而用 visualMap 来更改。\r\n当设定了 geoIndex 后，series-map.map 属性，以及 series-map.itemStyle 等样式配置不再起作用，而是采用 geo 中的相应属性。\r\n\r\nhttp://echarts.baidu.com/option.html#series-map.geoIndex\r\n\r\n并且加了pin气泡图标以示数值大小\r\n*/\r\n\r\nvar uploadedDataURL = \"/asset/get/s/data-1525848254835-HyDpOfl0f.json\";\r\nmyChart.showLoading();\r\n$.getJSON(uploadedDataURL, function(geoJson) {\r\n    echarts.registerMap('hubei', geoJson);\r\n    myChart.hideLoading();\r\n    var geoCoordMap = {\r\n        '武汉':[114.31,30.52],\r\n        '鄂州':[114.899,30.39],\r\n        '恩施':[109.49,30.28],\r\n        '黄冈':[114.90,30.44],\r\n        '黄石':[115.04,30.19],\r\n        '荆门':[112.216,31.044],\r\n        '孝感':[113.55,30.55],\r\n        '荆州':[112.14,30.206],\r\n        '十堰':[110.47,32.37],\r\n        '襄阳':[112.12,32.04],\r\n        '随州':[113.38,31.69],\r\n        '咸宁':[114.19,29.50],\r\n        '宜昌':[111.28,30.69]\r\n\r\n    }\r\n    var data = [\r\n        {name: '武汉', value: 107},\r\n        {name: '鄂州', value: 105},\r\n        {name: '恩施', value: 102},\r\n        {name: '黄冈', value: 72},\r\n        {name: '黄石', value: 89},\r\n        {name: '荆门', value: 117},\r\n        {name: '孝感', value: 110},\r\n        {name: '荆州', value: 139},\r\n        {name: '十堰', value: 107},\r\n        {name: '襄阳', value: 147},\r\n        {name: '随州', value: 97},\r\n        {name: '咸宁', value: 78},\r\n        {name: '宜昌', value: 105},\r\n    ];\r\n    var max = 480, min = 9; // todo \r\n    var maxSize4Pin = 100, minSize4Pin = 20;\r\n\r\n  var convertData = function (data) {\r\n    var res = [];\r\n    for (var i = 0; i < data.length; i++) {\r\n        var geoCoord = geoCoordMap[data[i].name];//坐标\r\n        console.log(geoCoord+1111111111111);\r\n        var yyy = data[i].name;\r\n        console.log(yyy+6666666666666);\r\n        var ys = data[i].value;\r\n        console.log(ys+111);   //空气数值\r\n        var yy = data[i];\r\n        console.log(yy);\r\n        \r\n        if (geoCoord) {\r\n            res.push({\r\n                name: data[i].name,        //显示地名\r\n                value: geoCoord.concat(data[i].value)//关键的一句\r\n            });\r\n        }\r\n       \r\n    }\r\n    \r\n     \r\n        // console.log(res);//荆州139\r\n        // console.log(res[2].value[2]);//荆州139\r\n    return res;\r\n};\r\n\r\n\r\n    option = {\r\n        title: {\r\n            text: '“空气简报” - 湖北省',\r\n            subtext: '',\r\n            x: 'center',\r\n            textStyle: {\r\n                color: '#ccc'\r\n            }\r\n        },\r\n        tooltip: {\r\n            trigger: 'item',\r\n            formatter: function (params) {\r\n              if(typeof(params.value)[2] == \"undefined\"){\r\n              \treturn params.name + ' : ' + params.value;\r\n              }else{\r\n              \treturn params.name + ' : ' + params.value[2];\r\n              }\r\n            }\r\n        },\r\n        legend: {\r\n            orient: 'vertical',\r\n            y: 'bottom',\r\n            x: 'right',\r\n            data: ['credit_pm2.5'],\r\n            textStyle: {\r\n                color: '#fff'\r\n            }\r\n        },\r\n        visualMap: {\r\n            show: false,\r\n            min: 0,\r\n            max: 500,\r\n            left: 'left',\r\n            top: 'bottom',\r\n            text: ['高', '低'], // 文本，默认为数值文本\r\n            calculable: true,\r\n            seriesIndex: [1],//切换位置圆点显示形态0~...\r\n            inRange: {\r\n                color: ['#0f0c29', '#302b63', '#24243e'] // 黑紫黑\r\n            }\r\n        },\r\n        geo: {\r\n            show: true,\r\n            map: 'hubei',\r\n            label: {\r\n                normal: {\r\n                    show: false\r\n                },\r\n                emphasis: {\r\n                    show: false,\r\n                }\r\n            },\r\n            roam: true,\r\n            itemStyle: {\r\n                normal: {\r\n                    areaColor: '#031525',\r\n                    borderColor: '#3B5077',\r\n                },\r\n                emphasis: {\r\n                    areaColor: '#2B91B7',\r\n                }\r\n            }\r\n        },\r\n        series : [\r\n      {\r\n            name: 'credit_pm2.5',\r\n            type: 'scatter',\r\n            coordinateSystem: 'geo',\r\n            data: convertData(data),\r\n            symbolSize: function (val) {\r\n                return val[2] / 10;\r\n            },\r\n            label: {\r\n                normal: {\r\n                    formatter: '{b}',\r\n                    position: 'right',\r\n                    show: true\r\n                },\r\n                emphasis: {\r\n                    show: true\r\n                }\r\n            },\r\n            itemStyle: {\r\n                normal: {\r\n                    color: '#05C3F9'\r\n                }\r\n            }\r\n        },\r\n         {\r\n            type: 'map',\r\n            map: 'hubei',\r\n            geoIndex: 0,\r\n            aspectScale: 0.75, //长宽比\r\n            showLegendSymbol: false, // 存在legend时显示\r\n            label: {\r\n                normal: {\r\n                    show: false\r\n                },\r\n                emphasis: {\r\n                    show: false,\r\n                    textStyle: {\r\n                        color: '#fff'\r\n                    }\r\n                }\r\n            },\r\n            roam: true,\r\n            itemStyle: {\r\n                normal: {\r\n                    areaColor: '#031525',\r\n                    borderColor: '#3B5077',\r\n                },\r\n                emphasis: {\r\n                    areaColor: '#2B91B7'\r\n                }\r\n            },\r\n            animation: false,\r\n            data: data\r\n        },\r\n        {\r\n            name: '点',\r\n            type: 'scatter',\r\n            coordinateSystem: 'geo',\r\n            symbol: 'pin',\r\n            symbolSize: function (val) {\r\n                var a = (maxSize4Pin - minSize4Pin) / (max - min);\r\n                var b = minSize4Pin - a*min;\r\n                b = maxSize4Pin - a*max;\r\n                return a*val[2]+b;\r\n            },\r\n            label: {\r\n                normal: {\r\n                    show: true,\r\n                    textStyle: {\r\n                        color: '#fff',\r\n                        fontSize: 9,\r\n                    }\r\n                }\r\n            },\r\n            itemStyle: {\r\n                normal: {\r\n                    color: '#F62157', //标志颜色\r\n                }\r\n            },\r\n            zlevel: 6,\r\n            data: convertData(data),\r\n        },\r\n        {\r\n            name: 'Top 5',\r\n            type: 'effectScatter',\r\n            coordinateSystem: 'geo',\r\n            data: convertData(data.sort(function (a, b) {\r\n                return b.value - a.value;\r\n            }).slice(0, 5)),\r\n            symbolSize: function (val) {\r\n                return val[2] / 10;\r\n            },\r\n            showEffectOn: 'render',\r\n            rippleEffect: {\r\n                brushType: 'stroke'\r\n            },\r\n            hoverAnimation: true,\r\n            label: {\r\n                normal: {\r\n                    formatter: '{b}',\r\n                    position: 'right',\r\n                    show: true\r\n                }\r\n            },\r\n            itemStyle: {\r\n                normal: {\r\n                    color: '#05C3F9',\r\n                    shadowBlur: 10,\r\n                    shadowColor: '#05C3F9'\r\n                }\r\n            },\r\n            zlevel: 1\r\n        },\r\n         \r\n    ]\r\n    };\r\n    myChart.setOption(option);\r\n});","html":"","externalScripts":"","updaterUID":"bd-575768103","theme":"","layout":"","viewCount":1329,"userName":"黯***殇","commentCount":0,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xSycobDY0z.png?v=1526634046909","isCustomThumbnail":0,"builtinTags":["category-work","geo","legend","series-effectScatter","series-map","series-scatter","title","tooltip","visualMap"],"customTags":[],"updaterUserName":"黯***殇"}}