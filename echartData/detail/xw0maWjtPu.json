{"status":0,"data":{"cid":"xw0maWjtPu","authorUid":"obd-oFd6pkarLNjFEsUvZLV73dXIx6Sdu5Q","authorUserName":"老***太","title":"Awesome Chart","description":"111","latestVersion":10,"alwaysLatest":1,"createTime":"2020-09-08T04:05:08.000Z","lastUpdateTime":"2020-09-08T04:05:08.000Z","auth":2,"uid":"obd-oFd6pkarLNjFEsUvZLV73dXIx6Sdu5Q","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":10,"parentVersion":9,"echartsVersion":"4.8.0","versionCreateTime":"2020-09-08T10:39:23.000Z","code":"function getBaseLog(x, y = 10) {\n    const isNegativeNumber = x < 0 ? -1 : 1\n    x = x * isNegativeNumber\n    return Math.log(x) / Math.log(y) * isNegativeNumber\n}\n\nfunction getBaseData(num, x = 10) {\n    const isNegativeNumber = num < 0 ? -1 : 1\n    num = num * isNegativeNumber\n    return parseFloat(Math.pow(x, num).toFixed(5)) * isNegativeNumber\n}\n\nfunction randomData(idx, now = new Date()) {\n    const random = Math.random() * 1000 * (Math.random() * 10 > 5 ? 1 : -1)\n    let value = idx * 20 + 10 + getBaseLog(random);\n    if (Math.random() * 10 < 2) {\n        value = null\n        // return\n    }\n    // const now = new Date()\n    return {\n        name: now.toString(),\n        value: [\n            +now,\n            value\n        ]\n    };\n}\n\nvar seriesData = [];\nconst seriesNameList = [\n    '轧制力(N)',\n    '轧制速度(m/s)',\n    '后张力(N)',\n    '前张力(N)',\n    '钢带出口厚度(mm)',\n    '钢带入口厚度(mm)',\n    '钢带2出口厚度(mm)',\n    '钢带2入口厚度(mm)',\n]\nlet productionLen = 0\nfor (var i = 1; i < 9; i++) {\n    seriesData.push({\n        name: seriesNameList[i - 1],\n        type: 'line',\n        showSymbol: false,\n        hoverAnimation: false,\n        data: []\n    });\n}\nseriesData.push({\n    name: '',\n    type: 'line',\n    yAxisIndex: 1,\n    tooltip: {\n        show: false\n    },\n    data: []\n})\nseriesData.push({\n    name: '',\n    type: 'line',\n    xAxisIndex: 1,\n    zlevel: -1,\n    show: false,\n    data: []\n})\noption = {\n    title: {\n        text: '实时参数录制'\n    },\n    legend: {\n        show: true,\n    },\n    tooltip: {\n        trigger: 'axis',\n        formatter: function(params) {\n            const textList = params.map(param => {\n                const {\n                    marker,\n                    seriesName,\n                    value,\n                    seriesIndex: idx,\n                } = param\n                const paramValue = value[1]\n                return `${marker} ${seriesName}: ${paramValue === null ? null : getBaseData(paramValue - 10 - 20 * idx)}`\n            })\n            textList.reverse()\n            params = params[0];\n            var date = new Date(params.name);\n            const time = `${date.getFullYear()}-${date.getMonth() + 1}-${date.getDate()} \n            ${date.getHours()}:${date.getMinutes()}:${date.getSeconds()}`\n            textList.unshift(time)\n            return textList.join('<br />');\n        },\n        axisPointer: {\n            animation: false,\n            snap: true,\n        }\n    },\n    xAxis: [{\n            type: 'time',\n            splitLine: {\n                show: false\n            },\n            axisLine: {\n                show: false,\n            },\n            axisTick: {\n                show: false, //  坐标轴刻度隐藏\n            },\n        },\n        {\n            type: 'category',\n            name: '长度',\n            axisTick: {\n                show: false, //  坐标轴刻度隐藏\n            },\n            minorSplitLine: {\n                show: false,\n            },\n            axisPointer: {\n                show: false,\n            },\n            data: []\n        }\n    ],\n    yAxis: [{\n            type: 'value',\n            splitLine: {\n                show: false\n            },\n            show: false,\n            scale: true,\n            // max: (value) => {\n            //     const range = value.max - value.min\n            //     return value.max + range / 20\n            // },\n            // min: (value) => {\n            //     const range = value.max - value.min\n            //     return value.min - range / 20\n            // },\n            // splitNumber: 8,\n            interval: 20,\n            min: 0,\n            max: 160,\n            axisLabel: {\n                show: false,\n            },\n        },\n        {\n            type: 'category',\n            splitLine: {\n                show: true\n            },\n            scale: true,\n            interval: 20,\n            position: 'left',\n            axisTick: {\n                show: false, //  坐标轴刻度隐藏\n            },\n            axisPointer: {\n                show: false,\n            },\n            // min: 10,\n            // max: 170,\n            data: seriesNameList\n        }\n    ],\n    series: seriesData\n};\n\nconst interval = setInterval(function() {\n    const ChartOption = myChart.getOption()\n    const {\n        xAxis\n    } = ChartOption\n    const xAxisData = xAxis[1].data\n    const now = new Date()\n    for (var i = 0; i < 8; i++) {\n        const data = seriesData[i].data\n        if (data.length > 20) {\n            // clearInterval(interval)\n            data.shift()\n        }\n        const seriesValueNew = randomData(i, now)\n        if (seriesValueNew) {\n            data.push(seriesValueNew)\n        }\n    }\n    if (xAxisData.length > 20) {\n        xAxisData.shift()\n    }\n    productionLen++\n    xAxisData.push(productionLen)\n\n    myChart.setOption({\n        xAxis,\n        series: seriesData\n    });\n}, 1000);","html":"","externalScripts":"","updaterUID":"obd-oFd6pkarLNjFEsUvZLV73dXIx6Sdu5Q","theme":"","layout":"","viewCount":135,"userName":"老***太","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xw0maWjtPu.png?v=1599561564083","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-line","title"],"customTags":[],"updaterUserName":"老***太"}}