{"status":0,"data":{"cid":"x2xIDpyNHZ","authorUid":"bd-258458457","authorUserName":"破***火","title":"双类目轴堆叠","description":"","latestVersion":2,"alwaysLatest":1,"createTime":"2019-07-02T08:01:03.000Z","lastUpdateTime":"2019-07-02T08:01:03.000Z","auth":2,"uid":"bd-258458457","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.2.1","versionCreateTime":"2019-07-02T09:41:30.000Z","code":"let startTime = 10\n    , endTime = 22\nlet yAxis = [], yAxisObj = {}\n\nlet mockSeriesData = [\n    '2019-07-02 15:32:20',\n    '2019-07-02 14:32:20'\n]\n\n\n/**\n * 提取时分格式数据\n * @param {object|string} date '2019-07-02 14:32:24'\n * @return {number|string}\n */\nfunction dateToMinute(date) {\n    return date.replace(/^(\\d{4})-(\\d{2})-(\\d{2})\\s(\\d{2}):(\\d{2}):(\\d{2})/g, '$4:$5')\n}\n\n/**\n * 生成开始结束时间分钟级日期数据\n * @param {number} startTime\n * @param {number} endTime\n * @param {number} timeLevel\n */\nfunction createDate(startTime, endTime, timeLevel) {\n    if (timeLevel === 'MM') {\n        timeLevel = 60\n    }\n    let resultObj = {}\n    let length = endTime - startTime\n    let yAxisData = Array.from({ length: length * timeLevel }).map((item, index) => index)\n    let chunkData = chunkGroup(yAxisData, timeLevel)\n    chunkData.forEach((item, index) => {\n        let _h = index + startTime\n        item.forEach((itemData, itemIndex) => {\n            let _m = itemIndex < 10\n                ? '0' + itemIndex\n                : itemIndex >= 60\n                    ? 59\n                    : itemIndex\n            resultObj[`${_h}:${_m}`] = itemData\n            yAxisObj[itemData] = `${_h}:${_m}`\n        })\n    })\n    yAxisObj[yAxisData.length] = `${endTime}:00`\n    resultObj[`${endTime}:00`] = yAxisData.length\n    console.group('yAxis')\n    console.log(yAxisObj)\n    console.log(resultObj)\n    console.groupEnd()\n    yAxis = yAxisData\n    return resultObj\n}\nlet dateObj = createDate(startTime, endTime, 60)\n\nfunction chunkGroup(data, size) {\n    return Array.from(\n      { length: Math.ceil(data.length / size) },\n      (v, i) => data.slice(i * size, i * size + size)\n    )\n}\n\n\nlet newData = mockSeriesData.map(item => {\n    return dateObj[dateToMinute(item)]\n})\n\nconsole.log('-====================-', newData)\n\noption = {\n    color: ['#6784E3', '#3BB8FF', '#FFC62E', '#FF9631', '#87D14B'],\n    yAxis: [\n        // {\n        //     type: 'category',\n        //     position: 'left',\n        //     data: Object.keys(yAxisObj).map(k => k),\n        //     axisLabel: {\n        //         formatter: (param) => {\n        //             return yAxisObj[param]\n        //         }\n        //     }\n        // },\n        {\n             type: 'value',\n             position: 'left',\n            //  show: false,\n            //  min:0,\n            max: 720,\n            interval: 10,\n            axisLabel: {\n                formatter: (param) => {\n                    return yAxisObj[param]\n                }\n            }\n        }\n    ],\n    xAxis: {\n        type: 'category',\n        data: ['person1', 'person2']\n    },\n    // toolbox: {\n    //     feature: {\n    //         dataZoom: {\n    //             show: true,\n    //             yAxisIndex: 0\n    //         }\n    //     }\n    // },\n    // legend: {\n        // data: ['zone1', 'zone2']\n    // },\n    tooltip: {\n        trigger: 'axis',\n        formatter: (params) => {\n            let htmls = `\n                <div>${params[0].axisValue}</div>\n            `\n            params.reverse()\n            params.pop()\n            params.forEach((item, index) => {\n                // 上一柱子的值\n                let lastNum = params[index + 1] ? params[index + 1].value : 0\n                htmls += `\n                    <p>${item.marker} ${item.seriesName}: ${yAxisObj[item.value + (lastNum || 0)] || '--'}</p>\n                `\n            })\n            return htmls\n        }\n    },\n    dataZoom: [\n        {\n            type: 'slider',\n            orient: 'vertical',\n            // yAxisIndex: 0,\n            realtime: true,\n            filterMode: 'none',\n            left: '4%',\n        },\n        // {\n        //     type: 'inside',\n        //     yAxisIndex: 1\n        // }\n    ],\n    series: [\n        {\n            name: 'help',\n            stack: 'a',\n            type: 'bar',\n            data: [0, 10],\n            itemStyle: {\n                normal: {\n                    barBorderColor: 'rgba(0,0,0,0)',\n                    color: 'rgba(0,0,0,0)'\n                },\n                emphasis: {\n                    barBorderColor: 'rgba(0,0,0,0)',\n                    color: 'rgba(0,0,0,0)'\n                }\n            },\n        },\n        {\n            type: 'bar',\n            stack: 'a',\n            name: 'zone1',\n            // yAxisIndex: 1,\n            barMaxWidth: 30,\n            data: [100, 10]\n        },\n        {\n            type: 'bar',\n            stack: 'a',\n            name: 'zone2',\n            // yAxisIndex: 1,\n            barMaxWidth: 30,\n            data: [23, 20]\n        }\n    ]\n}","html":"","externalScripts":"","updaterUID":"bd-258458457","theme":"","layout":"","viewCount":191,"userName":"破***火","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x2xIDpyNHZ.png?v=1562060491086","isCustomThumbnail":0,"builtinTags":["category-work","dataZoom","grid","series-bar","tooltip"],"customTags":[],"updaterUserName":"破***火"}}