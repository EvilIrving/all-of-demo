{"status":0,"data":{"cid":"xluzAEG3nZ","authorUid":"bd-354497128","authorUserName":"残雪X无痕","title":"动态上升柱状图","description":"动态上升柱状图","latestVersion":1,"alwaysLatest":1,"createTime":"2019-04-17T06:23:06.000Z","lastUpdateTime":"2019-04-17T06:23:06.000Z","auth":2,"uid":"bd-354497128","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.2.1","versionCreateTime":"2019-04-17T06:23:06.000Z","code":" var data = [{\r\n         product: '111',\r\n         \"今年\": 800,\r\n         \"去年\": 158\r\n     },\r\n     {\r\n         product: '222',\r\n         \"今年\": 200,\r\n         \"去年\": 951\r\n     },\r\n     {\r\n         product: '333',\r\n         \"今年\": 600,\r\n         \"去年\": 528\r\n     },\r\n     {\r\n         product: '444',\r\n         \"今年\": 500,\r\n         \"去年\": 561\r\n     },\r\n     {\r\n         product: '555',\r\n         \"今年\": 400,\r\n         \"去年\": 111\r\n     },\r\n ]\r\n option = {\r\n     color: ['#3398DB'],\r\n     tooltip: {\r\n         trigger: 'axis',\r\n         textStyle: {\r\n             color: \"white\",\r\n         },\r\n         axisPointer: { // 坐标轴指示器，坐标轴触发有效\r\n             type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'\r\n         },\r\n         formatter: function(params) {\r\n             var name = params[0].name;\r\n             var info = []\r\n             params.forEach(element => {\r\n                 info.push({\r\n                     seriesName: element.seriesName,\r\n                     value: element.value,\r\n                     marker: element.marker\r\n                 })\r\n             });\r\n             return `\r\n                                ${name}</br>\r\n                                ${info[1].marker}${info[0].seriesName}:${info[0].value + info[1].value}</br>\r\n                                ${info[3].marker}${info[2].seriesName}:${info[2].value + info[3].value}\r\n                            `;\r\n         },\r\n     },\r\n     grid: {\r\n         left: '0%',\r\n         right: '0%',\r\n         bottom: '0%',\r\n         containLabel: true\r\n     },\r\n     xAxis: {\r\n         type: 'category',\r\n         axisLabel: { // 文字样式\r\n             color: 'black',\r\n         },\r\n         data: data.map((element) => {\r\n             return element.product\r\n         })\r\n     },\r\n     yAxis: {\r\n         type: 'value',\r\n         axisLabel: {\r\n             color: 'black',\r\n         },\r\n         splitLine: { //分隔线颜色\r\n             lineStyle: {\r\n                 color: ['#162b5f']\r\n             }\r\n         }\r\n     },\r\n     series: [{\r\n             name: '今年',\r\n             type: 'bar',\r\n             stack: 'this',\r\n             barWidth: 30,\r\n             itemStyle: {\r\n                 color: new echarts.graphic.LinearGradient(\r\n                     0, 0, 0, 1,\r\n                     [{\r\n                             offset: 0,\r\n                             color: '#44f0ff'\r\n                         },\r\n                         {\r\n                             offset: 1,\r\n                             color: '#3487da'\r\n                         }\r\n                     ]\r\n                 )\r\n             },\r\n             animationDelay: 0, //动画延迟时间\r\n             animationDuration: 0, //动画时长\r\n             animationDurationUpdate: 0\r\n         },\r\n         {\r\n             name: '今年Bg',\r\n             type: 'bar',\r\n             stack: 'this',\r\n             barWidth: 30,\r\n             itemStyle: {\r\n                 color: '#44f0ff',\r\n                 opacity: 0.5\r\n             },\r\n             animationDelay: 0, //动画延迟时间\r\n             animationDuration: 0, //动画时长\r\n             animationDurationUpdate: 0\r\n         },\r\n         {\r\n             name: '去年',\r\n             type: 'bar',\r\n             stack: 'last',\r\n             barWidth: 30,\r\n             itemStyle: {\r\n                 color: new echarts.graphic.LinearGradient(\r\n                     0, 0, 0, 1,\r\n                     [{\r\n                             offset: 0,\r\n                             color: '#fb387e'\r\n                         },\r\n                         {\r\n                             offset: 1,\r\n                             color: '#3586da'\r\n                         }\r\n                     ]\r\n                 )\r\n             },\r\n             animationDelay: 0, //动画延迟时间\r\n             animationDuration: 0, //动画时长\r\n             animationDurationUpdate: 0\r\n         },\r\n         {\r\n             name: '去年Bg',\r\n             type: 'bar',\r\n             stack: 'last',\r\n             barWidth: 30,\r\n             itemStyle: {\r\n                 color: '#fb387e',\r\n                 opacity: 0.5\r\n             },\r\n             animationDelay: 0, //动画延迟时间\r\n             animationDuration: 0, //动画时长\r\n             animationDurationUpdate: 0\r\n         },\r\n\r\n     ]\r\n };\r\n \r\n riseAnimation(data, myChart, option, 5, 50)\r\n\r\n function riseAnimation(data, chart, option, time, speed) {\r\n     var thisYearData = {\r\n         norm: data.map((e) => {\r\n             return e[\"今年\"]\r\n         }),\r\n         data1: new Array(5).fill(0),\r\n         data2: [],\r\n     }\r\n     var lastYearData = {\r\n         norm: data.map((e) => {\r\n             return e[\"去年\"]\r\n         }),\r\n         data1: new Array(5).fill(0),\r\n         data2: [],\r\n     }\r\n     chart.myOption = option\r\n     chart.thisYearData = thisYearData\r\n     chart.lastYearData = lastYearData\r\n\r\n     function formData(data) {\r\n         var norm = data.norm\r\n         var data1 = data.data1\r\n         var data2 = data.data2\r\n         data2 = norm.map((e, index) => {\r\n             var item = e / ((time * 1000) / speed)\r\n             data1[index] += item\r\n             if (data1[index] >= e) {\r\n                 data1[index] = 0\r\n             }\r\n             return e - data1[index]\r\n         })\r\n         return [data1, data2]\r\n     }\r\n     setInterval(function() {\r\n         var thisYear = formData(this.thisYearData)\r\n         var lastYear = formData(this.lastYearData)\r\n         this.myOption.series[0].data = thisYear[0]\r\n         this.myOption.series[1].data = thisYear[1]\r\n         this.myOption.series[2].data = lastYear[0]\r\n         this.myOption.series[3].data = lastYear[1]\r\n         this.setOption(this.myOption)\r\n     }.bind(chart), speed)\r\n }","html":"","externalScripts":"","updaterUID":"bd-354497128","theme":"","layout":"","viewCount":194,"userName":"残雪X无痕","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xluzAEG3nZ.png?v=1555482186525","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-bar","tooltip"],"customTags":[],"updaterUserName":"残雪X无痕"}}