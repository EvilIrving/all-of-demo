{"status":0,"data":{"cid":"xUd7p0k4F","authorUid":"bd-1191663638","authorUserName":"s***1","title":"四川—— 路线图","description":"四川—— 路线图","latestVersion":3,"alwaysLatest":1,"createTime":"2019-12-13T02:06:23.000Z","lastUpdateTime":"2021-09-30T09:40:11.000Z","auth":2,"uid":"bd-1191663638","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":3,"parentVersion":2,"echartsVersion":"4.9.0","versionCreateTime":"2021-09-30T09:40:11.000Z","code":"var sichuan = \"/asset/get/s/data-1576202716004-RTJpxnA2.json\";\r\n$.get(sichuan, function(tjJson) {\r\n    echarts.registerMap('sichuan', tjJson);\r\n    myChart.setOption({\r\n        series: [{\r\n            type: 'map',\r\n            map: 'sichuan'\r\n        }]\r\n    });\r\nvar planePath = 'path://M1705.06,1318.313v-89.254l-319.9-221.799l0.073-208.063c0.521-84.662-26.629-121.796-63.961-121.491c-37.332-0.305-64.482,36.829-63.961,121.491l0.073,208.063l-319.9,221.799v89.254l330.343-157.288l12.238,241.308l-134.449,92.931l0.531,42.034l175.125-42.917l175.125,42.917l0.531-42.034l-134.449-92.931l12.238-241.308L1705.06,1318.313z';\r\n    var geoCoordMap = {\r\n\t\t'广元市':[105.850994,32.439423],\r\n\t\t'达州市':[107.472292,31.214554],\r\n\t\t'广安市':[106.638979,30.461996],\r\n\t\t'遂宁市':[105.598849,30.538848],\r\n\t\t'德阳市':[104.402117,31.134352],\r\n\t\t'绵阳市':[104.684985,31.471938],\r\n\t\t'成都市':[104.076356,30.664024],\r\n\t\t'资阳市':[104.637312,30.136206],\r\n\t\t'眉山市':[103.854842,30.081277],\r\n\t\t'内江市':[105.061141,29.586137],\r\n\t\t'自贡市':[104.782145,29.348859],\r\n\t\t'泸州市':[105.448526,28.878933],\r\n\t\t'宜宾市':[104.649403,28.75826],\r\n\t\t'乐山市':[103.77254,29.559197],\r\n\t\t'雅安市':[103.050114,30.017042],\r\n\t\t'南充市':[106.115779,30.845023],\r\n\t\t'巴中市':[106.115779,30.845023],\r\n\t\t'攀枝花市':[101.724969,26.588292],\r\n\t\t'甘孜藏族自治州':[101.96912,30.056028],\r\n\t\t'阿坝藏族羌族自治州':[102.231991,31.911642],\r\n\t\t'凉山彝族自治州':[102.262579,27.888518],\r\n         \r\n    };\r\n\r\n\r\n    var goData = [\r\n\t\t\t\t\t\t\t\t{ name: '广元市', value:50 },\r\n\t\t\t\t\t\t\t\t{ name: '达州市', value:50 },\r\n\t\t\t\t\t\t\t\t{ name: '攀枝花市', value:10 },\r\n\t\t\t\t\t\t\t\t{ name: '成都市', value:106 },\r\n\t\t\t\t\t\t\t\t\r\n    ];\r\n    var goTotal=0;//计算总人数\r\n    goData.forEach(function(item,i){\r\n        goTotal+=item.value;\r\n    })\r\n\r\n    var planePath = 'arrow';\r\n    var convertData = function(name, data) {\r\n        var res = [];\r\n        for (var i = 0; i < data.length; i++) {\r\n            var fromCoord = geoCoordMap[name];\r\n            var toCoord = geoCoordMap[data[i].name];\r\n            if (fromCoord && toCoord) {\r\n                res.push({\r\n                    //对换即可调整方向\r\n                    coords: [toCoord, fromCoord]\r\n                });\r\n            }\r\n        }\r\n        return res;\r\n    };\r\n    var series = [];\r\n    [\r\n        ['成都市', goData],\r\n       // ['徐州', backData],\r\n\r\n    ].forEach(function(item) {\r\n        series.push(\r\n\t\t\t{\r\n            name: item[0],\r\n            type: 'lines',\r\n            zlevel: 1,\r\n            //线特效配置\r\n              effect: {\r\n                show: true,\r\n                period: 6,\r\n                trailLength: 0.7,\r\n\t\t\t\tsymbol: planePath,\r\n                color: '#ffde00',\r\n                symbolSize: 13\r\n            },\r\n            lineStyle: {\r\n                normal: {\r\n                    width: 1,\r\n                    opacity: 0.4,\r\n                    curveness: 0.2, //弧线角度\r\n                    color: '#ffde00'\r\n                }\r\n            },\r\n            data: convertData(item[0], item[1])\r\n        }, \r\n\t\t\t{  //起点\r\n            name: item[0],\r\n            type: 'effectScatter',\r\n            coordinateSystem: 'geo',\r\n            zlevel: 2,\r\n\t\t\t //波纹效果\r\n        rippleEffect: {\r\n            period: 2,\r\n            brushType: 'stroke',\r\n            scale: 3\r\n        },\r\n            label: {\r\n                normal: {\r\n                    show: true,\r\n                     color: '#ffde00',\r\n                    position: 'left',\r\n                    formatter: '{b}'\r\n                }\r\n            },\r\n            symbol: 'circle',\r\n\t\t\tsymbolSize:10,\r\n            //圆点大小\r\n            /****symbolSize: function(val) {\r\n                return val[2]*100 / goTotal;\r\n            },***/\r\n            itemStyle: {\r\n                normal: {\r\n                    show: true\r\n                }\r\n            },\r\n            data: item[1].map(function(dataItem) {\r\n                console.log(dataItem)\r\n                return {\r\n                    name: dataItem.name,\r\n                    value: geoCoordMap[dataItem.name].concat([dataItem.value])\r\n                };\r\n            })\r\n\r\n        }, \r\n\t\t\t{//终点\r\n            name: 'item[0]',\r\n            type: 'effectScatter',\r\n            coordinateSystem: 'geo',\r\n            zlevel: 2,\r\n\t\t\t //波纹效果\r\n        rippleEffect: {\r\n            period: 2,\r\n            brushType: 'stroke',\r\n            scale: 3\r\n        },\r\n            label: {\r\n                normal: {\r\n                    show: false,\r\n                    position: 'left',\r\n                    formatter: '{b}',\r\n\t\t\t\t\tcolor:'#ffde00'\r\n                }\r\n            },\r\n            symbolSize: function(val) {\r\n                return 25;\r\n            },\r\n            symbol: 'circle',\r\n\r\n            itemStyle: {\r\n                normal: {\r\n                    show: true\r\n                }\r\n            },\r\n            data: [{\r\n                name: item[0],\r\n                value: geoCoordMap[item[0]].concat([100])\r\n            }]\r\n\r\n        })\r\n\r\n    });\r\n\r\n\r\n    option = {\r\n  backgroundColor:'#222',\r\n        tooltip: {\r\n            trigger: 'item',\r\n            formatter: \"{b}\"\r\n        },\r\n        //线颜色及飞行轨道颜色\r\n        visualMap: {\r\n            show: false,\r\n            min: 0,\r\n            max: 100,\r\n            color: ['#ffde00']\r\n        },\r\n        //地图相关设置\r\n        geo: {\r\n            map: 'sichuan',\r\n            //视角缩放比例\r\n            zoom: 1,\r\n            //显示文本样式\r\n            label: {\r\n                normal: {\r\n                    show: false,\r\n                    textStyle: {\r\n                        color: 'rgba(255,255,255,.1)'\r\n                    }\r\n                },\r\n                emphasis: {\r\n\t\t\t\t\tshow: false,\r\n                    textStyle: {\r\n                        color: '#fff'//滑过文字颜色\r\n                    }\r\n                }\r\n            },\r\n            //鼠标缩放和平移\r\n            roam: true,\r\n            itemStyle: {\r\n           normal: {\r\n                areaColor: 'rgba(0,97,225,.3)',\r\n                borderColor: 'rgba(255,255,255,.6)'\r\n            },\r\n            emphasis: {\r\n                areaColor: '#033d94'\r\n            }\r\n        }\r\n        },\r\n        series: series\r\n    };\r\n         myChart.setOption(option);\r\n        window.addEventListener(\"resize\",function(){\r\n            myChart.resize();\r\n        });\r\n})","html":"","externalScripts":"","updaterUID":"bd-1191663638","theme":"","layout":"","viewCount":534,"userName":"s***1","commentCount":0,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xUd7p0k4F.png?v=1632994811497","isCustomThumbnail":0,"builtinTags":["category-work","geo","series-effectScatter","series-lines","tooltip","visualMap"],"customTags":[],"updaterUserName":"s***1"}}