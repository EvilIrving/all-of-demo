{"status":0,"data":{"cid":"x4FGlXksFG","authorUid":"bd-2680668432","authorUserName":"C***酱","title":"环形渐变","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2020-08-14T02:52:25.000Z","lastUpdateTime":"2020-08-14T02:52:25.000Z","auth":2,"uid":"bd-2680668432","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-08-14T02:52:25.000Z","code":"const startAlpha = 1;\nconst endAlpha = 0;\nconst color = [{\n        r: 21,\n        g: 118,\n        b: 210\n    },\n    {\n        r: 209,\n        g: 74,\n        b: 130\n    },\n    {\n        r: 38,\n        g: 193,\n        b: 242\n    },\n    {\n        r: 161,\n        g: 102,\n        b: 255\n    },\n    {\n        r: 18,\n        g: 113,\n        b: 204\n    }\n]\n\nconst data = [{\n    \"name\": \"2015\",\n    \"value\": 40,\n    \"_startArc\": 0,\n    \"_endArc\": 1.0471975511965976,\n    \"_color\": \"#1576d2\",\n    \"_percent\": 0.16666666666666666\n}, {\n    \"name\": \"2016\",\n    \"value\": 100,\n    \"_startArc\": 1.0471975511965976,\n    \"_endArc\": 3.665191429188092,\n    \"_color\": \"#d14a82\",\n    \"_percent\": 0.4166666666666667\n}, {\n    \"name\": \"2017\",\n    \"value\": 10,\n    \"_startArc\": 3.665191429188092,\n    \"_endArc\": 3.9269908169872414,\n    \"_color\": \"#26c1f2\",\n    \"_percent\": 0.041666666666666664\n}, {\n    \"name\": \"2018\",\n    \"value\": 70,\n    \"_startArc\": 3.9269908169872414,\n    \"_endArc\": 5.759586531581288,\n    \"_color\": \"#a166ff\",\n    \"_percent\": 0.2916666666666667\n}, {\n    \"name\": \"2019\",\n    \"value\": 20,\n    \"_startArc\": 5.759586531581288,\n    \"_endArc\": 6.283185307179585,\n    \"_color\": \"#1271cc\",\n    \"_percent\": 0.08333333333333333\n}]\n\n/**\n * 线性渐变起止方向的计算方法\n * \n *\n * @param {*} startArc 开始角度\n * @param {*} endArc 结束角度\n * @returns 四个坐标 x,y,x2,y2\n */\nfunction getCoordinates(startArc, endArc) {\n    const posi = [\n        Math.sin(startArc),\n        -Math.cos(startArc),\n        Math.sin(endArc),\n        -Math.cos(endArc)\n    ]\n    const dx = posi[2] - posi[0]\n    const dy = posi[3] - posi[1]\n    \n    return getLocation(dx, dy)\n}\n\nfunction getLocation(dx, dy) {\n  const tanV = dx / dy\n  const directSign = Math.abs(tanV) < 1\n  const t = directSign ? tanV : 1 / tanV\n  \n  const sign1 = t > 0 ? 1 : -1\n  const sign2 = dx > 0 ? 1 : -1\n  const sign = directSign ? sign1 * sign2 : sign2\n  \n  const group1 = [ 0.5 - sign * t / 2, 0.5 + sign * t / 2]\n  const group2 = sign > 0 ? [0, 1] : [1, 0]\n  const group = [...group1, ...group2]\n  const keys = directSign ? ['x', 'x2', 'y', 'y2'] : ['y', 'y2', 'x', 'x2' ]\n\n  let res = {}\n  keys.forEach((k, idx) => {\n    res[k] = group[idx]\n  })\n  return res\n}\n\n/**\n * 给数据写入 样式(线性渐变)\n *\n * @param {*} datas 数据\n * @param {*} colorlist 颜色列表\n * @param {*} startAlpha 开始颜色的透明度\n * @param {*} endAlpha 结束颜色透的明度\n * @returns 带样式的数据\n */\nfunction setGradientColorInItemSyle(datas, colorlist, startAlpha, endAlpha) {\n    for (let i = 0; i < datas.length; i++) {\n        const color = colorlist[i];\n        const startArc = datas[i]._startArc;\n        const endArc = datas[i]._endArc;\n        // 这里计算了 线性渐变的起止方向\n        const coordinates = getCoordinates(startArc, endArc);\n        datas[i].itemStyle = {\n            color: {\n                ...coordinates,\n                \"type\": \"linear\",\n                \"global\": false,\n                // 这里给了 线性渐变的起止颜色\n                \"colorStops\": [{\n                    offset: 0,\n                    color: `rgba(${color.r}, ${color.g}, ${color.b}, ${startAlpha})`\n                }, {\n                    offset: 1,\n                    color: `rgba(${color.r}, ${color.g}, ${color.b}, ${endAlpha})`\n                }]\n            }\n        }\n    }\n    return datas\n}\n\noption = {\n    backgroundColor: \"#000\",\n    \"color\": [\"#1576d2\", \"#d14a82\", \"#26c1f2\", \"#a166ff\", \"#1271cc\", \"#272f67\", \"#9C2BB6\"],\n    \"tooltip\": {\n        \"show\": true,\n        \"textStyle\": {\n            \"color\": \"#fff\",\n            \"fontSize\": 15,\n            \"fontFamily\": \"微软雅黑\"\n        }\n    },\n    \"series\": [{\n        \"type\": \"pie\",\n        \"data\": setGradientColorInItemSyle(data, color, startAlpha, endAlpha),\n        \"animation\": false,\n        \"radius\": [\"50%\", \"75%\"],\n        \"center\": [\"50%\", \"50%\"],\n        \"labelLine\": {\n            show: false\n        },\n        \"itemStyle\": {\n            \"linearGradient\": true\n        },\n        \"hoverAnimation\": false\n    }]\n};\nconsole.log(option)","html":"","externalScripts":"","updaterUID":"bd-2680668432","theme":"","layout":"","viewCount":1107,"userName":"C***酱","commentCount":0,"starCount":18,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x4FGlXksFG.png?v=1597373545226","isCustomThumbnail":0,"builtinTags":["category-work","series-pie","tooltip"],"customTags":[],"updaterUserName":"C***酱"}}