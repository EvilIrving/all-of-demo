{"status":0,"data":{"cid":"xOjEb-3KsE","authorUid":"obd-ojMzKebRWlOBrfglNE5_mBJi3x6hmEl","authorUserName":"9***2","title":"不考虑丢包,异常的情况下,模拟新方案延时图效果","description":"","latestVersion":2,"alwaysLatest":1,"createTime":"2020-09-16T07:28:16.000Z","lastUpdateTime":"2020-09-16T07:28:16.000Z","auth":1,"uid":"obd-ojMzKebRWlOBrfglNE5_mBJi3x6hmEl","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.8.0","versionCreateTime":"2020-09-16T08:11:17.000Z","code":"//数据量,可以改这个值测一下不同数据量的展示效果\nconst 配置 = {\n    数据量: 50,\n    定时: true,\n    延时波动的概率: 0.9\n}\n//-------------------------------------------------\nconst time = new Date().getTime()\nconst base = 配置.数据量\n\nconst data = []\nconst title = `不考虑丢包,异常的情况下,模拟新方案延时图效果,数据量: ${配置.数据量}`\nlet i = 0\n\nif (配置.定时) {\n    setInterval(() => {\n        配置.数据量 += base\n        makeMock()\n        myChart.setOption({\n            title: {\n                text: `不考虑丢包,异常的情况下,模拟新方案延时图效果,数据量: ${data.length}`,\n            },\n            series: [{\n                data\n            }]\n        });\n    }, 3000)\n}\n\n\noption = {\n    title: {\n        text: title,\n    },\n    xAxis: {\n        type: 'time'\n    },\n    yAxis: {},\n    tooltip: {\n        trigger: 'axis',\n        formatter: (params) => {\n            try {\n                const data = params[0].data\n                if (!data) return ''\n                const status = data.isNoPing ? '推荐数据' : '低延时'\n                return `${status} : ${data.delay}`\n            } catch (e) {\n                return ''\n            }\n        },\n    },\n    color: ['#3385ff'],\n    animation: false,\n    dataZoom: [{\n        type: 'inside',\n        filterMode: 'none',\n    }],\n    series: [{\n        type: 'line',\n        data,\n        symbol: 'circle',\n        markLine: {\n            silent: true,\n            data: [{\n                yAxis: 20,\n                label: {\n                    formatter: () => '低延时'\n                },\n                lineStyle: {\n                    color: '#09d174'\n                }\n            }]\n        }\n    }],\n};\n\nfunction makeMock() {\n    const mock = []\n    let delay = ~~(Math.random() * 100 + 20)\n    let isNoPing = Math.random() > 0.5\n    while (i < 配置.数据量) {\n        if (Math.random() < 配置.延时波动的概率) {\n            delay = ~~(Math.random() * 100 + 20)\n            isNoPing = Math.random() > 0.5\n        }\n        mock.push({\n            value: [time + 30000 * i, delay],\n            isNoPing,\n            delay,\n            itemStyle: {\n                borderWidth: isNoPing ? 2 : 0,\n                borderColor: '#fff'\n            }\n        })\n        i++\n    }\n    data.push(...mock)\n}\n\nmakeMock()","html":"","externalScripts":"","updaterUID":"obd-ojMzKebRWlOBrfglNE5_mBJi3x6hmEl","theme":"","layout":"","viewCount":227,"userName":"9***2","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xOjEb-3KsE.png?v=1600243877556","isCustomThumbnail":0,"builtinTags":["category-work","dataZoom","grid","markLine","series-line","title","tooltip"],"customTags":[],"updaterUserName":"9***2"}}