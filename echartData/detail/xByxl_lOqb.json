{"status":0,"data":{"cid":"xByxl_lOqb","authorUid":"bd-302833795","authorUserName":"gshock007","title":"全国主要城市 噪音分贝","description":"data from 中国统计局官网","latestVersion":1,"alwaysLatest":1,"createTime":"2017-09-14T12:36:56.000Z","lastUpdateTime":"2017-09-14T12:36:56.000Z","auth":2,"uid":"bd-302833795","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"3.7.1","versionCreateTime":"2017-09-14T12:36:56.000Z","code":"var geoCoordMap = {\r\n    \"太原\": [112.55, 37.87],\r\n    \"北京\": [116.4, 39.9],\r\n    \"天津\": [117.2, 39.12],\r\n    \"呼和浩特\": [111.73, 40.83],\r\n    \"沈阳\": [123.43, 41.8],\r\n    \"大连\": [121.62, 38.92],\r\n    \"长春\": [125.32, 43.9],\r\n    \"哈尔滨\": [126.53, 45.8],\r\n    \"上海\": [121.47, 31.23],\r\n    \"南京\": [118.78, 32.07],\r\n    \"杭州\": [120.15, 30.28],\r\n    \"宁波\": [121.55, 29.88],\r\n    \"合肥\": [117.25, 31.83],\r\n    \"福州\": [119.3, 26.08],\r\n    \"厦门\": [118.08, 24.48],\r\n    \"南昌\": [115.85, 28.68],\r\n    \"济南\": [116.98, 36.67],\r\n    \"青岛\": [120.38, 36.07],\r\n    \"郑州\": [113.62, 34.75],\r\n    \"武汉\": [114.3, 30.6],\r\n    \"长沙\": [112.93, 28.23],\r\n    \"广州\": [113.27, 23.13],\r\n    \"深圳\": [114.05, 22.55],\r\n    \"南宁\": [108.37, 22.82],\r\n    \"海口\": [110.32, 20.03],\r\n    \"重庆\": [106.55, 29.57],\r\n    \"成都\": [104.07, 30.67],\r\n    \"贵阳\": [106.63, 26.65],\r\n    \"昆明\": [102.72, 25.05],\r\n    \"西安\": [108.93, 34.27],\r\n    \"兰州\": [103.82, 36.07],\r\n    \"银川\": [106.28, 38.47],\r\n    \"乌鲁木齐\": [87.62, 43.82],\r\n    \"西宁\": [101.78, 36.62]\r\n\r\n};\r\n\r\nvar data = [{\r\n    name: \"太原\",\r\n    value: 52.9\r\n}, {\r\n    name: \"北京\",\r\n    value: 53.3\r\n}, {\r\n    name: \"天津\",\r\n    value: 54.2\r\n}, {\r\n    name: \"石家庄\",\r\n    value: 50.8\r\n}, {\r\n    name: \"呼和浩特\",\r\n    value: 54.1\r\n}, {\r\n    name: \"沈阳\",\r\n    value: 55.6\r\n}, {\r\n    name: \"大连\",\r\n    value: 54.2\r\n}, {\r\n    name: \"长春\",\r\n    value: 56.1\r\n}, {\r\n    name: \"哈尔滨\",\r\n    value: 58.3\r\n}, {\r\n    name: \"上海\",\r\n    value: 56.2\r\n}, {\r\n    name: \"南京\",\r\n    value: 54.2\r\n}, {\r\n    name: \"杭州\",\r\n    value: 56.2\r\n}, {\r\n    name: \"宁波\",\r\n    value: 57.0\r\n}, {\r\n    name: \"合肥\",\r\n    value: 54.4\r\n}, {\r\n    name: \"福州\",\r\n    value: 56.0\r\n}, {\r\n    name: \"厦门\",\r\n    value: 56.1\r\n}, {\r\n    name: \"南昌\",\r\n    value: 53.6\r\n}, {\r\n    name: \"济南\",\r\n    value: 53.6\r\n}, {\r\n    name: \"青岛\",\r\n    value: 54.2\r\n}, {\r\n    name: \"郑州\",\r\n    value: 55\r\n}, {\r\n    name: \"武汉\",\r\n    value: 55.9\r\n}, {\r\n    name: \"长沙\",\r\n    value: 54.9\r\n}, {\r\n    name: \"广州\",\r\n    value: 55.2\r\n}, {\r\n    name: \"深圳\",\r\n    value: 56.8\r\n}, {\r\n    name: \"南宁\",\r\n    value: 53.2\r\n}, {\r\n    name: \"海口\",\r\n    value: 55.0\r\n}, {\r\n    name: \"重庆\",\r\n    value: 53.6\r\n}, {\r\n    name: \"成都\",\r\n    value: 54.2\r\n}, {\r\n    name: \"贵阳\",\r\n    value: 58.9\r\n}, {\r\n    name: \"昆明\",\r\n    value: 53.5\r\n}, {\r\n    name: \"西安\",\r\n    value: 54.7\r\n}, {\r\n    name: \"兰州\",\r\n    value: 54.6\r\n}, {\r\n    name: \"银川\",\r\n    value: 53.1\r\n}, {\r\n    name: \"乌鲁木齐\",\r\n    value: 53.7\r\n}, {\r\n    name: \"西宁\",\r\n    value: 52.2\r\n}];\r\n\r\nvar convertData = function(data) {\r\n    var res = [];\r\n    for (var i = 0; i < data.length; i++) {\r\n        var geoCoord = geoCoordMap[data[i].name];\r\n        if (geoCoord) {\r\n            res.push({\r\n                name: data[i].name,\r\n                value: geoCoord.concat(data[i].value)\r\n            });\r\n        }\r\n    }\r\n    return res;\r\n};\r\n\r\nvar convertedData = [\r\n    convertData(data),\r\n    convertData(data.sort(function(a, b) {\r\n        return b.value - a.value;\r\n    }).slice(0, 6))\r\n];\r\n\r\n\r\noption = {\r\n    backgroundColor: '#404a59',\r\n    animation: true,\r\n    animationDuration: 1000,\r\n    animationEasing: 'cubicInOut',\r\n    animationDurationUpdate: 1000,\r\n    animationEasingUpdate: 'cubicInOut',\r\n    title: [{\r\n        text: '全国主要城市 噪音分贝',\r\n        subtext: 'data from 中国统计局官网',\r\n        sublink: 'http://www.stats.gov.cn/',\r\n        left: 'center',\r\n        textStyle: {\r\n            color: '#fff'\r\n        }\r\n    }, {\r\n        id: 'statistic',\r\n        right: 120,\r\n        top: 40,\r\n        width: 100,\r\n        textStyle: {\r\n            color: '#fff',\r\n            fontSize: 16\r\n        }\r\n    }],\r\n    toolbox: {\r\n        iconStyle: {\r\n            normal: {\r\n                borderColor: '#fff'\r\n            },\r\n            emphasis: {\r\n                borderColor: '#b1e4ff'\r\n            }\r\n        }\r\n    },\r\n    brush: {\r\n        outOfBrush: {\r\n            color: '#abc'\r\n        },\r\n        brushStyle: {\r\n            borderWidth: 2,\r\n            color: 'rgba(0,0,0,0.2)',\r\n            borderColor: 'rgba(0,0,0,0.5)',\r\n        },\r\n        seriesIndex: [0, 1],\r\n        throttleType: 'debounce',\r\n        throttleDelay: 300,\r\n        geoIndex: 0\r\n    },\r\n    geo: {\r\n        map: 'china',\r\n        left: '10',\r\n        right: '35%',\r\n        center: [117.98561551896913, 31.205000490896193],\r\n        zoom: 2.5,\r\n        label: {\r\n            emphasis: {\r\n                show: false\r\n            }\r\n        },\r\n        roam: true,\r\n        itemStyle: {\r\n            normal: {\r\n                areaColor: '#323c48',\r\n                borderColor: '#111'\r\n            },\r\n            emphasis: {\r\n                areaColor: '#2a333d'\r\n            }\r\n        }\r\n    },\r\n    tooltip: {\r\n        trigger: 'item',\r\n        formatter: function(params, ticket, callback) {\r\n            console.log(params)\r\n            var res = \"噪音\" + \"<br />\" + params.data.name + \"&nbsp;:&nbsp;\" + params.data.value[2]\r\n            return res;\r\n        }\r\n    },\r\n    grid: {\r\n        right: 40,\r\n        top: 100,\r\n        bottom: 40,\r\n        width: '30%'\r\n    },\r\n    xAxis: {\r\n        type: 'value',\r\n        scale: true,\r\n        position: 'top',\r\n        boundaryGap: false,\r\n        splitLine: {\r\n            show: false\r\n        },\r\n        axisLine: {\r\n            show: false\r\n        },\r\n        axisTick: {\r\n            show: false\r\n        },\r\n        axisLabel: {\r\n            margin: 2,\r\n            textStyle: {\r\n                color: '#aaa'\r\n            }\r\n        },\r\n    },\r\n    yAxis: {\r\n        type: 'category',\r\n        name: '排名列表',\r\n        nameGap: 16,\r\n        axisLine: {\r\n            show: false,\r\n            lineStyle: {\r\n                color: '#ddd'\r\n            }\r\n        },\r\n        axisTick: {\r\n            show: false,\r\n            lineStyle: {\r\n                color: '#ddd'\r\n            }\r\n        },\r\n        axisLabel: {\r\n            interval: 0,\r\n            textStyle: {\r\n                color: '#ddd'\r\n            }\r\n        },\r\n        data: []\r\n    },\r\n    series: [{\r\n        name: '噪音分贝',\r\n        type: 'scatter',\r\n        coordinateSystem: 'geo',\r\n        data: convertedData[0],\r\n        symbolSize: function(val) {\r\n            return Math.max(val[2] / 10, 8);\r\n        },\r\n        label: {\r\n            normal: {\r\n                formatter: '{b}',\r\n                position: 'right',\r\n                show: false\r\n            },\r\n            emphasis: {\r\n                show: true\r\n            }\r\n        },\r\n        itemStyle: {\r\n            normal: {\r\n                color: '#ddb926'\r\n            }\r\n        }\r\n    }, {\r\n        name: 'Top 5',\r\n        type: 'effectScatter',\r\n        coordinateSystem: 'geo',\r\n        data: convertedData[1],\r\n        symbolSize: function(val) {\r\n            return Math.max(val[2] / 10, 8);\r\n        },\r\n        showEffectOn: 'emphasis',\r\n        rippleEffect: {\r\n            brushType: 'stroke'\r\n        },\r\n        hoverAnimation: true,\r\n        label: {\r\n            normal: {\r\n                formatter: '{b}',\r\n                position: 'right',\r\n                show: true\r\n            }\r\n        },\r\n        itemStyle: {\r\n            normal: {\r\n                color: '#f4e925',\r\n                shadowBlur: 10,\r\n                shadowColor: '#333'\r\n            }\r\n        },\r\n        zlevel: 1\r\n    }, {\r\n        id: 'bar',\r\n        zlevel: 2,\r\n        type: 'bar',\r\n        symbol: 'none',\r\n        itemStyle: {\r\n            normal: {\r\n                color: '#ddb926'\r\n            }\r\n        },\r\n        data: []\r\n    }]\r\n};\r\n\r\n\r\nmyChart.on('brushselected', renderBrushed);\r\n\r\n// myChart.setOption(option);\r\n\r\nsetTimeout(function() {\r\n    myChart.dispatchAction({\r\n        type: 'brush',\r\n        areas: [{\r\n            geoIndex: 0,\r\n            brushType: 'polygon',\r\n            coordRange: [\r\n                [119.72, 34.85],\r\n                [119.68, 34.85],\r\n                [119.5, 34.84],\r\n                [119.19, 34.77],\r\n                [118.76, 34.63],\r\n                [118.6, 34.6],\r\n                [118.46, 34.6],\r\n                [118.33, 34.57],\r\n                [118.05, 34.56],\r\n                [117.6, 34.56],\r\n                [117.41, 34.56],\r\n                [117.25, 34.56],\r\n                [117.11, 34.56],\r\n                [117.02, 34.56],\r\n                [117, 34.56],\r\n                [116.94, 34.56],\r\n                [116.94, 34.55],\r\n                [116.9, 34.5],\r\n                [116.88, 34.44],\r\n                [116.88, 34.37],\r\n                [116.88, 34.33],\r\n                [116.88, 34.24],\r\n                [116.92, 34.15],\r\n                [116.98, 34.09],\r\n                [117.05, 34.06],\r\n                [117.19, 33.96],\r\n                [117.29, 33.9],\r\n                [117.43, 33.8],\r\n                [117.49, 33.75],\r\n                [117.54, 33.68],\r\n                [117.6, 33.65],\r\n                [117.62, 33.61],\r\n                [117.64, 33.59],\r\n                [117.68, 33.58],\r\n                [117.7, 33.52],\r\n                [117.74, 33.5],\r\n                [117.74, 33.46],\r\n                [117.8, 33.44],\r\n                [117.82, 33.41],\r\n                [117.86, 33.37],\r\n                [117.9, 33.3],\r\n                [117.9, 33.28],\r\n                [117.9, 33.27],\r\n                [118.09, 32.97],\r\n                [118.21, 32.7],\r\n                [118.29, 32.56],\r\n                [118.31, 32.5],\r\n                [118.35, 32.46],\r\n                [118.35, 32.42],\r\n                [118.35, 32.36],\r\n                [118.35, 32.34],\r\n                [118.37, 32.24],\r\n                [118.37, 32.14],\r\n                [118.37, 32.09],\r\n                [118.44, 32.05],\r\n                [118.46, 32.01],\r\n                [118.54, 31.98],\r\n                [118.6, 31.93],\r\n                [118.68, 31.86],\r\n                [118.72, 31.8],\r\n                [118.74, 31.78],\r\n                [118.76, 31.74],\r\n                [118.78, 31.7],\r\n                [118.82, 31.64],\r\n                [118.82, 31.62],\r\n                [118.86, 31.58],\r\n                [118.86, 31.55],\r\n                [118.88, 31.54],\r\n                [118.88, 31.52],\r\n                [118.9, 31.51],\r\n                [118.91, 31.48],\r\n                [118.93, 31.43],\r\n                [118.95, 31.4],\r\n                [118.97, 31.39],\r\n                [118.97, 31.37],\r\n                [118.97, 31.34],\r\n                [118.97, 31.27],\r\n                [118.97, 31.21],\r\n                [118.97, 31.17],\r\n                [118.97, 31.12],\r\n                [118.97, 31.02],\r\n                [118.97, 30.93],\r\n                [118.97, 30.87],\r\n                [118.97, 30.85],\r\n                [118.95, 30.8],\r\n                [118.95, 30.77],\r\n                [118.95, 30.76],\r\n                [118.93, 30.7],\r\n                [118.91, 30.63],\r\n                [118.91, 30.61],\r\n                [118.91, 30.6],\r\n                [118.9, 30.6],\r\n                [118.88, 30.54],\r\n                [118.88, 30.51],\r\n                [118.86, 30.51],\r\n                [118.86, 30.46],\r\n                [118.72, 30.18],\r\n                [118.68, 30.1],\r\n                [118.66, 30.07],\r\n                [118.62, 29.91],\r\n                [118.56, 29.73],\r\n                [118.52, 29.63],\r\n                [118.48, 29.51],\r\n                [118.44, 29.42],\r\n                [118.44, 29.32],\r\n                [118.43, 29.19],\r\n                [118.43, 29.14],\r\n                [118.43, 29.08],\r\n                [118.44, 29.05],\r\n                [118.46, 29.05],\r\n                [118.6, 28.95],\r\n                [118.64, 28.94],\r\n                [119.07, 28.51],\r\n                [119.25, 28.41],\r\n                [119.36, 28.28],\r\n                [119.46, 28.19],\r\n                [119.54, 28.13],\r\n                [119.66, 28.03],\r\n                [119.78, 28],\r\n                [119.87, 27.94],\r\n                [120.03, 27.86],\r\n                [120.17, 27.79],\r\n                [120.23, 27.76],\r\n                [120.3, 27.72],\r\n                [120.42, 27.66],\r\n                [120.52, 27.64],\r\n                [120.58, 27.63],\r\n                [120.64, 27.63],\r\n                [120.77, 27.63],\r\n                [120.89, 27.61],\r\n                [120.97, 27.6],\r\n                [121.07, 27.59],\r\n                [121.15, 27.59],\r\n                [121.28, 27.59],\r\n                [121.38, 27.61],\r\n                [121.56, 27.73],\r\n                [121.73, 27.89],\r\n                [122.03, 28.2],\r\n                [122.3, 28.5],\r\n                [122.46, 28.72],\r\n                [122.5, 28.77],\r\n                [122.54, 28.82],\r\n                [122.56, 28.82],\r\n                [122.58, 28.85],\r\n                [122.6, 28.86],\r\n                [122.61, 28.91],\r\n                [122.71, 29.02],\r\n                [122.73, 29.08],\r\n                [122.93, 29.44],\r\n                [122.99, 29.54],\r\n                [123.03, 29.66],\r\n                [123.05, 29.73],\r\n                [123.16, 29.92],\r\n                [123.24, 30.02],\r\n                [123.28, 30.13],\r\n                [123.32, 30.29],\r\n                [123.36, 30.36],\r\n                [123.36, 30.55],\r\n                [123.36, 30.74],\r\n                [123.36, 31.05],\r\n                [123.36, 31.14],\r\n                [123.36, 31.26],\r\n                [123.38, 31.42],\r\n                [123.46, 31.74],\r\n                [123.48, 31.83],\r\n                [123.48, 31.95],\r\n                [123.46, 32.09],\r\n                [123.34, 32.25],\r\n                [123.22, 32.39],\r\n                [123.12, 32.46],\r\n                [123.07, 32.48],\r\n                [123.05, 32.49],\r\n                [122.97, 32.53],\r\n                [122.91, 32.59],\r\n                [122.83, 32.81],\r\n                [122.77, 32.87],\r\n                [122.71, 32.9],\r\n                [122.56, 32.97],\r\n                [122.38, 33.05],\r\n                [122.3, 33.12],\r\n                [122.26, 33.15],\r\n                [122.22, 33.21],\r\n                [122.22, 33.3],\r\n                [122.22, 33.39],\r\n                [122.18, 33.44],\r\n                [122.07, 33.56],\r\n                [121.99, 33.69],\r\n                [121.89, 33.78],\r\n                [121.69, 34.02],\r\n                [121.66, 34.05],\r\n                [121.64, 34.08]\r\n            ]\r\n        }]\r\n    });\r\n}, 0);\r\n\r\n\r\nfunction renderBrushed(params) {\r\n\r\n    var mainSeries = params.batch[0].selected[0];\r\n\r\n    var selectedItems = [];\r\n    var categoryData = [];\r\n    var barData = [];\r\n    var maxBar = 50;\r\n    var sum = 0;\r\n    var count = 0;\r\n\r\n    for (var i = 0; i < mainSeries.dataIndex.length; i++) {\r\n        var rawIndex = mainSeries.dataIndex[i];\r\n        var dataItem = convertedData[0][rawIndex];\r\n        var pmValue = dataItem.value[2];\r\n\r\n        sum += pmValue;\r\n        count++;\r\n\r\n        selectedItems.push(dataItem);\r\n    }\r\n\r\n    selectedItems.sort(function(a, b) {\r\n        return a.value[2] - b.value[2];\r\n    });\r\n\r\n    for (var i = 0; i < Math.min(selectedItems.length, maxBar); i++) {\r\n        categoryData.push(selectedItems[i].name);\r\n        barData.push(selectedItems[i].value[2]);\r\n    }\r\n\r\n    this.setOption({\r\n        yAxis: {\r\n            data: categoryData\r\n        },\r\n        xAxis: {\r\n            axisLabel: {\r\n                show: !!count\r\n            }\r\n        },\r\n        title: {\r\n            id: 'statistic',\r\n            text: count ? '平均: ' + (sum / count).toFixed(4) : ''\r\n        },\r\n        series: {\r\n            id: 'bar',\r\n            data: barData\r\n        }\r\n    });\r\n}","html":"","externalScripts":"/dep/echarts/map/js/china.js","updaterUID":"bd-302833795","theme":"","layout":"","viewCount":905,"userName":"gshock007","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xByxl_lOqb.png?v=1505392616453","isCustomThumbnail":0,"builtinTags":["brush","category-work","geo","grid","series-bar","series-effectScatter","series-scatter","title","toolbox","tooltip"],"customTags":[],"updaterUserName":"gshock007"}}