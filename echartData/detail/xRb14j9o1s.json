{"status":0,"data":{"cid":"xRb14j9o1s","authorUid":"obd-o2TqhU5V49yi28tSjDqysoIw4zUTi6H","authorUserName":"m***h","title":"各专业转入转出情况","description":"","latestVersion":4,"alwaysLatest":1,"createTime":"2021-02-22T07:32:22.000Z","lastUpdateTime":"2021-02-22T07:32:22.000Z","auth":2,"uid":"obd-o2TqhU5V49yi28tSjDqysoIw4zUTi6H","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":4,"parentVersion":3,"echartsVersion":"4.8.0","versionCreateTime":"2021-02-23T01:45:40.000Z","code":"let majorArr = [\r    ['经贸学院','金融学','经济学','注册会计'],\r    ['教育学院','应用心理','思想政治','学前教育'],\r    ['电信学院','电子科技','机电应用'],\r    ['法学院','国际政治','马克思','法学','国际法学'],\r    ['管理学院','工商管理'],\r    ['外国语学院','同声传译','日语'],\r    ['传播学院','新闻学','新媒体'],\r    ['药学院','中医学'],\r    ['医学院','口腔医学']\r]\r\rlet dataArr = [\r    ['金融学','rgba(45, 154, 255, 1)',false],\r    ['经济学','rgba(45, 154, 255, 1)',false],\r    ['注册会计','rgba(45, 154, 255, 1)',false],\r    ['应用心理','rgba(150, 137, 244, 1)',false],\r    ['思想政治','rgba(150, 137, 244, 1)',false],\r    ['学前教育','rgba(150, 137, 244, 1)',false],\r    ['电子科技','rgba(72, 213, 157, 1)',false],\r    ['机电应用','rgba(72, 213, 157, 1)',false],\r    ['国际政治','rgba(255, 155, 75, 1)',false],\r    ['马克思','rgba(255, 155, 75, 1)',false],\r    ['法学','rgba(255, 155, 75, 1)',false],\r    ['国际法学','rgba(255, 155, 75, 1)',false],\r    ['工商管理','rgba(45, 213, 255, 1)',true],\r    ['同声传译','rgba(85, 173, 255, 1)',true],\r    ['日语','rgba(85, 173, 255, 1)',true],\r    ['新闻学','rgba(107, 230, 17, 1)',true],\r    ['新媒体','rgba(107, 230, 17, 1)',true],\r    ['中医学','rgba(255, 98, 142, 1)',true],\r    ['口腔医学','rgba(255, 98, 142, 1)',true],\r]\rlet linkArr = [\r    ['金融学', '工商管理', 5,\r        {\r            x: 0,\r            y: 0,\r            x2: 1,\r            y2: 0,\r            colorStops: [{\r\r\r\r                offset: 0,\r\r                color: 'rgba(45, 154, 2550, 1)'\r\r            }, {\r\r                offset: 1,\r\r                color: 'rgba(45, 213, 2550, 1)'\r\r            }]\r        }\r    ],\r    ['金融学', '同声传译', 5,\r        {\r            x: 0,\r            y: 0,\r            x2: 1,\r            y2: 0,\r            colorStops: [{\r\r\r\r                offset: 0,\r\r                color: 'rgba(45, 154, 2550, 1)'\r\r            }, {\r\r                offset: 1,\r\r                color: 'rgba(85, 213, 2550, 1)'\r\r            }]\r        }\r    ],\r    ['金融学', '新闻学', 5,\r        {\r            x: 0,\r            y: 0,\r            x2: 1,\r            y2: 0,\r            colorStops: [{\r\r\r\r                offset: 0,\r\r                color: 'rgba(45, 154, 2550, 1)'\r\r            }, {\r\r                offset: 1,\r\r                color: 'rgba(107, 213, 2550, 1)'\r\r            }]\r        }\r    ],\r\r    ['经济学', '日语', 5,\r        {\r            x: 0,\r            y: 0,\r            x2: 1,\r            y2: 0,\r            colorStops: [{\r\r\r\r                offset: 0,\r\r                color: 'rgba(45, 154, 2550, 1)'\r\r            }, {\r\r                offset: 1,\r\r                color: 'rgba(85, 173, 2550, 1)'\r\r            }]\r        }\r    ],\r    ['注册会计', '新媒体', 5, {\r        x: 0,\r        y: 0,\r        x2: 1,\r        y2: 0,\r        colorStops: [{\r\r\r\r            offset: 0,\r\r            color: 'rgba(45, 154, 2550, 1)'\r\r        }, {\r\r            offset: 1,\r\r            color: 'rgba(107, 230, 170, 1)'\r\r        }]\r    }],\r    ['应用心理', '工商管理', 24, {\r        x: 0,\r        y: 0,\r        x2: 1,\r        y2: 0,\r        colorStops: [{\r\r\r\r            offset: 0,\r\r            color: 'rgba(150, 137, 2440, 1)'\r\r        }, {\r\r            offset: 1,\r\r            color: 'rgba(45, 213, 2550, 1)'\r\r        }]\r    }],\r    ['思想政治', '中医学', 5, {\r        x: 0,\r        y: 0,\r        x2: 1,\r        y2: 0,\r        colorStops: [{\r\r\r\r            offset: 0,\r\r            color: 'rgba(150, 137, 2440, 1)'\r\r        }, {\r\r            offset: 1,\r\r            color: 'rgba(255, 98, 1420, 1)'\r\r        }]\r    }],\r    ['学前教育', '口腔医学', 5, {\r        x: 0,\r        y: 0,\r        x2: 1,\r        y2: 0,\r        colorStops: [{\r\r\r\r            offset: 0,\r\r            color: 'rgba(150, 137, 2440, 1)'\r\r        }, {\r\r            offset: 1,\r\r            color: 'rgba(255, 98, 1420, 1)'\r\r        }]\r    }],\r    ['学前教育', '中医学', 5, {\r        x: 0,\r        y: 0,\r        x2: 1,\r        y2: 0,\r        colorStops: [{\r\r\r\r            offset: 0,\r\r            color: 'rgba(150, 137, 2440, 1)'\r\r        }, {\r\r            offset: 1,\r\r            color: 'rgba(255, 98, 1420, 1)'\r\r        }]\r    }],\r    ['机电应用', '新媒体', 5, {\r        x: 0,\r        y: 0,\r        x2: 1,\r        y2: 0,\r        colorStops: [{\r\r\r\r            offset: 0,\r\r            color: 'rgba(72, 213, 1570, 1)'\r\r        }, {\r\r            offset: 1,\r\r            color: 'rgba(107, 230, 170, 1)'\r\r        }]\r    }],\r    ['电子科技', '新闻学', 5, {\r        x: 0,\r        y: 0,\r        x2: 1,\r        y2: 0,\r        colorStops: [{\r\r\r\r            offset: 0,\r\r            color: 'rgba(72, 213, 1570, 1)'\r\r        }, {\r\r            offset: 1,\r\r            color: 'rgba(107, 230, 170, 1)'\r\r        }]\r    }],\r    ['机电应用', '中医学', 5, {\r        x: 0,\r        y: 0,\r        x2: 1,\r        y2: 0,\r        colorStops: [{\r\r\r\r            offset: 0,\r\r            color: 'rgba(72, 213, 1570, 1)'\r\r        }, {\r\r            offset: 1,\r\r            color: 'rgba(255, 98, 1420, 1)'\r\r        }]\r    }],\r    ['机电应用', '同声传译', 5, {\r        x: 0,\r        y: 0,\r        x2: 1,\r        y2: 0,\r        colorStops: [{\r\r\r\r            offset: 0,\r\r            color: 'rgba(72, 213, 1570, 1)'\r\r        }, {\r\r            offset: 1,\r\r            color: 'rgba(45, 213, 2550, 1)'\r\r        }]\r    }],\r    ['机电应用', '工商管理', 5, {\r        x: 0,\r        y: 0,\r        x2: 1,\r        y2: 0,\r        colorStops: [{\r\r\r\r            offset: 0,\r\r            color: 'rgba(72, 213, 1570, 1)'\r\r        }, {\r\r            offset: 1,\r\r            color: 'rgba(45, 213, 2550, 1)'\r\r        }]\r    }],\r    ['国际政治', '工商管理', 5, {\r        x: 0,\r        y: 0,\r        x2: 1,\r        y2: 0,\r        colorStops: [{\r\r\r\r            offset: 0,\r\r            color: 'rgba(255, 155, 750, 1)'\r\r        }, {\r\r            offset: 1,\r\r            color: 'rgba(45, 213, 2550, 1)'\r\r        }]\r    }],\r    ['马克思', '工商管理', 5, {\r        x: 0,\r        y: 0,\r        x2: 1,\r        y2: 0,\r        colorStops: [{\r\r\r\r            offset: 0,\r\r            color: 'rgba(255, 155, 750, 1)'\r\r        }, {\r\r            offset: 1,\r\r            color: 'rgba(45, 213, 2550, 1)'\r\r        }]\r    }],\r    ['法学', '工商管理', 5, {\r        x: 0,\r        y: 0,\r        x2: 1,\r        y2: 0,\r        colorStops: [{\r\r\r\r            offset: 0,\r\r            color: 'rgba(255, 155, 750, 1)'\r\r        }, {\r\r            offset: 1,\r\r            color: 'rgba(45, 213, 2550, 1)'\r\r        }]\r    }],\r    ['国际法学', '工商管理', 5, {\r        x: 0,\r        y: 0,\r        x2: 1,\r        y2: 0,\r        colorStops: [{\r\r\r\r            offset: 0,\r\r            color: 'rgba(255, 155, 750, 1)'\r\r        }, {\r\r            offset: 1,\r\r            color: 'rgba(45, 213, 2550, 1)'\r\r        }]\r    }]\r]\r\r\r\rlet links = linkArr.map(item=>{\r    return {\r        source:item[0],\r        target:item[1],\r        value:item[2],\r        lineStyle:{\r            color:item[3]\r        }\r    }\r})\rlet majorValue = {}\rlet majorLeft = {}\rlinks.map(item => {\r    majorLeft[item.source] = true;\r    majorValue[item.source] = majorValue[item.source] ? majorValue[item.source] + item.value : item.value;\r    majorValue[item.target] = majorValue[item.target] ? majorValue[item.target] + item.value : item.value;\r})\r\r\rlet data = dataArr.map(item=>{\r    return {\r        name:item[0],\r        itemStyle:{\r            color:item[1]\r        },\r        label:{\r            position:item[2]?'right':'left',\r            textStyle:{\r                fontSize:13,\r                fontFamily: 'SourceHanSansCN-Regular',\r                color:'#666666'\r            }\r        },\r        value:majorValue[item[0]]//兼容低版本Echarts不赋值无法在tooltip上获取value\r    }  \r})\rlet majorList = majorArr.map(item=>{\r    let newArr = [...item];\r    let collegeName = newArr.shift();\r    return {\r        name:collegeName,\r        revert:!majorLeft[newArr[0]],\r        majorList: newArr.map(item=>{\r            return {\r                name:item,\r                value:majorValue[item]\r            }\r        })\r    }\r})\rlet preName = []\rlet preLink = []\rmajorList.map(item => {\r    preName.push({\r        name: item.name,\r        label: {\r            position: item.revert ? 'right' : 'left',\r            color: 'rgba(136, 136, 136, 1)'\r        },\r        itemStyle: {\r            color: 'transparent'\r        }\r    })\r    item.majorList.map(major => {\r\r        preLink.push({\r            source: item.revert ? major.name : item.name,\r            target: item.revert ? item.name : major.name,\r            value: major.value,\r            lineStyle: {\r                color: 'transparent'\r            },\r            emphasis: {\r                lineStyle: {\r                    color: 'transparent'\r                }\r            }\r        })\r    })\r})\r\r\r\r\r\rlet links2 = links.map(item => {\r    return {\r        ...item,\r        lineStyle: {\r            color: 'transparent'\r        }\r    }\r})\rlet data2 = data.map(item => {\r    return {\r        ...item,\r        itemStyle: {\r            color: 'transparent'\r        },\r        label: {\r            color: 'transparent'\r        }\r    }\r})\roption = {\r\r    title: {\r\r        text: '各专业转入转出情况',\r\r        left: '0'\r\r    },\r\r    tooltip: {\r\r        trigger: 'item',\r\r        triggerOn: 'mousemove',\r\r        formatter: params => {\r            if (params.dataType == 'edge') {\r                return `<span style=\"color:rgba(0, 255, 252, 1)\">${params.data.source}</span>\r                转\r                <span style=\"color:rgba(0, 255, 252, 1)\">${params.data.target}</span>\r                <br/>\r                <span style=\"color:rgba(0, 255, 252, 1)\">${params.data.value}人</span>`\r            } else {\r                return `<span style=\"color:rgba(0, 255, 252, 1)\">${params.data.name}</span>\r                <br/>\r                ${params.data.label.position == 'left' ? '共转出':'共转入'}\r                <span style=\"color:rgba(0, 255, 252, 1)\">${params.value}人</span>\r                `\r            }\r        },\r\r        rich: {\r            textOther: {\r                color: 'rgba(0, 255, 252, 1)'\r            }\r        },\r\r        extraCssText: 'padding:20px;background:rgba(21, 64, 92, 1);width:123px;height:40px;fontSize:15px'\r\r    },\r\r    xAxis: {\r        data: ['转出专业', '转入专业'],\r        boundaryGap: false,\r        axisLabel: {\r            color: 'rgba(136, 136, 136, 1)',\r            fontSize: 13\r        },\r        axisLine: {\r            show: false\r        },\r        axisTick: {\r            show: false\r        }\r    },\r    yAxis: {\r        show: false,\r    },\r\r    grid: {\r        left: 200,\r        right: 200,\r        top: 0,\r        height: 80,\r        containLabel: true\r    },\r\r    series: [{\r\r            left: 200,\r\r            right: 200,\r\r            top: 100,\r\r            layoutIterations: 0,\r\r            type: 'sankey',\r\r            focusNodeAdjacency: 'allEdges',\r\r            itemStyle: {\r\r                borderWidth: 0,\r\r                borderColor: '#aaa'\r\r            },\r\r            lineStyle: {\r\r                color: 'source',\r\r                curveness: 0.5\r\r            },\r\r\r\r            nodeGap: 1,\r\r            data: data,\r\r            links: links,\r\r        },\r\r        {\r            left: 100,\r\r            right: 100,\r\r            top: 100,\r\r            layoutIterations: 0,\r\r            type: 'sankey',\r\r            focusNodeAdjacency: 'allEdges',\r\r            itemStyle: {\r\r                borderWidth: 0,\r\r                borderColor: '#aaa',\r\r            },\r\r\r            lineStyle: {\r\r                color: 'source',\r\r                curveness: 0.5,\r\r\r            },\r\r            silent: true,\r\r\r            nodeGap: 1,\r\r            data: [...preName, ...data2],\r\r            links: [...preLink, ...links2],\r\r        }\r    ]\r\r};","html":"","externalScripts":"","updaterUID":"obd-o2TqhU5V49yi28tSjDqysoIw4zUTi6H","theme":"","layout":"","viewCount":219,"userName":"m***h","commentCount":0,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xRb14j9o1s.png?v=1614044740853","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-sankey","title","tooltip"],"customTags":[],"updaterUserName":"m***h"}}