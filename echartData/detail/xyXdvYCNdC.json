{"status":0,"data":{"cid":"xyXdvYCNdC","authorUid":"bd-3079028567","authorUserName":"金***7","title":"pie3","description":"饼图","latestVersion":12,"alwaysLatest":1,"createTime":"2021-01-21T06:20:03.000Z","lastUpdateTime":"2021-01-21T06:20:03.000Z","auth":2,"uid":"bd-3079028567","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":12,"parentVersion":11,"echartsVersion":"4.8.0","versionCreateTime":"2021-01-27T08:10:39.000Z","code":"var sData = [{\r\n    name: \"验收通过\",\r\n    value: 40\r\n},{\r\n    name: \"已支付\",\r\n    value: 46\r\n}, {\r\n    name: \"已拒收\",\r\n    value: 14\r\n}];\r\n\r\nvar data = [];\r\nvar dataRotate = [];\r\nvar color = ['#10B4A8', '#26C755', '#BBBC19'];\r\nfunction angleText(i) {\r\n    let totalValue = 0;\r\n    let initValue = 0;\r\n    for (var j = 0; j < sData.length; j++){\r\n        totalValue += sData[j].value;\r\n    }\r\n    for(var k=0; k< sData.length; k++){\r\n        if(k<i){\r\n            initValue += sData[k].value;\r\n        }\r\n    }\r\n    //每个元素的角度\r\n    var everyAngle = 360 / totalValue;\r\n    //文字现在所在的角度\r\n    var currentAngle = (sData[i].value/2+initValue) * everyAngle;\r\n\r\n    if (currentAngle <= 90) {\r\n        return -currentAngle;\r\n    } else if (currentAngle <= 180 && currentAngle > 90) {\r\n        return -currentAngle;\r\n    } else if (currentAngle < 270 && currentAngle > 180) {\r\n        return -currentAngle;\r\n    } else if (currentAngle < 360 && currentAngle >= 270) {\r\n        return -currentAngle;\r\n    }\r\n}\r\n\r\nfor (var i = 0; i < sData.length; i++) {\r\n    data.push({\r\n        value: sData[i].value,\r\n        name: sData[i].name,\r\n        itemStyle: {\r\n            normal: {\r\n                borderWidth: 6,\r\n                borderColor: color[i],\r\n            }\r\n        },\r\n    }, {\r\n        value: 1,\r\n        name: '',\r\n        itemStyle: {\r\n            normal: {\r\n                label: {\r\n                    show: false\r\n                },\r\n                labelLine: {\r\n                    show: false\r\n                },\r\n                color: 'rgba(0, 0, 0, 0)',\r\n                borderColor: 'rgba(0, 0, 0, 0)',\r\n                borderWidth: 0\r\n            }\r\n        }\r\n    });\r\n    dataRotate.push({\r\n        value: sData[i].value,\r\n        name: sData[i].name,\r\n        itemStyle: {\r\n            normal: {\r\n                borderWidth: 6,\r\n                borderColor: color[i],\r\n            }\r\n        },\r\n        label:{\r\n            rotate:angleText(i),\r\n        }\r\n    }, {\r\n        value: 1,\r\n        name: '',\r\n        itemStyle: {\r\n            normal: {\r\n                label: {\r\n                    show: false\r\n                },\r\n                labelLine: {\r\n                    show: false\r\n                },\r\n                color: 'rgba(0, 0, 0, 0)',\r\n                borderColor: 'rgba(0, 0, 0, 0)',\r\n                borderWidth: 0\r\n            }\r\n        }\r\n    });\r\n    \r\n}\r\nvar legendData = [];\r\nfor (var i = 0; i < sData.length; i++) {\r\n    legendData.push(sData[i].name)\r\n}\r\nfunction Pie() {\r\n    let dataArr = [];\r\n    for (var i = 0; i < 300; i++) {\r\n        if (i % 5 === 0) {\r\n            dataArr.push({\r\n                name: (i + 1).toString(),\r\n                value: 20,\r\n                itemStyle: {\r\n                    normal: {\r\n                        color: \"rgba(0,255,255,.3)\",\r\n                        borderWidth: 0,\r\n                        borderColor: \"rgba(0,0,0,0)\"\r\n                    }\r\n                }\r\n            })\r\n        } else {\r\n            dataArr.push({\r\n                name: (i + 1).toString(),\r\n                value: 30,\r\n                itemStyle: {\r\n                    normal: {\r\n                        color: \"rgba(0,0,0,0)\",\r\n                        borderWidth: 0,\r\n                        borderColor: \"rgba(0,0,0,0)\"\r\n                    }\r\n                }\r\n            })\r\n        }\r\n    }\r\n    return dataArr\r\n}\r\n\r\n\r\n\r\nvar seriesOption = [{\r\n    name: '',\r\n    type: 'pie',\r\n    clockWise: true,\r\n    radius: ['64%', '67%'],\r\n    hoverAnimation: false,\r\n    itemStyle: {\r\n        normal: {\r\n            label: {\r\n                show: true,\r\n                // position: 'outside',\r\n                distanceToLabelLine: 30,\r\n                color: '#ddd',\r\n                formatter: function(params) {\r\n                    var percent = 0;\r\n                    var total = 0;\r\n                    for (var i = 0; i < sData.length; i++) {\r\n                        total += sData[i].value;\r\n                    }\r\n                    \r\n                    percent = ((params.value / total) * 100).toFixed(2);\r\n                    if (params.name !== '') {\r\n                        return percent + '%';\r\n                    } else {\r\n                        return '';\r\n                    }\r\n                },\r\n            },\r\n            labelLine: {\r\n                length: 20,\r\n                length2: 20,\r\n                show: false,\r\n                color: '#00ffff'\r\n            }\r\n        }\r\n    },\r\n    data: data\r\n},\r\n{\r\n        \r\n        type: 'pie',\r\n        silent: true, //取消高亮\r\n        radius: ['64%', '67%'],\r\n        // center: [\"50%\", \"50%\"],\r\n        labelLine: {\r\n            normal: {\r\n                length: 20,\r\n                length2: 0,\r\n                lineStyle: {\r\n                    color: 'transparent'\r\n                }\r\n            }\r\n        },\r\n        label: {\r\n            normal: {\r\n                formatter: params => {\r\n                    return '{cir|▴}';\r\n                },\r\n                rich: {\r\n                    cir: {\r\n                        fontSize: 40,\r\n                    },\r\n                }\r\n            },\r\n        },\r\n        data: dataRotate,\r\n        z: -1\r\n    },\r\n{\r\n            type: 'pie',\r\n            zlevel: 0,\r\n            silent: true,\r\n            startAngle: -147.5,\r\n            radius: ['59%', '58%'],\r\n            z: 1,\r\n            label: {\r\n                normal: {\r\n                    show: false\r\n                },\r\n            },\r\n            labelLine: {\r\n                normal: {\r\n                    show: false\r\n                }\r\n            },\r\n            data: Pie()\r\n        },{\r\n        type: 'gauge',\r\n        radius: '48%',\r\n        startAngle:'0',\r\n\t\tendAngle:'-359.99',\r\n        splitNumber: 30,\r\n        center: ['50%', '50%'],\r\n        pointer: {\r\n            show: false\r\n        },\r\n        title: {\r\n            show: false\r\n        },\r\n        detail: {\r\n            show: false\r\n        },\r\n        axisLine: {\r\n            lineStyle: {\r\n                width: 30,\r\n                color: [\r\n                    [0, '#5fa7ca'],\r\n                    [1, '#5fa7ca']\r\n                ],\r\n                opacity: 0\r\n            }\r\n        },\r\n        axisTick: {\r\n            length: 16,\r\n            lineStyle: {\r\n                color: 'auto'\r\n            }\r\n        },\r\n        splitLine: {\r\n            show: false\r\n        },\r\n        axisLabel: {\r\n            show: false,\r\n        }\r\n    },{\r\n    name: '第二层环',\r\n    type: 'pie',\r\n    z: 1,\r\n    tooltip: {\r\n        show: false\r\n    },\r\n    center: ['50%', '50%'],\r\n    radius: ['36%', '37%'],\r\n    hoverAnimation: false,\r\n    clockWise: false,\r\n    itemStyle: {\r\n        normal: {\r\n            borderWidth: 5,\r\n            shadowBlur: 15,\r\n            borderColor:'rgba(38,51,93,.3)',\r\n            shadowColor: 'rgba(38,51,93,.3)',\r\n            color: 'rgba(38,51,93,.95)',\r\n        },\r\n        emphasis: {\r\n            color: 'rgba(38,51,93,.95)',\r\n        }\r\n    },\r\n    label: {\r\n        show: false\r\n    },\r\n    data: [100]\r\n},{\r\n    name: '第一层环',\r\n    type: 'pie',\r\n    z: 1,\r\n    tooltip: {\r\n        show: false\r\n    },\r\n    center: ['50%', '50%'],\r\n    radius: ['29%', '33%'],\r\n    hoverAnimation: false,\r\n    clockWise: false,\r\n    itemStyle: {\r\n        normal: {\r\n            borderWidth: 5,\r\n            shadowBlur: 15,\r\n            borderColor:'rgba(255,255,255,.3)',\r\n            shadowColor: 'rgba(255,255,255,.3)',\r\n            color: 'rgba(255,255,255,.95)',\r\n        },\r\n        emphasis: {\r\n            color: 'rgba(255,255,255,.95)',\r\n        }\r\n    },\r\n    label: {\r\n        show: false\r\n    },\r\n    data: [100]\r\n},{\r\n    name: '最内层环',\r\n    type: 'pie',\r\n    z: 1,\r\n    tooltip: {\r\n        show: false\r\n    },\r\n    center: ['50%', '50%'],\r\n    radius: ['26%', '29%'],\r\n    hoverAnimation: false,\r\n    clockWise: false,\r\n    itemStyle: {\r\n        normal: {\r\n            borderWidth: 5,\r\n            shadowBlur: 15,\r\n            borderColor:'rgba(38,51,93,.3)',\r\n            shadowColor: 'rgba(38,51,93,.3)',\r\n            color: 'rgba(38,51,93,.95)',\r\n        },\r\n        emphasis: {\r\n            color: 'rgba(38,51,93,.95)',\r\n        }\r\n    },\r\n    label: {\r\n        show: false\r\n    },\r\n    data: [100]\r\n}];\r\noption = {\r\n    backgroundColor: '#0A2E5D',\r\n    color: color,\r\n    title: {\r\n        text: '',\r\n        top: '48%',\r\n        textAlign: \"center\",\r\n        left: \"49%\",\r\n        textStyle: {\r\n            color: '#fff',\r\n            fontSize: 22,\r\n            fontWeight: '400'\r\n        }\r\n    },\r\n    graphic: {\r\n        elements: [{\r\n            type: \"image\",\r\n            z: 3,\r\n            style: {\r\n                width: 178,\r\n                height: 178\r\n            },\r\n            left: 'center',\r\n            top: 'center',\r\n            position: [100, 100]\r\n        }]\r\n    },\r\n    tooltip: {\r\n        show: false\r\n    },\r\n    legend: {\r\n        itemWidth: 20,\r\n        itemHeight: 10,\r\n        orient: 'vertical',\r\n        data: legendData,\r\n        right: '8%',\r\n        align: 'right',\r\n        top: 'center',\r\n        textStyle: {\r\n            color: \"#fff\",\r\n            padding: [0,10,0,0]\r\n        },\r\n        itemGap: 40,\r\n        borderRadius:5,\r\n    },\r\n    toolbox: {\r\n        show: false\r\n    },\r\n    series: seriesOption\r\n}","html":"","externalScripts":"","updaterUID":"bd-3079028567","theme":"","layout":"","viewCount":65,"userName":"金***7","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xyXdvYCNdC.png?v=1611735039570","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-line","title"],"customTags":[],"updaterUserName":"金***7"}}