{"status":0,"data":{"cid":"xmWW3z5MLC","authorUid":"obd-ojDzE-xujyTCJS64xgvhQ6b1sM_MAEh","authorUserName":"自***篮","title":"审核流程 - 分行并行","description":"审核流程 - 分行并行","latestVersion":1,"alwaysLatest":1,"createTime":"2020-11-16T02:47:48.000Z","lastUpdateTime":"2020-11-16T02:47:48.000Z","auth":2,"uid":"obd-ojDzE-xujyTCJS64xgvhQ6b1sM_MAEh","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-11-16T02:47:48.000Z","code":"option = {\r\n    title: {\r\n        text: \"审核流程 \",\r\n    },\r\n    tooltip: {},\r\n    animationDurationUpdate: 1500,\r\n    animationEasingUpdate: \"quinticInOut\",\r\n    series: [{\r\n        type: \"graph\",\r\n        layout: \"none\",\r\n        symbolSize: 50,\r\n        roam: true,\r\n        label: {\r\n            show: true,\r\n        },\r\n        edgeSymbol: [\"circle\", \"arrow\"],\r\n        edgeSymbolSize: [4, 8],\r\n        edgeLabel: {\r\n            fontSize: 10,\r\n        },\r\n        data: [],\r\n        // links: [],\r\n        links: [],\r\n        lineStyle: {\r\n            color: \"#12b5d0\",\r\n            opacity: 0.9,\r\n            width: 1,\r\n            curveness: 0,\r\n            type: \"dashed\",\r\n        },\r\n        // 图形样式\r\n        itemStyle: {\r\n            normal: {\r\n                color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [{\r\n                        offset: 0,\r\n                        color: \"#157eff\",\r\n                    },\r\n                    {\r\n                        offset: 1,\r\n                        color: \"#35c2ff\",\r\n                    },\r\n                ]),\r\n            },\r\n        },\r\n    }, ],\r\n};\r\nvar end = [{\r\n    name: \"结束\",\r\n    x: 100,\r\n    y: 0,\r\n}, ];\r\nvar start = [{\r\n    name: \"开始\",\r\n    x: 100,\r\n    y: 100,\r\n}, ];\r\nvar iList = [];\r\nvar eList = [];\r\nvar data = [{\r\n        nodeDo: \"初审\",\r\n        nodeSort: 1,\r\n        nodeTypeName: \"并行\",\r\n        userRoleName: \"副经理\",\r\n    },\r\n    {\r\n        nodeDo: \"终审\",\r\n        nodeSort: 1,\r\n        nodeTypeName: \"并行\",\r\n        userRoleName: \"经理\",\r\n    },\r\n    {\r\n        nodeDo: \"复审\",\r\n        nodeSort: 2,\r\n        nodeTypeName: \"分行\",\r\n        userRoleName: \"主管\",\r\n    },\r\n    {\r\n        nodeDo: \"终审\",\r\n        nodeSort: 3,\r\n        nodeTypeName: \"并行\",\r\n        userRoleName: \"刘副总经理\",\r\n    },\r\n    {\r\n        nodeDo: \"终审\",\r\n        nodeSort: 3,\r\n        nodeTypeName: \"并行\",\r\n        userRoleName: \"张副总经理\",\r\n    },\r\n    {\r\n        nodeDo: \"终审\",\r\n        nodeSort: 3,\r\n        nodeTypeName: \"并行\",\r\n        userRoleName: \"李副总经理\",\r\n    },\r\n    {\r\n        nodeDo: \"复审\",\r\n        nodeSort: 4,\r\n        nodeTypeName: \"分行\",\r\n        userRoleName: \"总经理\",\r\n    },\r\n];\r\n\r\nfunction fun_Ilist(i) {\r\n    iList.map((ei) => {\r\n        obj = {\r\n            source: \"\",\r\n            target: \"\",\r\n        };\r\n        if (newData[ei].nodeSort === newData[i].nodeSort - 1) {\r\n            obj.source = newData[ei].name;\r\n            obj.target = newData[i].name;\r\n            option.series[0].links = [\r\n                ...option.series[0].links,\r\n                obj,\r\n            ];\r\n        }\r\n    });\r\n}\r\n\r\nfunction fun_Elist(i) {\r\n    eList.map((e) => {\r\n        obj.source = newData[e].name;\r\n        obj.target = newData[i].name;\r\n    });\r\n}\r\nvar newData = [...start, ...data, ...end];\r\nfor (let i = 0; i < newData.length; i++) {\r\n    for (let key in newData[i]) {\r\n        if (key === \"userRoleName\") {\r\n            newData[i].name = newData[i][key];\r\n            newData[i].x = 100;\r\n            newData[i].y = 100;\r\n        }\r\n    }\r\n    // 分行 x不变 y加100\r\n    // 并行 x加100 y不变\r\n    var obj = {\r\n        source: \"\",\r\n        target: \"\",\r\n    };\r\n    if (i === 0) {\r\n        eList.push(i);\r\n    }\r\n    if (i > 0) {\r\n        if (newData[i].nodeTypeName === \"并行\" && i == newData[i].nodeSort) {\r\n            iList.push(i);\r\n            newData[i].x = newData[i - 1].x + 100;\r\n            newData[i].y = newData[i].y + 100 * newData[i].nodeSort;\r\n            obj.source = newData[i - 1].name;\r\n            obj.target = newData[i].name;\r\n        } else if (\r\n            newData[i].nodeTypeName === \"并行\" &&\r\n            newData[i].nodeSort < i\r\n        ) {\r\n            newData[i].x = newData[i - 1].x + 100;\r\n            newData[i].y = newData[i].y + 100 * newData[i].nodeSort;\r\n            fun_Elist(i);\r\n            if (newData[i].nodeSort - 1 === newData[i - 1].nodeSort) {\r\n                obj.source = newData[i - 1].name;\r\n                obj.target = newData[i].name;\r\n            }\r\n            iList.push(i);\r\n        } else if (newData[i].nodeSort) {\r\n            eList.push(i);\r\n            newData[i].x = 100;\r\n            newData[i].y = newData[i].y + 100 * newData[i].nodeSort;\r\n            obj.source = newData[i - 1].name;\r\n            obj.target = newData[i].name;\r\n            if (newData[i].nodeSort - 1 === newData[i - 1].nodeSort) {\r\n                obj.source = newData[i - 1].name;\r\n                obj.target = newData[i].name;\r\n            }\r\n            fun_Ilist(i);\r\n        } else {\r\n            newData[i].x = 100;\r\n            newData[i].y = newData[i].y + 100 * newData[i - 1].nodeSort + 200;\r\n            obj.source = newData[i - 1].name;\r\n            obj.target = newData[i].name;\r\n        }\r\n    }\r\n    option.series[0].links.push(obj);\r\n}\r\noption.series[0].data = newData;","html":"","externalScripts":"","updaterUID":"obd-ojDzE-xujyTCJS64xgvhQ6b1sM_MAEh","theme":"","layout":"","viewCount":1732,"userName":"自***篮","commentCount":0,"starCount":7,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xmWW3z5MLC.png?v=1605494869115","isCustomThumbnail":0,"builtinTags":["category-work","series-graph","title","tooltip"],"customTags":[],"updaterUserName":"自***篮"}}