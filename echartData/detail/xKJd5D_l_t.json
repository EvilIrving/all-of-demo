{"status":0,"data":{"cid":"xKJd5D_l_t","authorUid":"obd-ojYROKFu3ArVZ4EDhCezjbZSUemJQE2","authorUserName":"风***发","title":"关系图设置","description":"","latestVersion":10,"alwaysLatest":0,"createTime":"2021-12-27T07:14:19.000Z","lastUpdateTime":"2021-12-30T05:50:16.000Z","auth":2,"uid":"obd-ojYROKFu3ArVZ4EDhCezjbZSUemJQE2","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":10,"parentVersion":9,"echartsVersion":"5.2.2","versionCreateTime":"2021-12-30T05:50:16.000Z","code":"var listData = [\n    {\n        name: '根节点1',\n        value: 0,\n        draggable: false,\n        fixed: true,\n        x: 100, //myChart.getWidth() - 100\n        y: myChart.getHeight() / 2,\n        list: [\n            {\n                name: '节点1',\n                value: 1,\n                list: [\n                    { name: '节点1-1-1', value: '1-1-1' },\n                    { name: '节点1-1-2', value: '1-1-2' },\n                    { name: '节点1-1-3', value: '1-1-3' },\n                    { name: '节点1-1-4', value: '1-1-4' },\n                    { name: '节点1-1-5', value: '1-1-5' },\n                ],\n            },\n            {\n                name: '节点2',\n                value: 2,\n                list: [\n                    { name: '节点1-2-1', value: '1-2-1' },\n                    { name: '节点1-2-2', value: '1-2-2' },\n                    { name: '节点1-2-3', value: '1-2-3' },\n                    { name: '节点1-2-4', value: '1-2-4' },\n                    { name: '节点1-2-5', value: '1-2-5' },\n                ],\n            },\n            {\n                name: '节点3',\n                value: 3,\n                list: [\n                    { name: '节点1-3-1', value: '1-3-1' },\n                    { name: '节点1-3-2', value: '1-3-2' },\n                    { name: '节点1-3-3', value: '1-3-3' },\n                    { name: '节点1-3-4', value: '1-3-4' },\n                    {\n                        name: '节点1-3-51111',\n                        value: '1-3-5111',\n                        list: [\n                            { name: '节点1-3-111', value: '1-3-1' },\n                            { name: '节点1-3-2111', value: '1-3-2' },\n                            { name: '节点1-3-311', value: '1-3-3' },\n                            { name: '节点1-3-4111', value: '1-3-4' },\n                            { name: '节点1-3-511', value: '1-3-5' },\n                        ]\n                    },\n                ],\n            },\n        ],\n    },\n];\nvar listSon = listData[0].list; //除一级节点外\nvar legend = []; //二级节点列表 [val]\nvar categories = []; //二级节点列表 {name:val}\nvar list = [];\nvar links = []; // source: '源节点名称', target: '目标节点名称'\nlistSon.forEach((item) => {\n    legend.push(item.name);\n    categories.push({ name: item.name });\n});\n\nhandleList(JSON.parse(JSON.stringify(listData)), 0);\nhandleLinks(JSON.parse(JSON.stringify(listData)), 0);\n\n//  计算list\nfunction handleList(arr, idx, color, category) {\n    arr.forEach((item, index) => {\n        if (item.name === null) {\n            return false;\n        }\n        // 设置节点大小\n        let symbolSize = 10;\n        // 每个节点所对应的文本标签的样式。\n        let label = null;\n        if (idx === 0) {\n            //根节点\n            symbolSize = 130;\n            label = {\n                position: 'inside',\n                rotate: 0,\n                fontSize: 22,\n                fontWeight: 'bold',\n                color: '#FFFFFF',\n            };\n        } else if (idx === 1) {\n            //一级节点\n            symbolSize = 60;\n            label = {\n                position: 'right',\n                rotate: 0,\n                fontSize: 15,\n                distance: 0,\n                fontWeight: 'bold',\n                color: '#F4BE18',\n            };\n        } else {\n            symbolSize = 20;\n            label = {\n                fontSize: 12,\n                color: '#D0C7AD',\n            };\n        }\n\n        //浮窗 前面圆颜色设置\n        if (idx === 0) {\n            //根节点\n            bgcolor = 'blue';\n        } else {\n            //一级节点\n            bgcolor = 'red';\n        }\n        let itemStyle = null;\n        if (item.list && item.list.length !== 0) {\n            //非子节点\n            itemStyle = {\n                borderColor: '#000',\n                color: bgcolor,\n            };\n        } else {\n            //子节点\n            itemStyle = {\n                color: 'transparent',\n                borderColor: '#ccc',\n            };\n        }\n        //实现节点发光效果\n        itemStyle = Object.assign(itemStyle, {\n            shadowColor: 'rgba(202, 144, 3, 0.5)',\n            shadowBlur: 20,\n        });\n\n        if (idx == 1) {\n            category = item.name;\n        }\n        let obj = {\n            name: item.name,\n            symbolSize: symbolSize,\n            category: category,\n            label,\n            color: bgcolor,\n            itemStyle,\n        };\n        obj = Object.assign(item, obj);\n        list.push(obj);\n        if (item.list && item.list.length > 0) {\n            handleList(item.list, idx + 1, color, category);\n        }\n    });\n}\n// 计算links\nfunction handleLinks(arr, index) {\n    arr.forEach((item) => {\n        if (item.list) {\n            item.list.forEach((item2, eq) => {\n                let lineStyle = null;\n                if (index === 0) {\n                    //一级二级中间节点的线\n                    lineStyle = {\n                        normal: {\n                            color: 'rgba(255,255,255,0.3)', //线\n                            width: 3,\n                        },\n                    };\n                } else {\n                    lineStyle = {\n                        normal: {\n                            color: 'rgba(255,255,255,0.5)', //线\n                            width: 1,\n                        },\n                    };\n                }\n                let obj = {\n                    source: item.name,\n                    target: item2.name,\n                    value: 1111, //连接线上文字\n                    lineStyle,\n                };\n                links.push(obj);\n                if (item2.list && item.list.length > 0) {\n                    handleLinks(item.list, index + 1);\n                }\n            });\n        }\n    });\n}\n\noption = {\n    backgroundColor: '#020f3c',\n    tooltip: {},\n    toolbox: {\n        show: true,\n        left: 'right',\n        right: 20,\n        top: 'bottom',\n        bottom: 20,\n    },\n    legend: {\n        show: true,\n        data: legend,\n        textStyle: {\n            color: '#fff',\n            fontSize: 10,\n        },\n        // inactiveColor: \"#fff\",\n        icon: 'circle',\n        type: 'scroll',\n        orient: 'vertical',\n        left: 'right',\n        right: 20,\n        top: 20,\n        bottom: 80,\n        // itemWidth: 12,\n        // itemHeight: 12,\n        pageIconColor: '#00f6ff',\n        pageIconInactiveColor: '#fff',\n        pageIconSize: 12,\n        pageTextStyle: {\n            color: '#fff',\n            fontSize: 12,\n        },\n    },\n    selectedMode: 'false',\n    bottom: 20,\n    left: 0,\n    right: 0,\n    confine: true,\n    top: 0,\n    animationDuration: 1500,\n    animationEasingUpdate: 'quinticInOut',\n    series: [\n        {\n            name: '知识图谱',\n            type: 'graph',\n            hoverAnimation: true,\n            layout: 'force',\n            force: {\n                repulsion: [-2, 100], //节点之间的斥力因子。支持数组表达斥力范围，值越大斥力越大。\n                gravity: 0.03, //节点受到的向中心的引力因子。该值越大节点越往中心点靠拢。\n                edgeLength: [20, 200], //边的两个节点之间的距离，这个距离也会受 repulsion:[10, 50]值越小则长度越长\n                layoutAnimation: true,\n            },\n            nodeScaleRatio: 0.6,\n            draggable: true,\n            roam: false, //鼠标缩放和平移\n            symbol: 'circle',\n            data: list,\n            links: links,\n            categories: categories,\n            cursor: 'pointer',\n            focusNodeAdjacency: true,\n            scaleLimit: {\n                //所属组件的z分层，z值小的图形会被z值大的图形覆盖\n                min: 0, //最小的缩放值\n                max: 9, //最大的缩放值\n            },\n            // edgeSymbol: ['circle', 'arrow'],\n            // edgeSymbolSize: [4, 8],\n            edgeLabel: {\n                //连接线上文字\n                normal: {\n                    show: true,\n                    textStyle: {\n                        fontSize: 10,\n                    },\n                    formatter: '{c}',\n                },\n            },\n            label: {\n                normal: {\n                    show: true,\n                    position: 'right',\n                    color: '#fff',\n                    distance: 10,\n                },\n            },\n            lineStyle: {\n                normal: {\n                    width: 1.5,\n                    curveness: 0,\n                    type: 'solid',\n                },\n            },\n        },\n    ],\n};\n","html":"","externalScripts":"","updaterUID":"obd-ojYROKFu3ArVZ4EDhCezjbZSUemJQE2","theme":"","layout":"","viewCount":0,"userName":"风***发","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xKJd5D_l_t.png?v=1640843416977","isCustomThumbnail":0,"builtinTags":["category-work","legend","series-graph","toolbox","tooltip"],"customTags":[],"updaterUserName":"风***发"}}