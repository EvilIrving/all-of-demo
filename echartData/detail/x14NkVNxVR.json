{"status":0,"data":{"cid":"x14NkVNxVR","authorUid":"bd-184588791","authorUserName":"r***e","title":"子弹图","description":"","latestVersion":13,"alwaysLatest":1,"createTime":"2019-03-02T15:53:47.000Z","lastUpdateTime":"2019-03-02T15:53:47.000Z","auth":2,"uid":"bd-184588791","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":13,"parentVersion":12,"echartsVersion":"4.2.1","versionCreateTime":"2019-05-29T15:49:53.000Z","code":"const itemStyle = {\r\n    \"type\": \"bar\",\r\n    \"barWidth\": 50,\r\n    \"barGap\": \"-130%\",\r\n    \"silent\": true,\r\n    \"stack\": \"指标范围\",\r\n}\r\n\r\n\r\nconst color = '#fff';\r\nconst hideAxis = {\r\n    show: false\r\n};\r\n\r\noption = {\r\n    backgroundColor: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n            offset: 0,\r\n            color: '#0e2147'\r\n        },\r\n        {\r\n            offset: 1,\r\n            color: '#111c4e'\r\n        }\r\n    ], false),\r\n    \"toolbox\": {\r\n        \"feature\": {\r\n            \"saveAsImage\": {}\r\n        }\r\n    },\r\n    \"tooltip\": {\r\n        backgroundColor: 'rgba(255,255,255,0.95)',\r\n        extraCssText: 'padding:20px;color:#999;border-radius:5px;box-shadow: 0 0 7px rgba(0, 0, 0, 0.6);',\r\n        textStyle: {\r\n            color: '#333',\r\n        },\r\n        \"trigger\": \"axis\",\r\n        \"axisPointer\": {\r\n            \"type\": \"shadow\"\r\n        },\r\n        formatter(params) {\r\n            let [target, actual, ...levels] = params;\r\n            levels = levels.map(({\r\n                seriesName,\r\n                value\r\n            }) => ({\r\n                seriesName,\r\n                value,\r\n            }));\r\n            levels.forEach((_, idx) => {\r\n                if (idx) {\r\n                    levels[idx].value += levels[idx - 1].value;\r\n                }\r\n            });\r\n            let curLevel = -1;\r\n            levels.forEach((item, idx) => {\r\n                if (actual.value >= item.value) {\r\n                    curLevel = idx;\r\n                }\r\n            });\r\n\r\n            let curText = levels[curLevel + 1].seriesName;\r\n\r\n            let levelDst = R.clone(levels).map((item, idx) => {\r\n                item.value = idx === 0 ? `0 ~ ${levels[idx].value}` : `${levels[idx - 1].value} ~ ${levels[idx].value}`;\r\n                return item;\r\n            });\r\n\r\n            let detail = [target, actual, ...levelDst]\r\n                .map(({\r\n                    seriesName,\r\n                    value\r\n                }) => `${seriesName}: ${value}`)\r\n                .join('<br>');\r\n            return `${target.name}<strong style=\"color:#f67;\"> (${curText}) </strong><br><br>\r\n        ${detail} \r\n        `;\r\n        },\r\n    },\r\n    \"legend\": {\r\n        \"data\": [\"目标值\", , \"实际值\", \"低于较差值\", \"较差值\", \"中间值\", \"良好值\", \"优秀值\"].map(name => ({\r\n            name,\r\n            \"icon\": \"circle\",\r\n\r\n        })),\r\n        \"selectedMode\": false,\r\n        right: 20,\r\n        top: 40,\r\n        textStyle: {\r\n            color\r\n        }\r\n    },\r\n    grid: {\r\n        y: 100\r\n    },\r\n    \"title\": [{\r\n        \"text\": \"子弹图示例\",\r\n        subtext: '点击查看纵向版本',\r\n        sublink: 'https://gallery.echartsjs.com/editor.html?c=xiOkfPsqyl',\r\n        \"textStyle\": {\r\n            \"fontSize\": 30,\r\n            \"fontWeight\": 200,\r\n            color\r\n        },\r\n        top: 20,\r\n        left: 140\r\n    }, {\r\n        \"text\": \"数据来源：xxx\",\r\n        \"borderWidth\": 0,\r\n        \"textStyle\": {\r\n            \"fontSize\": 10,\r\n            \"fontWeight\": \"normal\",\r\n            color\r\n        },\r\n        \"x\": 5,\r\n        \"y2\": 0\r\n    }, {\r\n        \"text\": \"©xx公司\",\r\n        \"borderColor\": color,\r\n        \"borderWidth\": 0,\r\n        \"textStyle\": {\r\n            \"fontSize\": 10,\r\n            \"fontWeight\": \"normal\",\r\n            color\r\n        },\r\n        \"x\": \"right\",\r\n        \"y2\": 3\r\n    }],\r\n    \"yAxis\": {\r\n        \"data\": [\"品种1\", \"品种2\", \"品种3\", \"品种4\", \"品种5\"],\r\n        \"axisLine\": hideAxis,\r\n        \"axisTick\": hideAxis,\r\n        axisLabel: {\r\n            textStyle: {\r\n                color\r\n            }\r\n        },\r\n    },\r\n    \"xAxis\": {\r\n        \"splitLine\": hideAxis,\r\n        axisLabel: {\r\n            textStyle: {\r\n                color\r\n            }\r\n        },\r\n        \"axisTick\": {\r\n            textStyle: {\r\n                color\r\n            }\r\n        },\r\n        axisLine: hideAxis\r\n    }, \r\n    \"series\": [{\r\n        \"type\": \"bar\",\r\n        id: 'target',\r\n        \"name\": \"目标值\",\r\n        data: new Array(5).fill(0).map(item => Math.ceil(40 + Math.random() * 60)),\r\n        \"barWidth\": 30,\r\n        \"z\": 9,\r\n        itemStyle: {\r\n            normal: {\r\n                show: 'true',\r\n                barBorderRadius: [0,30,30,0],\r\n                color: new echarts.graphic.LinearGradient(0, 1, 1, 0, [\r\n                    {\r\n                        offset: 1,\r\n                        color: '#00feff'\r\n                    },\r\n                    {\r\n                        offset: 0.5,\r\n                        color: '#027eff'\r\n                    },\r\n                    {\r\n                        offset: 0,\r\n                        color: '#0286ff'\r\n                    }\r\n                ]),\r\n                shadowColor: '#28f',\r\n                shadowOffsetX: 0,\r\n                shadowOffsetY: 0,\r\n                shadowBlur: 30\r\n            },\r\n        }\r\n    }, {\r\n        \"type\": \"custom\",\r\n        id: 'actual',\r\n        \"name\": \"实际值\",\r\n        \"data\": new Array(5).fill(0).map(item => Math.ceil(40 + Math.random() * 60)),\r\n        \"z\": 10,\r\n        renderItem: (_, api) => {\r\n            const [x, y] = api.coord([api.value(0), api.value(1)]);\r\n            return {\r\n                type: 'group',\r\n                children: [{\r\n                    type: 'line',\r\n                    shape: {\r\n                        x1: x,\r\n                        x2: x,\r\n                        y1: y - 30,\r\n                        y2: y + 20,\r\n                    },\r\n                    style: {\r\n                        stroke: api.visual('color'),\r\n                        lineWidth: 6\r\n                    }\r\n                }],\r\n            };\r\n        },\r\n        itemStyle: {\r\n            normal: {\r\n                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                    offset: 0,\r\n                    color: '#fc3b05'\r\n                }, {\r\n                    offset: 1,\r\n                    color: '#f5104d'\r\n                }]),\r\n                shadowColor: '#fff',\r\n                shadowOffsetX: 0,\r\n                shadowOffsetY: 0,\r\n                shadowBlur: 30\r\n            }\r\n        }\r\n    }, {\r\n        ...itemStyle,\r\n        \"name\": \"低于较差值\",\r\n        \"data\": [60, 65, 70, 65, 65],\r\n        \"itemStyle\": {\r\n            \"color\": \"#FF636E\"\r\n        }\r\n    }, {\r\n        ...itemStyle,\r\n        \"name\": \"较差值\",\r\n        \"data\": [10, 10, 5, 5, 3],\r\n        \"itemStyle\": {\r\n            \"color\": \"#FFA39E\"\r\n        }\r\n    }, {\r\n        ...itemStyle,\r\n        \"name\": \"中间值\",\r\n        \"data\": [10, 10, 5, 12, 3],\r\n        \"itemStyle\": {\r\n            \"color\": \"#FFD591\"\r\n        }\r\n    }, {\r\n        ...itemStyle,\r\n        \"name\": \"良好值\",\r\n        \"data\": [10, 10, 10, 8, 3],\r\n        \"itemStyle\": {\r\n            \"color\": \"#91D5FF\"\r\n        }\r\n    }, {\r\n        ...itemStyle,\r\n        \"name\": \"优秀值\",\r\n        \"data\": [10, 5, 10, 10, 26],\r\n        \"itemStyle\": {\r\n            \"color\": \"#A7E8B4\"\r\n        }\r\n    }]\r\n}\r\n\r\nlet myChart = echarts.getInstanceByDom(document.querySelector(\"#chart-panel\"));\r\nsetInterval(() => {\r\n    myChart.setOption({\r\n        series: [{\r\n            id: 'target',\r\n            data: new Array(5).fill(0).map(item => Math.ceil(40 + Math.random() * 60))\r\n        }, {\r\n            id: 'actual',\r\n            \"data\": new Array(5).fill(0).map(item => Math.ceil(40 + Math.random() * 60))\r\n        }]\r\n    })\r\n}, 2000)","html":"","externalScripts":"https://cdn.bootcss.com/ramda/0.25.0/ramda.min.js","updaterUID":"bd-184588791","theme":"","layout":"","viewCount":53389,"userName":"r***e","commentCount":1,"starCount":19,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x14NkVNxVR.png?v=1559144993231","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","series-custom","title","toolbox","tooltip"],"customTags":[],"updaterUserName":"r***e"}}