{"status":0,"data":{"cid":"x0A9jQ8a1j","authorUid":"obd-oEZ_5QIXj0M0iAp8XBpMaIFmcHqS24i","authorUserName":"雨***图","title":"Hong Kong Tooltip轮播","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2020-04-27T03:29:56.000Z","lastUpdateTime":"2020-04-27T03:29:56.000Z","auth":2,"uid":"obd-oEZ_5QIXj0M0iAp8XBpMaIFmcHqS24i","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.7.0","versionCreateTime":"2020-04-27T03:29:56.000Z","code":"myChart.showLoading();\r\n\r\nvar geoCoordMap = {\r\n  Aberdeen: [114.154527, 22.248614],\r\n  Tsimshatsui: [114.171552, 22.296108],\r\n  \"Lai Chi Kok\": [114.138628, 22.338379],\r\n  Fanling: [114.143703, 22.500478],\r\n  \"Tuen Mun\": [113.964351, 22.381489],\r\n  \"Sham Shui\": [114.159874, 22.331216],\r\n  \"Tai Po\": [114.168684, 22.444209],\r\n  \"Tuen Mun\": [113.976737, 22.393006],\r\n  Sanpokong: [114.196315, 22.336025],\r\n  Central: [114.156604, 22.282287],\r\n  Mongkok: [114.169249, 22.318697],\r\n  \"Chai Wan\": [114.24899, 22.262842],\r\n};\r\n\r\nvar convertData = function (data) {\r\n  var res = [];\r\n  for (var i = 0; i < data.length; i++) {\r\n    var dataName = data[i].name;\r\n    for (var key in geoCoordMap) {\r\n      var geoCoord = geoCoordMap[key];\r\n      if (dataName.indexOf(key) > -1) {\r\n        res.push({\r\n          name: data[i].name,\r\n          value: geoCoord.concat(data[i].value),\r\n          visualMap: true,\r\n        });\r\n        break;\r\n      }\r\n    }\r\n  }\r\n  return res;\r\n};\r\n//定义geo不同颜色的区域块\r\nvar regionsList = [\r\n  //对不同的区块进行着色\r\n  {\r\n    name: \"North\", //区块名称\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#177CC8\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Tai Po\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#177DC9\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Sha Tin\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#1584CB\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Central and Western\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#2553A8\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Eastern\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#3782CE\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Islands\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#1583CA\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Kowloon City\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#1C7EBE\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Kwai Tsing\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#2E8FCE\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Kwun Tong\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#2B79C7\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Sai Kung\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#1B6FC4\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Sham Shui Po\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#1659D6\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Southern\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#2089C4\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Tsuen Wan\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#418DDE\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Tuen Mun\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#2257C4\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Wan Chai\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#3782CE\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Wong Tai Sin\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#3176DB\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Yau Tsim Mong\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#226AD3\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Yuen Long\",\r\n    itemStyle: {\r\n      normal: {\r\n        areaColor: \"#1B60C4\",\r\n      },\r\n    },\r\n  },\r\n];\r\nvar max = 100; //期望生成的最小值\r\nvar min = 20; //期望生成的最大值\r\nvar randomData = [\r\n  {\r\n    name: \"Tsimshatsui\",\r\n    value: Math.floor(Math.random() * (200 - 140 + 1) + 140),\r\n  },\r\n  {\r\n    name: \"Lai Chi Kok\",\r\n    value: Math.floor(Math.random() * (max - min + 1) + min),\r\n  },\r\n  {\r\n    name: \"Aberdeen\",\r\n    value: Math.floor(Math.random() * (max - min + 1) + min),\r\n  },\r\n  {\r\n    name: \"Fanling\",\r\n    value: Math.floor(Math.random() * (max - min + 1) + min),\r\n  },\r\n  {\r\n    name: \"Tuen Mun\",\r\n    value: Math.floor(Math.random() * (max - min + 1) + min),\r\n  },\r\n  {\r\n    name: \"Sham Shui\",\r\n    value: Math.floor(Math.random() * (max - min + 1) + min),\r\n  },\r\n  {\r\n    name: \"Tai Po\",\r\n    value: Math.floor(Math.random() * (max - min + 1) + min),\r\n  },\r\n  {\r\n    name: \"Tuen Mun\",\r\n    value: Math.floor(Math.random() * (max - min + 1) + min),\r\n  },\r\n  {\r\n    name: \"Sanpokong\",\r\n    value: Math.floor(Math.random() * (max - min + 1) + min),\r\n  },\r\n  {\r\n    name: \"Central\",\r\n    value: Math.floor(Math.random() * (max - min + 1) + min),\r\n  },\r\n  {\r\n    name: \"Mongkok\",\r\n    value: Math.floor(Math.random() * (max - min + 1) + min),\r\n  },\r\n  {\r\n    name: \"Chai Wan\",\r\n    value: Math.floor(Math.random() * (max - min + 1) + min),\r\n  },\r\n];\r\nvar NumDescSort = function (a, b) {\r\n  return a.value - b.value;\r\n};\r\nrandomData = randomData.sort(NumDescSort);\r\nconsole.log(convertData(randomData));\r\n$.get(\"https://echarts.apache.org/examples/data/asset/geo/HK.json\", function (geoJson) {\r\n  myChart.hideLoading();\r\n  echarts.registerMap(\"HK\", geoJson);\r\n\r\n  myChart.setOption(\r\n    (option = {\r\n      backgroundColor: \"#404a59\",\r\n      title: [\r\n        {\r\n          text: \"Hong Kong XXX Store Network Latency\",\r\n          x: \"center\",\r\n          y: \"top\",\r\n          textStyle: {\r\n            fontSize: 15,\r\n            color: \"#fff\",\r\n          },\r\n        },\r\n        {\r\n          text: \"Tsimshatsui anomaly detection\",\r\n          top: 60,\r\n          left: '6%',\r\n          textStyle: {\r\n            color: \"#FB977F\",\r\n            fontSize: 15,\r\n          },\r\n        },\r\n      ],\r\n      tooltip: {\r\n        trigger: \"item\",\r\n        formatter: \"{b}<br/>{c} (p / km2)\",\r\n      },\r\n      visualMap: {\r\n        calculable: true,\r\n        inRange: {\r\n          color: [\"#50a3ba\", \"#eac736\", \"#FC021D\"],\r\n        },\r\n        textStyle: {\r\n          color: \"#fff\",\r\n        },\r\n        seriesIndex: 0,\r\n      },\r\n      geo: {\r\n        map: \"HK\",\r\n        top: 100,\r\n        left: \"9%\",\r\n        bottom: \"14%\",\r\n        zoom: 1.1,\r\n        visualMap: true,\r\n        itemStyle: {\r\n          emphasis: {\r\n            areaColor: \"#2a333d\",\r\n          },\r\n        },\r\n        label: {\r\n          normal: {\r\n            show: true,\r\n            color: \"#01DAFF\",\r\n            fontSize: 10,\r\n          },\r\n          emphasis: {\r\n            color: \"#878787\",\r\n            fontSize: 10,\r\n          },\r\n        },\r\n        regions: regionsList,\r\n      },\r\n      grid: [\r\n        {\r\n          right: 40,\r\n          top: 60,\r\n          bottom: 70,\r\n          width: \"28%\",\r\n        },\r\n      ],\r\n      xAxis: [\r\n        {\r\n          position: \"top\",\r\n          type: \"value\",\r\n          boundaryGap: false,\r\n          axisLabel: {\r\n            formatter: \"{value} ms\",\r\n            textStyle: {\r\n              color: \"#c3dbff\", //更改坐标轴文字颜色\r\n              fontSize: 10, //更改坐标轴文字大小\r\n            },\r\n          },\r\n          splitLine: {\r\n            show: false,\r\n          },\r\n          axisLine: {\r\n            show: false,\r\n          },\r\n          axisTick: {\r\n            show: false,\r\n          },\r\n        },\r\n      ],\r\n      yAxis: [\r\n        {\r\n          type: \"category\",\r\n          data: [],\r\n          axisTick: {\r\n            alignWithLabel: true,\r\n          },\r\n        },\r\n      ],\r\n      series: [\r\n        {\r\n          z: 1,\r\n          type: \"effectScatter\",\r\n          legendHoverLink: true,\r\n          coordinateSystem: \"geo\",\r\n          data: convertData(randomData),\r\n          symbolSize: 10,\r\n          showEffectOn: \"render\",\r\n          rippleEffect: {\r\n            brushType: \"stroke\",\r\n          },\r\n          hoverAnimation: true,\r\n          label: {\r\n            normal: {\r\n              formatter: \"{b}\",\r\n              position: \"left\",\r\n              textStyle: {\r\n                color: \"#FFD857\",\r\n                fontSize: 10,\r\n              },\r\n\r\n              show: true,\r\n            },\r\n            emphasis: {\r\n              formatter: \"{b}\",\r\n              show: true,\r\n            },\r\n          },\r\n          tooltip: {\r\n            formatter: function (v) {\r\n              return v.name + \" : \" + v.data.value[2] + \" ms\";\r\n            },\r\n          },\r\n          itemStyle: {\r\n            normal: {\r\n              color: \"#f4e925\",\r\n              shadowBlur: 30,\r\n              shadowColor: \"#EE0000\",\r\n            },\r\n          },\r\n          visualMap: true,\r\n          zlevel: 1,\r\n        },\r\n        {\r\n          type: \"bar\",\r\n          // visualMap: true,\r\n          tooltip: {\r\n            formatter: function (v) {\r\n              return v.data.name + \" : \" + v.data.value + \" ms\";\r\n            },\r\n          },\r\n          itemStyle: {\r\n            normal: {\r\n              color: \"#599D44\",\r\n            },\r\n          },\r\n          label: {\r\n            normal: {\r\n              show: true,\r\n              formatter: \"{b}\",\r\n              position: \"insideLeft\",\r\n              textStyle: {\r\n                color: \"#FFFFFF\",\r\n                fontSize: 10,\r\n              },\r\n            },\r\n            emphasis: {\r\n              show: true,\r\n            },\r\n          },\r\n          data: randomData,\r\n        },\r\n      ],\r\n    })\r\n  );\r\n  var timer = 0;\r\n  var total = option.series[0].data.length;\r\n  var count = 0;\r\n  function autoTip() {\r\n    timer = setInterval(function () {\r\n      var curr = count % total;\r\n\r\n      //3.0以上版本的showTip使用方式\r\n      //myChart.dispatchAction({type: 'showTip', seriesIndex: '1', dataIndex: '1'});\r\n      myChart.dispatchAction({\r\n        type: \"showTip\",\r\n        seriesIndex: 0,\r\n        dataIndex: curr,\r\n      });\r\n      count += 1;\r\n    }, 5000);\r\n  }\r\n  autoTip();\r\n\r\n  //mousemove和mouseout总是成对出现，而且out先出现。。。。所以没法解决鼠标hover时暂停自动tip的效果\r\n  myChart.on(\"mousemove\", function (param) {\r\n    // console.log(\"move\");\r\n    if (timer) {\r\n      clearInterval(timer);\r\n      timer = 0;\r\n    }\r\n  });\r\n  myChart.on(\"mouseout\", function (param) {\r\n    // console.log(\"OUT\");\r\n    if (param.event) {\r\n      //判断坐标是否在图表上，然后在处理应该可以实现\r\n      if (!timer) {\r\n        autoTip();\r\n      }\r\n    }\r\n  });\r\n});\r\n","html":"","externalScripts":"","updaterUID":"obd-oEZ_5QIXj0M0iAp8XBpMaIFmcHqS24i","theme":"","layout":"","viewCount":1497,"userName":"雨***图","commentCount":0,"starCount":4,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x0A9jQ8a1j.png?v=1587958196340","isCustomThumbnail":0,"builtinTags":["category-work","geo","grid","series-bar","series-effectScatter","title","tooltip","visualMap"],"customTags":[],"updaterUserName":"雨***图"}}