{"status":0,"data":{"cid":"xQoymltvfg","authorUid":"obd-o-oz7gxKVkTTzW-2qxkUh4sEcxo4KAR","authorUserName":"131*****689","title":"柱状图+表格","description":"","latestVersion":3,"alwaysLatest":0,"createTime":"2021-06-18T09:41:17.000Z","lastUpdateTime":"2021-10-30T06:25:42.000Z","auth":1,"uid":"obd-o-oz7gxKVkTTzW-2qxkUh4sEcxo4KAR","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":3,"parentVersion":2,"echartsVersion":"5.1.2","versionCreateTime":"2021-10-30T06:25:42.000Z","code":"let dataArr = [\r\n    {\r\n         \"测试1\": 24,\r\n        \"测试2\": 12,\r\n        \"测试3\": 67,\r\n        \"测试4\": 54,\r\n        \"测试5\": 23,\r\n        \"测试6\": 56,\r\n        \"Title\": \"表头1\",\r\n    },\r\n    {\r\n        \"测试1\": 24,\r\n        \"测试2\": 78,\r\n        \"测试3\": 24,\r\n        \"测试4\": 22,\r\n        \"测试5\": 24,\r\n        \"测试6\": 56,\r\n        \"Title\": \"表头2\",\r\n    },\r\n    {\r\n         \"测试1\": 24,\r\n        \"测试2\": 12,\r\n        \"测试3\": 78,\r\n        \"测试4\": 66,\r\n        \"测试5\": 87,\r\n        \"测试6\": 56,\r\n        \"Title\": \"表头3\",\r\n    },\r\n    {\r\n        \"测试1\": 24,\r\n        \"测试2\": 54,\r\n        \"测试3\": 35,\r\n        \"测试4\": 75,\r\n        \"测试5\": 54,\r\n        \"测试6\": 56,\r\n        \"Title\": \"表头4\",\r\n    },\r\n    {\r\n        \"测试1\": 24,\r\n        \"测试2\": 87,\r\n        \"测试3\": 25,\r\n        \"测试4\": 57,\r\n        \"测试5\": 24,\r\n        \"测试6\": 56,\r\n        \"Title\": \"表头5\",\r\n    },\r\n    {\r\n       \"测试1\": 24,\r\n        \"测试2\": 75,\r\n        \"测试3\": 24,\r\n        \"测试4\": 35,\r\n        \"测试5\": 24,\r\n        \"测试6\": 56,\r\n        \"Title\": \"表头6\",\r\n    },\r\n    {\r\n       \"测试1\": 24,\r\n        \"测试2\": 77,\r\n        \"测试3\": 57,\r\n        \"测试4\": 85,\r\n        \"测试5\": 24,\r\n        \"测试6\": 56,\r\n        \"Title\": \"表头7\",\r\n    },\r\n    {\r\n        \"测试1\": 24,\r\n        \"测试2\": 7,\r\n        \"测试3\": 75,\r\n        \"测试4\": 12,\r\n        \"测试5\": 24,\r\n        \"测试6\": 56,\r\n        \"Title\": \"表头8\",\r\n    }\r\n];\r\n// 取表头\r\nlet tableHead = [];\r\nfor(var e = 0;e < dataArr.length;e++) {\r\n    tableHead.push(dataArr[e].Title);\r\n}\r\nlet totalArr = [];\r\n// 左侧标题\r\nvar letftTitle = [\"测试1\",\"测试2\",\"测试3\",\"测试4\"];\r\nfunction SeriesData() {\r\n    let arr = [];\r\n    for(var i = 0;i < letftTitle.length;i++) {\r\n        let arr2 = [];\r\n        for(var e = 0;e < tableHead.length;e++) {\r\n            let obj = dataArr.find(x => x.Title == tableHead[e]);\r\n            if(Object.keys(obj).find(x => x == letftTitle[i])){\r\n                let a = obj[Object.keys(obj).find(x => x == letftTitle[i])];\r\n                arr2.push(a);\r\n            }\r\n        }\r\n        // 将数据汇总\r\n        totalArr.push(arr2);\r\n         let obj = {\r\n            name: letftTitle[i],\r\n            type: 'bar',\r\n            label: {\r\n                show: true,\r\n                position: 'top',\r\n            },\r\n            yAxisIndex: 0,\r\n            data: arr2,\r\n        }\r\n        arr.push(obj);\r\n    }\r\n    return arr;\r\n}\r\nfunction fucIcon() {\r\n    let obj = {};\r\n    for(var i = 0;i < letftTitle.length;i++) {\r\n        obj[i] =  {fontSize: 20,color: color[i]};\r\n    }\r\n    return obj;\r\n}\r\n// 左侧标题显示\r\nfunction ForName(NameArr) {\r\nlet TitleName = '';\r\nfor (var i = 0; i < NameArr.length; i++) {\r\n    TitleName += '{'+i+'|●}' + NameArr[i] + '\\n';\r\n}\r\nreturn TitleName;\r\n}\r\n// 绘制表格线\r\nfunction getTableLine(num) {\r\nvar list = [];\r\nvar bottom = (letftTitle.length * 30)  + 65; // 可根据表格行数高度动态调整\r\nvar height = 30; // 表格线行高\r\n// 循环绘制表格\r\nfor (var i = 0; i < num; i++) {\r\n    list.push({\r\n        type: 'line',\r\n        bottom: bottom - i * height,\r\n        right: 80,\r\n        style: {\r\n            fill: '#333',\r\n        }, \r\n        // 线条\r\n        shape: {\r\n            x1: 0,\r\n            y1: 0,\r\n            x2: 2000,\r\n            y2: 0,\r\n        },\r\n    });\r\n}\r\nreturn list;\r\n}\r\n// 绘制表格线行数\r\nvar lineList = getTableLine(letftTitle.length+1);\r\n// 绘制表格数据\r\nfunction DrawTable(value) {\r\nlet str = '';\r\nstr += '{table|' + value +'}\\n{table|';\r\nfor (let i = 0; i < totalArr.length; i++) {\r\n    str += totalArr[i][i] +'}\\n{table|'\r\n}\r\nstr += '}';\r\nreturn str;\r\n}\r\nlet color = ['#5470c6', '#fac858', '#73c0de','#ee6666','#3ba272','#fc8452','#9a60b4','#ea7ccc'];\r\noption = {\r\n// 颜色配置\r\ncolor: color,\r\nlegend: {\r\n    orient: 'horizontal',\r\n    top: 10,\r\n    data: letftTitle\r\n    },\r\n// 左侧标题配置\r\ntitle: [\r\n    {   \r\n        text: ForName(letftTitle),\r\n        bottom: 45 - letftTitle.length,\r\n        left: 0,\r\n        textStyle: {\r\n            lineHeight: 30,\r\n            fontSize: 13,\r\n            fontWeight: 'normal',\r\n            formatter: function (value) {\r\n                return '{table|' + value + '}';\r\n            },\r\n            rich: fucIcon()\r\n        },\r\n    },\r\n],\r\n// 表格边距配置\r\ngrid: {\r\n    bottom: (letftTitle.length * 30) + 100, // 可根据表格行数动态调整高度\r\n    left: 100,\r\n    right: 80,\r\n    top:50\r\n},\r\ntoolbox: {\r\n    show: true,\r\n    feature: {\r\n        saveAsImage: {},\r\n    },\r\n},\r\ndataZoom: {\r\n    show: true,\r\n    realtime: true,\r\n    start: 0,\r\n    end: 50\r\n},\r\nxAxis: [\r\n    {\r\n        type: 'category',\r\n        boundaryGap: true,\r\n        data: tableHead,\r\n        axisTick: {\r\n            length: (letftTitle.length * 30) + 35,\r\n        },\r\n        axisLabel: {\r\n            formatter: function (value, index) {\r\n                var indexNum = 0;\r\n                for (var i = 0; i < tableHead.length; i++) {\r\n                    if (value == tableHead[i]) {\r\n                        indexNum = i;\r\n                    }\r\n                }\r\n                return (DrawTable(value));\r\n            },\r\n            rich: {\r\n                table: {\r\n                    height: 30, //表格内数据行高\r\n                    lineHeight:30,\r\n                    align: 'center',\r\n                    verticalAlign: 'bottom',\r\n                },\r\n            },\r\n        },\r\n    },\r\n],\r\nyAxis: [\r\n    {\r\n        type: 'value',\r\n        scale: true,\r\n        minInterval: 1,\r\n        splitLine: {\r\n            show: false,\r\n        },\r\n        min: function (v) {\r\n            return Math.max(v.min - 10, 0);\r\n        },\r\n    },\r\n],\r\nseries: SeriesData(),\r\ngraphic: lineList,\r\n};\r\n","html":"","externalScripts":"","updaterUID":"obd-o2TLuyFj1eWRan2xZfwbrlyW3fHvT6j","theme":"","layout":"","viewCount":0,"userName":"131*****689","commentCount":1,"starCount":8,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xQoymltvfg.png?v=1635575142774","isCustomThumbnail":0,"builtinTags":["category-work","dataZoom","graphic","grid","legend","series-bar","title","toolbox"],"customTags":[],"updaterUserName":"w***3"}}