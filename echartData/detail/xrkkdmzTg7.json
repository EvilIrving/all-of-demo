{"status":0,"data":{"cid":"xrkkdmzTg7","authorUid":"bd-17147066","authorUserName":"oyai32","title":"轮播环形图","description":"多个时间维度多个项目的故障值与目标值的对比，当故障值大于目标值则为红色","latestVersion":2,"alwaysLatest":1,"createTime":"2018-06-12T09:33:26.000Z","lastUpdateTime":"2018-06-12T09:33:26.000Z","auth":2,"uid":"bd-17147066","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.1.0","versionCreateTime":"2018-06-12T09:44:55.000Z","code":"var chartData = {\r\n    \"timelineData\": [\r\n        \"1月\", \"2月\", \"3月\"\r\n    ],\r\n    \"optionsData\": {\r\n        \"1月\": [{\r\n            \"fault\": 1,\r\n            \"target\": 5\r\n        }, {\r\n            \"fault\": 2,\r\n            \"target\": 6\r\n        }, {\r\n            \"fault\": 3,\r\n            \"target\": 7\r\n        }, {\r\n            \"fault\": 8,\r\n            \"target\": 5\r\n        }],\r\n        \"2月\": [{\r\n            \"fault\": 2,\r\n            \"target\": 5\r\n        }, {\r\n            \"fault\": 3,\r\n            \"target\": 6\r\n        }, {\r\n            \"fault\": 1,\r\n            \"target\": 7\r\n        }, {\r\n            \"fault\": 2,\r\n            \"target\": 5\r\n        }],\r\n        \"3月\": [{\r\n            \"fault\": 4,\r\n            \"target\": 5\r\n        }, {\r\n            \"fault\": 9,\r\n            \"target\": 6\r\n        }, {\r\n            \"fault\": 5,\r\n            \"target\": 7\r\n        }, {\r\n            \"fault\": 5,\r\n            \"target\": 5\r\n        }]\r\n    },\r\n    \"xData\": [\"系统1\", \"系统2\", \"系统3\", \"系统4\"]\r\n};\r\n\r\n\r\n\r\nvar dataMap = {};\r\n\r\nfunction getColor(obj) {\r\n    if (obj.fault > obj.target) {\r\n        return ['#EA1644', \"rgba(212,212,212,0.3)\"]\r\n    }\r\n    return ['#27EBBD', \"rgba(212,212,212,0.3)\"];\r\n}\r\n\r\n//格式化好每月的数据\r\nfunction dataFormatter(obj) {\r\n    var temp;\r\n    var objMap = {};\r\n    for (var key of Object.keys(obj)) {\r\n        temp = obj[key];\r\n        objMap[key] = [];\r\n\r\n        for (var i = 0, l = temp.length; i < l; i++) {\r\n            objMap[key][i * 2] = {\r\n                data: [{\r\n                        value: temp[i].target,\r\n                        name: '',\r\n                        itemStyle: {\r\n                            opacity: 0\r\n                        },\r\n                        label: {\r\n                            show: false\r\n                        }\r\n                    },\r\n                    {\r\n                        value: temp[i].fault,\r\n                        name: `故障\\n${temp[i].fault}`,\r\n                        itemStyle: {\r\n                            color: getColor(temp[i])[0]\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n            objMap[key][i * 2 + 1] = {\r\n                data: [{\r\n                        value: temp[i].fault,\r\n                        name: '',\r\n                        itemStyle: {\r\n                            opacity: 0\r\n                        },\r\n                        label: {\r\n                            show: false\r\n                        }\r\n                    },\r\n                    {\r\n                        value: temp[i].target,\r\n                        name: `目标\\n${temp[i].target}`,\r\n                        itemStyle: {\r\n                            color: getColor(temp[i])[1]\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    return objMap;\r\n}\r\n\r\n\r\n\r\nfunction optionsFormatter() {\r\n    var optData = [];\r\n    for (var value of chartData.timelineData) {\r\n        optData.push({\r\n            series: dataMap.dataGDP[value]\r\n\r\n        });\r\n    }\r\n\r\n    return optData;\r\n}\r\n\r\nfunction seriesFormatter() {\r\n    var seriesData = [];\r\n    const oneSeries = {\r\n        type: 'pie',\r\n        selectedMode: 'single',\r\n        label: {\r\n            normal: {\r\n                position: 'inner'\r\n            }\r\n        },\r\n        labelLine: {\r\n            normal: {\r\n                show: false\r\n            }\r\n        },\r\n    };\r\n    var preArr = ['12%', '37%', '62%', '87%']\r\n\r\n\r\n    for (var i = 0; i < chartData.xData.length; i++) {\r\n        seriesData.push({\r\n            type: 'pie',\r\n            selectedMode: 'single',\r\n            radius: ['15%', '18%'],\r\n            center: [`${preArr[i]}`, '47%'],\r\n            label: {\r\n                normal: {\r\n                    position: 'inner'\r\n                }\r\n            },\r\n            labelLine: {\r\n                normal: {\r\n                    show: false\r\n                }\r\n            },\r\n        })\r\n        seriesData.push({\r\n            type: 'pie',\r\n            selectedMode: 'single',\r\n            radius: ['12%', '15%'],\r\n            center: [`${preArr[i]}`, '47%'],\r\n            label: {\r\n                normal: {\r\n                    position: 'inner'\r\n                }\r\n            },\r\n            labelLine: {\r\n                normal: {\r\n                    show: false\r\n                }\r\n            },\r\n        })\r\n    }\r\n\r\n    return seriesData;\r\n}\r\n\r\ndataMap.dataGDP = dataFormatter(chartData.optionsData);\r\n\r\noption = {\r\n\r\n    baseOption: {\r\n        backgroundColor: {\r\n            type: 'linear',\r\n            x: 0,\r\n            y: 0,\r\n            x2: 1,\r\n            y2: 1,\r\n            colorStops: [{\r\n                offset: 0, color: '#0f2c70' // 0% 处的颜色\r\n            }, {\r\n                offset: 1, color: '#091732' // 100% 处的颜色\r\n            }],\r\n            globalCoord: false // 缺省为 false\r\n        },\r\n        timeline: {\r\n            show: true,\r\n            bottom: 150,\r\n            axisType: 'category',\r\n            // realtime: false,\r\n            // loop: false,\r\n            autoPlay: true,\r\n            currentIndex: 0,\r\n            playInterval: 3000,\r\n            // controlStyle: {\r\n            //     position: 'left'\r\n            // },\r\n            data: chartData.timelineData,\r\n            itemStyle: {\r\n                color: '#27C4F8'\r\n            },\r\n            label: {\r\n                textStyle: {\r\n                    color: '#d0d0d0'\r\n                }\r\n            },\r\n            lineStyle: {\r\n                color: '#57657c'\r\n            },\r\n            checkpointStyle: {\r\n                color: '#27C4F8',\r\n                borderColor: 'rgba(39,196,248,0.5)'\r\n            },\r\n            controlStyle: {\r\n                color: '#57657c',\r\n                borderColor: '#57657c'\r\n            },\r\n            emphasis: {\r\n                controlStyle: {\r\n                    color: '#27C4F8',\r\n                    borderColor: '#27C4F8'\r\n                },\r\n                itemStyle: {\r\n                    color: '#27C4F8'\r\n                },\r\n            }\r\n        },\r\n        series: seriesFormatter()\r\n    },\r\n    options: optionsFormatter()\r\n};","html":"","externalScripts":"","updaterUID":"bd-17147066","theme":"","layout":"","viewCount":1266,"userName":"oyai32","commentCount":0,"starCount":8,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xrkkdmzTg7.png?v=1528796695169","isCustomThumbnail":0,"builtinTags":["category-work","series-pie","timeline"],"customTags":[],"updaterUserName":"oyai32"}}