{"status":0,"data":{"cid":"x1Kv_2iwN","authorUid":"bd-2545319","authorUserName":"i***绘","title":"折线图标注","description":"利用echarts为异常标注系统制作的折线图标注工具，可获取标注区域数据，但是数据量大时性能较差，配合dataZoom使用时，放大区域也会触发brushSelect。希望能得到优化和问题解决","latestVersion":1,"alwaysLatest":1,"createTime":"2019-10-25T08:57:52.000Z","lastUpdateTime":"2019-10-25T08:57:52.000Z","auth":2,"uid":"bd-2545319","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.4.0","versionCreateTime":"2019-10-25T08:57:52.000Z","code":"var chartData = {\r\n    name: 'theDemo',\r\n    lower: [],\r\n    upper: [],\r\n    timestamp: [],\r\n    value: [],\r\n\r\n};\r\nfor (var i = 0; i < 1000; i++) {\r\n    chartData.value[i] = Math.ceil(Math.random() * 10);\r\n    chartData.lower[i] = chartData.value[i] - 1\r\n    chartData.upper[i] = chartData.value[i] + 2\r\n    chartData.timestamp[i] = i + 1\r\n}\r\nvar markData = []\r\nvar option = {\r\n    title: {\r\n        show: true,\r\n        text: chartData.name,\r\n        textStyle: {\r\n            fontSize: 14\r\n        },\r\n        top: 10\r\n    },\r\n    grid: {\r\n        left: 40,\r\n        right: 40\r\n    },\r\n    xAxis: {\r\n        type: \"category\",\r\n        boundaryGap: false,\r\n        data: chartData.timestamp\r\n    },\r\n    brush: {\r\n        toolbox: [\"lineX\", \"clear\"],\r\n        transformable: false,\r\n        seriesIndex: \"all\",\r\n        throttleType: \"debounce\",\r\n        xAxisIndex: 0,\r\n        throttleDelay: 1000,\r\n        brushMode: \"multiple\",\r\n        // brushStyle: {\r\n        //     color: \"transparent\",\r\n        //     borderWidth: 0\r\n        // }\r\n    },\r\n    tooltip: {\r\n        show: false,\r\n    },\r\n    yAxis: [{\r\n        type: \"value\"\r\n    }],\r\n\r\n    series: [{\r\n            name: \"line\",\r\n            type: \"line\",\r\n            data: chartData.value,\r\n            symbol: \"none\",\r\n            lineStyle: {\r\n                color: \"#00a2ff\",\r\n                width: 1\r\n            },\r\n            showSymbol: false,\r\n            sampling: \"average\",\r\n            showAllSymbol: false,\r\n            markArea: {\r\n                data: markData\r\n            }\r\n        },\r\n        {\r\n            name: \"line\",\r\n            type: \"line\",\r\n            data: chartData.anomaly,\r\n            symbol: \"none\",\r\n            lineStyle: {\r\n                color: \"red\",\r\n                width: 1\r\n            },\r\n            showSymbol: false,\r\n            sampling: \"average\",\r\n            showAllSymbol: false\r\n        },\r\n        {\r\n            name: \"lineBtm\",\r\n            type: \"line\",\r\n            stack: \"lb\", // 两根线这个字段值设置就会叠加\r\n            data: chartData.lower,\r\n            symbol: \"none\",\r\n            lineStyle: {\r\n                color: \"transparent\"\r\n            },\r\n            showSymbol: false,\r\n            sampling: \"average\",\r\n            showAllSymbol: false\r\n        },\r\n        {\r\n            name: \"lineTop\",\r\n            type: \"line\",\r\n            areaStyle: {\r\n                color: \"#bedbff\"\r\n            }, // 设置此属性就会填充颜色\r\n            stack: \"lb\",\r\n            data: chartData.upper,\r\n            symbol: \"none\",\r\n            lineStyle: {\r\n                color: \"transparent\"\r\n            },\r\n            showSymbol: false,\r\n            sampling: \"average\",\r\n            showAllSymbol: false\r\n        }\r\n    ]\r\n};\r\nmyChart.setOption(option)\r\nmyChart.off(\"brush\");\r\nmyChart.on(\"brushSelected\", params => {\r\n\r\n    if (params.batch[0].areas.length > 0) {\r\n        var xSelect = params.batch[0].areas[0].coordRange;\r\n        markData.push([{\r\n                xAxis: chartData.timestamp[xSelect[0]],\r\n                itemStyle: {\r\n                    color: \"rgba(255,70,70,0.3)\"\r\n                }\r\n            },\r\n            {\r\n                xAxis: chartData.timestamp[xSelect[1]]\r\n            }\r\n        ]);\r\n        console.log(xSelect) //选中区域起点和终点\r\n        myChart.setOption(option);\r\n    }\r\n\r\n})","html":"","externalScripts":"","updaterUID":"bd-2545319","theme":"","layout":"","viewCount":715,"userName":"i***绘","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x1Kv_2iwN.png?v=1571993872645","isCustomThumbnail":0,"builtinTags":["brush","category-work","grid","markArea","series-line","title","toolbox","tooltip"],"customTags":[],"updaterUserName":"i***绘"}}