{"status":0,"data":{"cid":"x7cxD71fIE","authorUid":"bd-3778831175","authorUserName":"m***i","title":"上海地铁可视化","description":"上海地铁可视化","latestVersion":1,"alwaysLatest":1,"createTime":"2019-01-17T07:23:19.000Z","lastUpdateTime":"2019-01-17T07:23:19.000Z","auth":2,"uid":"bd-3778831175","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.2.0","versionCreateTime":"2019-01-17T07:23:19.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1547704761530-PZeTnGn7R.json\";\nconst symbol = 'image://data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEd0lEQVRYR8WXa2hcRRTH//+7DxKXaENaRK1N0odGY7K59w6KplAf9EMRxFT0Q1tUBD+IRVsUi22plaoUfOPjkyJSURStD4qCUlpEMejcu7vBJEKgttUq1iKYkqR6d++RWXbDZnM3u4mUzLd755wzvznzn5kzxDyb7/tpEVkJYCmAZSJyGsBPzc3NI93d3X/NMxzYiIPWehWAe0luAdBRy0dEfiZ5REQOt7W1Hezs7DxXL/6cAENDQ61BEOwRka0k4/WCVfWfIrnTtu0DJKWWb00ArfWtJA8AaJ3nwNXm34nIbUqpM1FxZgEMDw8np6amniX5ULWDiEyRfB/Aico+mimK2AAuBeBG+J20LGuD4zgj1X2zADzP+wjAxkpDETlJcldTU9Pn9YSmte4yqQewGYBVjiMif5O83nXd0RnwlR9a6wdIvl5F+bWIbFBKTZr/2Wz22kKhMAjMFLCI/O667nKSobHzff/qMAzfIWkyU2wi8isAu3I5pjOQy+WuCYLAJ5moAMjF4/H+dDo9Uf6XzWYvy+fzRljTsysF/00ptakSPpfLLQ+CYIRkSwXE90qp68rf0wBa629I9lel/mal1JH/I0LP814BsLUq7mal1LvmXxFAa30nyQ9mCYTsINlaKBReXAiEUuom3/d3iMj+KoBjruteQbJQBPA871sAN0Sotz0Wi60Mw3BBWXBdl1EAxZmTmxzHeY+jo6Ntk5OTf1aLqrSu5w1ARD5VSt1uCO8TkTejUiwi5w0AwL+pVGopPc97FcCDiwAAy7LWGoCDAAZqASilTi5EgGWfWhooLfFd1FoPkpzel1VqbT/PANtMBnIAehcpA4+bDHxJcv1iAJC8xwC8TfLuRQJYb5ZgL4An5gLIZDI32rZ9tFExZjKZJQCW2LZ9fC4RxuPxiw2Aub91jeDp0tVsALe7rvtSIxCe5x0H0G5Zll0oFO4guTvilPWVUm75LjhBckVE8GdE5AeSH4vIgFLqkwYBsiLSkUgk7Hw+b3yiRP6k67p7y3eBKSCejqA8Z1nWRsdxvmhk4EobrXWC5GsA7o+IGySTya7e3t5jRYBcLpcKgsBkoS3COA9glTkPjF5EZF0dmJdNpnzf3y0i+2po63ml1KPFS6ls4HneNgCzrl0R2aOU2meEFYZhI0tw1KS2VFsOkbyyCuJ0KpVa3dXVdXYGgIjEfN8/DKByhoOO4/SXy6wFLEMPSSPwZMk3tCzrlsodNaMoHRsbu3B8fNwDsBrARDKZvKqnp+eX0vvg4UYBTO2nlHrD2Huetx3AC6Wzv5jNyjizqmKttdkNX5Hc77ruW6UguwA81SgAgDAWi63o6+s7VfI3Z4jvOM4j1Y+UyIeJ1voiAIdIrp3HoJGmInLWsqwtjuN8FmUw18vIbKOdIvIYyQsWAGLKc3PM73Acx1Rcka3u41RrfQlJcyANkDSZqdcmROTDRCLxXDqd/rGecV2AcgARsTKZjBOG4TqSl4vIMvM8J2lewGdE5A/LsnRLS8uhNWvW/FNv4HL/f4hdX+MrfW87AAAAAElFTkSuQmCC';\n\n//image://http://xxx.xxx.xxx/a/b.png\n\nfunction formatLngLat(str) {\n    if (str.includes(';')) {\n        const strArr = str.split(';');\n        const lnglats = strArr.map(lnglat => {\n            const ll = lnglat.split(',');\n            return [parseFloat(ll[0]), parseFloat(ll[1])];\n        });\n        return lnglats;\n    } else {\n        const ll = str.split(',');\n        return [parseFloat(ll[0]), parseFloat(ll[1])];\n    }\n}\n\n\nfetch(uploadedDataURL).then(res => res.json()).then(json => {\n    console.log(json);\n    const data = [],\n        names = [],\n        colors = [];\n    let stationData = [];\n    json.forEach(lines => {\n        lines.forEach(line => {\n            const buslines = line.buslines;\n            buslines.forEach(busline => {\n                const {\n                    polyline,\n                    name,\n                    color,\n                    stations\n                } = busline;\n                const lnglats = formatLngLat(polyline);\n                data.push({\n                    coords: lnglats,\n                    name: name,\n                    lineStyle: {\n                        normal: {\n                            // color: color,\n                            width: 3\n                        }\n                    }\n                });\n                names.push(name);\n                if (colors.length > 0) {\n                    if (color != colors[colors.length - 1]) {\n                        colors.push(color);\n                    }\n                } else {\n                    colors.push(color);\n                }\n                const sts = stations.map(station => {\n                    const {\n                        location,\n                        name\n                    } = station;\n                    const lnglat = formatLngLat(location);\n                    return {\n                        value: lnglat.concat(20),\n                        name: name\n                    }\n                })\n                stationData = stationData.concat(sts);\n            });\n        });\n    });\n    const option = getOption();\n    data.forEach(line => {\n        const serier = {\n            name: line.name,\n            type: 'lines',\n            coordinateSystem: 'bmap',\n            polyline: true,\n            data: [line],\n        };\n        option.series.push(serier);\n    });\n\n    option.series.push({\n        name: '地铁站',\n        type: 'scatter',\n        coordinateSystem: 'bmap',\n        symbol: symbol,\n        symbolSize: 15,\n        data: stationData\n    });\n    names.push('地铁站');\n    option.legend = {\n        top: 20,\n        textStyle: {\n            color: '#fff',\n        },\n        data: names,\n    };\n    option.color = colors;\n    console.log(option);\n    myChart.setOption(option);\n});\n\n\n\n\nfunction getOption() {\n    return {\n        title: {\n            text: 'ShangHai SubWay'\n        },\n        tooltip: {},\n        bmap: {\n            center: [121.44780229094795, 31.27769952977698],\n            zoom: 12,\n            roam: true,\n            mapStyle: {\n                'styleJson': [{\n                        'featureType': 'water',\n                        'elementType': 'all',\n                        'stylers': {\n                            'color': '#031628'\n                        }\n                    }, {\n                        'featureType': 'land',\n                        'elementType': 'geometry',\n                        'stylers': {\n                            'color': '#000102'\n                        }\n                    }, {\n                        'featureType': 'highway',\n                        'elementType': 'all',\n                        'stylers': {\n                            'visibility': 'off'\n                        }\n                    }, {\n                        'featureType': 'arterial',\n                        'elementType': 'geometry.fill',\n                        'stylers': {\n                            'color': '#000000'\n                        }\n                    }, {\n                        'featureType': 'arterial',\n                        'elementType': 'geometry.stroke',\n                        'stylers': {\n                            'color': '#0b3d51'\n                        }\n                    }, {\n                        'featureType': 'local',\n                        'elementType': 'geometry',\n                        'stylers': {\n                            'color': '#000000'\n                        }\n                    }, {\n                        'featureType': 'railway',\n                        'elementType': 'geometry.fill',\n                        'stylers': {\n                            'color': '#000000'\n                        }\n                    }, {\n                        'featureType': 'railway',\n                        'elementType': 'geometry.stroke',\n                        'stylers': {\n                            'color': '#08304b'\n                        }\n                    },\n                    {\n                        'featureType': 'subway',\n                        'elementType': 'geometry',\n                        'stylers': {\n                            'lightness': -70,\n                            'visibility': 'off'\n                        }\n                    },\n                    {\n                        'featureType': 'building',\n                        'elementType': 'geometry.fill',\n                        'stylers': {\n                            'color': '#000000'\n                        }\n                    }, {\n                        'featureType': 'all',\n                        'elementType': 'labels.text.fill',\n                        'stylers': {\n                            'color': '#857f7f'\n                        }\n                    }, {\n                        'featureType': 'all',\n                        'elementType': 'labels.text.stroke',\n                        'stylers': {\n                            'color': '#000000'\n                        }\n                    }, {\n                        'featureType': 'building',\n                        'elementType': 'geometry',\n                        'stylers': {\n                            'color': '#022338'\n                        }\n                    }, {\n                        'featureType': 'green',\n                        'elementType': 'geometry',\n                        'stylers': {\n                            'color': '#062032'\n                        }\n                    }, {\n                        'featureType': 'boundary',\n                        'elementType': 'all',\n                        'stylers': {\n                            'color': '#465b6c'\n                        }\n                    }, {\n                        'featureType': 'manmade',\n                        'elementType': 'all',\n                        'stylers': {\n                            'color': '#022338'\n                        }\n                    }, {\n                        'featureType': 'label',\n                        'elementType': 'all',\n                        'stylers': {\n                            'visibility': 'off'\n                        }\n                    }\n                ]\n            }\n        },\n\n        series: []\n    };\n}","html":"","externalScripts":"https://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM,/dep/echarts/latest/extension/bmap.min.js","updaterUID":"bd-3778831175","theme":"","layout":"","viewCount":3093,"userName":"m***i","commentCount":1,"starCount":18,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x7cxD71fIE.png?v=1547709800957","isCustomThumbnail":1,"builtinTags":["category-work"],"customTags":["bmap","lines"],"updaterUserName":"m***i"}}