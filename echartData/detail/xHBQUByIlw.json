{"status":0,"data":{"cid":"xHBQUByIlw","authorUid":"bd-1767830562","authorUserName":"s***l","title":"整体渐变地图-迁徙图","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2021-07-14T04:00:55.000Z","lastUpdateTime":"2021-07-14T04:00:55.000Z","auth":2,"uid":"bd-1767830562","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"5.1.2","versionCreateTime":"2021-07-14T04:00:55.000Z","code":"var datasJSON = \"/asset/get/s/data-1626235059731-_1Z3kz9Wj.json\";\n\nvar mapJSON = '/asset/get/s/data-1626233214001-gxlJKZykZ.json';\n\nvar mapOuterJSON = '/asset/get/s/data-1626233206360-0r-gjDCUj.json';\nvar centerImgBG = '',\n    centerImgIcon = '',\n    centerDatas;\n$.get(datasJSON, function (res) {\n    centerImgBG = res.centerImgBG;\n    centerImgIcon = res.centerImgIcon;\n    centerDatas = res.mapData;\n});\nvar geoCoordMap = {};\nvar mapDatas = [];\nvar fromData = {\n    center: [118.1064, 29.0004],\n    name: '市外',\n};\nvar fromImgBg = centerImgBG;\nvar fromImgIcon = centerImgIcon;\nvar series = [\n    {\n        type: 'scatter',\n        coordinateSystem: 'geo',\n        zlevel: 3,\n        label: {\n            show: false,\n        },\n        symbol: 'image://' + fromImgBg,\n        symbolSize: [196, 196],\n        itemStyle: {\n            normal: {\n                show: false,\n                color: '#34c6bb',\n            },\n        },\n        data: [{ name: fromData.name, value: fromData.center }],\n    },\n    {\n        type: 'scatter',\n        coordinateSystem: 'geo',\n        zlevel: 3,\n        label: {\n            show: true,\n            position: 'inside',\n            color: '#fff',\n            fontSize: 36,\n            fontWeight: 'bold',\n            formatter: function (params) {\n                return fromData.name;\n            },\n        },\n        symbol: 'image://' + fromImgIcon,\n        symbolSize: [118, 86],\n        itemStyle: {\n            normal: {\n                show: false,\n                color: '#34c6bb',\n            },\n        },\n        data: [{ name: fromData.name, value: fromData.center }],\n    },\n];\n$.each(centerDatas, function (i, item) {\n    geoCoordMap[item.name] = item.center;\n    mapDatas.push([item]);\n});\n\nvar convertData = function (data) {\n    var res = [];\n    for (var i = 0; i < data.length; i++) {\n        var dataItem = data[i];\n        var fromCoord = geoCoordMap[dataItem[0].name];\n        var toCoord = fromData.center;\n        if (fromCoord && toCoord) {\n            res.push([\n                {\n                    coord: toCoord,\n                },\n                {\n                    coord: fromCoord,\n                    value: dataItem[0].value,\n                },\n            ]);\n        }\n    }\n    return res;\n};\n[[fromData.name, mapDatas]].forEach(function (item, i) {\n    series.push(\n        {\n            type: 'lines',\n            zlevel: 3,\n            effect: {\n                show: true,\n                period: 4, //箭头指向速度，值越小速度越快\n                trailLength: 0.1, //特效尾迹长度[0,1]值越大，尾迹越长重\n                symbol: 'arrow', //箭头图标\n                symbolSize: 5, //图标大小\n                // color:'#fff'\n            },\n            lineStyle: {\n                normal: {\n                    color: '#00FFF6',\n                    width: 1, //尾迹线条宽度\n                    opacity: 1, //尾迹线条透明度\n                    curveness: 0.3, //尾迹线条曲直度\n                },\n            },\n            data: convertData(item[1]),\n        },\n        {\n            type: 'effectScatter',\n            coordinateSystem: 'geo',\n            zlevel: 4,\n            rippleEffect: {\n                period: 4, //动画时间，值越小速度越快\n                brushType: 'stroke', //波纹绘制方式 stroke, fill\n                scale: 4, //波纹圆环最大限制，值越大波纹越大\n            },\n            label: {\n                normal: {\n                    show: true,\n                    position: 'bottom', //显示位置\n                    color: '#fff',\n                    fontSize: 16,\n                    offset: [0, 0], //偏移设置\n                    formatter: function (params) {\n                        //圆环显示文字\n                        console.log(params);\n                        return [params.data.name, params.data.value[2] + '/' + (params.data.value[3].total || 0)].join(\n                            '\\n'\n                        );\n                    },\n                    fontSize: 13,\n                },\n                emphasis: {\n                    show: true,\n                },\n            },\n            symbol: 'circle',\n            symbolSize: function (val) {\n                return 5 + val[2] * 5; //圆环大小\n            },\n            itemStyle: {\n                normal: {\n                    color: '#00FFF6',\n                },\n            },\n            data: item[1].map(function (dataItem) {\n                return {\n                    name: dataItem[0].name,\n                    value: geoCoordMap[dataItem[0].name].concat([dataItem[0].value, dataItem[0]]),\n                };\n            }),\n        }\n    );\n});\n$.get(mapOuterJSON, function (json) {\n    echarts.registerMap('lsMap2', json);\n});\n$.get(mapJSON, function (json) {\n    echarts.registerMap('lsMap', json);\n    option = {\n        backgroundColor: 'transparent',\n        geo: [\n            {\n                boundingCoords: [\n                    // 定位左上角经纬度\n                    [118.1964, 29.3104],\n                    // 定位右下角经纬度\n                    [120.4706, 27.3864],\n                ],\n                map: 'lsMap',\n                aspectScale: 0.9,\n                roam: false, //是否允许缩放\n                //zoom: 1.1, //默认显示级别\n                layoutSize: '100%',\n                layoutCenter: ['55%', '50%'],\n                itemStyle: {\n                    areaColor: 'transparent',\n                    borderColor: 'rgba(68,157,255,1)',\n                    borderWidth: 2,\n                },\n                emphasis: {\n                    itemStyle: {\n                        areaColor: '#3c98ff',\n                    },\n                    label: {\n                        show: false,\n                    },\n                },\n                zlevel: 2,\n            },\n            {\n                boundingCoords: [\n                    // 定位左上角经纬度\n                    [118.1964, 29.3104],\n                    // 定位右下角经纬度\n                    [120.4706, 27.3864],\n                ],\n                map: 'lsMap2',\n                aspectScale: 0.9,\n                roam: false, //是否允许缩放\n                //zoom: 1.1, //默认显示级别\n                layoutSize: '100%',\n                layoutCenter: ['55%', '50%'],\n                // itemStyle: {\n                //     areaColor: 'rgba(22,56,196,1)',\n                //     // borderColor: '#37C1FD',\n                //     // borderWidth: 2,\n                // },\n                itemStyle: {\n                    areaColor: {\n                        type: 'linear',\n                        x: 0,\n                        y: 0,\n                        x2: 0,\n                        y2: 1,\n                        colorStops: [\n                            {\n                                offset: 0,\n                                color: '#008AFF', // 0% 处的颜色\n                            },\n                            {\n                                offset: 1,\n                                color: '#1638C4', // 100% 处的颜色\n                            },\n                        ],\n                        global: false, // 缺省为 false\n                    },\n                    borderColor: '#1493FF',\n                    borderWidth: 2,\n                },\n                zlevel: 1,\n                silent: true,\n            },\n        ],\n        series: series,\n    };\n    myChart.setOption(option);\n});\n","html":"","externalScripts":"","updaterUID":"bd-1767830562","theme":"","layout":"","viewCount":0,"userName":"s***l","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xHBQUByIlw.png?v=1626235255443","isCustomThumbnail":0,"builtinTags":["category-work","geo","series-effectScatter","series-lines","series-scatter"],"customTags":[],"updaterUserName":"s***l"}}