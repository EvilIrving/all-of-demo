{"status":0,"data":{"cid":"xorZIifJCg","authorUid":"bd-3071323166","authorUserName":"w***1","title":"系列分组","description":"","latestVersion":2,"alwaysLatest":1,"createTime":"2020-12-30T11:38:29.000Z","lastUpdateTime":"2020-12-30T11:38:29.000Z","auth":1,"uid":"bd-3071323166","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.8.0","versionCreateTime":"2020-12-30T11:51:37.000Z","code":"const source = {\n    \"DC1\": [{\n        \"sceneId\": 0,\n        \"sceneName\": \"基准场景\",\n        \"stockName\": \"DC1\",\n        \"productName\": \"SKU1\",\n        \"stockOutAmount\": 5,\n        \"stockOutWeight\": 10,\n        \"stockOutSquare\": 5,\n        \"stockInCost\": 5,\n        \"stockOutCost\": 10,\n        \"avgStockAmount\": 5,\n        \"storageCost\": 116.9,\n        \"stockHoldCost\": 66.8\n    }, {\n        \"sceneId\": 0,\n        \"sceneName\": \"基准场景\",\n        \"stockName\": \"DC1\",\n        \"productName\": \"SKU2\",\n        \"stockOutAmount\": 2,\n        \"stockOutWeight\": 3,\n        \"stockOutSquare\": 4,\n        \"stockInCost\": 2,\n        \"stockOutCost\": 4,\n        \"avgStockAmount\": 2,\n        \"storageCost\": 93.8,\n        \"stockHoldCost\": 40.2\n    }, {\n        \"sceneId\": 0,\n        \"sceneName\": \"基准场景\",\n        \"stockName\": \"DC1\",\n        \"productName\": \"SKU3\",\n        \"stockOutAmount\": 4,\n        \"stockOutWeight\": 6,\n        \"stockOutSquare\": 8,\n        \"stockInCost\": 4,\n        \"stockOutCost\": 8,\n        \"avgStockAmount\": 4,\n        \"storageCost\": 186.2,\n        \"stockHoldCost\": 79.8\n    }, {\n        \"sceneId\": 0,\n        \"sceneName\": \"基准场景\",\n        \"stockName\": \"DC1\",\n        \"productName\": \"SKU4\",\n        \"stockOutAmount\": 1,\n        \"stockOutWeight\": 2,\n        \"stockOutSquare\": 3,\n        \"stockInCost\": 1,\n        \"stockOutCost\": 2,\n        \"avgStockAmount\": 1,\n        \"storageCost\": 69.3,\n        \"stockHoldCost\": 33\n    }, {\n        \"sceneId\": 0,\n        \"sceneName\": \"基准场景\",\n        \"stockName\": \"DC1\",\n        \"productName\": \"SKU5\",\n        \"stockOutAmount\": 3,\n        \"stockOutWeight\": 6,\n        \"stockOutSquare\": 9,\n        \"stockInCost\": 3,\n        \"stockOutCost\": 6,\n        \"avgStockAmount\": 3,\n        \"storageCost\": 210,\n        \"stockHoldCost\": 80\n    }, {\n        \"sceneId\": 0,\n        \"sceneName\": \"基准场景\",\n        \"stockName\": \"DC1\",\n        \"productName\": \"SKU6\",\n        \"stockOutAmount\": 6,\n        \"stockOutWeight\": 12,\n        \"stockOutSquare\": 18,\n        \"stockInCost\": 6,\n        \"stockOutCost\": 12,\n        \"avgStockAmount\": 6,\n        \"storageCost\": 420,\n        \"stockHoldCost\": 160\n    }, {\n        \"sceneId\": 0,\n        \"sceneName\": \"基准场景\",\n        \"stockName\": \"DC1\",\n        \"productName\": \"SKU7\",\n        \"stockOutAmount\": 7,\n        \"stockOutWeight\": 3.5,\n        \"stockOutSquare\": 3.5,\n        \"stockInCost\": 7,\n        \"stockOutCost\": 14,\n        \"avgStockAmount\": 7,\n        \"storageCost\": 174.75,\n        \"stockHoldCost\": 46.6\n    }, {\n        \"sceneId\": 0,\n        \"sceneName\": \"基准场景\",\n        \"stockName\": \"DC1\",\n        \"productName\": \"SKU8\",\n        \"stockOutAmount\": 1,\n        \"stockOutWeight\": 0.5,\n        \"stockOutSquare\": 0.5,\n        \"stockInCost\": 1,\n        \"stockOutCost\": 2,\n        \"avgStockAmount\": 1,\n        \"storageCost\": 24.75,\n        \"stockHoldCost\": 6.6\n    }, {\n        \"sceneId\": 0,\n        \"sceneName\": \"基准场景\",\n        \"stockName\": \"DC1\",\n        \"productName\": \"SKU9\",\n        \"stockOutAmount\": 3,\n        \"stockOutWeight\": 0.3,\n        \"stockOutSquare\": 0.3,\n        \"stockInCost\": 3,\n        \"stockOutCost\": 6,\n        \"avgStockAmount\": 3,\n        \"storageCost\": 15,\n        \"stockHoldCost\": 10\n    }],\n    \"DC2\": [{\n        \"sceneId\": 0,\n        \"sceneName\": \"基准场景\",\n        \"stockName\": \"DC2\",\n        \"productName\": \"SKU1\",\n        \"stockOutAmount\": 60,\n        \"stockOutWeight\": 120,\n        \"stockOutSquare\": 60,\n        \"stockInCost\": 120,\n        \"stockOutCost\": 180,\n        \"avgStockAmount\": 60,\n        \"storageCost\": 1400,\n        \"stockHoldCost\": 800\n    }, {\n        \"sceneId\": 0,\n        \"sceneName\": \"基准场景\",\n        \"stockName\": \"DC2\",\n        \"productName\": \"SKU2\",\n        \"stockOutAmount\": 60,\n        \"stockOutWeight\": 90,\n        \"stockOutSquare\": 120,\n        \"stockInCost\": 120,\n        \"stockOutCost\": 180,\n        \"avgStockAmount\": 60,\n        \"storageCost\": 2800,\n        \"stockHoldCost\": 1200\n    }, {\n        \"sceneId\": 0,\n        \"sceneName\": \"基准场景\",\n        \"stockName\": \"DC2\",\n        \"productName\": \"SKU3\",\n        \"stockOutAmount\": 60,\n        \"stockOutWeight\": 90,\n        \"stockOutSquare\": 120,\n        \"stockInCost\": 120,\n        \"stockOutCost\": 180,\n        \"avgStockAmount\": 60,\n        \"storageCost\": 2800,\n        \"stockHoldCost\": 1200\n    }, {\n        \"sceneId\": 0,\n        \"sceneName\": \"基准场景\",\n        \"stockName\": \"DC2\",\n        \"productName\": \"SKU4\",\n        \"stockOutAmount\": 30,\n        \"stockOutWeight\": 60,\n        \"stockOutSquare\": 90,\n        \"stockInCost\": 60,\n        \"stockOutCost\": 90,\n        \"avgStockAmount\": 30,\n        \"storageCost\": 2100,\n        \"stockHoldCost\": 1000\n    }]\n}\n\n\nlet skuCount = 0\nlet productList = []\nfor (let key in source) {\n    const dcArr = source[key]\n    skuCount += (dcArr.length + 1)\n    productList = productList.concat(dcArr, [{\n        productName: '',\n    }])\n}\n\nlet series = []\nfor (let key in source) {\n    const num = source[key].length\n    series.push({\n        data: [{\n            name: key,\n            value: 1\n        }],\n        label: {\n            show: true,\n            position: 'inside',\n            formatter: '{b}',\n            textStyle: {\n                fontSize: 14,\n                color: '#000',\n                fontWeight: 'bold',\n            }\n        },\n        type: 'bar',\n        barGap: 0,\n        barWidth: `${(num)/skuCount*100}%`,\n        itemStyle: {\n            normal: {\n                // color: (params) => {\n                //   console.log(params)\n                //   let colors = ['#4150d8', '#28bf7e', '#ed7c2f', '#f2a93b', '#f9cf36', '#4a5bdc', '#4cd698', '#f4914e', '#fcb75b', '#ffe180', '#b6c2ff', '#96edc1']\n                //   return colors[params.dataIndex]\n                // },\n                // opacity: 0.4,\n                // color: 'rgba(0, 0, 0, 0)',\n            }\n        },\n        xAxisIndex: 1,\n        yAxisIndex: 1\n    }, {\n        type: 'bar',\n        barGap: 0,\n        barWidth: `${1/skuCount*100}%`,\n        xAxisIndex: 1,\n        yAxisIndex: 1\n    })\n}\n\nconst productNameList = productList.map(item => item.productName)\nconst stockOutAmountList = productList.map(item => item.stockOutAmount)\nconst avgStockAmountList = productList.map(item => item.avgStockAmount)\n\noption = {\n    toolbox: {\n        feature: {\n            saveAsImage: {},\n            restore: {},\n        }\n    },\n    tooltip: {\n        trigger: 'axis',\n        axisPointer: {\n            type: 'shadow'\n        }\n    },\n    axisPointer: {\n        link: {\n            xAxisIndex: 'all'\n        }\n    },\n    legend: {\n        data: ['出库量', '库存'],\n    },\n    grid: [{\n            top: 40,\n            height: 100,\n        },\n        {\n            height: 50,\n            top: 140\n        },\n        {\n            top: 190,\n            height: 100,\n        },\n    ],\n    xAxis: [{\n            type: 'category',\n            data: productNameList,\n            gridIndex: 0,\n            axisLabel: {\n                color: '#333',\n                margin: 4,\n            },\n            // axisLine: {\n            //   lineStyle: {\n            //     color: '#e7e7e7'\n            //   }\n            // },\n            axisTick: {\n                show: false,\n            },\n            zlevel: 2\n        },\n        {\n            type: 'category',\n            gridIndex: 1,\n            axisLine: {\n                show: false\n            },\n            zlevel: 3\n        },\n        {\n            position: 'top',\n            type: 'category',\n            data: productNameList,\n            gridIndex: 2,\n            axisLabel: {\n                color: '#333',\n                margin: 0,\n            },\n            // axisLine: {\n            //   lineStyle: {\n            //     color: '#e7e7e7'\n            //   }\n            // },\n            axisTick: {\n                show: false,\n            },\n            zlevel: 2\n        },\n    ],\n    yAxis: [{\n            type: 'value',\n            gridIndex: 0,\n            minInterval: 1,\n            axisLabel: {\n                color: '#333'\n            },\n            splitLine: {\n                show: false,\n            },\n            axisLine: {\n                lineStyle: {\n                    color: '#ccc'\n                }\n            },\n            axisTick: {\n                lineStyle: {\n                    color: '#ccc'\n                }\n            }\n        },\n        {\n            type: 'value',\n            gridIndex: 1,\n            axisLabel: {\n                show: false\n            },\n            axisLine: {\n                show: false\n            },\n            splitLine: {\n                show: false\n            },\n            axisTick: {\n                show: false\n            }\n        },\n        {\n            type: 'value',\n            inverse: true,\n            gridIndex: 2,\n            minInterval: 1,\n            axisLabel: {\n                color: '#333'\n            },\n            splitLine: {\n                show: false,\n            },\n            axisLine: {\n                lineStyle: {\n                    color: '#ccc'\n                }\n            },\n            axisTick: {\n                lineStyle: {\n                    color: '#ccc'\n                }\n            }\n        },\n    ],\n    series: [{\n            name: '出库量',\n            data: stockOutAmountList,\n            type: 'bar',\n            label: {\n                show: true,\n                position: 'top',\n                textStyle: {\n                    color: '#555'\n                }\n            },\n            itemStyle: {\n                normal: {\n                    color: '#5B9BD5',\n                }\n            },\n            xAxisIndex: 0,\n            yAxisIndex: 0,\n            // barWidth: '100%',\n        },\n        \n        ...series,\n        \n        {\n            name: '库存',\n            data: avgStockAmountList,\n            type: 'bar',\n            label: {\n                show: true,\n                position: 'bottom',\n                textStyle: {\n                    color: '#555'\n                }\n            },\n            itemStyle: {\n                normal: {\n                    color: '#DBDBDB',\n                }\n            },\n            xAxisIndex: 2,\n            yAxisIndex: 2,\n            // barWidth: '100%',\n        },\n    ]\n};","html":"","externalScripts":"","updaterUID":"bd-3071323166","theme":"","layout":"","viewCount":62,"userName":"w***1","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xorZIifJCg.png?v=1609329097461","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","toolbox","tooltip"],"customTags":[],"updaterUserName":"w***1"}}