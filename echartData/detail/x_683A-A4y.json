{"status":0,"data":{"cid":"x_683A-A4y","authorUid":"bd-1563239519","authorUserName":"ubflchi","title":"aa","description":"aaa","latestVersion":1,"alwaysLatest":1,"createTime":"2019-03-22T01:22:00.000Z","lastUpdateTime":"2019-03-22T01:22:00.000Z","auth":2,"uid":"bd-1563239519","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.2.1","versionCreateTime":"2019-03-22T01:22:00.000Z","code":"// 设置每个bar的颜色\r\nfunction setColor(index){\r\n  var colorList = ['#FF9983', '#038DFF', '#72DC93', '#8B87FF', '#00D3FF', '#C6CAD3'];\r\n  var length = colorList.length;\r\n  var Index = index;\r\n  function change(){\r\n    if(Index>=length) {\r\n      Index = Index-length;\r\n      change();\r\n    }\r\n  }\r\n  change();\r\n  return colorList[Index];\r\n}\r\n\r\n// 设置每个data的值\r\nfunction setData(item, index) {\r\n  var _array = [];\r\n  _array[index] = item.count;\r\n  for(var i=0; i<index;i++) {\r\n    _array[i] = 0\r\n  }\r\n  return _array;\r\n}\r\nvar orgResourceBySubject = [\r\n    {\r\n\t\t\"percentage\":\"0%\",\r\n\t\t\"count\":0,\r\n\t\t\"subjectName\":\"生物\"\r\n\t},\r\n\t{\r\n\t\t\"percentage\":\"0%\",\r\n\t\t\"count\":0,\r\n\t\t\"subjectName\":\"艺术\"\r\n\t},\r\n\t{\r\n\t\t\"percentage\":\"0%\",\r\n\t\t\"count\":0,\r\n\t\t\"subjectName\":\"历史\"\r\n\t},\r\n\t{\r\n\t\t\"percentage\":\"83.33%\",\r\n\t\t\"count\":15,\r\n\t\t\"subjectName\":\"语文\"\r\n\t},\r\n]\r\nvar chartData = [];\r\nvar chartNames = [];\r\nvar max = 0;\r\n// 初始化传入echarts的数据\r\nfunction getChartData() {\r\n  if(orgResourceBySubject.length<=0) {\r\n    return;\r\n  }\r\n  var list = [...orgResourceBySubject];\r\n  chartData = []; \r\n  var counts = []; // item.count的集合\r\n  var differences=[]; // 差值（最大值减去每个item.count）\r\n\r\n  list.forEach((item, index) => {\r\n    // echarts的series数据\r\n    chartData.push({\r\n      name: item.subjectName,\r\n      type: 'bar',\r\n      barGap:'-100%',\r\n      z: 3,\r\n      itemStyle: {\r\n        normal: {\r\n          color: setColor(index)\r\n        }\r\n      },\r\n      data: setData(item,index),\r\n      label: {\r\n        normal: {\r\n          formatter: function(data){\r\n            return list[data.dataIndex].percentage+' '+data.value+'个';\r\n          },\r\n          position: 'left',\r\n          offset: [250,0],\r\n          show: true,\r\n          color: '#666',\r\n        }\r\n      },\r\n    });\r\n    // 数据的‘数量’数组\r\n    counts.push(item.count);\r\n    chartNames.push(item.subjectName);\r\n    \r\n    // 设置最大值\r\n    max = max + item.count;\r\n  });\r\n\r\n  // 差值数组\r\n  counts.forEach(item => {\r\n    differences.push(max-item);\r\n  });\r\n  // 在尾巴添加一个底色\r\n  chartData.push({\r\n    type: 'bar',\r\n    stack: 'chart',\r\n    silent: true,\r\n    itemStyle: {\r\n      normal: {\r\n        color: '#eee'\r\n      }\r\n    },\r\n    data: differences\r\n  });\r\n}\r\n\r\noption = {\r\n        tooltip: {},\r\n        color: ['#FF9983', '#038DFF', '#72DC93', '#8B87FF', '#00D3FF', '#C6CAD3'],\r\n        legend: {\r\n          // data: yarray,\r\n          formatter: '{name}',\r\n          icon: 'circle',\r\n          itemWidth: 8,\r\n          itemHeight: 8,\r\n          borderRadius: 8,\r\n          textStyle: {\r\n            color: '#999999',\r\n            borderRadius: 8,\r\n          }\r\n        },\r\n        grid: [{\r\n          top: 0,\r\n          width: '100%',\r\n          bottom: 20,\r\n          left: 0,\r\n          right:0,\r\n          containLabel: true\r\n        }],\r\n        xAxis: [{\r\n          show: false,\r\n          type: 'value',\r\n          max: max,\r\n          splitLine: {\r\n            show: false\r\n          }\r\n        }],\r\n        yAxis: [{\r\n          type: 'category',\r\n          data: chartNames,\r\n          axisLabel: {\r\n            margin:16,\r\n            interval: 0,\r\n            color: '#333333',\r\n            fontFamily: \"PingFang SC\",\r\n            fontSize: 12\r\n          },\r\n          inverse: true,\r\n          axisLine:{       //y轴\r\n            show:false\r\n          },\r\n          axisTick:{\r\n            show:false\r\n          },\r\n          splitLine: {\r\n            show: false\r\n          },\r\n        }],\r\n        series: this.chartData\r\n      }","html":"","externalScripts":"","updaterUID":"bd-1563239519","theme":"","layout":"","viewCount":51,"userName":"ubflchi","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x_683A-A4y.png?v=1553217720420","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","tooltip"],"customTags":[],"updaterUserName":"ubflchi"}}