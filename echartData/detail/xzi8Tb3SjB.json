{"status":0,"data":{"cid":"xzi8Tb3SjB","authorUid":"obd-oNxO_0pSiX4Qhzuy4VZap5faODTirCs","authorUserName":"梦***呢","title":"立体柱状图","description":"","latestVersion":1,"alwaysLatest":0,"createTime":"2021-10-18T12:02:57.000Z","lastUpdateTime":"2021-10-18T12:02:57.000Z","auth":2,"uid":"obd-oNxO_0pSiX4Qhzuy4VZap5faODTirCs","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"5.2.1","versionCreateTime":"2021-10-18T12:02:57.000Z","code":"// mock 数据\nconst dataArr = {\n    xdata: ['01-01', '01-02', '01-03', '01-04', '01-05', '01-06', '01-07'],\n    result: [\n        { name: '天河', data: [0, 435, 490, 340, 320, 270, 0] },\n        { name: '海珠', data: [150, 220, 210, 310, 0, 180, 288] },\n        // { name: '荔湾', data: [250, 120, 240, 280, 240, 180, 188] },\n    ],\n};\n// 头部菱形\nconst diamondData = dataArr.result.reduce((pre, cur, index) => {\n    pre[index] = cur.data.map((el, id) => el + (pre[index - 1] ? pre[index - 1][id] : 0));\n    return pre;\n}, []);\n\n// color\nconst color = [['#0079FA'], ['#00FD9F'], ['#00C2FF'], ['#0EEBFF']];\nconst color1 = [\n    [\n        { offset: 0, color: '#0079FA' },\n        { offset: 0.5, color: '#009AFF' },\n        { offset: 1, color: '#0079FF' },\n    ],\n    [\n        { offset: 0, color: '#00FD9F' },\n        { offset: 0.5, color: '#44FFBA' },\n        { offset: 1, color: '#00FD9F' },\n    ],\n    [\n        { offset: 0, color: '#00C2FF' },\n        { offset: 0.5, color: '#0EEBFF' },\n        { offset: 1, color: '#00C2FF' },\n    ],\n];\n// series\nlet series = dataArr.result.reduce((p, c, i, array) => {\n    p.push(\n        {\n            z: i + 1,\n            stack: '总量',\n            type: 'bar',\n            name: c.name,\n            barGap: '-100%',\n            barWidth: 15,\n            data: c.data,\n            itemStyle: { \n                // borderRadius:i==0?[5,0,0,5]:[0,0,0,0],\n                color: new echarts.graphic.LinearGradient(0, 1, 1, 0, color1[i]), opacity: 1 },\n        },\n        {\n            z: i + 10,\n            type: 'pictorialBar',\n            symbolPosition: 'end',\n            symbol: 'circle',\n            symbolOffset: [0,'-50%'],\n            symbolSize: [15, 7],\n            data: diamondData[i],\n            itemStyle: { \n                color:function(params){\n                    console.log('params',params)\n                if(c.data[params.dataIndex]==0){\n                    return 'rgba(0,0,0,0)'\n                }else{\n                  return new echarts.graphic.LinearGradient(0, 1, 1, 0, color1[i])}; \n                }\n                // color:'#ffffff'\n            }, \n            tooltip: { show: false },\n        }\n    );\n\n    // 是否最后一个了？\n    // if (p.length === array.length * 2) {\n    //     console.log(122)\n    //     p.push({\n    //         z: array.length * 2,\n    //         type: 'pictorialBar',\n    //         symbolPosition: 'start',\n    //         data: [22,33],\n    //         symbol: 'circle',\n    //       symbolOffset: [0,'-50%'],\n    //         symbolSize: [15, 0],\n    //         itemStyle: { color:'#EF5C02'},\n    //         tooltip: { show: false },\n    //     });\n    //     return p;\n    // }\n\n    return p;\n}, []);\n\n// tooltip\nconst tooltip = { show: true, trigger: 'axis' };\n\n// legend\nconst legend = {\n    data: dataArr.result.map((item) => item.name),\n    textStyle: { fontSize: 14, color: '#fff' },\n    itemWidth: 25,\n    itemHeight: 15,\n    itemGap: 15,\n    bottom: '5%',\n    // 禁止点击\n    selectedMode: false,\n};\n// grid\nconst grid = { top: '10%', left: '10%', right: '3%', bottom: '15%' };\n\n// xAxis\nconst xAxis = {\n    // boundaryGap:[0,2],\n    axisLabel: {\n        color: '#fff',\n        textStyle: {\n            fontSize: '13',\n        },\n    },\n    splitLine: {\n        show: true,\n        lineStyle: {\n            type: 'dashed',\n            color: 'rgba(255,255,255,0.2)',\n        },\n    },\n    axisLine: {\n        show: false,\n        lineStyle: {\n            color: '#fff',\n            width: 1,\n            opacity: 0.3,\n        },\n    },\n    axisTick: {\n        show: false,\n    },\n    data: dataArr.xdata,\n};\n\n// yAxis\nconst yAxis = [\n    {\n        // inverse: true,\n        // position:'bottom',\n        // offset:'10',\n        splitLine: {\n            show: false,\n        },\n        axisTick: {\n            show: false,\n        },\n        axisLine: {\n            lineStyle: {\n                // color: '#fff',\n                color: new echarts.graphic.LinearGradient(0, 1, 1, 0, [\n                    {\n                        offset: 0,\n                        color: 'rgba(255,255,255,0.8)',\n                    },\n                    {\n                        offset: 1,\n                        color: 'rgba(255,255,255,0)',\n                    },\n                ]),\n                width: 1,\n            },\n        },\n        axisLabel: { textStyle: { fontSize: 16, color: '#fff' } },\n    },\n];\n\n// 渲染\noption = { tooltip, xAxis, yAxis, series, grid, legend, backgroundColor: 'rgba(0, 0, 0, .8)' };\n","html":"","externalScripts":"","updaterUID":"obd-oNxO_0pSiX4Qhzuy4VZap5faODTirCs","theme":"","layout":"","viewCount":0,"userName":"梦***呢","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xzi8Tb3SjB.png?v=1634558577954","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","series-pictorialBar","tooltip"],"customTags":[],"updaterUserName":"梦***呢"}}