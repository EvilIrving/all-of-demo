{"status":0,"data":{"cid":"xQDTVgEcjL","authorUid":"bd-4061446379","authorUserName":"A***9","title":"让tooltip始终显示在最高的柱子顶端","description":"让tooltip始终显示在最高的柱子顶端","latestVersion":2,"alwaysLatest":1,"createTime":"2019-03-13T03:11:32.000Z","lastUpdateTime":"2019-03-13T03:11:32.000Z","auth":2,"uid":"bd-4061446379","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.2.1","versionCreateTime":"2019-03-13T03:12:48.000Z","code":"var barOption = null\r\nvar barWidth = null\r\nvar barSpace = null\r\nfunction getBarOption() {\r\n    var displayList = myChart.getZr().storage._displayList\r\n    var barList = []\r\n    var xList = []\r\n    for (var i = 0;i<displayList.length;i++){\r\n        if (displayList[i]['type'] === 'rect' && displayList[i]['shape']['x'] >0){\r\n            barList.push(displayList[i])\r\n            xList.push(displayList[i]['shape']['x']).toFixed(2)\r\n        }\r\n    }\r\n    var barWidth = barList[2]['shape']['width']\r\n    xList = xList.sort((a,b)=>{return a-b})\r\n    var spaceList = []\r\n    for (var i = 0; i < xList.length - 1; i++) {\r\n        var space = (xList[i+1] - xList[i] - barWidth).toFixed(2)\r\n        if (spaceList.indexOf(space) === -1){\r\n            spaceList.push(space);\r\n        }\r\n    }\r\n    return [barWidth,parseInt(spaceList[0])]\r\n    }\r\nfunction setBarOption(){\r\n    barOption = getBarOption()\r\n    barWidth = barOption[0]\r\n    barSpace = barOption[1]\r\n}\r\noption = {\r\n    legend: {},\r\n    roam:true,\r\n    tooltip: {\r\n        trigger:'axis',\r\n        position:(point,params,dom,rect)=>{\r\n            var tooltipHeight = 100\r\n            x = params[0]['data'][0]\r\n            y = Math.max.apply(null,params[0]['data'].slice(1))\r\n            idx = params[0]['data'].slice(1).indexOf(y)\r\n            point = myChart.convertToPixel({gridIndex:0},[x,y])\r\n            point[0] = point[0] - 1.5*(barWidth) - barSpace + idx * (barWidth+barSpace)\r\n            point[1] -= tooltipHeight\r\n            return  point\r\n        }\r\n    },\r\n    dataset: {\r\n        source: [\r\n            ['product', '2015', '2016', '2017'],\r\n            ['Matcha Latte', 43.3, 85.8, 93.7],\r\n            ['Milk Tea', 83.1, 73.4, 55.1],\r\n            ['Cheese Cocoa', 86.4, 65.2, 82.5],\r\n            ['Walnut Brownie', 72.4, 80, 39.1]\r\n        ]\r\n    },\r\n    xAxis: {type: 'category'},\r\n    yAxis: {},\r\n    // graphic:{\r\n    //     type:'rect',\r\n    //     shape: {\r\n    //     x: 135.83999999999997,\r\n    //     y: 333,\r\n    //     width: 50,\r\n    //     height: -118.209\r\n    // }\r\n    // },\r\n    // Declare several bar series, each will be mapped\r\n    // to a column of dataset.source by default.\r\n    series: [\r\n        {type: 'bar'},\r\n        {type: 'bar'},\r\n        {type: 'bar'}\r\n    ]\r\n};\r\nsetTimeout(() => {\r\n    setBarOption()\r\n}, 500);","html":"","externalScripts":"","updaterUID":"bd-4061446379","theme":"","layout":"","viewCount":53,"userName":"A***9","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xQDTVgEcjL.png?v=1552446768180","isCustomThumbnail":0,"builtinTags":["category-work","dataset","grid","legend","series-bar","tooltip"],"customTags":["position"],"updaterUserName":"A***9"}}