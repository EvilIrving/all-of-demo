{"status":0,"data":{"cid":"xLSe_4jfMh","authorUid":"bd-1335944923","authorUserName":"锃***6","title":"动画tooltip","description":"CANVA生成动态tooltip,","latestVersion":18,"alwaysLatest":1,"createTime":"2019-01-07T09:09:56.000Z","lastUpdateTime":"2019-01-07T09:09:56.000Z","auth":1,"uid":"bd-1335944923","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":18,"parentVersion":17,"echartsVersion":"4.8.0","versionCreateTime":"2020-09-28T08:02:53.000Z","code":"/**\n*   2019.01.07\n*/\nlet data = [\n{name: '扬州 1', value: 40},\n/*{name: '北京 28', value: 200},\n{name: '南京 4', value: 100},\n{name: '合肥 3', value: 70},\n{name: '重庆 2', value: 60},\n{name: '郑州 2', value: 60},\n{name: '徐州 1', value: 50},\n{name: '武汉 1', value: 40},\n{name: '常州 1', value: 40},\n{name: '大连 1', value: 40},\n{name: '沈阳 1', value: 40},\n{name: '青岛 2', value: 40},\n{name: '保定 1', value: 40},\n{name: '济南 2', value: 60},\n{name: '石家庄 2', value: 60},\n{name: '长沙 2', value: 60},\n{name: '成都 1', value: 40},\n{name: '哈尔滨 1', value: 40},\n{name: '太原 1', value: 40},\n{name: '苏州 1', value: 40},\n{name: '扬州 1', value: 40},*/\n]; \nlet geoCoordMap = {\n'扬州 1':[119.42,32.39],\n/*'北京 28':[116.40,39.90],\n'南京 4':[118.76,32.04],\n'合肥 3':[117.00,32.00],\n'重庆 2':[106.54,29.59],\n'郑州 2':[113.67,34.76],\n'徐州 1':[117.20,34.26],\n'武汉 1':[114.29,30.58],\n'常州 1':[119.95,31.78],\n'大连 1':[121.62,38.92],\n'沈阳 1':[123.43,41.80],\n'青岛 2':[120.33,36.07],\n'保定 1':[115.47,38.87],\n '济南 2':[116.98,36.67],\n'石家庄 2':[114.26,38.03],\n'长沙 2':[112.93,28.23],\n'成都 1':[104.07,30.67],\n'哈尔滨 1':[126.63,45.75],\n'太原 1':[112.53,37.87],\n'潍坊 1':[119.1,36.62],\n'苏州 1':[120.62,31.32],\n'扬州 1':[119.42,32.39],*/\n}; \n\nlet convertData = function (data) {\n    var res = [];\n    for (var i = 0; i < data.length; i++) {\n        var geoCoord = geoCoordMap[data[i].name];\n        if (geoCoord) {\n            res.push({\n                name: data[i].name,\n                value: geoCoord.concat(data[i].value)\n            });\n        }\n    }\n    return res;\n};\nlet convertData2 = function (data) {\n            let res = [];\n            for (let i = 0; i < data.length; i++) {\n                let geoCoord = geoCoordMap[data[i].name];\n                if (geoCoord) {\n                    res.push({\n                        name: data[i].name,\n                        coord:[geoCoord[0],geoCoord[1]],\n                    });\n                    console.info(res)\n                }\n            }\n            return res;\n        };\nlet tooltipDom = '<canvas id=\"tCanvas\" width=\"200\" height=\"80\">123</canvas>'\nvar max = 480,\nmin = 9; // todo\nvar maxSize4Pin = 50,\nminSize4Pin = 20;\nvar url = \"http://pic3.nipic.com/20090702/918855_174429094_2.jpg\";\nvar img=document.createElement(\"img\");\nimg.src=url;\nimg.style = {\n    width: '2px',\n    height: '2px',\n    backgroundSize: '100%',\n}\n\noption = {\n    backgroundColor: '#4d4d4d',\n    tooltip : {\n        trigger: 'item',\n        triggerOn: 'click',\n        backgroundColor: 'transparent',\n        alwaysShowContent: true,\n        position (pos) {\n            return pos\n        },\n        formatter (params) {\n            //canvasAnimation(params)\n            return \"<img src='https://dg-img.oss-cn-shenzhen.aliyuncs.com/headicon/4187355-004781d447d5e94557f7663192491f62.jpg' style='width:30px; height:30px; border-radius:50%;'></div>\"\n        }\n    },\n    legend: {\n        show:false\n    },\n    geo: {\n        map: 'china',\n        label: {\n            emphasis: {\n                show: false\n            }\n        },\n        roam: true,\n        itemStyle: {\n            normal: {\n                areaColor: '#323c48', /*中国地图颜色*/\n                borderColor: '#111'\n            },\n            emphasis: {\n                areaColor: '#2a333d'\n            }\n        }\n    },\n    series : [\n        {\n            name: 'Tooltip Test',\n            type: 'effectScatter',\n            coordinateSystem: 'geo',\n            data: convertData(data.sort(function (a, b) {\n                return b.value - a.value;\n            }).slice(0, 6)),\n            symbolSize: function (val) {\n                return val[2] / 10;\n            },\n            showEffectOn: 'render',\n            rippleEffect: {\n                brushType: 'stroke'\n            },\n            hoverAnimation: true,\n            label: {\n                normal: {\n                    formatter: '{b}',\n                    position: 'right', /*文字显示位置*/\n                    show: true\n                }\n            },\n            itemStyle: {\n                normal: {\n                    color: '#FFE503', /*原点颜色#FFE503,#02BCEB*/\n                    shadowBlur: 10,\n                    shadowColor: '#333'\n                }\n            },\n            zlevel: 1\n        },\n       /* {\n                    name: '点',\n                    type: 'scatter',\n                    coordinateSystem: 'geo',\n                    symbol: 'pin', //气泡\n                    symbolSize: function(val) {\n                        var a = (maxSize4Pin - minSize4Pin) / (max - min);\n                        var b = minSize4Pin - a * min;\n                        b = maxSize4Pin - a * max;\n                        return (a * val[2] + b * 2)  ;\n                    },\n                    itemStyle: {\n                        borderWidth:0,\n                        color: {\n                            image : img,\n                        }\n                    },\n                    markPoint : {\n                        data: convertData2(data)\n                    },\n                    zlevel: 6,\n                    data: convertData(data)\n                }*/ /*去掉蓝色气泡*/\n    ]\n};\n\nconst canvasAnimation = params => {\n    setTimeout(function() {\n        let canvas = document.querySelector('#tCanvas')\n        let ctx = canvas.getContext(\"2d\")\n        let a = {a: 0}\n        TweenMax.to(a, 1, {\n            a: 1,\n            onUpdate () {\n                ctx.clearRect(0,0,200,80)\n                let s = a.a\n                ctx.font= 20*s + \"px Georgia\";\n                ctx.fillStyle=\"red\";\n                ctx.fillRect(0,0,150*s,80*s);\n                ctx.strokeText(params.name,10*s,45*s)\n            }\n        })\n        \n    }, 0);\n}\n\nfunction autoPlay(){\n   setInterval(function(){ \n\n    \n   }, 3000);\n}\nautoPlay();\n\n\n","html":"","externalScripts":"/dep/echarts/map/js/china.js,https://cdnjs.cloudflare.com/ajax/libs/gsap/2.0.1/TweenMax.min.js","updaterUID":"bd-2469771537","theme":"","layout":"","viewCount":2153,"userName":"锃***6","commentCount":0,"starCount":6,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xLSe_4jfMh.png?v=1601280173110","isCustomThumbnail":0,"builtinTags":["category-work","geo","legend","series-effectScatter","tooltip"],"customTags":["canvas","tooltip"],"updaterUserName":"N***T"}}