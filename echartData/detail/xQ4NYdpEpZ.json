{"status":0,"data":{"cid":"xQ4NYdpEpZ","authorUid":"bd-51531618","authorUserName":"w***n","title":"飞行柱状图","description":"","latestVersion":1,"alwaysLatest":0,"createTime":"2021-09-18T07:06:53.000Z","lastUpdateTime":"2021-09-18T07:06:53.000Z","auth":2,"uid":"bd-51531618","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"5.2.0","versionCreateTime":"2021-09-18T07:06:53.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1631946943149-3XielQM5i.json\";\n\n\n\nvar geoGpsMap = {\n    1: [118.887168, 32.123757],\n    2: [118.887168, 32.123757],\n    3: [118.887168, 32.123757],\n    4: [118.887168, 32.123757],\n    5: [118.887168, 32.123757],\n    6: [118.887168, 32.123757],\n};\nvar geoCoordMap = {\n\t\"栖霞区妇保所\": [118.894611, 32.12831],\n\t\"马群社区卫生服务中心\": [118.907069, 32.045823],\n\t\"仙林社区卫生服务中心\": [118.914975, 32.102825],\n\t\"燕子矶社区卫生服务中心\": [118.826144, 32.137535],\n\t\"迈皋桥社区卫生服务中心\": [118.86736, 32.120344],\n\t\"西岗社区卫生服务中心\": [119.016773, 32.148921],\n\t\"栖霞区医院\": [118.887168, 32.123757],\n\t\"八卦洲社区卫生服务中心\": [118.832511, 32.180964],\n\t\"靖安社区卫生服务中心\": [119.13715, 32.226298],\n\t\"栖霞社区卫生服务中心\": [118.957792, 32.149649],\n\t\"龙潭社区卫生服务中心\": [119.079298, 32.188193],\n\t\"尧化社区卫生服务中心\": [118.901572, 32.133156],\n\t\"其他机构\": [118.886398, 32.123233]\n};\n\nvar d1 = {\n\t\"栖霞区妇保所\": 589,\n\t\"马群社区卫生服务中心\": 353,\n\t\"仙林社区卫生服务中心\": 400,\n\t\"燕子矶社区卫生服务中心\": 342,\n\t\"迈皋桥社区卫生服务中心\": 407,\n\t\"西岗社区卫生服务中心\": 411,\n\t\"栖霞区医院\": 234,\n\t\"八卦洲社区卫生服务中心\": 339,\n\t\"靖安社区卫生服务中心\": 390,\n\t\"栖霞社区卫生服务中心\": 334,\n\t\"龙潭社区卫生服务中心\": 401,\n\t\"尧化社区卫生服务中心\": 401,\n\t\"其他机构\": 201\n};\n\nvar d2 = {\n\t\"栖霞区妇保所\": 170,\n\t\"马群社区卫生服务中心\": 385,\n\t\"仙林社区卫生服务中心\": 316,\n\t\"燕子矶社区卫生服务中心\": 324,\n\t\"迈皋桥社区卫生服务中心\": 571,\n\t\"西岗社区卫生服务中心\": 284,\n\t\"栖霞区医院\": 107,\n\t\"八卦洲社区卫生服务中心\": 581,\n\t\"靖安社区卫生服务中心\": 486,\n\t\"栖霞社区卫生服务中心\": 586,\n\t\"龙潭社区卫生服务中心\": 373,\n\t\"尧化社区卫生服务中心\": 505,\n\t\"其他机构\": 309\n};\n\nvar d3 = {\n\t\"栖霞区妇保所\": 417,\n\t\"马群社区卫生服务中心\": 176,\n\t\"仙林社区卫生服务中心\": 528,\n\t\"燕子矶社区卫生服务中心\": 510,\n\t\"迈皋桥社区卫生服务中心\": 368,\n\t\"西岗社区卫生服务中心\": 208,\n\t\"栖霞区医院\": 337,\n\t\"八卦洲社区卫生服务中心\": 462,\n\t\"靖安社区卫生服务中心\": 200,\n\t\"栖霞社区卫生服务中心\": 511,\n\t\"龙潭社区卫生服务中心\": 358,\n\t\"尧化社区卫生服务中心\": 157,\n\t\"其他机构\": 112\n};\n\nvar d4 = {\n\t\"栖霞区妇保所\": 457,\n\t\"马群社区卫生服务中心\": 275,\n\t\"仙林社区卫生服务中心\": 403,\n\t\"燕子矶社区卫生服务中心\": 590,\n\t\"迈皋桥社区卫生服务中心\": 143,\n\t\"西岗社区卫生服务中心\": 345,\n\t\"栖霞区医院\": 193,\n\t\"八卦洲社区卫生服务中心\": 332,\n\t\"靖安社区卫生服务中心\": 480,\n\t\"栖霞社区卫生服务中心\": 303,\n\t\"龙潭社区卫生服务中心\": 476,\n\t\"尧化社区卫生服务中心\": 373,\n\t\"其他机构\": 334\n};\n\nvar d5 = {\n\t\"栖霞区妇保所\": 514,\n\t\"马群社区卫生服务中心\": 528,\n\t\"仙林社区卫生服务中心\": 500,\n\t\"燕子矶社区卫生服务中心\": 313,\n\t\"迈皋桥社区卫生服务中心\": 466,\n\t\"西岗社区卫生服务中心\": 289,\n\t\"栖霞区医院\": 449,\n\t\"八卦洲社区卫生服务中心\": 277,\n\t\"靖安社区卫生服务中心\": 440,\n\t\"栖霞社区卫生服务中心\": 269,\n\t\"龙潭社区卫生服务中心\": 426,\n\t\"尧化社区卫生服务中心\": 223,\n\t\"其他机构\": 234\n};\n\nvar d6 = {\n\t\"栖霞区妇保所\": 463,\n\t\"马群社区卫生服务中心\": 518,\n\t\"仙林社区卫生服务中心\": 102,\n\t\"燕子矶社区卫生服务中心\": 355,\n\t\"迈皋桥社区卫生服务中心\": 371,\n\t\"西岗社区卫生服务中心\": 189,\n\t\"栖霞区医院\": 232,\n\t\"八卦洲社区卫生服务中心\": 494,\n\t\"靖安社区卫生服务中心\": 174,\n\t\"栖霞社区卫生服务中心\": 286,\n\t\"龙潭社区卫生服务中心\": 307,\n\t\"尧化社区卫生服务中心\": 579,\n\t\"其他机构\": 372\n};\n\nvar colors = [\n    ['#1DE9B6', '#1DE9B6', '#FFDB5C', '#FFDB5C', '#04B9FF', '#04B9FF'],\n    ['#1DE9B6', '#F46E36', '#04B9FF', '#5DBD32', '#FFC809', '#FB95D5', '#BDA29A', '#6E7074', '#546570', '#C4CCD3'],\n    [\n        '#37A2DA',\n        '#67E0E3',\n        '#32C5E9',\n        '#9FE6B8',\n        '#FFDB5C',\n        '#FF9F7F',\n        '#FB7293',\n        '#E062AE',\n        '#E690D1',\n        '#E7BCF3',\n        '#9D96F5',\n        '#8378EA',\n        '#8378EA',\n    ],\n    [\n        '#DD6B66',\n        '#759AA0',\n        '#E69D87',\n        '#8DC1A9',\n        '#EA7E53',\n        '#EEDD78',\n        '#73A373',\n        '#73B9BC',\n        '#7289AB',\n        '#91CA8C',\n        '#F49F42',\n    ],\n];\n\nvar colorIndex = 0;\n$(function () {\n    var year = ['检查', '检验', '心电', '转诊', '会诊', '消毒'];\n    var mapData = [[], [], [], [], [], []];\n    /*柱子Y名称*/\n    var categoryData = [];\n    var barData = [];\n\n    for (var key in geoCoordMap) {\n        mapData[0].push({\n            year: '检查',\n            name: key,\n            value: d1[key] / 100,\n            value1: d1[key] / 100,\n        });\n        mapData[1].push({\n            year: '检验',\n            name: key,\n            value: d1[key] / 100,\n            value1: d2[key] / 100,\n        });\n        mapData[2].push({\n            year: '心电',\n            name: key,\n            value: d3[key] / 100,\n            value1: d3[key] / 100,\n        });\n        mapData[3].push({\n            year: '转诊',\n            name: key,\n            value: d3[key] / 100,\n            value1: d4[key] / 100,\n        });\n        mapData[4].push({\n            year: '会诊',\n            name: key,\n            value: d5[key] / 100,\n            value1: d5[key] / 100,\n        });\n        mapData[5].push({\n            year: '消毒',\n            name: key,\n            value: d5[key] / 100,\n            value1: d6[key] / 100,\n        });\n    }\n\n    for (var i = 0; i < mapData.length; i++) {\n        mapData[i].sort(function sortNumber(a, b) {\n            return a.value - b.value;\n        });\n        barData.push([]);\n        categoryData.push([]);\n        for (var j = 0; j < mapData[i].length; j++) {\n            barData[i].push(mapData[i][j].value1);\n            categoryData[i].push(mapData[i][j].name);\n        }\n    }\n\n    $.getJSON(uploadedDataURL, function (geoJson) {\n        console.log(geoJson)\n        echarts.registerMap('320113', geoJson);\n        \n        var convertData = function (data) {\n            var res = [];\n            for (var i = 0; i < data.length; i++) {\n                var geoCoord = geoCoordMap[data[i].name];\n                if (geoCoord) {\n                    res.push({\n                        name: data[i].name,\n                        value: geoCoord.concat(data[i].value),\n                    });\n                }\n            }\n            return res;\n        };\n\n        var convertToLineData = function (data, gps) {\n            var res = [];\n            for (var i = 0; i < data.length; i++) {\n                var dataItem = data[i];\n                var toCoord = geoCoordMap[dataItem.name];\n                var fromCoord = gps; //郑州\n                //  var toCoord = geoGps[Math.random()*3];\n                if (fromCoord && toCoord) {\n                    res.push([\n                        {\n                            coord: fromCoord,\n                            value: dataItem.value,\n                        },\n                        {\n                            coord: toCoord,\n                        },\n                    ]);\n                }\n            }\n            return res;\n        };\n\n        optionXyMap01 = {\n            timeline: {\n                data: year,\n                axisType: 'category',\n                autoPlay: true,\n                playInterval: 3000,\n                left: '10%',\n                right: '10%',\n                bottom: '3%',\n                width: '80%',\n                //  height: null,\n                label: {\n                    normal: {\n                        textStyle: {\n                            color: '#ddd',\n                        },\n                    },\n                    emphasis: {\n                        textStyle: {\n                            color: '#fff',\n                        },\n                    },\n                },\n                symbolSize: 10,\n                lineStyle: {\n                    color: '#555',\n                },\n                checkpointStyle: {\n                    borderColor: '#777',\n                    borderWidth: 2,\n                },\n                controlStyle: {\n                    showNextBtn: true,\n                    showPrevBtn: true,\n                    normal: {\n                        color: '#666',\n                        borderColor: '#666',\n                    },\n                    emphasis: {\n                        color: '#aaa',\n                        borderColor: '#aaa',\n                    },\n                },\n            },\n            baseOption: {\n                animation: true,\n                animationDuration: 1000,\n                animationEasing: 'cubicInOut',\n                animationDurationUpdate: 1000,\n                animationEasingUpdate: 'cubicInOut',\n                grid: {\n                    right: '1%',\n                    top: '15%',\n                    bottom: '10%',\n                    width: '20%',\n                },\n                tooltip: {\n                    trigger: 'axis', // hover触发器\n                    axisPointer: {\n                        // 坐标轴指示器，坐标轴触发有效\n                        type: 'shadow', // 默认为直线，可选为：'line' | 'shadow'\n                        shadowStyle: {\n                            color: 'rgba(150,150,150,0.1)', //hover颜色\n                        },\n                    },\n                },\n                geo: {\n                    show: true,\n                    map: '320113',\n                    roam: true,\n                    zoom: 1,\n                    label: {\n                        emphasis: {\n                            show: false,\n                        },\n                    },\n                    itemStyle: {\n                        normal: {\n                            borderColor: 'rgba(147, 235, 248, 1)',\n                            borderWidth: 1,\n                            areaColor: {\n                                type: 'radial',\n                                x: 0.5,\n                                y: 0.5,\n                                r: 0.8,\n                                colorStops: [\n                                    {\n                                        offset: 0,\n                                        color: 'rgba(147, 235, 248, 0)', // 0% 处的颜色\n                                    },\n                                    {\n                                        offset: 1,\n                                        color: 'rgba(147, 235, 248, .2)', // 100% 处的颜色\n                                    },\n                                ],\n                                globalCoord: false, // 缺省为 false\n                            },\n                            shadowColor: 'rgba(128, 217, 248, 1)',\n                            // shadowColor: 'rgba(255, 255, 255, 1)',\n                            shadowOffsetX: -2,\n                            shadowOffsetY: 2,\n                            shadowBlur: 10,\n                        },\n                        emphasis: {\n                            areaColor: '#389BB7',\n                            borderWidth: 0,\n                        },\n                    },\n                },\n            },\n            options: [],\n        };\n\n        for (var n = 0; n < year.length; n++) {\n            optionXyMap01.options.push({\n                backgroundColor: '#013954',\n                title: [\n                    {\n                        id: 'statistic',\n                        text: year[n] + '数据统计情况',\n                        left: '80%',\n                        top: '8%',\n                        textStyle: {\n                            color: '#fff',\n                            fontSize: 16,\n                        },\n                    },\n                ],\n                xAxis: {\n                    type: 'value',\n                    scale: true,\n                    position: 'top',\n                    min: 0,\n                    boundaryGap: false,\n                    splitLine: {\n                        show: false,\n                    },\n                    axisLine: {\n                        show: false,\n                    },\n                    axisTick: {\n                        show: false,\n                    },\n                    axisLabel: {\n                        margin: 2,\n                        textStyle: {\n                            color: '#aaa',\n                        },\n                    },\n                },\n                yAxis: {\n                    type: 'category',\n                    //  name: 'TOP 20',\n                    nameGap: 16,\n                    axisLine: {\n                        show: true,\n                        lineStyle: {\n                            color: '#ddd',\n                        },\n                    },\n                    axisTick: {\n                        show: false,\n                        lineStyle: {\n                            color: '#ddd',\n                        },\n                    },\n                    axisLabel: {\n                        interval: 0,\n                        textStyle: {\n                            color: '#ddd',\n                        },\n                    },\n                    data: categoryData[n],\n                },\n                series: [\n                    //未知作用\n                    {\n                        //文字和标志\n                        name: 'light',\n                        type: 'scatter',\n                        coordinateSystem: 'geo',\n                        data: convertData(mapData[n]),\n                        symbolSize: function (val) {\n                            return val[2] / 10;\n                        },\n                        label: {\n                            normal: {\n                                formatter: '{b}',\n                                position: 'right',\n                                show: true,\n                            },\n                            emphasis: {\n                                show: true,\n                            },\n                        },\n                        itemStyle: {\n                            normal: {\n                                color: colors[colorIndex][n],\n                            },\n                        },\n                    },\n                    //地图？\n                    {\n                        type: 'map',\n                        map: '320113',\n                        geoIndex: 0,\n                        aspectScale: 0.75, //长宽比\n                        showLegendSymbol: false, // 存在legend时显示\n                        label: {\n                            normal: {\n                                show: false,\n                            },\n                            emphasis: {\n                                show: false,\n                                textStyle: {\n                                    color: '#fff',\n                                },\n                            },\n                        },\n                        roam: true,\n                        itemStyle: {\n                            normal: {\n                                areaColor: '#031525',\n                                borderColor: '#FFFFFF',\n                            },\n                            emphasis: {\n                                areaColor: '#2B91B7',\n                            },\n                        },\n                        animation: false,\n                        data: mapData,\n                    },\n                    //地图点的动画效果\n                    {\n                        //  name: 'Top 5',\n                        type: 'effectScatter',\n                        coordinateSystem: 'geo',\n                        data: convertData(\n                            mapData[n]\n                                .sort(function (a, b) {\n                                    return b.value - a.value;\n                                })\n                                .slice(0, 20)\n                        ),\n                        symbolSize: function (val) {\n                            return val[2] / 10;\n                        },\n                        showEffectOn: 'render',\n                        rippleEffect: {\n                            brushType: 'stroke',\n                        },\n                        hoverAnimation: true,\n                        label: {\n                            normal: {\n                                formatter: '{b}',\n                                position: 'right',\n                                show: true,\n                            },\n                        },\n                        itemStyle: {\n                            normal: {\n                                color: colors[colorIndex][n],\n                                shadowBlur: 10,\n                                shadowColor: colors[colorIndex][n],\n                            },\n                        },\n                        zlevel: 1,\n                    },\n                    //地图线的动画效果\n                    {\n                        type: 'lines',\n                        zlevel: 2,\n                        effect: {\n                            show: true,\n                            period: 4, //箭头指向速度，值越小速度越快\n                            trailLength: 0.02, //特效尾迹长度[0,1]值越大，尾迹越长重\n                            symbol: 'arrow', //箭头图标\n                            symbolSize: 3, //图标大小\n                        },\n                        lineStyle: {\n                            normal: {\n                                color: colors[colorIndex][n],\n                                width: 0.1, //尾迹线条宽度\n                                opacity: 0.5, //尾迹线条透明度\n                                curveness: 0.3, //尾迹线条曲直度\n                            },\n                        },\n                        data: convertToLineData(mapData[n], geoGpsMap[n + 1]),\n                    },\n                    //柱状图\n                    {\n                        zlevel: 1.5,\n                        type: 'bar',\n                        symbol: 'none',\n                        itemStyle: {\n                            normal: {\n                                color: colors[colorIndex][n],\n                            },\n                        },\n                        data: barData[n],\n                    },\n                ],\n            });\n        }\n        myChart.setOption(optionXyMap01);\n    });\n});\n\nfunction randomNum(minNum, maxNum) {\n    switch (arguments.length) {\n        case 1:\n            return parseInt(Math.random() * minNum + 1, 10);\n        case 2:\n            return parseInt(Math.random() * (maxNum - minNum + 1) + minNum, 10);\n        default:\n            return 0;\n    }\n}\n","html":"","externalScripts":"","updaterUID":"bd-51531618","theme":"","layout":"","viewCount":0,"userName":"w***n","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xQ4NYdpEpZ.png?v=1631948813922","isCustomThumbnail":0,"builtinTags":["category-work","geo","grid","series-bar","series-effectScatter","series-lines","series-map","series-scatter","timeline","title","tooltip"],"customTags":[],"updaterUserName":"w***n"}}