{"status":0,"data":{"cid":"xwbOfNmEu","authorUid":"bd-1110163957","authorUserName":"汝***丶","title":"地图内多饼图示例","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2019-11-07T08:02:50.000Z","lastUpdateTime":"2019-11-07T08:02:50.000Z","auth":2,"uid":"bd-1110163957","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.4.0","versionCreateTime":"2019-11-07T08:02:50.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1519279347346-BkslpCjwf.json\";\r\n\r\n/**\r\n此版本通过设置geoindex && seriesIndex: [1] 属性来实现geo和map共存，\r\n来达到hover散点和区域显示tooltip的效果\r\n\r\n默认情况下，map series 会自己生成内部专用的 geo 组件。\r\n但是也可以用这个 geoIndex 指定一个 geo 组件。\r\n这样的话，map 和 其他 series（例如散点图）就可以共享一个 geo 组件了。\r\n并且，geo 组件的颜色也可以被这个 map series 控制，从而用 visualMap 来更改。\r\n当设定了 geoIndex 后，series-map.map 属性，\r\n以及 series-map.itemStyle 等样式配置不再起作用，而是采用 geo 中的相应属性。\r\n\r\nhttp://echarts.baidu.com/option.html#series-map.geoIndex\r\n\r\n并且加了pin气泡图标以示数值大小\r\n*/\r\nmyChart.showLoading();\r\n$.getJSON(uploadedDataURL, function(geoJson) {\r\n    echarts.registerMap('jiangxi', geoJson);\r\n    myChart.hideLoading();\r\n    var geoCoordMap = {\r\n        '省委':[117.37,31.786],\r\n        '合肥市':[117.37,31.386],\r\n        '六安市':[116.27,31.786],\r\n        '滁州市':[118.07,32.486],\r\n        '蚌埠市':[117.27,33.086],\r\n        '淮南市':[116.67,32.786],\r\n        '宿州市':[117.77,33.486],\r\n        '淮北市':[116.67,33.686],\r\n        '亳州市':[116.27,33.386],\r\n        '阜阳市':[115.57,32.986],\r\n        '安庆市':[116.47,30.486],\r\n        '池州市':[117.47,30.386],\r\n        '黄山市':[118.17,29.886],\r\n        '宣城市':[119.27,30.916],\r\n        '芜湖市':[118.17,31.186],\r\n        '马鞍山市':[118.47,31.616],\r\n        '铜陵市':[117.87,30.956],\r\n    };\r\n    var moveLine = {\r\n    'normal':[\r\n    {\"fromName\":\"省委\",\"toName\":\"合肥市\",'coords':[[117.37,31.786],[117.37,31.386],]},\r\n    {\"fromName\":\"省委\",\"toName\":\"六安市\",'coords':[[117.37,31.786],[116.27,31.786],]},\r\n    {\"fromName\":\"省委\",\"toName\":\"滁州市\",'coords':[[117.37,31.786],[118.07,32.486],[117.37,31.786]]},\r\n    {\"fromName\":\"省委\",\"toName\":\"蚌埠市\",'coords':[[117.37,31.786],[117.27,33.086],[117.37,31.786]]},\r\n    {\"fromName\":\"省委\",\"toName\":\"淮南市\",'coords':[[117.37,31.786],[116.67,32.786],[117.37,31.786]]},\r\n    {\"fromName\":\"省委\",\"toName\":\"宿州市\",'coords':[[117.37,31.786],[117.77,33.486],[117.37,31.786]]},\r\n    {\"fromName\":\"省委\",\"toName\":\"淮北市\",'coords':[[117.37,31.786],[116.67,33.686],[117.37,31.786]]},\r\n    {\"fromName\":\"省委\",\"toName\":\"亳州市\",'coords':[[117.37,31.786],[116.27,33.386],[117.37,31.786]]},\r\n    {\"fromName\":\"省委\",\"toName\":\"阜阳市\",'coords':[[117.37,31.786],[115.57,32.986],[117.37,31.786]]},\r\n    \r\n    {\"fromName\":\"省委\",\"toName\":\"池州市\",'coords':[[117.37,31.786],[117.47,30.386],[117.37,31.786]]},\r\n    {\"fromName\":\"省委\",\"toName\":\"黄山市\",'coords':[[117.37,31.786],[118.17,29.886],[117.37,31.786]]},\r\n    {\"fromName\":\"省委\",\"toName\":\"宣城市\",'coords':[[117.37,31.786],[119.27,30.916],[117.37,31.786]]},\r\n    {\"fromName\":\"省委\",\"toName\":\"芜湖市\",'coords':[[117.37,31.786],[118.17,31.186],[117.37,31.786]]},\r\n    {\"fromName\":\"省委\",\"toName\":\"安庆市\",'coords':[[117.37,31.786],[116.47,30.486],[117.37,31.786]]},\r\n    {\"fromName\":\"省委\",\"toName\":\"马鞍山市\",'coords':[[117.37,31.786],[118.47,31.616],[117.37,31.786]]},    \r\n    {\"fromName\":\"省委\",\"toName\":\"铜陵市\",'coords':[[117.37,31.786],[117.87,30.956],[117.37,31.786]]},\r\n    ],\r\n    'warning':[\r\n    \r\n    ]\r\n    };\r\n    var data = [\r\n        {name:'省委',value:190},\r\n        {name:'合肥市',value:190},\r\n        {name:'六安市',value:190},\r\n        {name:'滁州市',value:190},\r\n        {name:'蚌埠市',value:190},\r\n        {name:'淮南市',value:90},\r\n        {name:'宿州市',value:120},\r\n        {name:'淮北市',value:120},\r\n        {name:'亳州市',value:120},\r\n        {name:'阜阳市',value:120},\r\n        {name:'安庆市',value:190},\r\n        {name:'池州市',value:190},\r\n        {name:'黄山市',value:190},\r\n        {name:'宣城市',value:190},\r\n        {name:'芜湖市',value:190},\r\n        {name:'马鞍山市',value:190},\r\n        {name:'铜陵市',value:90},\r\n    ];\r\n    var max = 480, min = 9; // todo \r\n    var maxSize4Pin = 100, minSize4Pin = 20;\r\n\r\n  var convertData = function (data) {\r\n    var res = [];\r\n    for (var i = 0; i < data.length; i++) {\r\n        var geoCoord = geoCoordMap[data[i].name];\r\n        if (geoCoord) {\r\n            res.push({\r\n                name: data[i].name,\r\n                value: geoCoord.concat(data[i].value)\r\n            });\r\n        }\r\n    }\r\n    return res;\r\n};\r\n\r\n\r\n    option = {\r\n        backgroundColor: '#091c3d',\r\n        title: {\r\n            top:20,\r\n            text: '',\r\n            subtext: '',\r\n            x: 'center',\r\n            textStyle: {\r\n                color: '#ccc'\r\n            }\r\n        },    \r\n\r\n        tooltip: {\r\n            trigger: 'item',\r\n            formatter: function (params) {\r\n              if(typeof(params.value)[2] == \"undefined\"){\r\n              \treturn params.name + ' : ' + params.value;\r\n              }else{\r\n              \treturn params.name + ' : ' + params.value[2];\r\n              }\r\n            }\r\n        },\r\n        legend: {\r\n        orient: 'vertical',\r\n        y: 'bottom',\r\n        x:'right',\r\n        data:['pm2.5'],\r\n        textStyle: {\r\n            color: '#fff'\r\n        }\r\n        }, \r\n        visualMap: {\r\n            show: false,\r\n            min: 0,\r\n            max: 500,\r\n            left: 'left',\r\n            top: 'bottom',\r\n            text: ['高', '低'], // 文本，默认为数值文本\r\n            calculable: true,\r\n            seriesIndex: [1],\r\n            inRange: {\r\n                // color: ['#3B5077', '#031525'] // 蓝黑\r\n                // color: ['#ffc0cb', '#800080'] // 红紫\r\n                // color: ['#3C3B3F', '#605C3C'] // 黑绿\r\n                //color: ['#0f0c29', '#302b63', '#24243e'] // 黑紫黑\r\n                 //color: ['#23074d', '#cc5333'] // 紫红\r\n                // color: ['#00467F', '#A5CC82'] // 蓝绿\r\n                // color: ['#1488CC', '#2B32B2'] // 浅蓝\r\n                // color: ['#00467F', '#A5CC82'] // 蓝绿\r\n                // color: ['#00467F', '#A5CC82'] // 蓝绿\r\n                // color: ['#00467F', '#A5CC82'] // 蓝绿\r\n                // color: ['#00467F', '#A5CC82'] // 蓝绿\r\n\r\n            }\r\n        },\r\n        // toolbox: {\r\n        //     show: true,\r\n        //     orient: 'vertical',\r\n        //     left: 'right',\r\n        //     top: 'center',\r\n        //     feature: {\r\n        //             dataView: {readOnly: false},\r\n        //             restore: {},\r\n        //             saveAsImage: {}\r\n        //             }\r\n        // },\r\n        geo: {\r\n            show: true,\r\n            map: 'jiangxi',\r\n            label: {\r\n                normal: {\r\n                    show: false\r\n                },\r\n                emphasis: {\r\n                    show: false,\r\n                }\r\n            },\r\n            roam: true,\r\n            itemStyle: {\r\n                normal: {\r\n                    areaColor: 'transparent',\r\n                    borderColor: '#3fdaff',\r\n                    borderWidth: 2,\r\n                    shadowColor: 'rgba(63, 218, 255, 0.5)',\r\n                    shadowBlur: 30\r\n                },\r\n                emphasis: {\r\n                    areaColor: '#2B91B7',\r\n                }\r\n            }\r\n        },\r\n        series : [\r\n      {\r\n            name: 'light',\r\n            type: 'scatter',\r\n            coordinateSystem: 'geo',\r\n            data: convertData(data),\r\n            symbolSize: function (val) {\r\n                return val[2] / 10;\r\n            },\r\n            label: {\r\n                normal: {\r\n                    formatter: '{b}',\r\n                    position: 'right',\r\n                    show: true\r\n                },\r\n                emphasis: {\r\n                    show: true\r\n                }\r\n            },\r\n            itemStyle: {\r\n                normal: {\r\n                    color: '#F4E925'\r\n                }\r\n            }\r\n        },\r\n         {\r\n            type: 'map',\r\n            map: 'jiangxi',\r\n            geoIndex: 0,\r\n            aspectScale: 0.75, //长宽比\r\n            showLegendSymbol: false, // 存在legend时显示\r\n            label: {\r\n                normal: {\r\n                    show: false\r\n                },\r\n                emphasis: {\r\n                    show: false,\r\n                    textStyle: {\r\n                        color: '#fff'\r\n                    }\r\n                }\r\n            },\r\n            roam: true,\r\n            itemStyle: {\r\n                normal: {\r\n                    areaColor: '#031525',\r\n                    borderColor: '#FFFFFF',\r\n                },\r\n                emphasis: {\r\n                    areaColor: '#2B91B7'\r\n                }\r\n            },\r\n            animation: false,\r\n            data: data\r\n        },\r\n        {\r\n            name: 'Top 5',\r\n            type: 'effectScatter',\r\n            coordinateSystem: 'geo',\r\n            data: convertData(data.sort(function (a, b) {\r\n                return b.value - a.value;\r\n            }).slice(0, 5)),\r\n            symbolSize: function (val) {\r\n                return val[2] / 10;\r\n            },\r\n            showEffectOn: 'render',\r\n            rippleEffect: {\r\n                brushType: 'stroke'\r\n            },\r\n            hoverAnimation: true,\r\n            label: {\r\n                normal: {\r\n                    formatter: '{b}',\r\n                    position: 'right',\r\n                    show: true\r\n                }\r\n            },\r\n            itemStyle: {\r\n                normal: {\r\n                    color: '#F4E925',\r\n                    shadowBlur: 10,\r\n                    shadowColor: '#05C3F9'\r\n                }\r\n            },\r\n            zlevel: 1\r\n        },\r\n         {\r\n        name: '线路',\r\n        type: 'lines',\r\n        coordinateSystem: 'geo',\r\n        zlevel: 2,\r\n        large: true,\r\n        effect: {\r\n            show: true,\r\n            constantSpeed: 30,\r\n            symbol: 'arrow',//ECharts 提供的标记类型包括 'circle', 'rect', 'roundRect', 'triangle', 'diamond', 'pin', 'arrow'\r\n            symbolSize: 0,\r\n            trailLength: 0,\r\n        },\r\n        \r\n        lineStyle: {\r\n            normal: {\r\n                color:'#0fff17',\r\n                /*\r\n                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                        offset: 0, color: '#58B3CC'\r\n                    }, {\r\n                        offset: 1, color: '#F58158'\r\n                    }], false),*/\r\n                width: 2,\r\n                opacity: 1.0,\r\n                curveness: 0.15\r\n            }\r\n        },\r\n        data: moveLine.normal\r\n    },\r\n    {\r\n        name: '线路',\r\n        type: 'lines',\r\n        coordinateSystem: 'geo',\r\n        zlevel: 2,\r\n        large: true,\r\n        effect: {\r\n            show: true,\r\n            constantSpeed: 30,\r\n            symbol: 'arrow',//ECharts 提供的标记类型包括 'circle', 'rect', 'roundRect', 'triangle', 'diamond', 'pin', 'arrow'\r\n            symbolSize: 10,\r\n            trailLength: 0,\r\n        },\r\n        \r\n        lineStyle: {\r\n            normal: {\r\n                color:'rgb(255, 0, 0)',\r\n                width: 2,\r\n                opacity: 1,\r\n                curveness: 0.15\r\n            }\r\n        },\r\n        data: moveLine.warning\r\n    },\r\n    {//饼状图 可以无限复制这个对象生成 只需要改center 然后data是赋值\r\n            name: ' ',\r\n            type: 'pie',\r\n            radius: ['5%', '7%'],\r\n            center : ['10%', '90%'],//饼状图的距离 这是第一个\r\n            startAngle: 225,\r\n            color: [new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                offset: 0,\r\n                color: '#00a2ff'\r\n            }, {\r\n                offset: 1,\r\n                color: '#70ffac'\r\n            }]), \"transparent\"],\r\n\r\n            labelLine: {\r\n                normal: {\r\n                    show: false\r\n                }\r\n            },\r\n            data: [{\r\n                value: 75\r\n            }, {\r\n                value: 25\r\n            }]\r\n        },\r\n            {\r\n            name: ' ',\r\n            type: 'pie',\r\n            radius: ['5%', '7%'],\r\n             center : ['20%', '90%'],\r\n            startAngle: 225,\r\n            color: [new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                offset: 0,\r\n                color: '#00a2ff'\r\n            }, {\r\n                offset: 1,\r\n                color: '#70ffac'\r\n            }]), \"transparent\"],\r\n\r\n            labelLine: {\r\n                normal: {\r\n                    show: false\r\n                }\r\n            },\r\n            data: [{\r\n                value: 75\r\n            }, {\r\n                value: 25\r\n            }]\r\n        },\r\n            {\r\n            name: ' ',\r\n            type: 'pie',\r\n            radius: ['5%', '7%'],\r\n             center : ['30%', '90%'],\r\n            startAngle: 225,\r\n            color: [new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                offset: 0,\r\n                color: '#00a2ff'\r\n            }, {\r\n                offset: 1,\r\n                color: '#70ffac'\r\n            }]), \"transparent\"],\r\n\r\n            labelLine: {\r\n                normal: {\r\n                    show: false\r\n                }\r\n            },\r\n            data: [{\r\n                value: 75\r\n            }, {\r\n                value: 25\r\n            }]\r\n        },\r\n            {\r\n            name: ' ',\r\n            type: 'pie',\r\n            radius: ['5%', '7%'],\r\n             center : ['40%', '90%'],\r\n            startAngle: 225,\r\n            color: [new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                offset: 0,\r\n                color: '#00a2ff'\r\n            }, {\r\n                offset: 1,\r\n                color: '#70ffac'\r\n            }]), \"transparent\"],\r\n\r\n            labelLine: {\r\n                normal: {\r\n                    show: false\r\n                }\r\n            },\r\n            data: [{\r\n                value: 75\r\n            }, {\r\n                value: 25\r\n            }]\r\n        },    {\r\n            name: ' ',\r\n            type: 'pie',\r\n            radius: ['5%', '7%'],\r\n             center : ['50%', '90%'],\r\n            startAngle: 225,\r\n            color: [new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                offset: 0,\r\n                color: '#00a2ff'\r\n            }, {\r\n                offset: 1,\r\n                color: '#70ffac'\r\n            }]), \"transparent\"],\r\n\r\n            labelLine: {\r\n                normal: {\r\n                    show: false\r\n                }\r\n            },\r\n            data: [{\r\n                value: 75\r\n            }, {\r\n                value: 25\r\n            }]\r\n        },\r\n            {\r\n            name: ' ',\r\n            type: 'pie',\r\n            radius: ['5%', '7%'],\r\n             center : ['60%', '90%'],\r\n            startAngle: 225,\r\n            color: [new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                offset: 0,\r\n                color: '#00a2ff'\r\n            }, {\r\n                offset: 1,\r\n                color: '#70ffac'\r\n            }]), \"transparent\"],\r\n\r\n            labelLine: {\r\n                normal: {\r\n                    show: false\r\n                }\r\n            },\r\n            data: [{\r\n                value: 75\r\n            }, {\r\n                value: 25\r\n            }]\r\n        },\r\n            {\r\n            name: ' ',\r\n            type: 'pie',\r\n            radius: ['5%', '7%'],\r\n             center : ['70%', '90%'],\r\n            startAngle: 225,\r\n            color: [new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                offset: 0,\r\n                color: '#00a2ff'\r\n            }, {\r\n                offset: 1,\r\n                color: '#70ffac'\r\n            }]), \"transparent\"],\r\n\r\n            labelLine: {\r\n                normal: {\r\n                    show: false\r\n                }\r\n            },\r\n            data: [{\r\n                value: 75\r\n            }, {\r\n                value: 25\r\n            }]\r\n        }\r\n         \r\n    ]\r\n    };\r\n    myChart.setOption(option);\r\n});","html":"","externalScripts":"","updaterUID":"bd-1110163957","theme":"","layout":"","viewCount":1138,"userName":"汝***丶","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xwbOfNmEu.png?v=1573113771040","isCustomThumbnail":0,"builtinTags":["category-work","geo","legend","series-effectScatter","series-lines","series-map","series-pie","series-scatter","title","tooltip","visualMap"],"customTags":[],"updaterUserName":"汝***丶"}}