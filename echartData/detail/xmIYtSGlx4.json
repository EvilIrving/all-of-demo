{"status":0,"data":{"cid":"xmIYtSGlx4","authorUid":"obd-otOA8qXQLT7Euv6LEboIgbJhwu2Yk83","authorUserName":"g***4","title":"关系图Demo","description":"  ","latestVersion":2,"alwaysLatest":0,"createTime":"2021-06-08T08:10:44.000Z","lastUpdateTime":"2021-06-08T08:10:44.000Z","auth":1,"uid":"obd-otOA8qXQLT7Euv6LEboIgbJhwu2Yk83","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"5.1.1","versionCreateTime":"2021-06-09T01:28:04.000Z","code":"myChart.on('mouseover', function (param) {\n    //这个params可以获取你要的图中的当前点击的项的参数\n    console.dir(param);\n    stopInterval();\n});\nmyChart.on('globalout', function (param) {\n    //这个params可以获取你要的图中的当前点击的项的参数\n    console.dir(param);\n    startInterval();\n});\nmyChart.on('click', function (param) {\n    console.log('click');\n    console.dir(param);\n    console.log(param.data.id);\n    showSecondTree(param.data.id);\n});\n\nvar colors = ['#9119FB', '#9119FB', '#14B2BF', '#68B998', '#AE9C9C', '#D0B34D', '#B84DCF'];\nvar names = ['', 'test1', 'test2', 'test3', 'test4', 'test5', 'test6'];\nvar secondTreeNames = ['1', '2', '3', '4', '5'];\n\nvar secondPosition = []\nvar clickPosition = {}\nvar position = [\n        {\n            x: 0,\n            y: 0,\n            angle: 0,\n            index: 0,\n            zoom: 1,\n        },\n        {\n            x: 0,\n            y: 150,\n            angle: 0,\n            index: 1,\n            zoom: 1,\n        },\n        {\n            x: 130,\n            y: 75,\n            angle: 60,\n            index: 2,\n            zoom: 1,\n        },\n        {\n            x: 130,\n            y: -75,\n            angle: 120,\n            index: 3,\n            zoom: 1,\n        },\n        {\n            x: 0,\n            y: -150,\n            angle: 180,\n            index: 4,\n            zoom: 1,\n        },\n        {\n            x: -130,\n            y: -75,\n            angle: 240,\n            index: 5,\n            zoom: 1,\n        },\n        {\n            x: -130,\n            y: 75,\n            angle: 300,\n            index: 6,\n            zoom: 1,\n        },\n    ]\n\nvar intervalId = []\nvar count = 0\n\nlet intervalIdFirst = setInterval(() => {\n    drawGraphInterval();\n    count++;\n}, 30);\nintervalId.push(intervalIdFirst);\n\nfunction drawGraphInterval() {\n    position.map((item) => {\n        item.angle = (item.angle + 1) % 360;\n        item.y = 0 + 150 * Math.cos(((2 * Math.PI) / 360) * item.angle);\n        item.x = 0 + 150 * Math.sin(((2 * Math.PI) / 360) * item.angle);\n    });\n    drawGraph();\n}\nfunction stopInterval() {\n    let flagCount = count;\n    setTimeout(() => {\n        console.log('stopInterval');\n        console.log(intervalId);\n        for (let index = 0; index < intervalId.length; index++) {\n            clearInterval(intervalId[index]);\n        }\n        if (flagCount == count) {\n            intervalId = [];\n        }\n    }, 50);\n}\nfunction startInterval() {\n    secondPosition = [];\n    let arr = Object.getOwnPropertyNames(clickPosition);\n    if (arr.length > 0) {\n        position[clickPosition.index] = clickPosition;\n        clickPosition = {};\n    }\n    console.log('startInterval');\n    let intervalIdFirst = setInterval(() => {\n        drawGraphInterval();\n        count++;\n    }, 30);\n    intervalId.push(intervalIdFirst);\n    console.log(intervalId);\n}\nfunction showSecondTree(index) {\n    if(index > 7){\n        return;\n    }\n    secondPosition = [];\n    let arr = Object.getOwnPropertyNames(clickPosition);\n    var that = that;\n    if (arr.length > 0) {\n        position[clickPosition.index] = clickPosition;\n    }\n    clickPosition = position[index];\n    position[index] = { x: 0, y: 0, angle: 0, index: index, zoom: 1.2 };\n    let x = 180 * Math.sin(((2 * Math.PI) / 360) * clickPosition.angle);\n    let y = 180 * Math.cos(((2 * Math.PI) / 360) * clickPosition.angle);\n    for (let index = 0; index < 5; index++) {\n        secondPosition.push({\n            x:\n                index === 0\n                    ? x\n                    : x +\n                      80 *\n                          Math.sin(\n                              ((2 * Math.PI) / 360) * (360 - 60 * (index - 1) + ((clickPosition.angle + 90) % 360))\n                          ),\n            y:\n                index === 0\n                    ? y\n                    : y +\n                      80 *\n                          Math.cos(\n                              ((2 * Math.PI) / 360) * (360 - 60 * (index - 1) + ((clickPosition.angle + 90) % 360))\n                          ),\n            angle: index === 0 ? clickPosition.angle : (clickPosition.angle + 90) % 360,\n            index: position.length + secondPosition.length + 1,\n            zoom: index === 0 ? 1 : 0.25,\n        });\n    }\n\n    drawGraph();\n}\n\nfunction drawGraph(){\nvar option;\n//判断是否存在点击\nlet arr = Object.getOwnPropertyNames(clickPosition);\n\nfunction createNodes(count) {\n    var nodes = [];\n    for (var i = 0; i < position.length; i++) {\n        nodes.push({\n            id: i,\n            name: names[i],\n            //symbolOffset: position[i],\n            x: position[i].x,\n            y: position[i].y,\n            symbol: 'circle',\n            symbolSize: i === 0 ? 0 : [120 * position[i].zoom, 120 * position[i].zoom],\n            //symbolKeepAspect: true,\n            itemStyle: {\n                color: colors[i],\n            },\n            label: {\n                color: '#FFFFFF',\n                fontSize: 18,\n                show: true,\n            },\n        });\n    }\n    //存在点击,将2级3级关系图放入节点\n    if (arr.length > 0) {\n        for (let j = 0; j < secondPosition.length; j++) {\n            nodes.push({\n                id: j + position.length + 1,\n                name: secondTreeNames[j],\n                //symbolOffset: position[i],\n                x: secondPosition[j].x,\n                y: secondPosition[j].y,\n                symbol: 'circle',\n                symbolSize: [120 * secondPosition[j].zoom, 120 * secondPosition[j].zoom],\n                //symbolKeepAspect: true,\n                itemStyle: {\n                    color: j === 0 ? '#9FC9FB' : '#CDD4DE',\n                },\n                label: {\n                    color: j === 0 ? '#FFFFFF' : '#2582D6',\n                    fontSize: j === 0 ? 18 : 14,\n                    show: true,\n                },\n            });\n        }\n    }\n\n    return nodes;\n}\n\nvar datas = [];\ndatas.push({\n    nodes: createNodes(),\n    //edges: createEdges(),\n});\n\noption = {\n    series: datas.map(function (item) {\n        return {\n            type: 'graph',\n            layout: 'force',\n            animation: true,\n            data: item.nodes,\n            //width: \"50%\",\n            //height: \"50%\",\n            circular: {\n                //rotateLabel: true,\n            },\n            force: {\n                //initLayout: 'circular',\n                gravity: -0,\n                repulsion: 0,\n                edgeLength: 0,\n            },\n            // edges: item.edges.map(function (e) {\n            //   return {\n            //     source: e[0],\n            //     target: e[1],\n            //     lineStyle: {\n            //       width: 2,\n            //     },\n            //   };\n            // }),\n        };\n    }),\n};\nmyChart.setOption(option, true);\n}\n\n","html":"","externalScripts":"","updaterUID":"obd-otOA8qXQLT7Euv6LEboIgbJhwu2Yk83","theme":"","layout":"","viewCount":0,"userName":"g***4","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xmIYtSGlx4.png?v=1623202084552","isCustomThumbnail":0,"builtinTags":["category-work","series-graph"],"customTags":["二级","关系图","旋转"],"updaterUserName":"g***4"}}