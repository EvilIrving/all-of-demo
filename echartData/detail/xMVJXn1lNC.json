{"status":0,"data":{"cid":"xMVJXn1lNC","authorUid":"bd-1230793542","authorUserName":"菜***y","title":"双折线图标注的文字位置自动上下排序","description":"时候项目组要求做的一些折线图比较奇葩一点，比如本年每个月的数据和去年的数据进行比较，而且标注的文字要根据数据的大小变化，大的值标注的文字在上面，小的值标注的文字要在下面，数据data顺序要一一对应。关键部分的代码判断比较麻烦，如哪位大神有更好的办法，请指教，谢谢！","latestVersion":3,"alwaysLatest":0,"createTime":"2021-06-18T02:34:30.000Z","lastUpdateTime":"2021-06-18T02:34:30.000Z","auth":2,"uid":"bd-1230793542","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":3,"parentVersion":2,"echartsVersion":"4.5.0","versionCreateTime":"2021-06-18T03:14:42.000Z","code":"var data = {\n    title: '我是标题',\n    color: ['red', 'blue'],\n    x: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],\n    y: [{ min: null, max: null, name: '(单位：亿元)' }],\n    data: [\n        {\n            name: '本年累计',\n            data: ['21', '3', '38', '9', '8.5', '5', '35', '25', '14', '11', '9', '25'],\n        },\n        {\n            name: '去年累计',\n            data: ['13', '9.3', '9', '17', '8.5', '11.5', '9.3', '9', '17', '8.5', '27.5', '23.666'],\n        },\n    ],\n};\n//前端细节区分\nvar tip = {\n    tofiexd: 2, //y轴刻度保留2位数小数\n    unit: '%', //y轴刻度单位\n};\nvar type = 'line_auto_up_down';\noption = {\n    backgroundColor: '#001534',\n    title: {\n        text: '默认标题',\n        x: 'center',\n        top: '5',\n        textStyle: { color: '#fff' },\n    },\n    tooltip: {\n        trigger: 'axis',\n        confine: true,\n        axisPointer: {\n            type: 'line',\n        },\n    },\n    legend: {\n        show: true,\n        bottom: 15,\n        textStyle: { color: '#fff' },\n    },\n    xAxis: {\n        type: 'category',\n        axisLabel: {\n            color: '#fff',\n        },\n        axisLine: {\n            lineStyle: { color: '#fff' },\n        },\n        data: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],\n    },\n    yAxis: [\n        {\n            type: 'value',\n            show: true,\n            min: null,\n            max: null,\n            name: '(单位：xx)',\n            splitLine: { show: false },\n            axisLine: {\n                lineStyle: { color: '#fff' },\n            },\n        },\n        {\n            type: 'value',\n            show: false,\n            min: null,\n            max: null,\n            name: '(单位：xx)',\n            splitLine: { show: false },\n            axisLine: {\n                lineStyle: { color: '#fff' },\n            },\n        },\n    ],\n    grid: {\n        left: '4%',\n        right: '4%',\n        bottom: '15%',\n        top: '20%',\n        containLabel: true,\n    },\n    series: [],\n};\n//后端传数据源进行处理\nif (data.title) {\n    option.title.text = data.title;\n}\nif (data.color) {\n    var arrColor = data.color;\n    option.color = arrColor;\n}\nif (data.x) {\n    option.xAxis.data = data.x;\n}\n//全局处理设置Y轴刻度单位（默认无单位），显示多少位小数(默认0位)\nvar sunit = '',\n    stofixed = 0;\n//前端控制设置\nif (tip) {\n    if (tip.tofiexd) {\n        stofixed = tip.tofiexd;\n    }\n    if (tip.unit) {\n        sunit = tip.unit;\n    }\n}\nfor (var mm = 0; mm < data.y.length; mm++) {\n    if (data.y[mm].name) {\n        option.yAxis[mm].name = data.y[mm].name;\n    }\n    if (data.y[mm].min) {\n        option.yAxis[mm].min = data.y[mm].min;\n    }\n    if (data.y[mm].max) {\n        option.yAxis[mm].max = data.y[mm].max;\n    }\n\n    option.yAxis[mm].axisLabel = {\n        formatter: function (val) {\n            if (stofixed == 0) {\n                return val + sunit;\n            } else {\n                return val.toFixed(stofixed) + sunit;\n            }\n        },\n    };\n}\nif (data.y.length > 1) {\n    //双Y轴处理\n    option.yAxis[1].show = true;\n}\n//line_auto_up_down标注文字上下自动排序显示类型处理\nif (type == 'line_auto_up_down') {\n    var arrVal1 = [],\n        arrVal2 = [];\n    for (var i = 0; i < data.data.length; i++) {\n        var val = data.data[i];\n        var tmp = {\n            name: val.name,\n            yAxisIndex: 0,\n            type: 'line',\n            data: [],\n        };\n        for (var j = 0; j < val.data.length; j++) {\n            var vval = {\n                value: val.data[j],\n                label: { show: true },\n            };\n            tmp.data.push(vval);\n        }\n        option.series.push(tmp);\n    }\n\n    for (var j = 0; j < data.data[0].data.length; j++) {\n        arrVal1.push(data.data[0].data[j]);\n        arrVal2.push(data.data[1].data[j]);\n    }\n    //判断数组大小并进行上下自动显示\n    if (arrVal1.length == arrVal2.length) {\n        for (var j = 0; j < arrVal1.length; j++) {\n            var val0 = option.series[0].data[j].value;\n            var val1 = option.series[1].data[j].value;\n            if (Number(val0) > Number(val1) || Number(val0) == Number(val1)) {\n                option.series[0].data[j].label.position = 'top';\n                option.series[1].data[j].label.position = 'bottom';\n            } else {\n                option.series[0].data[j].label.position = 'bottom';\n                option.series[1].data[j].label.position = 'top';\n            }\n        }\n    }\n}\n","html":"","externalScripts":"","updaterUID":"bd-1230793542","theme":"","layout":"","viewCount":0,"userName":"菜***y","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xMVJXn1lNC.png?v=1623986082217","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-line","title","tooltip"],"customTags":["line"],"updaterUserName":"菜***y"}}