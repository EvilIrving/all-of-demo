{"status":0,"data":{"cid":"x_VRqm0EqJ","authorUid":"bd-3379959023","authorUserName":"135******72","title":"地图结合柱状图","description":"地图结合柱状图","latestVersion":2,"alwaysLatest":1,"createTime":"2019-03-07T03:30:21.000Z","lastUpdateTime":"2019-03-07T03:30:21.000Z","auth":1,"uid":"bd-3379959023","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.2.1","versionCreateTime":"2019-03-07T03:31:56.000Z","code":"var province = [\n    \"西藏\",\n    \"上海\",\n    \"福建\",\n    \"浙江\",\n    \"广东\",\n    \"山西\",\n    \"云南\",\n    \"辽宁\",\n    \"吉林\",\n    \"江西\",\n    \"海南\",\n    \"广西\",\n    \"内蒙古\",\n    \"四川\",\n    \"陕西\",\n    \"江苏\",\n    \"贵州\",\n    \"北京\",\n    \"新疆\",\n    \"山东\",\n    \"甘肃\",\n    \"天津\",\n    \"河南\",\n    \"黑龙江\",\n    \"河北\",\n    \"湖南\",\n    \"安徽\",\n    \"湖北\",\n    \"青海\",\n    \"重庆\",\n    \"宁夏\"\n];\nvar geoCoordMap = {\n    西藏: [91.11, 30.97],\n    上海: [121.48, 31.22],\n    福建: [118.1, 27.46],\n    浙江: [119.96, 29.86],\n    广东: [113.23, 24.16],\n    山西: [112.53, 38.87],\n    云南: [101.73, 25.04],\n    辽宁: [123.38, 42.8],\n    吉林: [125.35, 44.88],\n    江西: [115.89, 28.68],\n    海南: [109.51, 20.25],\n    广西: [108.74, 24.16],\n    内蒙古: [111.65, 42.42],\n    四川: [104.06, 31.67],\n    陕西: [108.95, 35.27],\n    江苏: [119.78, 33.04],\n    贵州: [106.71, 27.57],\n    北京: [116.46, 41.92],\n    新疆: [86.68, 41.77],\n    山东: [118, 36.65],\n    甘肃: [103.73, 37.03],\n    天津: [117.2, 40.13],\n    河南: [113.65, 34.76],\n    黑龙江: [127.63, 47.75],\n    河北: [115.48, 40.03],\n    湖南: [112, 28.21],\n    安徽: [117.27, 32.86],\n    湖北: [112.31, 31.52],\n    青海: [97.31, 37.03],\n    重庆: [107.31, 30.52],\n    宁夏: [106.31, 38.52]\n};\nvar gdp = [\n    //['第一产业','第二产业','第三产业',‘GDP’]\n    [129.79, 4944.44, 20594.9, 25669.13],\n    [220.22, 7571.35, 10093.82, 17885.39],\n    [3492.81, 15256.93, 13320.71, 32070.45],\n    [784.78, 5028.99, 7236.64, 13050.41],\n    [1637.39, 8553.63, 7937.08, 18128.1],\n    [2173.06, 8606.54, 11467.3, 22246.9],\n    [1498.52, 7004.95, 6273.33, 14776.8],\n    [2670.46, 4400.69, 8314.94, 15386.09],\n    [109.47, 8406.28, 19662.9, 28178.65],\n    [4077.18, 34619.5, 38691.6, 77388.28],\n    [1965.18, 21194.61, 24091.57, 47251.36],\n    [2567.72, 11821.58, 10018.32, 24407.62],\n    [2363.22, 14093.47, 12353.89, 28810.58],\n    [1904.53, 8829.54, 7764.93, 18499],\n    [4929.13, 31343.67, 31751.69, 68024.49],\n    [4286.21, 19275.82, 16909.76, 40471.79],\n    [3659.33, 14654.38, 14351.67, 32665.38],\n    [3578.37, 13341.17, 14631.83, 31551.37],\n    [3694.37, 35109.66, 42050.88, 80854.91],\n    [2796.8, 8273.66, 7247.18, 18317.64],\n    [948.35, 905.95, 2198.9, 4053.2],\n    [1303.24, 7898.92, 8538.43, 17740.59],\n    [3929.33, 13448.92, 15556.29, 32934.54],\n    [1846.19, 4669.53, 5261.01, 11776.73],\n    [2195.11, 5690.16, 6903.15, 14788.42],\n    [115.78, 429.17, 606.46, 1151.41],\n    [1693.85, 9490.72, 8215.02, 19399.59],\n    [983.39, 2515.56, 3701.42, 7200.37],\n    [221.19, 1249.98, 1101.32, 2572.49],\n    [241.6, 1488.44, 1438.55, 3168.59],\n    [1648.97, 3647.01, 4353.72, 9649.7]\n];\nvar option = null;\nvar data = [];\nvar mapName = \"china\";\nfor (var i = 0; i < province.length; i++) {\n    data.push({\n        name: province[i],\n        value: [{\n                name: \"第一产业\",\n                value: gdp[i][0]\n            },\n            {\n                name: \"第二产业\",\n                value: gdp[i][1]\n            },\n            {\n                name: \"第三产业\",\n                value: gdp[i][2]\n            }\n        ]\n    });\n}\n/*addBar*/\nfunction addBar(chart, data) {\n    var op = chart.getOption();\n    var sd = option.series;\n\n    var grids = [];\n    var xAxis = [];\n    var yAxis = [];\n    var barSeries = [];\n\n    for (var i = 0; i < data.length; i++) {\n        var randomValue = 15;\n        var radius = randomValue;\n        var geoCoord = geoCoordMap[data[i].name];\n\n\n        if (geoCoord) {\n            var vr = [];\n            data[i].value.map(function(v) {\n                vr.push({\n                    name: v.name,\n                    value: v.value,\n                    visualMap: false\n                }); //饼图的数据不进行映射\n            });\n\n            xAxis.push({\n                gridIndex: i,\n                show: false,\n                type: \"category\",\n                data: [\"早\", \"中\", \"晚\"],\n                z: 100\n            });\n\n            yAxis.push({\n                type: \"value\",\n                show: false,\n                gridIndex: i,\n                z: 100\n            });\n\n            var coord = chart.convertToPixel(\"geo\", geoCoord);\n            console.log(\"coord\", geoCoord, chart, coord);\n            grids.push({\n                width: 30,\n                height: 30,\n                left: coord[0] - 25,\n                top: coord[1] - 25,\n                z: 100\n            });\n\n            let barSeriesData = data[i].value.map(item => item.value);\n            barSeries.push({\n                id: i,\n                type: \"bar\",\n                xAxisIndex: i,\n                yAxisIndex: i,\n                barCategoryGap: 0,\n                data: barSeriesData,\n                z: 100,\n                itemStyle: {\n                    normal: {\n                        color: function(params) {\n                            // 柱状图每根柱子颜色\n                            var colorList = [\"red\", \"green\", \"yellow\"];\n                            return colorList[params.dataIndex];\n                        }\n                    },\n                    emphasis: {\n                        label: {\n                            show: false\n                        }\n                    }\n                }\n            });\n\n            var newOption = {\n                geo: op.geo,\n                grid: grids,\n                xAxis: xAxis,\n                yAxis: yAxis,\n                series: [...barSeries]\n            };\n        }\n    }\n    return newOption;\n}\n\n\nvar option = {\n    geo: {\n        map: \"china\",\n        roam: false,\n        zoom: 0.7, // 地图初始大小\n        center: [110.366794, 23.400309], // 初始中心位置\n        label: {\n            emphasis: {\n                show: false,\n                areaColor: \"#eee\"\n            }\n        },\n        // 地区块儿颜色\n        itemStyle: {\n            normal: {\n                areaColor: \"#55C3FC\",\n                borderColor: \"#fff\"\n            },\n            emphasis: {\n                areaColor: \"#21AEF8\"\n            }\n        }\n    },\n    series: [\n\n    ]\n};\n\n\nmyChart.setOption(option);\noption = addBar(myChart, data);\nmyChart.setOption(option);\nconsole.log('myChart', myChart, option)","html":"","externalScripts":"/dep/echarts/map/js/china.js","updaterUID":"bd-3379959023","theme":"","layout":"","viewCount":1701,"userName":"135******72","commentCount":0,"starCount":8,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x_VRqm0EqJ.png?v=1551929516894","isCustomThumbnail":0,"builtinTags":["category-work","geo","grid","series-bar"],"customTags":[],"updaterUserName":"135******72"}}