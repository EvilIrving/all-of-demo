{"status":0,"data":{"cid":"xI7LiL0tmD","authorUid":"obd-ojGzVRdfrvFQ3IT5jCSeLtd_jXT5EEd","authorUserName":"V***y","title":"Sankey 桑基图点击高亮显示","description":"点击某一项将与其有关联的所有父项目和子项目全部高亮显示，其他降低透明度，再次点击则取消高亮状态","latestVersion":1,"alwaysLatest":1,"createTime":"2021-01-28T08:57:18.000Z","lastUpdateTime":"2021-01-28T08:57:18.000Z","auth":2,"uid":"obd-ojGzVRdfrvFQ3IT5jCSeLtd_jXT5EEd","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2021-01-28T08:57:18.000Z","code":"var ROOT_PATH = 'https://cdn.jsdelivr.net/gh/apache/echarts-website@asf-site/examples';\n\nmyChart.showLoading();\n$.get(ROOT_PATH + '/data/asset/data/energy.json', function (data) {\n    myChart.hideLoading();\n\n    myChart.setOption(option = {\n        title: {\n            text: 'Sankey Diagram'\n        },\n        tooltip: {\n            trigger: 'item',\n            triggerOn: 'mousemove'\n        },\n        series: [\n            {\n                type: 'sankey',\n                data: data.nodes,\n                links: data.links,\n                emphasis: {\n                    focus: 'adjacency'\n                },\n                lineStyle: {\n                    color: 'source',\n                    curveness: 0.5\n                }\n            }\n        ]\n    });\n    \n    \n    let isSelected = false, cacheName = '';\n    myChart.on('click',(e) => {\n        // console.log(e,drawData)\n        if(e.data.source) return;\n        let {name} = e;\n        let {links,nodes} = _.cloneDeep(data);\n        let options = myChart.getOption();\n        if(cacheName !== name){\n            isSelected = false;\n        }\n        cacheName = name;\n        if(!isSelected){\n            let selectedNodes = [],selectedLinks = [];\n            selectedNodes = links.filter(item => {\n                return item.source === name || item.target === name;\n            }).map(item => {\n                return [{\n                    name: item.source,\n                    itemStyle: {\n                        // color: '#1DFA7C',\n                        opacity: 1\n                    },\n                    label: {\n                        fontSize: 12,\n                    }\n                },{\n                    name: item.target,\n                    itemStyle: {\n                        // color: '#1DFA7C',\n                        opacity: 1\n                    },\n                    label: {\n                        fontSize: 12,\n                    }\n                }];\n            }).flat();\n            nodes = _.unionBy(selectedNodes, nodes, 'name').map(item => {\n                if(!item.itemStyle){\n                    item.itemStyle = {\n                        opacity: 0.3\n                    };\n                    item.label = {\n                        show: false\n                    };\n                }\n                return item;\n            });\n            selectedLinks = links.map(item => {\n                if(item.source === name || item.target === name){\n                    return {\n                        ...item,\n                        lineStyle: {\n                            // color: '#FFD700',\n                            opacity: .8\n                        }\n                    }\n                }else{\n                    return {\n                        ...item,\n                        lineStyle: {\n                            color: 'transparent',\n                            opacity: 0.3\n                        }\n                    }\n                }\n            });\n            options.series[0].data = nodes;\n            options.series[0].links = selectedLinks;\n            isSelected = true;\n        }else{\n            options.series[0].data = nodes;\n            options.series[0].links = links;\n            isSelected = false;\n        }\n        myChart.setOption(options);\n    })\n    \n});\n","html":"","externalScripts":"https://cdn.bootcdn.net/ajax/libs/lodash.js/4.17.20/lodash.min.js","updaterUID":"obd-ojGzVRdfrvFQ3IT5jCSeLtd_jXT5EEd","theme":"macarons","layout":"","viewCount":112,"userName":"V***y","commentCount":2,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xI7LiL0tmD.png?v=1611824239262","isCustomThumbnail":0,"builtinTags":["category-work","series-sankey","title","tooltip"],"customTags":[],"updaterUserName":"V***y"}}