{"status":0,"data":{"cid":"xBf-Sp6ZQJ","authorUid":"obd-o2SdpVu0xEEq5kDTO4FCDMKLB-xKSBD","authorUserName":"雅***珥","title":"计量中心关联关系","description":"关系图连接关系，添加链接线，连接动态效果，根据source 设置线条颜色，箭头颜色","latestVersion":1,"alwaysLatest":0,"createTime":"2021-12-27T03:18:29.000Z","lastUpdateTime":"2021-12-27T03:18:29.000Z","auth":2,"uid":"obd-o2SdpVu0xEEq5kDTO4FCDMKLB-xKSBD","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.9.0","versionCreateTime":"2021-12-27T03:18:29.000Z","code":"// 获取设置图形的颜色样式\nfunction getCircle(option = {}) {\n  option.color = option.color || [];\n  return {\n    shadowBlur: 10,\n    shadowColor: option.shadowColor || '#D65CEA',\n    color: {\n      type: 'radial', // 径向渐变\n      x: 0.5, // 圆心坐标（中心）\n      y: 0.5,\n      r: 0.5, // 半径长度\n      colorStops: [\n        {\n          offset: 0.1,\n          color: option.color[0] || '#FCA7FF', // offset：坐标为0处的颜色\n        },\n        {\n          offset: 1,\n          color: option.color[1] || '#F772FB', // offset：坐标为1处的颜色\n        },\n      ],\n    },\n  };\n}\n\n// 计算线条箭头，根据source 样式设置箭头颜色\nfunction calcLines(links, seriesData) {\n  let obj = {};\n  links.forEach((v) => {\n    if (obj[v.source]) {\n      obj[v.source].data.push({\n        coords: [seriesData[v.source].value, seriesData[v.target].value],\n      });\n    } else {\n      obj[v.source] = {\n        type: 'lines',\n        coordinateSystem: 'cartesian2d',\n        z: 1,\n        zlevel: 2,\n        animation: false,\n        effect: {\n          show: true,\n          period: 10,\n          trailLength: 0.01,\n          symbolSize: 8,\n          symbol: 'arrow',\n          loop: true,\n          //   color: \"rgba(55,155,255,0.9)\"\n          color: seriesData[v.source].itemStyle.shadowColor,\n        },\n        // lines 线条样式，echarts 5.0+ 不生效时可以使用 方法1\n        // lineStyle: {\n        //     opacity: 0.9,\n        //     width: 1,\n        //     curveness: 0.3,\n        //     color: seriesData[v.source].itemStyle.shadowColor,\n        // },\n        lineStyle: {\n          width: 0,\n          curveness: 0.3,\n        },\n        data: [\n          {\n            coords: [seriesData[v.source].value, seriesData[v.target].value],\n          },\n        ],\n      };\n    }\n  });\n  let arr = Object.keys(obj).map((v) => obj[v]);\n\n  return arr;\n}\n\n// 获取几种基础颜色图形\nlet pinkCircle = getCircle();\nlet cyanCircle = getCircle({\n  color: ['#42D9D6', '#1EA9A6'],\n  shadowColor: '#5EF1E7',\n});\nlet blueCircle = getCircle({\n  color: ['#89C4FF', '#449BF3'],\n  shadowColor: '#60BDF6',\n});\nlet purpleCircle = getCircle({\n  color: ['#B1A7FF', '#7161F7'],\n  shadowColor: '#9487FF',\n});\nlet orangeCircle = getCircle({\n  color: ['#FFB7A5', '#EC7E64'],\n  shadowColor: '#FA9E88',\n});\nlet yellowCircle = getCircle({\n  color: ['#FFD4A8', '#FDAC59'],\n  shadowColor: '#FCCD84',\n});\n\n// 连接关联数据 根据index 下标连接\nconst links = [\n  { source: 0, target: 1 },\n  { source: 2, target: 0 },\n  { source: 0, target: 3 },\n  { source: 4, target: 0 },\n  { source: 2, target: 1 },\n  { source: 2, target: 3 },\n  { source: 5, target: 3 },\n  { source: 3, target: 1 },\n  { source: 5, target: 4 },\n  { source: 0, target: 5 },\n  { source: 6, target: 0 },\n  { source: 7, target: 0 },\n];\n\n// 图形数据\nconst seriesData = [\n  {\n    name: '北京分院',\n    symbolSize: 50,\n    value: [20, 40],\n    itemStyle: yellowCircle,\n  },\n  {\n    name: '中国计量科学研究院',\n    symbolSize: 120,\n    value: [-20, 30],\n    itemStyle: pinkCircle,\n  },\n  {\n    name: '湖北计量中心',\n    symbolSize: 50,\n    value: [0, 55],\n    itemStyle: purpleCircle,\n  },\n  {\n    name: '国网计量中心',\n    symbolSize: 90,\n    value: [0, 30],\n    itemStyle: cyanCircle,\n  },\n  {\n    name: '江西计量中心',\n    symbolSize: 50,\n    value: [36, 39],\n    itemStyle: orangeCircle,\n  },\n  {\n    name: '武汉分院',\n    symbolSize: 50,\n    value: [5, 5],\n    itemStyle: blueCircle,\n  },\n  {\n    name: '辽宁计量中心',\n    symbolSize: 50,\n    value: [35, 55],\n    itemStyle: cyanCircle,\n  },\n  {\n    name: '四川计量中心',\n    symbolSize: 50,\n    value: [30, 15],\n    itemStyle: cyanCircle,\n  },\n];\n\n// 根据图形样式，创建图例样式\nconst categories = seriesData.map((v) => {\n  return {\n    name: v.name,\n    itemStyle: {\n      color: v.itemStyle.color,\n    },\n  };\n});\n\noption = {\n  xAxis: {\n    show: false,\n    type: 'value',\n  },\n  yAxis: {\n    show: false,\n    type: 'value',\n  },\n  legend: {\n    show: true,\n    top: '10',\n    left: 'center',\n    textStyle: { color: 'rgba(255,255,255,.9)' },\n    itemWidth: 8,\n    itemHeight: 8,\n  },\n  series: [\n    {\n      type: 'graph',\n      layout: 'none', // 图的布局\n      zlevel: 3,\n      symbolSize: 90,\n      coordinateSystem: 'cartesian2d',\n      categories: categories,\n      label: {\n        show: true,\n        position: 'bottom',\n        textStyle: { fontSize: 14, color: 'rgba(255,255,255,.9)' },\n      },\n      data: seriesData,\n      links: links,\n      //   兼容echarts 5.0+ 线条样式 方法2\n      //   links: links.map(v => {\n      //       v.lineStyle = {\n      //         color: seriesData[v.source].itemStyle.color\n      //       }\n      //       return v;\n      //   }),\n      lineStyle: {\n        opacity: 1,\n        width: 1.5,\n        curveness: 0.3, // 曲线弯曲度\n        // 根据连接线开始节点颜色设置，目前ehcarts5.0+ 不支持\n        // 可以在 上一个属性 links 里指定样式，也可以在type: lines seriesItem 里指定线条样式 ↑↑↑↑↑\n        color: 'source',\n      },\n    },\n    ...calcLines(links, seriesData),\n  ],\n  backgroundColor: '#000000',\n};\n","html":"","externalScripts":"http://libs.baidu.com/jquery/2.0.0/jquery.min.js","updaterUID":"obd-o2SdpVu0xEEq5kDTO4FCDMKLB-xKSBD","theme":"","layout":"","viewCount":0,"userName":"雅***珥","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xBf-Sp6ZQJ.png?v=1640575109203","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-graph","series-lines"],"customTags":["graph","lines","连接线"],"updaterUserName":"雅***珥"}}