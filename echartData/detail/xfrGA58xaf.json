{"status":0,"data":{"cid":"xfrGA58xaf","authorUid":"bd-1245979803","authorUserName":"d***t","title":"月相","description":"","latestVersion":12,"alwaysLatest":1,"createTime":"2020-10-07T07:24:01.000Z","lastUpdateTime":"2020-10-07T07:24:01.000Z","auth":2,"uid":"bd-1245979803","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":12,"parentVersion":11,"echartsVersion":"4.8.0","versionCreateTime":"2020-10-09T02:26:08.000Z","code":"var moon30 = \"/asset/get/s/data-1602120452196-diRVht_ky.jpg\";\r\n\r\nvar moon29 = \"/asset/get/s/data-1602120447555-I6XrEBYVt.jpg\";\r\n\r\nvar moon28 = \"/asset/get/s/data-1602120442467-h2lBBYbyw.jpg\";\r\n\r\nvar moon27 = \"/asset/get/s/data-1602120437703-JrMyM6ett.jpg\";\r\n\r\nvar moon26 = \"/asset/get/s/data-1602120432130-Q-KUmquR1.jpg\";\r\n\r\nvar moon25 = \"/asset/get/s/data-1602120427717-NlQDLFtd2.jpg\";\r\n\r\nvar moon24 = \"/asset/get/s/data-1602120422377-IhSRjoKgy.jpg\";\r\n\r\nvar moon23 = \"/asset/get/s/data-1602120416446-x5IGnu4Nq.jpg\";\r\n\r\nvar moon22 = \"/asset/get/s/data-1602118837196-MLg3ZIFyv.jpg\";\r\n\r\nvar moon21 = \"/asset/get/s/data-1602120411260-fl61S7t_k.jpg\";\r\n\r\nvar moon20 = \"/asset/get/s/data-1602120403590-6WJ1JW75z.jpg\";\r\n\r\nvar moon19 = \"/asset/get/s/data-1602120397176-b52bf8Tk1.jpg\";\r\n\r\nvar moon17 = \"/asset/get/s/data-1602120390574-GpmDmltrH.jpg\";\r\n\r\nvar moon14 = \"/asset/get/s/data-1602120377250-4UrSO9-le.jpg\";\r\n\r\nvar moon13 = \"/asset/get/s/data-1602120367881-qXJ-Mp3rG.jpg\";\r\n\r\nvar moon12 = \"/asset/get/s/data-1602120363941-Y_0jJodWA.jpg\";\r\n\r\nvar moon11 = \"/asset/get/s/data-1602120358662-8drDAH0d9.jpg\";\r\n\r\nvar moon10 = \"/asset/get/s/data-1602120352031-53PXxz9Xo.jpg\";\r\n\r\nvar moon9 = \"/asset/get/s/data-1602120345369-8wu14ZAc9.jpg\";\r\n\r\nvar moon8 = \"/asset/get/s/data-1602120340614-sPe5NLiZ9.jpg\";\r\n\r\nvar moon6 = \"/asset/get/s/data-1602120335071-h0zvx2KZ3.jpg\";\r\n\r\nvar moon5 = \"/asset/get/s/data-1602120329940-rByfQfZOE.jpg\";\r\n\r\nvar moon4 = \"/asset/get/s/data-1602120325642-LpcR8ebcQ.jpg\";\r\n\r\nvar moon3 = \"/asset/get/s/data-1602120317270-4kqQ7gjRF.jpg\";\r\n\r\nvar moon2 = \"/asset/get/s/data-1602120139031-e42DKQK3w.jpg\";\r\n\r\nvar moon1 = \"/asset/get/s/data-1602120100638-yNWQwhlec.jpg\";\r\n\r\n\r\n\r\nvar anum = ['(盈凸月)九', '(盈凸月)十', '(盈凸月)十一', '(盈凸月)十二', '(盈凸月)十三', '(盈凸月)十四', '(望/满月)十五', '(望/满月)十六', '(亏凸月)十七', '(亏凸月)十八', '(亏凸月)十九', '(亏凸月)二十', '(亏凸月)廿一', '(下弦月)廿二', '(下弦月)廿三', '(残月)廿四', '(残月)廿五', '(残月)廿六', '(残月)廿七', '(残月)廿八', '(残月)廿九', '(晦)三十', '(新月/朔)一', '(峨嵋月)二', '(峨嵋月)三', '(峨嵋月)四', '(峨嵋月)五', '(峨嵋月)六', '(上弦月)七', '(上弦月)八']\r\nvar moons = [moon1, moon2, moon3, moon4, moon5, moon6, moon8, moon8, moon9, moon10, moon11, moon12, moon13, moon14, moon17, moon17, moon19, moon20, moon21, moon22, moon23, moon24, moon24, moon25, moon25, moon26, moon27, moon28, moon29, moon30]\r\nvar dt = new Date()\r\n// 引入农历\r\nvar lunarInfo = [0x04bd8, 0x04ae0, 0x0a570, 0x054d5, 0x0d260, 0x0d950, 0x16554, 0x056a0, 0x09ad0, 0x055d2, //1900-1909\r\n    0x04ae0, 0x0a5b6, 0x0a4d0, 0x0d250, 0x1d255, 0x0b540, 0x0d6a0, 0x0ada2, 0x095b0, 0x14977, //1910-1919\r\n    0x04970, 0x0a4b0, 0x0b4b5, 0x06a50, 0x06d40, 0x1ab54, 0x02b60, 0x09570, 0x052f2, 0x04970, //1920-1929\r\n    0x06566, 0x0d4a0, 0x0ea50, 0x06e95, 0x05ad0, 0x02b60, 0x186e3, 0x092e0, 0x1c8d7, 0x0c950, //1930-1939\r\n    0x0d4a0, 0x1d8a6, 0x0b550, 0x056a0, 0x1a5b4, 0x025d0, 0x092d0, 0x0d2b2, 0x0a950, 0x0b557, //1940-1949\r\n    0x06ca0, 0x0b550, 0x15355, 0x04da0, 0x0a5b0, 0x14573, 0x052b0, 0x0a9a8, 0x0e950, 0x06aa0, //1950-1959\r\n    0x0aea6, 0x0ab50, 0x04b60, 0x0aae4, 0x0a570, 0x05260, 0x0f263, 0x0d950, 0x05b57, 0x056a0, //1960-1969\r\n    0x096d0, 0x04dd5, 0x04ad0, 0x0a4d0, 0x0d4d4, 0x0d250, 0x0d558, 0x0b540, 0x0b6a0, 0x195a6, //1970-1979\r\n    0x095b0, 0x049b0, 0x0a974, 0x0a4b0, 0x0b27a, 0x06a50, 0x06d40, 0x0af46, 0x0ab60, 0x09570, //1980-1989\r\n    0x04af5, 0x04970, 0x064b0, 0x074a3, 0x0ea50, 0x06b58, 0x05ac0, 0x0ab60, 0x096d5, 0x092e0, //1990-1999\r\n    0x0c960, 0x0d954, 0x0d4a0, 0x0da50, 0x07552, 0x056a0, 0x0abb7, 0x025d0, 0x092d0, 0x0cab5, //2000-2009\r\n    0x0a950, 0x0b4a0, 0x0baa4, 0x0ad50, 0x055d9, 0x04ba0, 0x0a5b0, 0x15176, 0x052b0, 0x0a930, //2010-2019\r\n    0x07954, 0x06aa0, 0x0ad50, 0x05b52, 0x04b60, 0x0a6e6, 0x0a4e0, 0x0d260, 0x0ea65, 0x0d530, //2020-2029\r\n    0x05aa0, 0x076a3, 0x096d0, 0x04afb, 0x04ad0, 0x0a4d0, 0x1d0b6, 0x0d250, 0x0d520, 0x0dd45, //2030-2039\r\n    0x0b5a0, 0x056d0, 0x055b2, 0x049b0, 0x0a577, 0x0a4b0, 0x0aa50, 0x1b255, 0x06d20, 0x0ada0, //2040-2049\r\n    0x14b63, 0x09370, 0x049f8, 0x04970, 0x064b0, 0x168a6, 0x0ea50, 0x06b20, 0x1a6c4, 0x0aae0, //2050-2059\r\n    0x0a2e0, 0x0d2e3, 0x0c960, 0x0d557, 0x0d4a0, 0x0da50, 0x05d55, 0x056a0, 0x0a6d0, 0x055d4, //2060-2069\r\n    0x052d0, 0x0a9b8, 0x0a950, 0x0b4a0, 0x0b6a6, 0x0ad50, 0x055a0, 0x0aba4, 0x0a5b0, 0x052b0, //2070-2079\r\n    0x0b273, 0x06930, 0x07337, 0x06aa0, 0x0ad50, 0x14b55, 0x04b60, 0x0a570, 0x054e4, 0x0d160, //2080-2089\r\n    0x0e968, 0x0d520, 0x0daa0, 0x16aa6, 0x056d0, 0x04ae0, 0x0a9d4, 0x0a2d0, 0x0d150, 0x0f252, //2090-2099\r\n    0x0d520\r\n];\r\n\r\n\r\nfunction lYearDays(y) {\r\n    var i, sum = 348;\r\n    for (i = 0x8000; i > 0x8; i >>= 1) {\r\n        sum += (lunarInfo[y - 1900] & i) ? 1 : 0;\r\n    }\r\n    return (sum + leapDays(y));\r\n};\r\n\r\nfunction leapMonth(y) {\r\n    return (lunarInfo[y - 1900] & 0xf);\r\n};\r\n\r\nfunction leapDays(y) {\r\n    if (leapMonth(y)) {\r\n        return ((lunarInfo[y - 1900] & 0x10000) ? 30 : 29);\r\n    }\r\n    return (0);\r\n};\r\n\r\nfunction monthDays(y, m) {\r\n    if (m > 12 || m < 1) {\r\n        return -1\r\n    }\r\n    return ((lunarInfo[y - 1900] & (0x10000 >> m)) ? 30 : 29);\r\n};\r\n\r\n\r\nfunction solar2lunar(y, m, d) {\r\n    //年份限定、上限\r\n    if (y < 1900 || y > 2100) {\r\n        return -1; // undefined转换为数字变为NaN\r\n    }\r\n    //公历传参最下限\r\n    if (y == 1900 && m == 1 && d < 31) {\r\n        return -1;\r\n    }\r\n    //未传参  获得当天\r\n    if (!y) {\r\n        var objDate = new Date();\r\n    } else {\r\n        var objDate = new Date(y, parseInt(m) - 1, d)\r\n    }\r\n    var i, leap = 0,\r\n        temp = 0;\r\n    //修正ymd参数\r\n    var y = objDate.getFullYear(),\r\n        m = objDate.getMonth() + 1,\r\n        d = objDate.getDate();\r\n    var offset = (Date.UTC(objDate.getFullYear(), objDate.getMonth(), objDate.getDate()) - Date.UTC(1900, 0, 31)) / 86400000;\r\n    for (i = 1900; i < 2101 && offset > 0; i++) {\r\n        temp = lYearDays(i);\r\n        offset -= temp;\r\n    }\r\n    if (offset < 0) {\r\n        offset += temp;\r\n        i--;\r\n    }\r\n\r\n    //是否今天\r\n    var isTodayObj = new Date(),\r\n        isToday = false;\r\n    if (isTodayObj.getFullYear() == y && isTodayObj.getMonth() + 1 == m && isTodayObj.getDate() == d) {\r\n        isToday = true;\r\n    }\r\n\r\n    //农历年\r\n    var year = i;\r\n    var leap = leapMonth(i); //闰哪个月\r\n    var isLeap = false;\r\n\r\n    //效验闰月\r\n    for (i = 1; i < 13 && offset > 0; i++) {\r\n        //闰月\r\n        if (leap > 0 && i == (leap + 1) && isLeap == false) {\r\n            --i;\r\n            isLeap = true;\r\n            temp = leapDays(year); //计算农历闰月天数\r\n        } else {\r\n            temp = monthDays(year, i); //计算农历普通月天数\r\n        }\r\n        //解除闰月\r\n        if (isLeap == true && i == (leap + 1)) {\r\n            isLeap = false;\r\n        }\r\n        offset -= temp;\r\n    }\r\n    // 闰月导致数组下标重叠取反\r\n    if (offset == 0 && leap > 0 && i == leap + 1) {\r\n        if (isLeap) {\r\n            isLeap = false;\r\n        } else {\r\n            isLeap = true;\r\n            --i;\r\n        }\r\n    }\r\n    if (offset < 0) {\r\n        offset += temp;\r\n        --i;\r\n    }\r\n    //农历月\r\n    var month = i;\r\n    //农历日\r\n    var day = offset + 1;\r\n\r\n\r\n    return {\r\n        'lYear': year,\r\n        'lMonth': month,\r\n        'lDay': day\r\n    };\r\n};\r\n//农历引入 end \r\n\r\nvar year = dt.getFullYear()\r\nvar m = dt.getMonth() + 1\r\nvar d = dt.getDate()\r\nvar lunar = solar2lunar(year, m, d)\r\nvar d1 = lunar.lDay\r\n\r\nif (d1 < 9) {\r\n    day = d1 + 21\r\n} else {\r\n    day = d1 - 9\r\n}\r\n\r\n\r\nfunction roundDatas(num, n, mk) {\r\n    var datas = [];\r\n    if (mk == '地球') {\r\n        label = '地球\\n北极';\r\n        for (var i = 0; i < num; i++) {\r\n            var x = Math.cos(n * i * Math.PI / 180);\r\n            var y = Math.sin(n * i * Math.PI / 180);\r\n            datas.push({\r\n\r\n                x: y,\r\n                y: x,\r\n                itemStyle: {\r\n                    normal: {\r\n                        color: '#94d6da'\r\n                    }\r\n                },\r\n                label: {\r\n                    normal: {\r\n                        show: true,\r\n                        formatter: label,\r\n                        fontSize: 14\r\n                    }\r\n                },\r\n            });\r\n        }\r\n    } else if (mk == '太阳') {\r\n        label = '太阳';\r\n        for (var i = 0; i < num; i++) {\r\n            var x = Math.cos(n * i * Math.PI / 180);\r\n            var y = Math.sin(n * i * Math.PI / 180);\r\n            datas.push({\r\n\r\n                x: y,\r\n                y: x,\r\n                itemStyle: {\r\n                    normal: {\r\n                        color: '#d54a20'\r\n                    }\r\n                },\r\n                label: {\r\n                    normal: {\r\n                        show: true,\r\n                        formatter: label,\r\n                        fontSize: 16\r\n                    }\r\n                },\r\n\r\n            });\r\n        }\r\n    } else {\r\n        label = '{b}';\r\n\r\n        for (var i = 0; i < num; i++) {\r\n            var x = Math.cos(n * i * Math.PI / 180);\r\n            var y = Math.sin(n * i * Math.PI / 180);\r\n            datas.push({\r\n                name: anum[i],\r\n                x: y,\r\n                y: x,\r\n                itemStyle: {\r\n                    normal: {\r\n                        color: '#D3D3D3'\r\n                    }\r\n                },\r\n\r\n\r\n            });\r\n        }\r\n        datas[day].symbolSize = 30;\r\n        datas[day].symbol = 'image://' + moons[d1 - 1];\r\n        datas[day].label = {\r\n            normal: {\r\n                show: true,\r\n                formatter: label,\r\n                fontSize: 16,\r\n                color: '#fff',\r\n                position: 'top'\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n\r\n    return datas;\r\n}\r\n\r\nfunction linkDatas(num) {\r\n    var ldatas = [];\r\n    for (var i = 0; i < num; i++) {\r\n        ldatas.push({\r\n\r\n            lineStyle: {\r\n                normal: {\r\n                    color: '#94d6da',\r\n                    width: 2,\r\n                    curveness: 0.01,\r\n                    opacity: 0.8,\r\n                    type: 'dashed',\r\n                }\r\n            },\r\n            source: i,\r\n            target: i + 1\r\n        });\r\n    }\r\n\r\n\r\n    ldatas.push({\r\n\r\n        lineStyle: {\r\n            normal: {\r\n                color: '#94d6da',\r\n                type: 'dashed',\r\n                width: 2,\r\n                curveness: 0.01,\r\n                opacity: 0.8\r\n            }\r\n        },\r\n        source: (i - 1),\r\n        target: 0\r\n    });\r\n\r\n    return ldatas;\r\n}\r\noption = {\r\n    backgroundColor: '#000',\r\n    title: {\r\n        text: '月相',\r\n        textStyle: {\r\n            color: '#fff',\r\n        },\r\n        subtext: `农历：${lunar.lYear}、${lunar.lMonth}、${lunar.lDay}\\n\\n人有悲欢离合 月有阴晴圆缺`,\r\n        subtextStyle:{\r\n            color:'#eee',\r\n        },\r\n        top: '10%',\r\n        left: '10%'\r\n    },\r\n\r\n    series: [\r\n\r\n        {\r\n            name: '太阳',\r\n            type: 'graph',\r\n\r\n            symbol: 'circle',\r\n            symbolSize: 60,\r\n            top: '12%',\r\n            left: '6%',\r\n            width: '300',\r\n            height: '300',\r\n            data: roundDatas(1, 1, '太阳'),\r\n            links: linkDatas(0)\r\n        },\r\n\r\n        {\r\n            name: '地球',\r\n            type: 'graph',\r\n\r\n            symbol: 'circle',\r\n            symbolSize: 50,\r\n            top: '20%',\r\n            left: '40%',\r\n            width: '300',\r\n            height: '300',\r\n            data: roundDatas(1, 1, '地球'),\r\n            links: linkDatas(0)\r\n        }, {\r\n            name: '月',\r\n            type: 'graph',\r\n\r\n            edgeSymbol: ['', 'arrow'],\r\n            edgeSymbolSize: [3, 8],\r\n            symbol: 'circle',\r\n            symbolSize: 1,\r\n            top: '20%',\r\n            left: '40%',\r\n            width: '300',\r\n            height: '300',\r\n            data: roundDatas(30, 12, 'm'),\r\n            links: linkDatas(30)\r\n        }\r\n    ]\r\n};\r\n\r\n// setInterval(function() {\r\n//     myChart.setOption(option)\r\n//     if (d1 < 9) {\r\n//         day = d1 + 21\r\n//     } else {\r\n//         day = d1 - 9\r\n//     }\r\n//     for (var j = 0; j < 30; j++) {\r\n//         option.series[2].data[j].symbolSize = 1;\r\n//         option.series[2].data[j].symbol = '';\r\n//         option.series[2].data[j].label = {\r\n//             normal: {\r\n//                 show: false,\r\n//                 formatter: label,\r\n//                 fontSize: 16,\r\n//                 color: '#fff',\r\n//                 position: 'top'\r\n//             }\r\n//         }\r\n//     }\r\n//     option.series[2].data[day].symbolSize = 30;\r\n//     option.series[2].data[day].symbol = 'image://' + moons[d1 - 1];\r\n//     option.series[2].data[day].label = {\r\n//         normal: {\r\n//             show: true,\r\n//             formatter: label,\r\n//             fontSize: 16,\r\n//             color: '#fff',\r\n//             position: 'top'\r\n//         }\r\n//     }\r\n\r\n//     d1++;\r\n//     if (d1 > 30) {\r\n//         d1 = 1;\r\n//     }\r\n\r\n// }, 1000)\r\n","html":"","externalScripts":"","updaterUID":"bd-1245979803","theme":"","layout":"","viewCount":157,"userName":"d***t","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xfrGA58xaf.png?v=1602210368502","isCustomThumbnail":0,"builtinTags":["category-work","series-graph","title"],"customTags":[],"updaterUserName":"d***t"}}