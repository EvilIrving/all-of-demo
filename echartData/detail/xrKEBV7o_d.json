{"status":0,"data":{"cid":"xrKEBV7o_d","authorUid":"bd-2248245480","authorUserName":"x***8","title":"仪表盘","description":"","latestVersion":11,"alwaysLatest":0,"createTime":"2021-11-15T06:18:48.000Z","lastUpdateTime":"2021-12-21T03:14:38.000Z","auth":2,"uid":"bd-2248245480","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":11,"parentVersion":10,"echartsVersion":"5.2.2","versionCreateTime":"2021-12-21T03:14:38.000Z","code":"var color = new echarts.graphic.LinearGradient(0, 1, 1, 1, [\n  { offset: 0, color: 'rgba(205,133,63, .3)' },\n  { offset: 0.5, color: 'rgba(205,133,63, .5)' },\n  { offset: 1, color: 'rgba(205,133,63, 1)' },\n]);\nvar val = 60;\nvar fontColor = val > 30 ? 'red' : 'green';\nconst sourceData = [\n  // {\n  //   name: '',\n  //   value: 10,\n  // },\n  {\n    name: '10',\n    value: 10,\n  },\n  {\n    name: '20',\n    value: 10,\n  },\n  {\n    name: '30',\n    value: 10,\n  },\n  {\n    name: '40',\n    value: 10,\n  },\n  {\n    name: '50',\n    value: 10,\n  },\n  {\n    name: '60',\n    value: 10,\n  },\n  {\n    name: '70',\n    value: 10,\n  },\n  {\n    name: '80',\n    value: 10,\n  },\n  {\n    name: '90',\n    value: 10,\n  },\n  {\n    name: '100',\n    value: 10,\n  },\n  {\n    name: '',\n    value: 90,\n  },\n];\n\nconst total = sourceData.reduce((num, item) => {\n  num += item.value;\n  return num;\n}, 0);\n\n// 为了实现内环间隔距离，需要额外插入的数值。200 只是个系数，值越大，单位间隔的距离越小。\nconst inSplitValue = Math.floor(total / 400);\n\n// 为了实现外环间隔距离，需要额外插入的数值。\nconst outSplitValue = Math.floor(total / 400);\n\n// 内环数据的总数\nconst valueTotal = total + inSplitValue * sourceData.length;\n\nfunction getTextAngle(currentAngle, angle) {\n  currentAngle = currentAngle + angle;\n  console.log('currentAngle', currentAngle);\n  return 90 - currentAngle;\n}\n\n// 外环数据\nconst outValueData = sourceData.reduce((arr, item, index) => {\n  const currentTotal = arr.reduce((total, item) => {\n    total += item.value;\n    return total;\n  }, 0);\n\n  const currentAngle = 360 * (currentTotal / valueTotal);\n  const angle = (360 * (item.value / valueTotal)) / 2;\n\n  arr.push(\n    {\n      name: item.name,\n      value: item.value,\n      label: {\n        color: 'rgb(160, 60, 60)',\n        position: 'inside',\n        align: 'center',\n        // lineHeight: 20,\n        // verticalAlign: 'top',\n        rotate: getTextAngle(currentAngle, angle),\n      },\n    },\n    {\n      name: '',\n      value: outSplitValue,\n      itemStyle: {\n        color: 'transparent',\n        opacity: 0,\n      },\n      label: {\n        show: false,\n      },\n      labelLine: {\n        show: false,\n      },\n    }\n  );\n  return arr;\n}, []);\noption = {\n  backgroundColor: '#fff',\n  title: {\n    text: val + '%',\n    x: 'center',\n    y: '50%',\n    textStyle: {\n      fontSize: 35,\n      color: fontColor,\n    },\n    subtext: '您的计划可行性',\n    subtextStyle: {\n      fontSize: 20,\n    },\n  },\n  series: [\n    {\n      type: 'gauge',\n      startAngle: 180,\n      endAngle: 0,\n      center: ['50%', '60%'],\n      min: 5,\n      max: 100,\n      splitNumber: 9,\n      // 外层圈\n      axisLine: {\n        roundCap: true,\n        lineStyle: {\n          width: 16,\n          color: [[1, color]],\n        },\n      },\n      // 箭头\n      pointer: {\n        length: '10%',\n        width: 10,\n        offsetCenter: [0, '-58%'],\n        itemStyle: {\n          color: 'orange',\n        },\n      },\n      // 小刻度\n      axisTick: {\n        show: false,\n      },\n      // 大刻度\n      splitLine: {\n        show: false,\n      },\n      axisLabel: {\n        show: false,\n        formatter: (e) => {\n          if (e) {\n            return e;\n          }\n        },\n        color: 'orange',\n      },\n      // 百分比\n      detail: {\n        show: false,\n      },\n      data: [\n        {\n          value: val,\n        },\n      ],\n    },\n    {\n      type: 'pie',\n      radius: '45%',\n      animation: false, // 此处的动画禁用是为了防止指针在初始化时候露出来尾巴\n      color: ['#fff', '#fff'],\n      startAngle: 180,\n      endAngle: 0,\n      silent: true,\n      label: {\n        normal: {\n          position: 'center',\n        },\n      },\n      labelLine: {\n        show: false,\n      },\n      center: ['50%', '60%'],\n      data: [\n        {\n          value: 50,\n          itemStyle: {\n            shadowColor: 'rgba(205,133,63, .3)', // 阴影\n            shadowBlur: 5,\n            shadowOffsetY: -5,\n          },\n        },\n        { value: 50 },\n      ],\n    },\n    {\n      type: 'pie',\n      startAngle: 180,\n      endAngle: 0,\n      radius: ['40%', '80%'],\n      center: ['50%', '60%'],\n      itemStyle: {\n        opacity: 1,\n        color: 'transparent',\n      },\n      label: {\n        show: true,\n        formatter(params) {\n          return '{a|' + params.data.name + '}';\n        },\n        rich: {\n          a: {\n            color: '#dedede',\n          },\n        },\n      },\n      labelLine: {\n        show: false,\n      },\n      data: outValueData,\n    },\n  ],\n};\n","html":"","externalScripts":"","updaterUID":"bd-2248245480","theme":"","layout":"","viewCount":0,"userName":"x***8","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xrKEBV7o_d.png?v=1640056478740","isCustomThumbnail":0,"builtinTags":["category-work","series-gauge"],"customTags":[],"updaterUserName":"x***8"}}