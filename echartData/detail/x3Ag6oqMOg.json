{"status":0,"data":{"cid":"x3Ag6oqMOg","authorUid":"obd-oMuVUEhRH-KU8ZOkZx0aApOOJzRRH27","authorUserName":"Y***D","title":"仿3D 地图","description":"通过阴影仿3D  支持闪点","latestVersion":1,"alwaysLatest":1,"createTime":"2021-02-25T02:32:21.000Z","lastUpdateTime":"2021-02-25T02:32:21.000Z","auth":1,"uid":"obd-oMuVUEhRH-KU8ZOkZx0aApOOJzRRH27","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2021-02-25T02:32:21.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1614174699882-wkvijIze3.json\";\r\n\r\n// var uploadedDataURL = \"/asset/get/s/data-1595473893338-SpJOkOU_l.json\";\r\n\r\n// var uploadedDataURL = \"/asset/get/s/data-1595468790318-hKTS8IYn1.json\";\r\n\r\n/**\r\n此版本通过设置geoindex && seriesIndex: [1] 属性来实现geo和map共存，来达到hover散点和区域显示tooltip的效果\r\n\r\n默认情况下，map series 会自己生成内部专用的 geo 组件。但是也可以用这个 geoIndex 指定一个 geo 组件。这样的话，map 和 其他 series（例如散点图）就可以共享一个 geo 组件了。并且，geo 组件的颜色也可以被这个 map series 控制，从而用 visualMap 来更改。\r\n当设定了 geoIndex 后，series-map.map 属性，以及 series-map.itemStyle 等样式配置不再起作用，而是采用 geo 中的相应属性。\r\n\r\nhttp://echarts.baidu.com/option.html#series-map.geoIndex\r\n\r\n并且加了pin气泡图标以示数值大小\r\n*/\r\n\r\nvar regions = [{\r\n    name: '迪庆',\r\n    itemStyle: {\r\n        areaColor: 'rgb(46 133 198)',\r\n        opacity: 0.5\r\n    }\r\n}, {\r\n    name: '丽江',\r\n    itemStyle: {\r\n        areaColor: 'rgb(122 32 179)',\r\n        opacity: 0.5\r\n    }\r\n}, {\r\n    name: '怒江',\r\n    itemStyle: {\r\n        areaColor: 'rgb(3 183 177)',\r\n        opacity: 0.5\r\n    }\r\n}, {\r\n    name: '大理',\r\n    itemStyle: {\r\n        areaColor: 'rgb(25 185 79)',\r\n        opacity: 0.5\r\n    }\r\n}, {\r\n    name: '保山',\r\n    itemStyle: {\r\n        areaColor: 'rgb(193 171 55)',\r\n        opacity: 0.5\r\n    }\r\n}, {\r\n    name: '德宏',\r\n    itemStyle: {\r\n        areaColor: \"rgb(46 133 198)\",\r\n        opacity: 0.5\r\n    }\r\n}, {\r\n    name: '临沧',\r\n    itemStyle: {\r\n        areaColor: 'rgb(3 183 177)',\r\n        opacity: 0.5\r\n    }\r\n}, {\r\n    name: '普洱',\r\n    itemStyle: {\r\n        areaColor: 'rgb(46 133 198)',\r\n        opacity: 0.5\r\n    }\r\n}, {\r\n    name: '西双版纳',\r\n    itemStyle: {\r\n        areaColor: 'rgb(193 171 55)',\r\n        opacity: 0.5\r\n    }\r\n}, {\r\n    name: '红河',\r\n    itemStyle: {\r\n        areaColor: 'rgb(46 133 198)',\r\n        opacity: 0.5\r\n    }\r\n}, {\r\n    name: '玉溪',\r\n    itemStyle: {\r\n        areaColor: 'rgb(3 183 177)',\r\n        opacity: 0.5\r\n    }\r\n}, {\r\n    name: '文山',\r\n    itemStyle: {\r\n        areaColor: 'rgb(46 133 198)',\r\n        opacity: 0.5\r\n    }\r\n}, {\r\n    name: '昆明',\r\n    itemStyle: {\r\n        areaColor: 'rgb(46 133 198)',\r\n        opacity: 0.5\r\n    }\r\n}, {\r\n    name: '曲靖',\r\n    itemStyle: {\r\n        areaColor: 'rgb(193 171 55)',\r\n        opacity: 0.5\r\n    }\r\n}, {\r\n    name: '楚雄',\r\n    itemStyle: {\r\n        areaColor: 'rgb(122 32 179)',\r\n        opacity: 0.5\r\n    }\r\n}, {\r\n    name: '昭通',\r\n    itemStyle: {\r\n        areaColor: 'rgb(122 32 179)',\r\n        opacity: 0.5\r\n    }\r\n}];\r\nvar splitList = [{start: 1, end: 1, label: '迪庆', color: 'rgb(46 133 198)'},\r\n{start: 2, end: 2, label: '怒江', color: 'rgb(3 183 177)'},\r\n{start: 3, end: 3, label: '丽江', color: 'rgb(122 32 179)'},\r\n{start: 4, end: 4, label: '大理', color: 'rgb(25 185 79)'},\r\n{start: 5, end: 5, label: '保山', color: 'rgb(193 171 55)'},\r\n{start: 6, end: 6, label: '德宏', color: 'rgb(46 133 198)'},\r\n{start: 7, end: 7, label: '临沧', color: 'rgb(3 183 177)'},\r\n{start: 8, end: 8, label: '普洱', color: 'rgb(46 133 198)'},\r\n{start: 9, end: 9, label: '西双版纳', color: 'rgb(193 171 55)'},\r\n{start: 10, end: 10, label: '红河', color: 'rgb(46 133 198)'},\r\n{start: 11, end: 11, label: '玉溪', color: 'rgb(3 183 177)'},\r\n{start: 12, end: 12, label: '楚雄', color: 'rgb(122 32 179)'},\r\n{start: 13, end: 13, label: '昆明', color: 'rgb(46 133 198)'},\r\n{start: 14, end: 14, label: '曲靖', color: 'rgb(193 171 55)'},\r\n{start: 15, end: 15, label: '昭通', color: 'rgb(122 32 179)'},\r\n{start: 16, end: 16, label: '文山', color: 'rgb(46 133 198)'}]\r\nmyChart.showLoading();\r\n$.getJSON(uploadedDataURL, function(geoJson) {\r\n    echarts.registerMap('yunnan', geoJson);\r\n    myChart.hideLoading();\r\n    var geoCoordMap = {}\r\n    var dataTooltip = [{name: '迪庆', selected: false, value: 1},\r\n{name: '怒江', selected: false, value: 2},\r\n{name: '丽江', selected: false, value: 3},\r\n{name: '大理', selected: false, value: 4},\r\n{name: '保山', selected: false, value: 5},\r\n{name: '德宏', selected: false, value: 6},\r\n{name: '临沧', selected: false, value: 7},\r\n{name: '普洱', selected: false, value: 8},\r\n{name: '西双版纳', selected: false, value: 9},\r\n{name: '红河', selected: false, value: 10},\r\n{name: '玉溪', selected: false, value: 11},\r\n{name: '楚雄', selected: false, value: 12},\r\n{name: '昆明', selected: false, value: 13},\r\n{name: '曲靖', selected: false, value: 14},\r\n{name: '昭通', selected: false, value: 15},\r\n{name: '文山', selected: false, value: 16}];\r\n\r\n\r\n    var convertData = function(data) {\r\n        var res = [];\r\n        for (var i = 0; i < data.length; i++) {\r\n            var geoCoord = geoCoordMap[data[i].name];\r\n            if (geoCoord) {\r\n                res.push({\r\n                    name: data[i].name,\r\n                    value: geoCoord.concat(data[i].value)\r\n                });\r\n            }\r\n        }\r\n        return res;\r\n    };\r\n\r\n    option = {\r\n        backgroundColor: '#fff',\r\n        title: {\r\n            show: false,\r\n        },\r\n        legend:{\r\n            show: false\r\n        },\r\n        tooltip: { //提示框组件\r\n            trigger: 'item', //触发类型：数据项图形触发\r\n            formatter: function(params) {\r\n                if (typeof(params.value)[2] == \"undefined\") {\r\n                    return params.name;\r\n                } else {\r\n                    return params.name + ' : ' + params.value[2] + '%';\r\n                }\r\n            }\r\n        }, //提示框浮层内容格式器\r\n        visualMap: { //视觉映射组件\r\n            show: false, //否显示 visualMap-continuous 组件。如果设置为 false，不会显示，但是数据映射的功能还存在\r\n            max: 100, //指定 visualMapContinuous 组件的允许的最大值\r\n            seriesIndex: [1], //指定取哪个系列的数据，即哪个系列的 series.data,默认取所有系列\r\n            inRange: { //定义 在选中范围中 的视觉元素\r\n                color: ['#00467F', '#A5CC82'] // 蓝绿\r\n            }\r\n        },\r\n        geo: {\r\n            show: true, //是否显示\r\n            map: 'yunnan', //地图类型\r\n            aspectScale: 1, // 地图倾斜度\r\n            zoom: 1, // 地图放大倍数\r\n            label: { //图形上的文本标签，说明图形的数据信息，比如值，名称\r\n                normal: {\r\n                    show: true, //是否在普通状态下显示标签\r\n                },\r\n                emphasis: {\r\n                    show: false, //是否在高亮状态下显示标签\r\n                }\r\n            },\r\n            roam: false, //是否开启鼠标缩放和平移漫游\r\n            itemStyle: {\r\n                normal: {\r\n                    borderColor: \"#00eaff\",\r\n                    borderWidth: 4,\r\n                    shadowColor: \"#00eaff\",\r\n                    shadowBlur: 16, // 阴影的模糊大小\r\n                    shadowOffsetX: 2, // 阴影水平方向上的偏移距离\r\n                    shadowOffsetY: 16, // 阴影垂直方向上的偏移距离\r\n                },\r\n                emphasis: {\r\n                    show: false,\r\n                    // areaColor: '#3fdaff', //hover高亮时的颜色\r\n                    areaColor: '#E6F1FF', //hover高亮时的颜色\r\n                }\r\n            },\r\n\r\n        },\r\n        dataRange:{\r\n            x: '-1000 px', //图例横轴位置\r\n            y: '-1000 px', //图例纵轴位置\r\n          splitList: splitList\r\n        },\r\n        series: [{\r\n            type: 'map',\r\n            map: 'yunnan',\r\n            geoIndex: 1,\r\n            aspectScale: 1, //长宽比\r\n            zoom: 1,\r\n            // top: '10%',\r\n            // left: '17%',\r\n            showLegendSymbol: false, // 存在legend时显示\r\n            label: {\r\n                normal: {\r\n                    show: true,\r\n                    textStyle: {\r\n                        color: '#fff'\r\n                    }\r\n                },\r\n                emphasis: {\r\n                    show: false,\r\n                    textStyle: {\r\n                        color: '#black'\r\n                    }\r\n                }\r\n            },\r\n            itemStyle: {\r\n                normal: {\r\n                    borderColor: '#00eaff',\r\n                    borderWidth: 1,\r\n                    // areaColor: '#E6F1FF'\r\n                },\r\n                emphasis: {\r\n                    // areaColor: '#E6F1FF',\r\n                    borderWidth: 0,\r\n                    color: 'green'\r\n                }\r\n            },\r\n            zlevel: 1,\r\n            roam: false,\r\n            animation: true,\r\n            data: dataTooltip,\r\n\r\n        },\r\n        // {\r\n        //         name: '项目闪点',\r\n        //         type: 'effectScatter',\r\n        //         coordinateSystem: 'geo',\r\n        //         data: convertData(dataTooltip),\r\n        //         symbolSize: 15, //基点\r\n        //         showEffectOn: 'render',\r\n        //         rippleEffect: {\r\n        //             //涟漪特效相关配置。\r\n        //             period: 5, //动画的周期，秒数。\r\n        //             scale: 5, //波纹的最大缩放比例。\r\n        //             brushType: \"stroke\", //波纹的绘制方式，可选 'stroke' 和 'fill'。\r\n        //         },\r\n        //         hoverAnimation: true,\r\n        //         label: {\r\n        //             normal: {\r\n        //                 formatter: '{b}',\r\n        //                 position: 'right',\r\n        //                 color: 'black',\r\n        //                 show: true\r\n        //             }\r\n        //         },\r\n        //         itemStyle: {\r\n        //             normal: {\r\n        //                 color: 'rgb(0,210,122)', //修改圆圈的颜色\r\n        //                 shadowBlur: 10,\r\n        //                 shadowColor: '#05C3F9'\r\n        //             }\r\n        //         },\r\n        //         animation: true,\r\n        //         zlevel: 1\r\n        //     },\r\n]\r\n    };\r\n    myChart.setOption(option);\r\n});\r\nmyChart.on('click', function(param) {\r\n    console.log(param);\r\n    if (param.componentType == 'series') {\r\n        console.log('闪点点击事件');\r\n        window.open(encodeURI('https://www.baidu.com/'))\r\n    }\r\n})","html":"","externalScripts":"","updaterUID":"obd-oMuVUEhRH-KU8ZOkZx0aApOOJzRRH27","theme":"","layout":"","viewCount":287,"userName":"Y***D","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x3Ag6oqMOg.png?v=1614220341588","isCustomThumbnail":0,"builtinTags":["category-work","geo","legend","series-effectScatter","series-map","title","tooltip","visualMap"],"customTags":[],"updaterUserName":"Y***D"}}