{"status":0,"data":{"cid":"xL6U9_VZER","authorUid":"bd-167860219","authorUserName":"n***1","title":"长三角各市职住OD","description":"点击城市显示详细职住","latestVersion":4,"alwaysLatest":0,"createTime":"2021-09-04T07:57:47.000Z","lastUpdateTime":"2021-09-04T10:27:00.000Z","auth":2,"uid":"bd-167860219","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":4,"parentVersion":3,"echartsVersion":"5.2.0","versionCreateTime":"2021-09-04T10:27:00.000Z","code":"var uploadedDataURL = '/asset/get/s/data-1630741505579-A8A8D-V6N.json';\n\n// 指定图表的配置项和数据\n$.getJSON(uploadedDataURL, function (data) {\n    var nodes = data[1];\n    var option = {\n        title: [\n            {\n                text: '长三角各市职住OD',\n                subtext: '点击城市显示详细职住',\n            },\n        ],\n        tooltip: {},\n        legend: {\n            data: ['上海市', '江苏省', '浙江省', '安徽省', '去向', '来源'],\n        },\n        series: [\n            {\n                name: '销量1',\n                type: 'graph',\n\n                layout: 'circular',\n                circular: {\n                    rotateLabel: true,\n                },\n                //draggable: true,\n                emphasis: { focus: 'adjacency' },\n                label: { position: 'right', show: true },\n                //roam: true,\n                categories: [{ name: '上海市' }, { name: '江苏省' }, { name: '浙江省' }, { name: '安徽省' }],\n                data: nodes,\n                //edgeSymbol: ['none', 'arrow'],\n                lineStyle: { color: 'source', curveness: 0.3 },\n                edges: data[0],\n            },\n        ],\n    };\n\n    // 使用刚指定的配置项和数据显示图表。\n    myChart.setOption(option);\n    myChart.on('click', function (params) {\n        console.log(params);\n        var city = params['name'];\n\n        var links = data[0];\n        var newnodes = [];\n        for (var i = 1; i < nodes.length; i++) {\n            if (nodes[i]['name'] == city) {\n                var citynode = nodes[i];\n                citynode['itemStyle'] = {\n                    borderColor: '#666',\n                    borderWidth: 1,\n                    shadowColor: 'rgba(0, 0, 0, 1)',\n                    shadowBlur: 10,\n                };\n                citynode['label'] = {\n                    color: 'red',\n                    textBorderColor: '#999',\n                    textBorderWidth:2\n                };\n                newnodes.push(citynode);\n            } else {\n                var citynode = nodes[i];\n                citynode['itemStyle'] = {};\n                citynode['label'] = {};\n                newnodes.push(citynode);\n            }\n        }\n        console.log(newnodes);\n        var option1 = {\n            title: [{}, { text: city + '职住来源去向情况', right: '5%' }],\n            dataset: [\n                {\n                    source: links,\n                },\n                {\n                    transform: {\n                        type: 'filter',\n                        config: { dimension: 'source', '=': city },\n                        print: true,\n                    },\n                },\n                {\n                    transform: {\n                        type: 'filter',\n                        config: { dimension: 'target', '=': city },\n                        print: true,\n                    },\n                },\n            ],\n            grid: [{ right: '7%', top: '7%', width: '38%', height: '80%' }],\n            xAxis: {},\n            yAxis: { type: 'category', inverse: true, max: 10 },\n            series: [\n                { left: '5%', width: '40%', data: newnodes },\n                {\n                    name: '去向',\n                    realtimeSort: true,\n                    type: 'bar',\n                    label: { show: true, position: 'right' },\n                    datasetIndex: 1,\n                    encode: { x: 'value', y: 'target' },\n                    barGap: '0%',\n                    barCategoryGap: '5%',\n                },\n                {\n                    name: '来源',\n                    type: 'bar',\n                    label: { show: true, position: 'right' },\n                    datasetIndex: 2,\n                    encode: { x: 'value', y: 'source' },\n                },\n            ],\n        };\n        myChart.setOption(option1);\n    });\n});\n","html":"","externalScripts":"https://code.jquery.com/jquery-2.1.1.js","updaterUID":"bd-167860219","theme":"","layout":"","viewCount":0,"userName":"n***1","commentCount":1,"starCount":5,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xL6U9_VZER.png?v=1630751221128","isCustomThumbnail":0,"builtinTags":["category-work","dataset","grid","legend","series-bar","series-graph","title","tooltip"],"customTags":[],"updaterUserName":"n***1"}}