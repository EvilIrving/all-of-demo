{"status":0,"data":{"cid":"xU0EToY4D8","authorUid":"obd-oPvKXcSGmLpm8qcAiYnaWMErxKKQJ9c","authorUserName":"182*****270","title":"仪表盘中的饼图","description":"","latestVersion":3,"alwaysLatest":0,"createTime":"2021-12-27T08:58:53.000Z","lastUpdateTime":"2021-12-28T01:06:47.000Z","auth":2,"uid":"obd-oPvKXcSGmLpm8qcAiYnaWMErxKKQJ9c","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":3,"parentVersion":2,"echartsVersion":"5.2.2","versionCreateTime":"2021-12-28T01:06:47.000Z","code":"var value = [\n    { name: 'ss', value: 120 },\n    { name: 'xx', value: 80 },\n    { name: 'yy', value: 65 },\n    { name: 'zz', value: 90 },\n    { name: 'hh', value: 70 },\n];\n\nvar dom_width = 800;\nvar dom_height = 800;\nvar center = ['50%', '93%'];\nvar guageMaxNum = 100; //仪表盘的最大数据值\nvar guageStartRadius = 10; //最小仪表盘半径\nvar guageIntervelRadius = 20; //仪表盘间隔半径\nvar colorArr = ['#5470C6', '#91CC75', '#FAC858', '#EE6666', '#73C0DE'];\nvar guageColorArr = ['#fff', '#fff', '#fff', '#fff', '#fff'];\n\n //饼图数据超过仪表盘最大值时\nvalue = value.map(function(val, index){\n\tvar obj = {}\n    obj.value = Math.min(val.value, guageMaxNum); \n\tobj.name = val.name;\n\tobj.trueVal = val.trueVal? val.trueVal:val.value;\n\treturn obj;\n})\n//半径参照值\nvar radiusRefer;\nif (dom_height >= dom_width / 2) {\n    //高度大于等于宽度的一般，半径参照值为容器宽度一半\n    radiusRefer = dom_width / 2;\n} else {\n    radiusRefer = Math.min(dom_height, dom_width);\n}\n\n\nvar maxPer;\nif (guageMaxNum % 5 == 0) {\n    maxPer = guageMaxNum / 5;\n} else {\n    maxPer = parseInt(guageMaxNum / 5) + 1;\n}\n\n\n//是否对数据进行处理\nvar isOperatorData;\nvalue.forEach(function (value, index) {\n    if (value.value == guageMaxNum && value.name == '') {\n        //有值为最大值的数据则处理数据\n        isOperatorData = true;\n    } else {\n        isOperatorData = false;\n    }\n});\n\nvar dataLength = value.length;\nif (isOperatorData) {\n    value.splice(dataLength / 2); //删除不是用户传入的数据（值为最大值的数据）\n}\n\n\nvar legend = [];\nvalue.map(function (value, index) {\n    legend.push(value.name);\n});\n\nvalue.forEach(function (item, index) {\n    value.push({\n        value: guageMaxNum, //使仪表盘值与饼图数据对应\n        name: '',\n        label: {\n            normal: {\n                show: false,\n            },\n        },\n        itemStyle: {\n            color: 'transparent',\n        },\n    });\n});\noption = {\n    backgroundColor: 'black',\n    title: {\n        show: false,\n        text: '标题',\n        left: 'center',\n        bottom: '5%',\n        textStyle: {\n            fontSize: 24,\n            color: '#fff',\n        },\n    },\n    legend: {\n        show: true,\n        top: 5,\n        left: 'center',\n        textStyle: {\n            fontSize: 14,\n            color: '#fff',\n        },\n        data: legend,\n    },\n    tooltip: {\n        trigger: 'item',\n    },\n    series: [\n        {\n            type: 'pie',\n            tooltip: {\n                formatter: function (params) {\n                    return params.data.name + ':' + params.data.trueVal;\n                },\n            },\n            radius: radiusRefer * 0.88,\n            center: center,\n            roseType: 'area',\n            startAngle: 180,\n            label: {\n                show: true,\n                position: 'inside',\n            },\n            itemStyle: {\n                opacity: 1,\n                color: function (params) {\n                    var colorList = colorArr;\n                    return colorList[params.dataIndex % colorList.length];\n                },\n            },\n            data: value,\n        },\n    ],\n};\n//向option.series中插入仪表盘\nfor (i = 5; i > 0; i--) {\n    var radiusAccount = (guageStartRadius + guageIntervelRadius * (i - 1)) * 0.01;\n    option.series.unshift({\n        name: 'Indicator',\n        type: 'gauge',\n        //radius: (confOptions.guageStartRadius + confOptions.guageIntervelRadius*(i-1)) + '%',\n        radius: radiusAccount * radiusRefer,\n        center: center,\n        detail: {\n            //仪表盘详情，用于显示数据\n            show: false,\n        },\n        pointer: {\n            //仪表盘指针\n            show: false,\n        },\n        startAngle: 180, //仪表盘起始角度\n        endAngle: 0, //仪表盘结束角度\n        splitNumber: 1, //仪表盘刻度的分割段数\n        axisTick: {\n            //刻度样式\n            show: false,\n        },\n        min: maxPer * i, //最小的数据值\n        max: maxPer * i, //最大的数据值\n        axisLine: {\n            //仪表盘轴线相关配置\n            show: true,\n            lineStyle: {\n                width: 1,\n                color: [[1, guageColorArr[i - 1] || '#fff']],\n            },\n        },\n        splitLine: {\n            //分割线样式\n            show: false,\n            length: 0, //分割线线长\n            distance: 0, //分割线与轴线距离\n        },\n        axisLabel: {\n            //刻度标签\n            show: true,\n            padding: [0, 0, 23, 0],\n            distance: -5, //标签与刻度线的距离\n            rich: {\n                pad: {\n                    padding: [45, 0, 0, 0],\n                },\n            },\n            formatter: '{pad|{value}}',\n        },\n    });\n}\n","html":"","externalScripts":"","updaterUID":"obd-oPvKXcSGmLpm8qcAiYnaWMErxKKQJ9c","theme":"","layout":"","viewCount":0,"userName":"182*****270","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xU0EToY4D8.png?v=1640653607440","isCustomThumbnail":0,"builtinTags":["category-work","legend","series-gauge","series-pie","title","tooltip"],"customTags":[],"updaterUserName":"182*****270"}}