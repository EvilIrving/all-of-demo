{"status":0,"data":{"cid":"xB1N10Fj4e","authorUid":"bd-4013131402","authorUserName":"o***4","title":"Ovilia 2016 读书统计","description":"","latestVersion":2,"alwaysLatest":1,"createTime":"2016-12-24T05:55:39.000Z","lastUpdateTime":"2016-12-24T05:55:39.000Z","auth":2,"uid":"bd-4013131402","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"3.3.2","versionCreateTime":"2016-12-24T05:58:48.000Z","code":"var score = [0, 0, 0, 0, 0];\nvar count = 100;\n\noption = {\n    title: {\n        text: 'Ovilia 读书统计 (loading...)'\n    },\n    xAxis: {\n        data: ['1分', '2分', '3分', '4分', '5分']\n    },\n    yAxis: {\n        max: 160,\n        interval: 40\n    },\n    series: [{\n        type: 'bar',\n        data: score,\n        label: {\n            normal: {\n                show: true,\n                position: 'top',\n                formatter: function(obj) {\n                    if (obj.value === 0) {\n                        return '';\n                    } else {\n                        return obj.value + '本';\n                    }\n                }\n            },\n        },\n    }],\n    tooltip: {\n        show: true\n    }\n};\n\nvar url = 'https://api.douban.com/v2/book/user/ovilia1024/collections';\nloadNext(0);\n\nvar collections = [];\n\nfunction loadNext(page) {\n    $.ajax({\n        url: url,\n        data: {\n            start: count * page,\n            count: count,\n            from: '2016-01-01T00:00:00'\n        },\n        dataType: 'jsonp',\n        crossDomain: true\n    })\n    .done(function(data) {\n        console.log(data)\n        \n        for (var i = 0; i < data.collections.length; ++i) {\n            var record = data.collections[i];\n            if (record.rating) {\n                ++score[parseInt(record.rating.value, 10) - 1];\n            }\n        }\n        collections = collections.concat(data.collections);\n        \n        var title = {};\n        \n        // load next page\n        if (data.start + data.count < data.total) {\n            loadNext(page + 1);\n        }\n        else {\n            title = {\n                text: 'Ovilia 读书统计'\n            };\n            // console.log(JSON.stringify(collections));\n        }\n        \n        myChart.setOption({\n            series: [{\n                data: score\n            }],\n            title: title\n        });\n    });\n}\n","html":"","externalScripts":"https://code.jquery.com/jquery-2.2.4.js","updaterUID":"bd-4013131402","theme":"","layout":"","viewCount":2283,"userName":"o***4","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xB1N10Fj4e.png?v=1482559128188","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-bar","title","tooltip"],"customTags":[],"updaterUserName":"o***4"}}