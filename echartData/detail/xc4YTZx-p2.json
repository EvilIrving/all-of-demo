{"status":0,"data":{"cid":"xc4YTZx-p2","authorUid":"bd-1896067372","authorUserName":"a***6","title":"苏州点位","description":"","latestVersion":16,"alwaysLatest":1,"createTime":"2020-03-28T09:23:58.000Z","lastUpdateTime":"2020-03-28T09:23:58.000Z","auth":2,"uid":"bd-1896067372","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":16,"parentVersion":15,"echartsVersion":"4.7.0","versionCreateTime":"2020-04-21T04:06:36.000Z","code":"/**\r\n此版本通过设置geoindex && seriesIndex: [1] 属性来实现geo和map共存，来达到hover散点和区域显示tooltip的效果\r\n\r\n默认情况下，map series 会自己生成内部专用的 geo 组件。但是也可以用这个 geoIndex 指定一个 geo 组件。这样的话，map 和 其他 series（例如散点图）就可以共享一个 geo 组件了。并且，geo 组件的颜色也可以被这个 map series 控制，从而用 visualMap 来更改。\r\n当设定了 geoIndex 后，series-map.map 属性，以及 series-map.itemStyle 等样式配置不再起作用，而是采用 geo 中的相应属性。\r\n\r\nhttp://echarts.baidu.com/option.html#series-map.geoIndex\r\n\r\n并且加了pin气泡图标以示数值大小\r\n*/\r\n\r\n\r\nvar uploadedDataURL = \"/asset/get/s/data-1560931254972-eeodqbz5-.json\";\r\n\r\n\r\nmyChart.showLoading();\r\n$.getJSON(uploadedDataURL, function(geoJson) {\r\n    echarts.registerMap('jiangxi', geoJson);\r\n    myChart.hideLoading();\r\n   var geoCoordMap = {\r\n            '南京市': [118.796, 32.058],\r\n            '无锡市': [120.312, 31.490],\r\n            '徐州市': [120.643338882, 31.9787250105],\r\n            '常州市': [120.643338882, 31.9787250105],\r\n            '苏州市': [120.643338882, 31.9787250105]\r\n        }\r\n        var data = [{\r\n                name: \"南京市\",\r\n                value: 4277,\r\n                myl: \"93.2%\"\r\n            },\r\n            {\r\n                name: \"无锡市\",\r\n                value: 877,\r\n                myl: \"93.2%\"\r\n            },\r\n            {\r\n                name: \"徐州市\",\r\n                value: 356,\r\n                myl: \"93.2%\"\r\n            },\r\n            {\r\n                name: \"常州市\",\r\n                value: 1532,\r\n                myl: \"93.2%\"\r\n            },\r\n            {\r\n                name: \"苏州市\",\r\n                value: 447,\r\n                myl: \"93.2%\"\r\n            },\r\n            {\r\n                name: \"南通市\",\r\n                value: 963,\r\n                myl: \"93.2%\"\r\n            },\r\n            {\r\n                name: \"淮安市\",\r\n                value: 809,\r\n                myl: \"93.2%\"\r\n            },\r\n            {\r\n                name: \"盐城市\",\r\n                value: 4641,\r\n                myl: \"93.2%\"\r\n            },\r\n            {\r\n                name: \"扬州市\",\r\n                value: 1268,\r\n                myl: \"93.2%\"\r\n            },\r\n            {\r\n                name: \"泰州市\",\r\n                value: 1268,\r\n                myl: \"93.2%\"\r\n            },\r\n            {\r\n                name: \"宿迁市\",\r\n                value: 4641,\r\n                myl: \"93.2%\"\r\n            },\r\n            {\r\n                name: \"镇江市\",\r\n                value: 1268,\r\n                myl: \"93.2%\"\r\n            },\r\n             {\r\n                name: \"连云港市\",\r\n                value: 1268,\r\n                myl: \"93.2%\"\r\n            }\r\n        ];\r\n    var max = 480, min = 9; // todo \r\n    var maxSize4Pin = 100, minSize4Pin = 20;\r\n\r\n  var convertData = function (data) {\r\n    var res = [];\r\n    for (var i = 0; i < data.length; i++) {\r\n        var geoCoord = geoCoordMap[data[i].name];\r\n        if (geoCoord) {\r\n            res.push({\r\n                name: data[i].name,\r\n                value: geoCoord.concat(data[i].value)\r\n            });\r\n        }\r\n    }\r\n    return res;\r\n};\r\n\r\n\r\n    option = {\r\n        title: {\r\n        },\r\n        tooltip: {\r\n            trigger: 'item',\r\n            formatter: function (params) {\r\n              if(typeof(params.value)[2] == \"undefined\"){\r\n              \treturn params.name + ' : ' + params.value;\r\n              }else{\r\n              \treturn params.name + ' : ' + params.value[2];\r\n              }\r\n            }\r\n        },\r\n\r\n        legend: {\r\n            orient: 'vertical',\r\n            y: 'bottom',\r\n            x: 'right',\r\n            data: ['credit_pm2.5'],\r\n            textStyle: {\r\n                color: '#fff'\r\n            }\r\n        },\r\n       \r\n         visualMap: {\r\n            min: 0,\r\n            max: 2000,\r\n            left: '1%',\r\n            bottom: '1%',\r\n             calculable: true,\r\n            seriesIndex: [0],\r\n            itemWidth: 15,\r\n            itemHeight: 100,\r\n            text: ['map3D'],\r\n            realtime: false,\r\n            textStyle: {\r\n                color: 'black',\r\n                fontSize: '15'\r\n            },\r\n            inRange: {\r\n                color: ['#83D1FC', '#62ACE8', '#3A7FCE']\r\n            }\r\n        },\r\n        geo: {\r\n            show: true,\r\n            zlevel: -100,\r\n            roam: false,\r\n            map: 'jiangxi'\r\n        },\r\n        series : [\r\n         {\r\n            type: 'map3D',\r\n            map: 'jiangxi',\r\n             roam: false,\r\n            data: data,\r\n            zlevel: 4\r\n        },\r\n        {\r\n            type: 'map',\r\n            map: 'jiangxi',\r\n            roam: false,\r\n            data: data,\r\n            show: false,\r\n            zlevel: -100\r\n        },\r\n        {\r\n            zlevel:12,\r\n            name: '点',\r\n            type: 'scatter',\r\n            coordinateSystem: 'geo',\r\n            symbol: 'pin',\r\n            symbolSize: 50,\r\n            label: {\r\n                normal: {\r\n                    show: true,\r\n                    formatter: function(value) {\r\n                        return value.value[2]\r\n                    },\r\n                    textStyle: {\r\n                        color: '#fff',\r\n                        fontSize: 12,\r\n                    }\r\n                }\r\n            },\r\n            itemStyle: {\r\n                normal: {\r\n                    color: '#CE376B', //标志颜色\r\n                }\r\n            },\r\n            data: convertData(data),\r\n        },\r\n        \r\n         \r\n    ]\r\n    };\r\n    myChart.setOption(option);\r\n});","html":"","externalScripts":"https://echarts.baidu.com/resource/echarts-gl-latest/dist/echarts-gl.min.js","updaterUID":"bd-1896067372","theme":"","layout":"","viewCount":1862,"userName":"a***6","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xc4YTZx-p2.png?v=1587441997040","isCustomThumbnail":0,"builtinTags":["category-work","geo","legend","series-map","series-map3D","series-scatter","title","tooltip","visualMap"],"customTags":[],"updaterUserName":"a***6"}}