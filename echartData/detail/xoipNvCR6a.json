{"status":0,"data":{"cid":"xoipNvCR6a","authorUid":"obd-o2LT5SPsRm62u1sF90rM6cs58MmkP66","authorUserName":"j***9","title":"","description":"","latestVersion":2,"alwaysLatest":0,"createTime":"2021-09-16T09:35:19.000Z","lastUpdateTime":"2021-09-16T09:44:11.000Z","auth":2,"uid":"obd-o2LT5SPsRm62u1sF90rM6cs58MmkP66","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"5.2.0","versionCreateTime":"2021-09-16T09:44:11.000Z","code":"// mock 数据\r\nconst dataArr = {\r\n    xdata: ['站前1标', '站前2标', '站前3标', '站前4标', '站前5标', '站前6标'],\r\n    result: [\r\n        { name: '桥架机', data: [320, 435, 490, 340, 320, 270,] },\r\n        { name: '运粮车', data: [150, 220, 210, 310, 140, 180,] },\r\n        { name: '轮胎及履带式起重机', data: [250, 120, 240, 280, 240, 180] },\r\n        { name: '长螺旋粘机', data: [180, 420, 370, 250, 210, 180,] },\r\n    ]\r\n}\r\n// 头部菱形\r\nconst diamondData = dataArr.result.reduce((pre, cur, index) => {\r\n    pre[index] = cur.data.map((el, id) => el + ( pre[index - 1] ? pre[index - 1][id] : 0))\r\n    return pre\r\n}, [])\r\n\r\n// color\r\nconst color = [\r\n    [{ offset: 0, color: \"#7297FF\", }, { offset: 0.5, color: \"#7297FF\", }, { offset: 0.5, color: \"#364BEC\", }, { offset: 1, color: \"#364BEC\", }],\r\n    [{ offset: 0, color: \"#00C4FF\", }, { offset: 0.5, color: \"#00C4FF\", }, { offset: 0.5, color: \"#0091FF\", }, { offset: 1, color: \"#0091FF\", }],\r\n    [{ offset: 0, color: \"#79EDDC\", }, { offset: 0.5, color: \"#79EDDC\", }, { offset: 0.5, color: \"#44D7B6\", }, { offset: 1, color: \"#44D7B6\", }],\r\n    [{ offset: 0, color: \"#FCDB00\", }, { offset: 0.5, color: \"#FCDB00\", }, { offset: 0.5, color: \"#F7B500\", }, { offset: 1, color: \"#F7B500\", }],\r\n    [{ offset: 0, color: \"#FA6400\", }, { offset: 0.5, color: \"#FA6400\", }, { offset: 0.5, color: \"#FD9D00\", }, { offset: 1, color: \"#FD9D00\", }],\r\n    [{ offset: 0, color: \"#D72552\", }, { offset: 0.5, color: \"#D72552\", }, { offset: 0.5, color: \"#F572A4\", }, { offset: 1, color: \"#F572A4\", }],\r\n    [{ offset: 0, color: \"#B620E0\", }, { offset: 0.5, color: \"#B620E0\", }, { offset: 0.5, color: \"#EC66FF\", }, { offset: 1, color: \"#EC66FF\", }],\r\n    [{ offset: 0, color: \"#6236FF\", }, { offset: 0.5, color: \"#6236FF\", }, { offset: 0.5, color: \"#9B66FF\", }, { offset: 1, color: \"#9B66FF\", }],\r\n]\r\n\r\n// series\r\nlet series = dataArr.result.reduce((p, c, i, array) => {\r\n    p.push({\r\n        z: i + 1,\r\n        stack: '总量',\r\n        type: 'bar',\r\n        name: c.name,\r\n        barGap: '-100%',\r\n        barWidth: 30,\r\n        data: c.data,\r\n        itemStyle:{ color: { type: 'linear', x: 0, x2: 1, y: 0, y2: 0, colorStops: color[i] } },\r\n    },{\r\n        z: i + 10,\r\n        type: 'pictorialBar',\r\n        symbolPosition: 'end',\r\n        symbol: 'diamond',\r\n        symbolOffset: [0, '-50%'],\r\n        symbolSize: [30, 10],\r\n        data: diamondData[i],\r\n        itemStyle: { color: { type: 'linear', x: 0, x2: 1, y: 0, y2: 0, colorStops: color[i] } },\r\n        tooltip: { show: false },\r\n    })\r\n\r\n    // 是否最后一个了？\r\n    if (p.length  === (array.length) * 2) {\r\n        p.push({\r\n            z: array.length * 2,\r\n            type: \"pictorialBar\",\r\n            symbolPosition: \"start\",\r\n            data: dataArr.result[0].data,\r\n            symbol: \"diamond\",\r\n            symbolOffset: [\"0%\", \"50%\"],\r\n            symbolSize: [30, 10],\r\n            itemStyle: { color: { type: 'linear', x: 0, x2: 1, y: 0, y2: 0, colorStops: color[0]} },\r\n            tooltip: { show: false },\r\n        })\r\n        return p\r\n    }\r\n\r\n    return p\r\n}, [])\r\n\r\n// tooltip\r\nconst tooltip = { trigger: \"axis\" }\r\n\r\n// legend\r\nconst legend = {\r\n    data: dataArr.result.map(item => item.name),\r\n    textStyle: { fontSize: 14, color: '#333333'},\r\n    itemWidth: 25,\r\n    itemHeight: 15,\r\n    itemGap: 15,\r\n    bottom: '5%',\r\n}\r\n// grid\r\nconst grid = { top: '10%', left: '10%', right: '3%', bottom: '15%'}\r\n\r\n// xAxis\r\nconst xAxis = { \r\n    axisTick: { show: true },\r\n    axisLine: { lineStyle: { color: 'rgba(0,0,0, .2)' } },\r\n    axisLabel: { textStyle: { fontSize: 12, color: '#333333'  }, },\r\n    data: dataArr.xdata\r\n}\r\n\r\n// yAxis\r\nconst yAxis = [{ \r\n    splitLine: { lineStyle: { color: 'rgba(0,0,0, .2)' } },\r\n    axisLine: { show: false, },\r\n    axisLabel: { textStyle: { fontSize: 16, color: '#3333333' } }\r\n}]\r\n\r\n// 渲染\r\noption = { tooltip, xAxis, yAxis, series, grid, legend, backgroundColor:'#fff' }\r\n","html":"","externalScripts":"","updaterUID":"obd-o2LT5SPsRm62u1sF90rM6cs58MmkP66","theme":"","layout":"","viewCount":0,"userName":"j***9","commentCount":0,"starCount":5,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xoipNvCR6a.png?v=1631785451421","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","series-pictorialBar","tooltip"],"customTags":[],"updaterUserName":"j***9"}}