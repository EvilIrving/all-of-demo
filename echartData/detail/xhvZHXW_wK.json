{"status":0,"data":{"cid":"xhvZHXW_wK","authorUid":"bd-101698999","authorUserName":"Z***8","title":"读者提问，提示框显示饼图","description":"版本 1：使用 setInterval 随时判断、渲染；\n版本 2：使用了 setTimeout 函数，随着 tooltip.formatter 回调函数的执行而触发。","latestVersion":2,"alwaysLatest":1,"createTime":"2020-06-18T06:30:35.000Z","lastUpdateTime":"2020-06-23T05:47:06.000Z","auth":2,"uid":"bd-101698999","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.8.0","versionCreateTime":"2020-06-23T05:18:49.000Z","code":"option = {\n    title: {\n        text: '读者提问，提示框能否显示饼图'\n    },\n    xAxis: {\n        data: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']\n    },\n    yAxis: {},\n    tooltip: {\n        trigger: 'axis',\n        formatter: params => {\n            // 根据触发提示框的数据，准备饼图数据\n            let pieData = [];\n            for (let i in params) {\n                pieData.push({\n                    name: params[i].seriesName,\n                    value: params[i].value,\n                    color: params[i].color\n                });\n            }\n\n            // 通过准备好的饼图数据，显示饼图（通过加一定时延，保证容器先覆盖完…）\n            initTooltipPie(pieData);\n            return `${params[0].axisValue}<br/><div id=\"tooltipPie\" style=\"width: 100px;height:100px;\"></>`;\n        }\n    },\n    series: [{\n        type: 'bar',\n        stack: 'stack1',\n        data: [220, 182, 191, 234, 290, 330, 310]\n    }, {\n        type: 'bar',\n        stack: 'stack1',\n        data: [120, 122, 91, 324, 113, 130, 410]\n    }, {\n        type: 'bar',\n        stack: 'stack1',\n        data: [42, 32, 29, 72, 31, 63, 101]\n    }]\n};\n\n\n// 饼图 option 生成函数\npieOption = data => {\n    console.log(data);\n    return {\n        series: {\n            type: \"pie\",\n            labelLine: {\n                show: false\n            },\n            label: {\n                show: false\n            },\n            data: data\n        },\n        animation: false\n    };\n};\n\n// 显示饼图的函数\ninitTooltipPie = (data, delay = 1) => {\n    setTimeout(function() {\n        if (document.getElementById('tooltipPie') !== null && document.getElementById('tooltipPie').innerHTML === '') {\n            if (typeof tooltipChart !== 'undefined') {\n                return tooltipChart.setOption(pieOption(data));\n            }\n            var tooltipChart = echarts.init(document.getElementById(\"tooltipPie\"));\n            tooltipChart.setOption(pieOption(data));\n        }\n    }, delay);\n};\n\n\n\n\n/**\n * 因为每次弹出/移动提示框，都会覆盖提示框 DOM，所以只能每次都重新渲染饼图\n * （暂且使用了个笨办法 setInterval，10 毫秒判断处理一次 = =b，有时间再想想更好的方式）\n\nsetInterval(function(){\n    if (document.getElementById('tooltipPie') !== null && document.getElementById('tooltipPie').innerHTML === '') {\n        if (typeof tooltipChart !== 'undefined') {\n            return tooltipChart.setOption(pieOption);\n        }\n        var tooltipChart = echarts.init(document.getElementById(\"tooltipPie\"));\n        tooltipChart.setOption(pieOption);\n    }\n},10);\n */","html":"","externalScripts":"","updaterUID":"bd-101698999","theme":"default","layout":"","viewCount":397,"userName":"Z***8","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xhvZHXW_wK.png?v=1592461836028","isCustomThumbnail":1,"builtinTags":["category-work","grid","series-bar","title","tooltip"],"customTags":["pie"],"updaterUserName":"Z***8"}}