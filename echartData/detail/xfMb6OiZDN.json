{"status":0,"data":{"cid":"xfMb6OiZDN","authorUid":"obd-oA0FLjFpzSNQia8AxuYYDSWpoDnYG7I","authorUserName":"长***依","title":"自定义系列","description":"","latestVersion":7,"alwaysLatest":1,"createTime":"2020-04-23T12:21:09.000Z","lastUpdateTime":"2020-04-23T12:21:09.000Z","auth":2,"uid":"obd-oA0FLjFpzSNQia8AxuYYDSWpoDnYG7I","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":7,"parentVersion":6,"echartsVersion":"4.7.0","versionCreateTime":"2020-05-08T07:44:51.000Z","code":"// const Y1_COORD = [530, 730, 900, 1040, 1040, 900, 730, 530]\nconst Y_COORD = [500, 595, 649, 667, 667, 649, 595, 500]\nconst STAGES = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H']\nconst STAGE_COUNT = 4\nconst PARENT_STAGE_HEIGHT = 70\nconst PARENT_STAGE_GAP = 20\nconst CHILD_STAGE_HEIGHT = 50\nconst CHILD_STAGE_GAP = 10\n\nconst DEL_ICON = 'M755.330958 336.707648l-20.329001 0 0 510.511089-67.077721 0L667.924235 336.707648 556.122917 336.707648l0 510.511089-67.081815 0L489.041102 336.707648 377.248993 336.707648l0 510.511089-67.077721 0L310.171272 336.707648l-42.688241 0c-50.514487 0-91.471294-0.728594-91.471294 0L176.011736 870.099864c0 49.105395 40.957831 88.914052 91.471294 88.914052l487.838717 0c50.52779 0 91.467201-39.808658 91.467201-88.914052L846.788949 336.707648C846.793042 332.960301 805.862841 336.707648 755.330958 336.707648L755.330958 336.707648zM890.73381 176.440501 690.283476 176.440501l0-54.552453c0-31.620162-56.511062-57.243749-89.446171-57.243749l-178.873923 0c-32.917714 0-89.432869 25.623587-89.432869 57.243749l0 54.552453-200.414519 0c-25.15389 0-45.537126 20.025079-45.537126 44.722574 0 24.684192 20.37812 44.709271 45.537126 44.709271l758.617817 0c25.127284 0 45.50131-20.025079 45.50131-44.709271C936.225911 196.46558 915.851884 176.440501 890.73381 176.440501L890.73381 176.440501zM600.841398 176.440501 421.972591 176.440501l0-22.35924 178.86983 0L600.842421 176.440501 600.841398 176.440501zM600.841398 176.440501'\nconst COLOR = ['#a4d3ff', '#77baff', '#4495f9', '#0d70ee', '#0451c6', '#7f91b4', '#99acd0', '#b4c7ec']\nconst COLOR_STAGE = '#ecf4fc'\nconst STAGE_BORDER_RADIUS = 4\nconst TRIANGLE_SIZE = 9\n\n// generate stage data\nlet data = []\necharts.util.each(STAGES, function(category, index) {\n    let basePosition = Y_COORD[index]\n    for (let i = 0; i < STAGE_COUNT; i++) {\n        let duration = i === 0 ? PARENT_STAGE_HEIGHT : CHILD_STAGE_HEIGHT\n        let textName = category + (i === 0 ? '期' : i)\n\n        data.push({\n            name: textName,\n            value: [index, basePosition, basePosition -= duration, textName, i],\n            itemStyle: {\n                normal: {\n                    color: i === 0 ? COLOR[index] : COLOR_STAGE\n                }\n            }\n        })\n        basePosition = basePosition - (i === 0 ? PARENT_STAGE_GAP : CHILD_STAGE_GAP)\n    }\n})\n\nfunction renderItem(params, api) {\n    let categoryIndex = api.value(0)\n    let start = api.coord([categoryIndex, api.value(1)])\n    let end = api.coord([categoryIndex, api.value(2)])\n    let width = api.size([1, 0])[0] * 0.6\n    let height = end[1] - start[1]\n    let x = start[0] - width / 2\n    let y = start[1] + height / 2\n\n    let rectShape = echarts.graphic.clipRectByRect({\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n    }, {\n        x: params.coordSys.x,\n        y: params.coordSys.y,\n        width: params.coordSys.width,\n        height: params.coordSys.height\n    })\n    rectShape.r = STAGE_BORDER_RADIUS\n\n    let isFstStage = api.value(4) === 0\n\n    let textSize = isFstStage ? 16 : 14\n    let textColor = isFstStage ? '#fff' : '#34495e'\n\n    let btnDelSize = isFstStage ? 16 : 12\n    let btnDelX = start[0] + width / 2 + btnDelSize\n    return {\n        type: 'group',\n        children: [{\n                type: 'path', // 此处设置svg路径类型\n                shape: {\n                    pathData: isFstStage ? \"m63.1875,76.61313l17,-29.75l17,29.75l-34,0z\" : '', // 三角形\n                    width: TRIANGLE_SIZE,\n                    height: TRIANGLE_SIZE,\n                    x: x + width / 2 - TRIANGLE_SIZE / 2,\n                    y: y - TRIANGLE_SIZE + 1\n                },\n                style: api.style()\n            },\n            {\n                type: 'rect',\n                shape: rectShape,\n                // 用 api.style(...) 得到默认的样式设置。这个样式设置包含了\n                // option 中 itemStyle 的配置和视觉映射得到的颜色。\n                style: api.style()\n            },\n            {\n                type: 'text',\n                style: {\n                    x: x + width / 2,\n                    y: y + height / 4,\n                    textAlign: 'center',\n                    text: api.value(3),\n                    fill: textColor,\n                    textFont: api.font({\n                        fontSize: textSize\n                    })\n                }\n            },\n\n            {\n                type: 'path',\n                name: 'btn-del',\n                shape: {\n                    pathData: DEL_ICON,\n                    x: -8,\n                    y: -8,\n                    width: btnDelSize,\n                    height: btnDelSize\n                },\n                position: [btnDelX, y + height / 2],\n                style: api.style({\n                    fill: '#99a4ae'\n                })\n            }\n        ]\n    }\n}\n\n\noption = {\n    title: {\n        text: '自定义系列',\n    },\n    color: COLOR,\n    backgroundColor: '#fff',\n    grid: {\n        left: '5%'\n    },\n    tooltip: {\n        formatter: function(params) {\n            return params.marker + params.value[3];\n        }\n    },\n    yAxis: {\n        max: 750,\n        name: '价值',\n        nameTextStyle: {\n            nameGap: 0,\n            fontSize: 14,\n            color: '#34495e'\n        },\n        axisLine: {\n            symbol: ['none', 'arrow'],\n            symbolSize: [8, 8],\n            lineStyle: {\n                width: 2,\n                color: '#dce5ed'\n            }\n        },\n        axisTick: {\n            show: false\n        },\n        axisLabel: {\n            show: false\n        },\n        splitLine: {\n            lineStyle: {\n                type: 'dotted',\n                color: ['#dbdcdb'],\n                opacity: 0.5\n            }\n        }\n    },\n    xAxis: {\n        name: '阶段',\n        nameTextStyle: {\n            nameGap: 0,\n            fontSize: 14,\n            color: '#34495e'\n        },\n        axisLine: {\n            symbol: ['none', 'arrow'],\n            symbolSize: [8, 8],\n            lineStyle: {\n                width: 2,\n                color: '#dce5ed'\n            }\n        },\n        axisTick: {\n            show: false\n        },\n        axisLabel: {\n            show: false\n        },\n        splitLine: {\n            show: true,\n            lineStyle: {\n                type: 'dashed',\n                color: ['#eff1f4']\n            }\n        },\n        data: STAGES\n    },\n    series: [{\n        type: 'custom',\n        renderItem: renderItem,\n        encode: {\n            y: [1, 2],\n            x: 0\n        },\n        data: data\n    }, {\n        data: Y_COORD,\n        type: 'line',\n        smooth: true,\n        symbol: 'circle',\n        animation: false,\n        symbolSize: 14,\n        itemStyle: {\n            color: (params) => {\n                return COLOR[params.dataIndex]\n            },\n            borderWidth: 4,\n            borderColor: '#fff'\n        },\n        lineStyle: {\n            color: '#eff1f4'\n        },\n        silent: true\n    }]\n};\n\n// 执行删除\nmyChart.on('click', {\n    element: 'btn-del'\n}, function(params) {\n    console.log(params);\n});","html":"","externalScripts":"","updaterUID":"obd-oA0FLjFpzSNQia8AxuYYDSWpoDnYG7I","theme":"","layout":"","viewCount":5647,"userName":"长***依","commentCount":0,"starCount":27,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xfMb6OiZDN.png?v=1588923891858","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-custom","series-line","title","tooltip"],"customTags":[],"updaterUserName":"长***依"}}