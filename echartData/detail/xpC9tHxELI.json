{"status":0,"data":{"cid":"xpC9tHxELI","authorUid":"obd-o-sCBghax_zkb7C2-SEMWGqPz3Q28AL","authorUserName":"i***a","title":"北京市中医机构督导情况","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2020-06-17T09:39:15.000Z","lastUpdateTime":"2020-06-17T09:39:15.000Z","auth":1,"uid":"obd-o-sCBghax_zkb7C2-SEMWGqPz3Q28AL","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-06-17T09:39:15.000Z","code":"var name_title = \"北京市中医机构督导情况\"\r\nvar subname = ''\r\nvar nameColor = \"#ffffff\"\r\nvar name_fontFamily = '等线'\r\nvar subname_fontSize = 15\r\nvar name_fontSize = 18\r\nvar mapName = 'beijing';\r\nvar beijingmapjson = \"https://geo.datav.aliyun.com/areas/bound/110000_full.json\";\r\nvar data = [{\r\n    name: \"北京王府中西医结合医院\",\r\n    value: 14\r\n}, {\r\n    name: \"中国中医科学院望京医院\",\r\n    value: 7\r\n}, {\r\n    name: \"中国中医科学院眼科医院\",\r\n    value: 6\r\n}, {\r\n    name: \"北京中医药大学东直门医院\",\r\n    value: 5\r\n}, {\r\n    name: \"北京中医药大学第三附属医院\",\r\n    value: 4\r\n}, {\r\n    name: \"北京华医中西医结合皮肤病医院\",\r\n    value: 3\r\n}, {\r\n    name: \"北京按摩医院\",\r\n    value: 10\r\n}, {\r\n    name: \"北京藏医院\",\r\n    value: 10\r\n}, {\r\n    name: \"裕和中西医结合康复医院\",\r\n    value: 8\r\n}];\r\n\r\nvar geoCoordMap = {\r\n    '北京王府中西医结合医院': [116.421084, 40.111241],\r\n    '中国中医科学院望京医院': [116.479714, 39.988116],\r\n    '中国中医科学院眼科医院': [116.237424, 39.910304],\r\n    '北京中医药大学东直门医院': [116.433851, 39.943285],\r\n    '北京中医药大学第三附属医院': [116.415561, 39.984592],\r\n    '北京华医中西医结合皮肤病医院': [116.281196, 39.961771],\r\n    '北京按摩医院': [116.377842, 39.941121],\r\n    '北京藏医院': [116.420175, 39.986357],\r\n    '裕和中西医结合康复医院': [116.270397, 39.92812]\r\n};\r\nvar toolTipData = [{\r\n    name: \"北京\",\r\n    value: [{\r\n        name: \"男\",\r\n        value: 1012\r\n    }, {\r\n        name: \"女\",\r\n        value: 948\r\n    }]\r\n}];\r\n\r\nvar max = 480,\r\n    min = 9; // todo \r\nvar maxSize4Pin = 100,\r\n    minSize4Pin = 20;\r\n\r\nvar convertData = function(data) {\r\n    var res = [];\r\n    for (var i = 0; i < data.length; i++) {\r\n        var geoCoord = geoCoordMap[data[i].name];\r\n        if (geoCoord) {\r\n            res.push({\r\n                name: data[i].name,\r\n                value: geoCoord.concat(data[i].value),\r\n            });\r\n        }\r\n    }\r\n    return res;\r\n};\r\nvar dsets = {\r\n    dimensions: ['机构', 'lng', 'lat', '风险分数', '风险级别'],\r\n    source: [{\r\n            '机构': '北京王府中西医结合医院',\r\n            'lng': 116.421084,\r\n            'lat': 40.111241,\r\n            '风险分数': 10,\r\n            '风险级别': '全局风险'\r\n        },\r\n        {\r\n            '机构': '中国中医科学院望京医院',\r\n            'lng': 116.479714,\r\n            'lat': 39.988116,\r\n            '风险分数': 7,\r\n            '风险级别': '重大风险'\r\n        },\r\n        {\r\n            '机构': '中国中医科学院眼科医院',\r\n            'lng': 116.237424,\r\n            'lat': 39.910304,\r\n            '风险分数': 14,\r\n            '风险级别': '局部风险'\r\n        },\r\n        {\r\n            '机构': '北京中医药大学东直门医院',\r\n            'lng': 116.433851,\r\n            'lat': 39.943285,\r\n            '风险分数': 4,\r\n            '风险级别': '个体风险'\r\n        },\r\n    ]\r\n};\r\n$.getJSON(beijingmapjson, function(d) {\r\n    echarts.registerMap(mapName, d);\r\n    option = {\r\n        dataset: dsets,\r\n        backgroundColor: '#044161',\r\n        title: {\r\n            text: name_title,\r\n            subtext: subname,\r\n            x: 'center',\r\n            textStyle: {\r\n                color: nameColor,\r\n                fontFamily: name_fontFamily,\r\n                fontSize: name_fontSize\r\n            },\r\n            subtextStyle: {\r\n                fontSize: subname_fontSize,\r\n                fontFamily: name_fontFamily\r\n            }\r\n        },\r\n        tooltip: {\r\n            trigger: 'item',\r\n            alwaysShowContent:true,\r\n            //formatter: function(params) {\r\n            //    var toolTiphtml = ''\r\n            //    for (var i = 0; i < toolTipData.length; i++) {\r\n            //        if (params.name == toolTipData[i].name) {\r\n            //            toolTiphtml += toolTipData[i].name + ':<br>'\r\n            //            for (var j = 0; j < toolTipData[i].value.length; j++) {\r\n            //                toolTiphtml += toolTipData[i].value[j].name + ':' + toolTipData[i].value[j].value + \"<br>\"\r\n            //            }\r\n            //        }\r\n            //    }\r\n            //    console.log(toolTiphtml)\r\n            // console.log(convertData(data))\r\n            //    return toolTiphtml;\r\n            //}\r\n        },\r\n        // legend: {\r\n        //     orient: 'vertical',\r\n        //     y: 'bottom',\r\n        //     x: 'right',\r\n        //     data: ['credit_pm2.5'],\r\n        //     textStyle: {\r\n        //         color: '#fff'\r\n        //     }\r\n        // },\r\n        visualMap: {\r\n            show: true,\r\n            min: 2,\r\n            max: 10,\r\n            orient:'horizontal',\r\n            left: 'center',\r\n            top: '5%',\r\n            dimension:4,\r\n            categories:['全局风险','重大风险','局部风险','个体风险'],\r\n            inRange:{\r\n                color: ['red', 'orange', 'yellow','green' ],\r\n            },\r\n            textStyle:{\r\n                color:'white'\r\n            }\r\n        },\r\n        toolbox: {\r\n             show: true,\r\n             orient: 'vertical',\r\n             left: 'right',\r\n        //     top: 'center',\r\n             feature: {\r\n        //         dataView: {\r\n        //             readOnly: false\r\n        //         },\r\n        //         restore: {},\r\n                 saveAsImage: {}\r\n             }\r\n        },\r\n        geo: {\r\n            show: true,\r\n            map: mapName,\r\n            roam: true,\r\n            zoom: 5,\r\n            center: [116.421196, 39.991771],\r\n            label: {\r\n                show: true,\r\n                color: '#959595'\r\n            },\r\n            itemStyle: {\r\n                areaColor: '#004981',\r\n                borderColor: '#029fd4',\r\n                borderWidth: 1.0,\r\n                borderType: 'dotted',\r\n            },\r\n            emphasis: {\r\n                label: {\r\n                    show: false,\r\n                    color: '#959595'\r\n                },\r\n                itemStyle: {\r\n                    areaColor: '#045c9e',\r\n                    borderColor: '#029fd4',\r\n                    borderWidth: 1.0,\r\n                    borderType: 'dotted'\r\n                }\r\n            }\r\n        },\r\n        series: [{\r\n                name: '机构风险',\r\n                type: 'effectScatter',\r\n                coordinateSystem: 'geo',\r\n                //data: convertData(data),\r\n                encode: {\r\n                    lng: 'lng',\r\n                    lat: 'lat',\r\n                    //seriesName: 0,\r\n                    tooltip: [3, 4],\r\n                    itemName: '机构'\r\n\r\n                },\r\n                symbolSize: function(val) {\r\n                    return val['风险分数']+10;\r\n                },\r\n                showEffectOn: 'render',\r\n                rippleEffect: {\r\n                    brushType: 'stroke'\r\n                },\r\n                hoverAnimation: true,\r\n                label: {\r\n                    formatter: '{b}',\r\n                    position: 'right',\r\n                    show: true,\r\n                    fontStyle:'bold'\r\n                    //color: '#ffffff'\r\n                },\r\n                itemStyle: {\r\n                    color: 'yellow',\r\n                    shadowBlur: 10,\r\n                    shadowColor: 'white'\r\n                },\r\n                //emphasis: {label:{show:false}}\r\n            },\r\n            //{\r\n            //    type: 'map',\r\n            //    map: mapName,\r\n            //    geoIndex: 0,\r\n            //    aspectScale: 0.75, //长宽比\r\n            //    showLegendSymbol: false, // 存在legend时显示\r\n            //    label: {\r\n            //        normal: {\r\n            //            show: true\r\n            //        },\r\n            //        emphasis: {\r\n            //           show: false,\r\n            //            textStyle: {\r\n            //                color: '#fff'\r\n            //            }\r\n            //        }\r\n            //    },\r\n            //roam: true,\r\n            //    itemStyle: {\r\n            //        normal: {\r\n            //            areaColor: '#ffffff',\r\n            //            borderColor: '#3B5077',\r\n            //        },\r\n            //        emphasis: {\r\n            //            areaColor: '#2B91B7'\r\n            //        }\r\n            //    },\r\n            //    animation: false,\r\n            //data: data\r\n            //},\r\n        ]\r\n    };\r\n    myChart.setOption(option);\r\n});","html":"","externalScripts":"","updaterUID":"obd-o-sCBghax_zkb7C2-SEMWGqPz3Q28AL","theme":"","layout":"","viewCount":36,"userName":"i***a","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xpC9tHxELI.png?v=1592386755606","isCustomThumbnail":0,"builtinTags":["category-work","dataset","geo","series-effectScatter","title","toolbox","tooltip","visualMap"],"customTags":[],"updaterUserName":"i***a"}}