{"status":0,"data":{"cid":"xLzvj9oAF-","authorUid":"bd-506765776","authorUserName":"我***脑","title":"多组件组合","description":"246853@qq.com","latestVersion":19,"alwaysLatest":0,"createTime":"2021-07-08T07:37:51.000Z","lastUpdateTime":"2021-07-08T09:05:25.000Z","auth":2,"uid":"bd-506765776","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":19,"parentVersion":18,"echartsVersion":"5.1.2","versionCreateTime":"2021-07-08T09:05:25.000Z","code":"let _token = null;\nlet _taskId = null;\nlet _index1 = 20;\nlet _index2 = 40;\nlet _index3 = 60;\nlet _links = [];\nlet _hlinks = [];\n\nlet _index4 = 15;\nlet _index5 = 35;\nlet _index6 = 55;\n\nvar ldata = [{}];\n\nvar tips = 0;\nvar m = 0;\nvar mm = 1;\nlet startAngle = 70; // 初始旋转角度\nlet dolitData = generateData(100, 25, 20, 'rgb(126,190,255)');\nlet threeData = generateData(6, 40, 10, '#2dc0c9');\nlet dataArr = [];\n\n\n\nstart();\n\nfunction start() {\n    \n\n\n     option = getOption();\n         \n     setInterval(function fun(){\n        // console.log(option)\n        console.log(11111)\n         _links = new Array();\n        _(0);\n     }, 2000);\n}\n\nfunction getOption() {\n   let opt = {\n        grid: {\n            // top: 100,\n            // bottom: 100,\n            // left: 100,\n            // right: 100,\n             top: '120',\n                left: '215',\n                width: '300',\n                height: '300',\n        },\n        yAxis: {\n            show: false,\n            type: 'value',\n            max: 1,\n            min: -1,\n        },\n        xAxis: {\n            show: false,\n            type: 'value',\n            max: 1,\n            min: -1,\n        },\n        animation: true,\n        series: [\n            {\n                name: '节点',\n                type: 'graph',\n                roam: true,\n                draggable: true,\n                itemStyle: {\n                    normal: {\n                        color: '#694d9f',\n                    },\n                },\n                lineStyle: {\n                    normal: {\n                        color: '#694d9f',\n                        curveness: 0.1,\n                        opacity: 0.2,\n                        width: 3,\n                    },\n                },\n                effect: {\n                    show: true,\n                    period: 4,\n                    trailLength: 0.02,\n                    symbol: 'circle',\n                    symbolSize: 15,\n                    color: '#fff',\n                },\n\n                symbol: 'circle',\n                symbolSize: 5,\n                top: '120',\n                left: '215',\n                width: '300',\n                height: '300',\n                data: roundDatas1(1),\n                //links: linkDatas(12)\n            },\n            {\n                name: 10000,\n                type: 'graph',\n                roam: false,\n                draggable: false,\n                itemStyle: {\n                    normal: {\n                        color: '#694d9f',\n                    },\n                },\n                lineStyle: {\n                    normal: {\n                        color: '#694d9f',\n                        curveness: 1,\n                        opacity: 0.2,\n                    },\n                },\n                symbol: 'circle',\n                symbolSize: 0,\n                top: '400',\n                left: '400',\n                width: '10',\n                height: '10',\n                // symbol: 'image://images/wb1.png',\n                data: roundDatasroot(1),\n            },\n            {\n                animation: false,\n                animationThreshold: 100,\n                animationDurationUpdate: function (idx) {\n                    // 越往后的数据延迟越大\n                    return idx * 1000;\n                },\n\n                name: 'loading',\n                type: 'pie',\n                radius: ['48%', '52%'],\n                center: ['50%', '50%'],\n                hoverAnimation: false,\n                label: {\n                    normal: {\n                        show: false,\n                    },\n                },\n                data: [],\n            },\n            {\n                type: 'pie',\n                name: '旋转圆',\n                zlevel: 20,\n                silent: true,\n                radius: ['50%', '48%'],\n                hoverAnimation: false,\n                startAngle: startAngle,\n                data: threeData,\n                label: {\n                    normal: {\n                        show: false,\n                    },\n                },\n                labelLine: {\n                    normal: {\n                        show: false,\n                    },\n                },\n            },\n            {\n                name: '线图',\n                type: 'lines',\n                hoverAnimation: false,\n                silent: false,\n                cursor: 'default',\n                coordinateSystem: 'cartesian2d',\n                polyline: false, // 多线段\n                z: 1,\n                lineStyle: {\n                    width: 1,\n                    // type: 'dashed',\n                    curveness: 0.2,\n                },\n                effect: {\n                    show: true,\n                    period: 8, //箭头指向速度，值越小速度越快\n                    // trailLength: 0.5, //特效尾迹长度[0,1]值越大，尾迹越长重\n                    // symbol: 'arrow', //箭头图标\n                    symbolSize: 10,\n                    trailLength: 0.3,\n                    smooth: true,\n                },\n                emphasis: {\n                    lineStyle: {\n                        type: 'dashed',\n                    },\n                },\n                data: dataArr,\n            },\n            {\n                name: '环线线图',\n                type: 'lines',\n                hoverAnimation: false,\n                silent: false,\n                cursor: 'default',\n                coordinateSystem: 'cartesian2d',\n                polyline: false, // 多线段\n                z: 1,\n                symbol: ['none', 'arrow'],\n                label: {\n                    show: true,\n                    position: 'middle',\n                    fontSize: 20,\n                },\n                lineStyle: {\n                    width: 1,\n                    // type: 'dashed',\n                    curveness: 0.3,\n                },\n                effect: {\n                    show: true,\n                    period: 8, //箭头指向速度，值越小速度越快\n                    // trailLength: 0.5, //特效尾迹长度[0,1]值越大，尾迹越长重\n                    symbol: 'arrow', //箭头图标\n                    symbolSize: 10,\n                    trailLength: 0.4,\n                    smooth: true,\n                },\n                emphasis: {\n                    lineStyle: {\n                        type: 'dashed',\n                    },\n                },\n                data: dataArr,\n            },\n        ],\n    };\n    return opt;\n}\n\nfunction _(index) {\n    var dt = new Date();\n    let _links = new Array();\n    let _hlinks = new Array();\n\n    var s1,\n        s2,\n        s3 = 0;\n    s1 = _index1 + 1;\n    _index1 = s1;\n    s2 = _index2 + 1;\n    _index2 = s2;\n    s3 = _index3 + 1;\n    _index3 = s3;\n\n    var xs1 = Math.cos((6 * s1 * Math.PI) / 180);\n    var xs2 = Math.cos((6 * s2 * Math.PI) / 180);\n    var xs3 = Math.cos((6 * s3 * Math.PI) / 180);\n\n    var ys1 = Math.sin((6 * s1 * Math.PI) / 180);\n    var ys2 = Math.sin((6 * s2 * Math.PI) / 180);\n    var ys3 = Math.sin((6 * s3 * Math.PI) / 180);\n\n    option.series[index].data = new Array();\n\n    for (var j = 0; j < 360; j++) {\n        var x1 = Math.cos((6 * j * Math.PI) / 180);\n        var y1 = Math.sin((6 * j * Math.PI) / 180);\n        option.series[index].data[j] = {\n            name: j,\n            symbolSize: 0,\n            x: y1,\n            y: -x1,\n        };\n    }\n    for (var j = 59; j > 360; j--) {\n        var x1 = Math.cos((6 * j * Math.PI) / 180);\n        var y1 = Math.sin((6 * j * Math.PI) / 180);\n        option.series[index].data[j] = {\n            name: j,\n            symbolSize: 0,\n            x: y1,\n            y: -x1,\n        };\n    }\n\n    option.series[index].data[1] = {\n        name: 1000,\n        symbolSize: 10,\n        x: 0.04,\n        y: 0.04,\n    };\n\n    option.series[index].data[s1] = {\n        // symbol: 'image://images/wb3.png',\n        symbolSize: 50,\n        x: ys1,\n        y: -xs1,\n    };\n\n    option.series[index].data[s2] = {\n        // symbol: 'image://images/wb3.png',\n        symbolSize: 50,\n        x: ys2,\n        y: -xs2,\n    };\n\n    option.series[index].data[s3] = {\n        // symbol: 'image://images/wb3.png',\n        symbolSize: 50,\n        x: ys3,\n        y: -xs3,\n    };\n\n    let ldatas = new Array();\n    ldatas.push(\n        {\n            source: s1,\n            target: 1,\n        },\n        {\n            source: s2,\n            target: 1,\n        },\n        {\n            source: s3,\n            target: 1,\n        }\n    );\n\n    s1 = _index4 + 1;\n    _index4 = s1;\n    s2 = _index5 + 1;\n    _index5 = s2;\n    s3 = _index6 + 1;\n    _index6 = s3;\n\n    xs1 = Math.cos((6 * s1 * Math.PI) / 180);\n    xs2 = Math.cos((6 * s2 * Math.PI) / 180);\n    xs3 = Math.cos((6 * s3 * Math.PI) / 180);\n\n    ys1 = Math.sin((6 * s1 * Math.PI) / 180);\n    ys2 = Math.sin((6 * s2 * Math.PI) / 180);\n    ys3 = Math.sin((6 * s3 * Math.PI) / 180);\n\n    _hlinks.push(getLink2(-xs1, ys1, -xs2, ys2, '深入溯源'));\n    _hlinks.push(getLink2(-xs2, ys2, -xs3, ys3, '关联'));\n    _hlinks.push(getLink2(-xs3, ys3, -xs1, ys1, '提示服务质量'));\n\n    let ls = getLink(0, 0, -xs1, ys1);\n    _links.push(ls);\n\n    ls = getLink(0, 0, -xs2, ys2);\n    _links.push(ls);\n\n    ls = getLink(0, 0, -xs3, ys3);\n    _links.push(ls);\n\n    option.series[4].data = _links;\n    option.series[5].data = _hlinks;\n\n    // tlog('option.series[index].data:' + JSON.stringify(option.series[index].data[s1]))\n\n    if (tips == 100) {\n        tips = 0;\n        m = 0;\n    } else if (tips <= 10) {\n        ++tips;\n        ++m;\n    } else {\n        tips = tips + 1.85;\n    }\n    // option.series[2].data = loading();\n\n    //旋转圆\n    startAngle = startAngle - 6;\n    option.series[3].startAngle = startAngle;\n    option.series[3].data = generateData(6, 20, 10, '#2dc0c9');\n\n    myChart.setOption(option, true);\n}\n\nfunction getLink(x1, y1, x2, y2) {\n    let coords = new Array();\n    coords.push([x1, y1]);\n    coords.push([x2, y2]);\n    return coords;\n}\n\n/**\n * 增加名称\n * @param {Object} x1\n * @param {Object} y1\n * @param {Object} x2\n * @param {Object} y2\n * @param {Object} name\n */\nfunction getLink2(x1, y1, x2, y2, name) {\n    let coords = new Array();\n    coords.push([x1, y1]);\n    coords.push([x2, y2]);\n    let info = {};\n    info.coords = coords;\n    info.name = name;\n    return info;\n}\n\nfunction loading() {\n    return [\n        {\n            value: tips,\n            itemStyle: {\n                normal: {\n                    color: 'rgba(0,0,0,0)',\n                },\n            },\n        },\n        {\n            value: m,\n            itemStyle: {\n                normal: {\n                    borderWidth: 5,\n                    borderColor: {\n                        type: 'linear',\n                        x: 0,\n                        y: 0,\n                        x2: 0,\n                        y2: 4,\n                        colorStops: [\n                            {\n                                offset: 0,\n                                color: 'rgba(255,255,255,0.7)', // 0% 处的颜色\n                            },\n                            {\n                                offset: 0.3,\n                                color: 'rgba(255,255,255,1)', // 0% 处的颜色\n                            },\n                            {\n                                offset: 0.6,\n                                color: 'rgba(255,255,255,1)', // 0% 处的颜色\n                            },\n                            {\n                                offset: 0.8,\n                                color: 'rgba(255,255,255,1)', // 0% 处的颜色\n                            },\n                            {\n                                offset: 1,\n                                color: 'rgba(255,255,255,1)', // 100% 处的颜色\n                            },\n                        ],\n                        globalCoord: false,\n                    },\n                    color: 'rgba(255,255,255,0)',\n                    shadowBlur: 30,\n                    shadowColor: 'rgba(255,255,255,1)',\n                },\n            },\n        },\n        {\n            value: 100 - tips,\n            itemStyle: {\n                normal: {\n                    color: 'rgba(0,0,0,0)',\n                },\n            },\n        },\n    ];\n}\n\nfunction roundDatas1(num) {\n    var datas = [];\n    for (var i = 0; i < num; i++) {\n        var x = Math.cos((6 * i * Math.PI) / 180);\n        var y = Math.sin((6 * i * Math.PI) / 180);\n        datas.push({\n            name: i,\n            x: y,\n            y: -x,\n        });\n    }\n    return datas;\n}\n\nfunction roundDatasroot(num) {\n    var datas = [];\n    for (var i = 0; i < num; i++) {\n        var x = Math.cos((6 * i * Math.PI) / 180);\n        var y = Math.sin((6 * i * Math.PI) / 180);\n        datas.push({\n            name: 'rootnode',\n            x: y,\n            y: -x,\n        });\n    }\n    return datas;\n}\nfunction generateData(totalNum, bigvalue, smallvalue, color) {\n    let dataArr = [];\n    for (var i = 0; i < totalNum; i++) {\n        if (i % 2 === 0) {\n            dataArr.push({\n                name: (i + 1).toString(),\n                value: bigvalue,\n                itemStyle: {\n                    normal: {\n                        color: color,\n                        borderWidth: 0,\n                    },\n                },\n            });\n        } else {\n            dataArr.push({\n                name: (i + 1).toString(),\n                value: smallvalue,\n                itemStyle: {\n                    normal: {\n                        color: 'rgba(0,0,0,0)',\n                        borderWidth: 0,\n                    },\n                },\n            });\n        }\n    }\n    return dataArr;\n}\n","html":"","externalScripts":"","updaterUID":"bd-506765776","theme":"","layout":"","viewCount":0,"userName":"我***脑","commentCount":0,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xLzvj9oAF-.png?v=1625735125198","isCustomThumbnail":0,"builtinTags":["category-work"],"customTags":["graph","lines","pie"],"updaterUserName":"我***脑"}}