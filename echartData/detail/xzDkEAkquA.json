{"status":0,"data":{"cid":"xzDkEAkquA","authorUid":"obd-o-UzC1jKH3yTkfKs1Y6IcjRu_ku3HAu","authorUserName":"z***k","title":"分段","description":"","latestVersion":2,"alwaysLatest":0,"createTime":"2021-11-17T03:49:48.000Z","lastUpdateTime":"2021-11-17T03:57:15.000Z","auth":2,"uid":"obd-o-UzC1jKH3yTkfKs1Y6IcjRu_ku3HAu","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"5.2.2","versionCreateTime":"2021-11-17T03:57:15.000Z","code":"var fun = function (params) {\n    var data3 = 0;\n    for (var i = 0, l = series.length; i < l; i++) {\n        data3 += series[i].data[params.dataIndex][1];\n    }\n    return data3;\n};\n\noption = {\n    title: [\n        {\n            text: '2021',\n            left: '23%',\n            textStyle: {\n                color: '#ccc',\n                fontStyle: 'normal',\n                fontWeight: '400',\n                fontFamily: 'sans-serif',\n                fontSize: 16,\n            },\n        },\n        {\n            text: '2020',\n            right: '49%',\n            textStyle: {\n                color: '#ccc',\n                fontStyle: 'normal',\n                fontWeight: '400',\n                fontFamily: 'sans-serif',\n                fontSize: 16,\n            },\n        },\n        {\n            text: '2019',\n            right: '22%',\n            textStyle: {\n                color: '#ccc',\n                fontStyle: 'normal',\n                fontWeight: '400',\n                fontFamily: 'sans-serif',\n                fontSize: 16,\n            },\n        },\n    ],\n    toolbox: {\n        feature: {\n            dataView: { show: true, readOnly: false },\n            magicType: { show: true, type: ['line', 'bar'] },\n            restore: { show: true },\n            saveAsImage: { show: true },\n        },\n    },\n    grid: [\n        {\n            top: 100,\n            bottom: 101,\n        },\n        {\n            height: 60,\n            bottom: 40,\n        },\n        {\n            top: '55%',\n            width: '50%',\n            bottom: 0,\n            left: 10,\n            containLabel: true,\n        },\n    ],\n    xAxis: {\n        type: 'category',\n        data: ['备案回执单', '审查决定单', '备案回执单', '审查决定单', '备案回执单', '审查决定单'],\n        splitLine: {\n            show: true,\n            interval: 1,\n            lineStyle: {\n                color: '#fff',\n                width: 1,\n                dashOffset: 11,\n            },\n        },\n    },\n    yAxis: {\n        type: 'log',\n        min: -1,\n        max: 2000,\n        logBase: 10,\n        // axisLabel: {\n        //   formatter: function (value) {\n        //     return value === 1 ? 0.01 : value;//第2步，将y轴最小值1变成从0开始；\n        //   }\n        // },\n    },\n    tooltip: {\n        show: true,\n        trigger: 'axis',\n    },\n    series: [\n        {\n            type: 'bar',\n            name: '科教影片',\n            data: [1, 2, 3, 4, 5, null],\n            stack: 'AD',\n            label: {\n                show: true,\n            },\n            itemStyle: {\n                color: 'rgba(213, 64, 64, 1)',\n            },\n        },\n        {\n            type: 'bar',\n            name: '动画影片',\n            stack: 'AD',\n            data: [8, 4, 103, 98, 76, 23],\n            label: {\n                show: true,\n            },\n        },\n        {\n            type: 'bar',\n            name: '故事影片',\n            stack: 'AD',\n            data: [79, 36, 4, 8, 23, 9],\n            label: {\n                show: true,\n            },\n        },\n        {\n            type: 'bar',\n            name: '恐怖片',\n            stack: 'AD',\n            data: [2, 99, 0, 3, 4, 5],\n            label: {\n                show: true,\n            },\n        },\n        {\n            name: '合计',\n            type: 'bar',\n            stack: 'AD',\n            label: {\n                normal: {\n                    // show: true,\n                    position: 'top',\n                    textStyle: {\n                        color: '#000',\n                    },\n                    formatter: '111',\n                },\n            },\n            data: [0, 0, 0, 0, 0, 0], //思路一：给series集合末尾多加一栏用于展示合计，但是值都是0；缺点：必须根据xAxis的data生成一组为空的数据，且tooltip不能加trigger: 'axis',这个条件，不然会展示合计：0\n        },\n    ],\n};\n//加载页面时候替换最后一个series的formatter\nseries[series.length - 1]['label']['normal']['formatter'] = fun;\nvar series = option['series'];\nmyChart.on('legendselectchanged', function (obj) {\n    var b = obj.selected,\n        d = [];\n    //alert(JSON.stringify(b))\n    for (var key in b) {\n        if (b[key]) {\n            //alert(key)\n            for (var i = 0, l = series.length; i < l; i++) {\n                var changename = series[i]['name'];\n                if (changename == key) {\n                    d.push(i); //得到状态是true的legend对应的series的下标\n                }\n            }\n        }\n    }\n    var fun1 = function (params) {\n        var data3 = 0;\n        for (var i = 0, l = d.length; i < l; i++) {\n            for (var j = 0, h = series.length; j < h; j++) {\n                if (d[i] == j) {\n                    data3 += series[j].data[params.dataIndex][1]; //重新计算总和\n                }\n            }\n        }\n        return data3;\n    };\n    series[series.length - 1]['label']['normal']['formatter'] = fun1;\n    myChart.setOption(option);\n});\n","html":"","externalScripts":"","updaterUID":"obd-o-UzC1jKH3yTkfKs1Y6IcjRu_ku3HAu","theme":"dark","layout":"","viewCount":0,"userName":"z***k","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xzDkEAkquA.png?v=1637121435942","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-bar","title","toolbox","tooltip"],"customTags":[],"updaterUserName":"z***k"}}