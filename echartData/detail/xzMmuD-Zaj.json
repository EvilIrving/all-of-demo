{"status":0,"data":{"cid":"xzMmuD-Zaj","authorUid":"bd-238068129","authorUserName":"想***美","title":"重庆变电站模拟地图","description":"数据为虚假数据","latestVersion":3,"alwaysLatest":1,"createTime":"2019-05-29T01:22:50.000Z","lastUpdateTime":"2019-05-29T01:22:50.000Z","auth":2,"uid":"bd-238068129","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":3,"parentVersion":2,"echartsVersion":"4.2.1","versionCreateTime":"2019-05-29T01:32:09.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1559032707973-kPCDcrc0f.json\";\n\n\nvar colors = [\n    [\"#1DE9B6\", \"#F46E36\", \"#04B9FF\", \"#5DBD32\", \"#FFC809\", \"#FB95D5\", \"#BDA29A\", \"#6E7074\", \"#546570\", \"#C4CCD3\"],\n    [\"#37A2DA\", \"#67E0E3\", \"#32C5E9\", \"#9FE6B8\", \"#FFDB5C\", \"#FF9F7F\", \"#FB7293\", \"#E062AE\", \"#E690D1\", \"#E7BCF3\", \"#9D96F5\", \"#8378EA\", \"#8378EA\"],\n    [\"#DD6B66\", \"#759AA0\", \"#E69D87\", \"#8DC1A9\", \"#EA7E53\", \"#EEDD78\", \"#73A373\", \"#73B9BC\", \"#7289AB\", \"#91CA8C\", \"#F49F42\"],\n];\n\nvar colorIndex = 0;\n$(function() {\n    var geoCoordMap = {\n    '北碚': [106.50,29.81],\n    '城口': [108.6520475,31.90676506],\n    '大足': [105.7692868,29.65392091],\n    '垫江': [107.4004904,30.24903189],\n    '丰都': [107.7461781,29.91492542],\n    '奉节': [109.3758974,30.98202119],\n    '合川': [106.2833096,30.09766756],\n    '江北': [106.6214893,29.64821182],\n    '江津': [106.2647885,28.98483627],\n    '开州': [108.1818518,31.29466521],\n    '南岸': [106.6379653,29.47704825],\n    '南川': [107.1406799,29.12047319],\n    '彭水': [108.2573507,29.36444557],\n    '綦南': [106.8036647,28.96872774],\n    '黔江': [108.7559876,29.44290625],\n    '石柱': [108.2438988,30.07512144],\n    '市区': [106.4377397,29.52648606],\n    '铜梁': [106.0616035,29.81036286],\n    '潼南': [105.8116920, 30.13795513],\n    '万州': [108.0828876,30.73353669],\n    '巫山': [109.8779184,31.09568937],\n    '巫溪': [109.2970739,31.48090521],\n    '武隆': [107.6831317,29.36831708],\n    '秀山': [108.9997005,28.49462861],\n    '永川': [105.8347961,29.41042605],\n    '酉阳': [108.7911679,28.88330557],\n    '云阳': [108.7533957,30.96025875],\n    '长寿': [107.24,29.95],\n    '忠县': [107.9279014,30.33522658],\n    '川东': [107.3488646,29.68233099]\n    };\n\n    var voltageLevel = [\"全部\", \"35kV\", \"110kV\", \"220kV\", \"500kV\"];\n    var mapData = [\n        [], [], [], [], [], [], [],[], [], [], [],[], [], [], [],\n        [], [], [], [], [], [], [], [], [],\n        [], [], [], [], [], [], [], [], [], [], [], []\n        ];\n\n    /*柱子Y名称*/\n    var categoryData = [];\n    var barData = [];\n    for (var key in geoCoordMap) {\n        categoryData.push(key);\n        mapData[0].push({\n            \"year\": 2014,\n            \"name\": key,\n            \"value\": randomNum(100, 300)\n        });\n        mapData[1].push({\n            \"year\": 2015,\n            \"name\": key,\n            \"value\": randomNum(100, 300)\n        });\n        mapData[2].push({\n            \"year\": 2016,\n            \"name\": key,\n            \"value\": randomNum(100, 300)\n        });\n        mapData[3].push({\n            \"year\": 2017,\n            \"name\": key,\n            \"value\": randomNum(100, 300)\n        });\n        mapData[4].push({\n            \"year\": 2018,\n            \"name\": key,\n            \"value\": randomNum(100, 300)\n        });\n        mapData[5].push({\n            \"year\": 2019,\n            \"name\": key,\n            \"value\": randomNum(100, 300)\n        });\n    }\n    for (var i = 0; i < mapData.length; i++) {\n        barData.push([]);\n        for (var j = 0; j < mapData[i].length; j++) {\n            barData[i].push(mapData[i][j].value)\n        }\n    }\n    $.getJSON(uploadedDataURL, function(geoJson) {\n        echarts.registerMap('xianyang3', geoJson);\n        var convertData = function(data) {\n            var res = [];\n            for (var i = 0; i < data.length; i++) {\n                var geoCoord = geoCoordMap[data[i].name];\n                if (geoCoord) {\n                    res.push({\n                        name: data[i].name,\n                        value: geoCoord.concat(data[i].value)\n                    });\n                }\n            }\n            return res;\n        };\n\n        var convertToLineData = function(data) {\n            var res = [];\n            for (var i = 0; i < data.length; i++) {\n                var dataItem = data[i];\n                var fromCoord = geoCoordMap[dataItem.name];\n                var toCoord = [106.55, 29.57]; //市区\n                if (fromCoord && toCoord) {\n                    res.push([{\n                        coord: fromCoord,\n                        value: dataItem.value\n                    }, {\n                        coord: toCoord,\n                    }]);\n                }\n            }\n            return res;\n        };\n\n        optionXyMap01 = {\n            timeline: {\n                data: voltageLevel,\n                axisType: 'category',\n                autoPlay: true,\n                playInterval: 3000,\n                left: '10%',\n                right: '10%',\n                bottom: '3%',\n                width: '80%',\n                //  height: null,\n                label: {\n                    normal: {\n                        textStyle: {\n                            color: '#ddd'\n                        }\n                    },\n                    emphasis: {\n                        textStyle: {\n                            color: '#fff'\n                        }\n                    }\n                },\n                symbolSize: 10,\n                lineStyle: {\n                    color: '#555'\n                },\n                checkpointStyle: {\n                    borderColor: '#777',\n                    borderWidth: 2\n                },\n                controlStyle: {\n                    showNextBtn: true,\n                    showPrevBtn: true,\n                    normal: {\n                        color: '#666',\n                        borderColor: '#666'\n                    },\n                    emphasis: {\n                        color: '#aaa',\n                        borderColor: '#aaa'\n                    }\n                },\n\n            },\n            baseOption: {\n                animation: true,\n                animationDuration: 1000,\n                animationEasing: 'cubicInOut',\n                animationDurationUpdate: 1000,\n                animationEasingUpdate: 'cubicInOut',\n                grid: {\n                    right: '1%',\n                    top: '15%',\n                    bottom: '10%',\n                    width: '20%'\n                },\n                tooltip: {\n                    trigger: 'axis', // hover触发器\n                    axisPointer: { // 坐标轴指示器，坐标轴触发有效\n                        type: 'shadow', // 默认为直线，可选为：'line' | 'shadow'\n                        shadowStyle: {\n                            color: 'rgba(150,150,150,0.1)' //hover颜色\n                        }\n                    }\n                },\n                geo: {\n                    show: true,\n                    map: 'xianyang3',\n                    roam: true,\n                    zoom: 1,\n                    center: [108.5, 30],  //中心点\n                    label: {\n                        emphasis: {\n                            show: false\n                        }\n                    },\n                    itemStyle: {\n                        normal: {\n                            borderColor: 'rgba(147, 235, 248, 1)',\n                            borderWidth: 1,\n                            areaColor: {\n                                type: 'radial',\n                                x: 0.5,\n                                y: 0.5,\n                                r: 0.5,\n                                colorStops: [{\n                                    offset: 0,\n                                    color: 'rgba(147, 235, 248, 0)' // 0% 处的颜色\n                                }, {\n                                    offset: 1,\n                                    color: 'rgba(147, 235, 248, .2)' // 100% 处的颜色\n                                }],\n                                globalCoord: false // 缺省为 false\n                            },\n                            // shadowColor: 'rgba(128, 217, 248, 1)',\n                            // shadowColor: 'rgba(255, 255, 255, 1)',\n                            // shadowOffsetX: -2,\n                            // shadowOffsetY: 2,\n                            // shadowBlur: 10\n                        },\n                        emphasis: {\n                            areaColor: '#389BB7',\n                            borderWidth: 0\n                        }\n                    }\n                },\n            },\n            options: []\n\n        };\n        for (var n = 0; n < voltageLevel.length; n++) {\n            optionXyMap01.options.push({\n                backgroundColor: '#142037',\n                title: [{\n                        text: '地图',\n                         left: 'center',\n                         textStyle: {\n                             color: '#fff'\n                         }\n                    },\n                    {\n                        id: 'statistic',\n                        text: voltageLevel[n] + \"变电站统计情况\",\n                        left: '75%',\n                        top: '8%',\n                        textStyle: {\n                            color: '#fff',\n                            fontSize: 20\n                        }\n                    }\n                ],\n                xAxis: {\n                    type: 'value',\n                    scale: true,\n                    position: 'top',\n                    min: 0,\n                    boundaryGap: false,\n                    splitLine: {\n                        show: false\n                    },\n                    axisLine: {\n                        show: false\n                    },\n                    axisTick: {\n                        show: false\n                    },\n                    axisLabel: {\n                        margin: 2,\n                        textStyle: {\n                            color: '#aaa'\n                        }\n                    },\n                },\n                yAxis: {\n                    type: 'category',\n                    //  name: 'TOP 20',\n                    nameGap: 16,\n                    axisLine: {\n                        show: true,\n                        lineStyle: {\n                            color: '#ddd'\n                        }\n                    },\n                    axisTick: {\n                        show: false,\n                        lineStyle: {\n                            color: '#ddd'\n                        }\n                    },\n                    axisLabel: {\n                        interval: 0,\n                        textStyle: {\n                            color: '#ddd'\n                        }\n                    },\n                    data: categoryData\n                },\n                series: [{\n                        //文字和标志\n                        name: 'light',\n                        type: 'scatter',\n                        coordinateSystem: 'geo',\n                        data: convertData(mapData[n]),\n                        symbolSize: function(val) {\n                            return val[2] / 10;\n                        },\n                        // label: {\n                        //     normal: {\n                        //         formatter: '{b}',\n                        //         position: 'right',\n                        //         show: true\n                        //     },\n                        //     emphasis: {\n                        //         show: true\n                        //     }\n                        // },\n                        itemStyle: {\n                            normal: {\n                                color: colors[colorIndex][n]\n                            }\n                        }\n                    },\n                    {\n                        type: 'map',\n                        map: 'xianyang3',\n                        geoIndex: 0,\n                        aspectScale: 0.75, //长宽比\n                        showLegendSymbol: false, // 存在legend时显示\n                        label: {\n                            normal: {\n                                show: false\n                            },\n                            emphasis: {\n                                show: false,\n                                textStyle: {\n                                    color: '#fff'\n                                }\n                            }\n                        },\n                        roam: true,\n                        itemStyle: {\n                            normal: {\n                                areaColor: '#031525',\n                                borderColor: '#FFFFFF',\n                            },\n                            emphasis: {\n                                areaColor: '#2B91B7'\n                            }\n                        },\n                        animation: false,\n                        data: mapData\n                    },\n                    {\n                        //  name: 'Top 5',\n                        type: 'effectScatter',\n                        coordinateSystem: 'geo',\n                        data: convertData(mapData[n].sort(function(a, b) {\n                            return b.value - a.value;\n                        }).slice(0, 20)),\n                        symbolSize: function(val) {\n                            return val[2] / 100;\n                        },\n                        showEffectOn: 'render',\n                        rippleEffect: {\n                            brushType: 'stroke'\n                        },\n                        hoverAnimation: true,\n                        label: {\n                            normal: {\n                                formatter: '{b}',\n                                position: 'right',\n                                show: true\n                            }\n                        },\n                        itemStyle: {\n                            normal: {\n                                color: colors[colorIndex][n],\n                                shadowBlur: 5,\n                                shadowColor: colors[colorIndex][n]\n                            }\n                        },\n                        zlevel: 1\n                    },\n                    // {\n                    //     type: 'lines',\n                    //     zlevel: 2,\n                    //     effect: {\n                    //         show: true,\n                    //         period: 4, //箭头指向速度，值越小速度越快\n                    //         trailLength: 0.02, //特效尾迹长度[0,1]值越大，尾迹越长重\n                    //         symbol: 'arrow', //箭头图标\n                    //         symbolSize: 2, //图标大小\n                    //     },\n                    //     lineStyle: {\n                    //         normal: {\n                    //             color: colors[colorIndex][n],\n                    //             width: 1, //尾迹线条宽度\n                    //             opacity: 1, //尾迹线条透明度\n                    //             curveness: .3 //尾迹线条曲直度\n                    //         }\n                    //     },\n                    //     data: convertToLineData(mapData[n])\n                    // },\n                    {\n                        zlevel: 1.5,\n                        type: 'bar',\n                        symbol: 'none',\n                        itemStyle: {\n                            normal: {\n                                color: colors[colorIndex][n]\n                            }\n                        },\n                        data: barData[n]\n                    }\n                ]\n            })\n        }\n        myChart.setOption(optionXyMap01);\n    });\n});\n\n\nfunction randomNum(minNum, maxNum) {\n    let res = null;\n    switch (arguments.length) {\n        case 1:\n            res = parseInt(Math.random() * minNum + 1, 10);\n            break;\n        case 2:\n            res=  parseInt(Math.random() * (maxNum - minNum + 1) + minNum, 10);\n            break;\n        default:\n            res =  0;\n            break;\n    }\n    return res;\n}","html":"","externalScripts":"","updaterUID":"bd-238068129","theme":"","layout":"","viewCount":24350,"userName":"想***美","commentCount":11,"starCount":67,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xzMmuD-Zaj.png?v=1559093529467","isCustomThumbnail":0,"builtinTags":["category-work","geo","grid","series-bar","series-effectScatter","series-map","series-scatter","timeline","title","tooltip"],"customTags":[],"updaterUserName":"想***美"}}