{"status":0,"data":{"cid":"xi0BHw0_5I","authorUid":"obd-o2-LLWDwzeS-EmSwas9Wmz-VBbJeZ6z","authorUserName":"西***影","title":"中国历代军力对比","description":"多指标-模拟浮雕效果","latestVersion":13,"alwaysLatest":1,"createTime":"2020-11-24T08:33:47.000Z","lastUpdateTime":"2020-11-25T05:21:55.000Z","auth":1,"uid":"obd-o2-LLWDwzeS-EmSwas9Wmz-VBbJeZ6z","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":13,"parentVersion":12,"echartsVersion":"4.9.0","versionCreateTime":"2021-06-11T02:18:16.000Z","code":"let innerTopData = (_data) => {\r\n    let arr = []\r\n    let height = (1000 - 126) / 100\r\n    _data.forEach(item => {\r\n        if (item * height > 20) {\r\n            arr.push({\r\n                value: item\r\n            })\r\n        } else {\r\n            arr.push({\r\n                value: item,\r\n                symbolOffset: [0, -25 + item * height]\r\n            })\r\n        }\r\n    })\r\n    return arr\r\n}\r\nlet innerShadowData = (_data) => {\r\n    let arr = []\r\n    let height = (1000 - 126) / 100\r\n    _data.forEach(item => {\r\n        if (item < 100) {\r\n            if (item * height > 20) {\r\n                arr.push({\r\n                    value: item\r\n                })\r\n            } else {\r\n                arr.push({\r\n                    value: item,\r\n                    symbolOffset: [0, -47.5 + item * height]\r\n                })\r\n            }\r\n        } else {\r\n            arr.push({\r\n                value: ''\r\n            })\r\n        }\r\n    })\r\n    return arr\r\n}\r\n\r\nvar option_data = {\r\n    \"item0\": {\r\n        \"unit\": \"万\",\r\n        \"min\": 19,\r\n        \"data\": [\r\n            30,\r\n            50,\r\n            60,\r\n            100\r\n        ],\r\n        \"max\": 85,\r\n        \"name\": \"总兵力\",\r\n        \"freq\": \"年度\",\r\n        \"axis\": []\r\n    },\r\n    \"item1\": {\r\n        \"unit\": \"%\",\r\n        \"min\": 19,\r\n        \"data\": [\r\n            90,\r\n            92,\r\n            98,\r\n            86\r\n        ],\r\n        \"max\": 75,\r\n        \"name\": \"综合战力\",\r\n        \"freq\": \"年度\",\r\n        \"axis\": []\r\n    },\r\n    \"item2\": {\r\n        \"unit\": \"%\",\r\n        \"min\": 19,\r\n        \"data\": [\r\n            89,\r\n            93,\r\n            96,\r\n            85\r\n        ],\r\n        \"max\": 75,\r\n        \"name\": \"后勤补给\",\r\n        \"freq\": \"年度\",\r\n        \"axis\": []\r\n    },\r\n    \"legend\": [\r\n        \"总兵力\",\r\n        \"综合战力\",\r\n        \"后勤补给\"\r\n    ],\r\n    \"dates\": [\r\n        \"秦朝\",\r\n        \"汉朝\",\r\n        \"唐朝\",\r\n        \"明朝\"\r\n    ],\r\n    \"title\": \"中国历代军力对比\",\r\n    \"multi\": []\r\n};\r\n\r\n// 初始化option的方法\r\nfunction initVisualizer(x_value) {\r\n    return {\r\n        title: {\r\n            x: \"center\",\r\n            y: \"3%\",\r\n            text: option_data.title,\r\n            textStyle: {\r\n                \"color\": \"#fff\",\r\n                \"fontSize\": 24,\r\n                \"fontFamily\": \"微软雅黑\",\r\n                \"fontWeight\": \"normal\"\r\n            }\r\n        },\r\n        backgroundColor: '#011B39',\r\n        tooltip: {\r\n            trigger: \"item\",\r\n            formatter: function(params) {\r\n                var res = params.name + '<br/>' + params.seriesName + ' : ' + params.value;\r\n                if (params.seriesName == option_data.legend[0]) {\r\n                    return res + option_data.item0.unit\r\n                } else if (params.seriesName == option_data.legend[1]) {\r\n                    return res + option_data.item1.unit\r\n                } else if (params.seriesName == option_data.legend[2]) {\r\n                    return res + option_data.item2.unit\r\n                }\r\n            }\r\n        },\r\n        grid: {\r\n            \"left\": \"6%\",\r\n            \"top\": \"12%\",\r\n            \"right\": \"4%\",\r\n            \"bottom\": \"15%\"\r\n        },\r\n        legend: {\r\n            \"orient\": 'horizontal',\r\n            \"itemWidth\": 18,\r\n            \"itemHeight\": 18,\r\n            \"itemGap\": 30,\r\n            \"y\": \"93%\",\r\n            \"textStyle\": { // 图例文字的样式\r\n                \"color\": \"#fff\",\r\n                \"fontSize\": 18,\r\n                \"padding\": [2, 0, 0, 2],\r\n                \"fontFamily\": \"微软雅黑\",\r\n                \"fontWeight\": \"normal\"\r\n            },\r\n            \"data\": option_data[\"legend\"],\r\n            \"show\": true\r\n        },\r\n        yAxis: {\r\n            \"type\": \"value\",\r\n            \"axisLine\": {\r\n                \"lineStyle\": {\r\n                    \"color\": \"#fff\"\r\n                }\r\n            },\r\n            \"nameTextStyle\": {\r\n                \"fontSize\": 14\r\n            },\r\n            \"axisLabel\": {\r\n                \"textStyle\": {\r\n                    \"color\": \"#fff\",\r\n                    \"fontSize\": 14,\r\n                    \"fontFamily\": \"微软雅黑\",\r\n                    \"fontWeight\": \"normal\"\r\n                }\r\n            },\r\n            \"splitLine\": {\r\n                \"show\": false\r\n            }\r\n        },\r\n        xAxis: {\r\n            \"type\": \"category\",\r\n            \"axisLine\": {\r\n                \"lineStyle\": {\r\n                    \"color\": \"#fff\"\r\n                }\r\n            },\r\n            \"axisLabel\": {\r\n                \"interval\": 0,\r\n                \"textStyle\": {\r\n                    \"color\": \"#fff\",\r\n                    \"fontSize\": 14\r\n                }\r\n            },\r\n            \"splitLine\": {\r\n                \"show\": false\r\n            },\r\n            \"interval\": 1.0,\r\n            \"data\": [\"秦朝\", \"汉朝\", \"唐朝\", \"明朝\"]\r\n        },\r\n        series: [{ //指标1:柱子左半边\r\n            name: option_data.item0.name,\r\n            type: 'bar',\r\n            z: 1,\r\n            barWidth: 8,\r\n            barGap: \"20%\",\r\n            barCategoryGap: \"20%\",\r\n            symbolOffset: [0, -6],\r\n            offset: 0,\r\n            data: option_data.item0.data,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: {\r\n                        x: 1,\r\n                        y: 0,\r\n                        x2: 0,\r\n                        y2: 0,\r\n                        colorStops: [{\r\n                                offset: 0,\r\n                                color: '#A5C6EE'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#59769B'\r\n                            }\r\n                        ]\r\n                    },\r\n                    opacity: 0.8\r\n                }\r\n            }\r\n        }, { //指标1:柱子右半边\r\n            name: option_data.item0.name,\r\n            type: 'bar',\r\n            barWidth: 8,\r\n            z: 1,\r\n            barGap: '-2%',\r\n            symbolOffset: [0, -6],\r\n            offset: 0,\r\n            data: option_data.item0.data,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: {\r\n                        x: 1,\r\n                        y: 0,\r\n                        x2: 0,\r\n                        y2: 0,\r\n                        colorStops: [{\r\n                                offset: 0,\r\n                                color: '#59769B'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#A5C6EE'\r\n                            }\r\n                        ]\r\n                    },\r\n                    opacity: 0.8\r\n                }\r\n            }\r\n        }, { //指标1:柱子顶部\r\n            name: option_data.item0.name,\r\n            type: 'pictorialBar',\r\n            z: 1,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: new echarts.graphic.LinearGradient(\r\n                        0, 0, 0, 1, [{\r\n                                offset: 0,\r\n                                color: '#ADDAE8'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#427BB4'\r\n                            }\r\n                        ]\r\n                    )\r\n                }\r\n            },\r\n            legendHoverLink: false,\r\n            symbolSize: [14.8, 4 * -1.5],\r\n            symbolOffset: [x_value[0], 2.8],\r\n            symbolPosition: 'end',\r\n            symbol: 'triangle',\r\n            animation: false,\r\n            data: innerTopData(option_data.item0.data)\r\n        }, { //指标1:柱子底部\r\n            name: option_data.item0.name,\r\n            type: 'pictorialBar',\r\n            z: 1,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: new echarts.graphic.LinearGradient(\r\n                        0, 0, 0, 1, [{\r\n                                offset: 0,\r\n                                color: '#D5F6FB'\r\n                            },\r\n                            {\r\n                                offset: 0.8,\r\n                                color: '#204570'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#427BB4'\r\n                            }\r\n                        ]\r\n                    )\r\n                }\r\n            },\r\n            legendHoverLink: false,\r\n            symbolSize: [14, 4 * 1.5],\r\n            symbolOffset: [x_value[0], 0],\r\n            symbolPosition: 'start',\r\n            symbol: 'triangle',\r\n            animation: false,\r\n            data: innerTopData(option_data.item0.data)\r\n        }, { //间隔用的柱子\r\n            type: 'bar',\r\n            barWidth: 6,\r\n            symbolOffset: [0, -6],\r\n            offset: 0,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: 'rgba(128, 128, 128, 0.1)'\r\n                }\r\n            }\r\n        }, { //指标2:柱子左半边\r\n            type: 'bar',\r\n            z: 2,\r\n            barWidth: 8,\r\n            barGap: \"40%\",\r\n            symbolOffset: [0, 6],\r\n            offset: 20,\r\n            name: option_data.item1.name,\r\n            data: option_data.item1.data,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: {\r\n                        x: 1,\r\n                        y: 0,\r\n                        x2: 0,\r\n                        y2: 0,\r\n                        colorStops: [{\r\n                                offset: 0,\r\n                                color: '#EF7272'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#F90101'\r\n                            }\r\n                        ]\r\n                    },\r\n                    opacity: 0.8\r\n                }\r\n            }\r\n        }, { //指标2:柱子右半边\r\n            type: 'bar',\r\n            z: 2,\r\n            barWidth: 8,\r\n            barGap: '-2%',\r\n            symbolOffset: [0, -6],\r\n            offset: 0,\r\n            name: option_data.item1.name,\r\n            data: option_data.item1.data,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: {\r\n                        x: 1,\r\n                        y: 0,\r\n                        x2: 0,\r\n                        y2: 0,\r\n                        colorStops: [{\r\n                                offset: 0,\r\n                                color: '#F90101'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#EF7272'\r\n                            }\r\n                        ]\r\n                    },\r\n                    opacity: 0.8\r\n                }\r\n            }\r\n        }, { //指标2:柱子顶部\r\n            name: option_data.item1.name,\r\n            z: 2,\r\n            type: 'pictorialBar',\r\n            barCategoryGap: 22,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: new echarts.graphic.LinearGradient(\r\n                        0, 0, 0, 1, [{\r\n                                offset: 0,\r\n                                color: '#EB8686'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#D95555'\r\n                            }\r\n                        ]\r\n                    )\r\n                }\r\n            },\r\n            legendHoverLink: false,\r\n            //symbolSize: [6, 3],\r\n            //symbolOffset: [0, 0],\r\n            symbolSize: [14.8, 4 * -1.8],\r\n            symbolOffset: [x_value[1], 3],\r\n            symbolPosition: 'end',\r\n            symbol: 'triangle',\r\n            animation: false,\r\n            data: innerTopData(option_data.item1.data)\r\n        }, { //指标2:柱子底部\r\n            z: 2,\r\n            name: option_data.item1.name,\r\n            type: 'pictorialBar',\r\n            itemStyle: {\r\n                normal: {\r\n                    color: new echarts.graphic.LinearGradient(\r\n                        0, 0, 0, 1, [{\r\n                                offset: 0,\r\n                                color: '#94D265'\r\n                            },\r\n                            {\r\n                                offset: 0.8,\r\n                                color: '#D66464'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#C94040'\r\n                            }\r\n                        ]\r\n                    )\r\n                }\r\n            },\r\n            legendHoverLink: false,\r\n            symbolSize: [14, 4 * 1.5],\r\n            symbolOffset: [x_value[1], 0],\r\n            symbolPosition: 'start',\r\n            symbol: 'triangle',\r\n            animation: false,\r\n            data: innerTopData(option_data.item1.data)\r\n        }, { //间隔用的柱子\r\n            type: 'bar',\r\n            barWidth: 6,\r\n            symbolOffset: [0, -6],\r\n            offset: 0,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: 'rgba(128, 128, 128, 0.1)'\r\n                }\r\n            }\r\n        }, { //指标3:柱子左半边\r\n            name: option_data.item2.name,\r\n            type: 'bar',\r\n            z: 3,\r\n            barWidth: 8,\r\n            symbolOffset: [0, -6],\r\n            offset: 0,\r\n            data: option_data.item2.data,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: {\r\n                        x: 1,\r\n                        y: 0,\r\n                        x2: 0,\r\n                        y2: 0,\r\n                        colorStops: [{\r\n                                offset: 0,\r\n                                color: '#ACE482'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#5D873E'\r\n                            }\r\n                        ]\r\n                    },\r\n                    opacity: 0.8\r\n                }\r\n            }\r\n        }, { //指标3:柱子右半边\r\n            name: option_data.item2.name,\r\n            type: 'bar',\r\n            z: 3,\r\n            barWidth: 8,\r\n            barGap: '-2%',\r\n            symbolOffset: [0, -6],\r\n            offset: 0,\r\n            data: option_data.item2.data,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: {\r\n                        x: 1,\r\n                        y: 0,\r\n                        x2: 0,\r\n                        y2: 0,\r\n                        colorStops: [{\r\n                                offset: 0,\r\n                                color: '#5D873E'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#ACE482'\r\n                            }\r\n                        ]\r\n                    },\r\n                    opacity: 0.8\r\n                }\r\n            }\r\n        }, { //指标3:柱子顶部\r\n            name: option_data.item2.name,\r\n            z: 3,\r\n            type: 'pictorialBar',\r\n            itemStyle: {\r\n                normal: {\r\n                    color: new echarts.graphic.LinearGradient(\r\n                        0, 0, 0, 1, [{\r\n                                offset: 0,\r\n                                color: '#ACE482'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#5D873E'\r\n                            }\r\n                        ]\r\n                    )\r\n                }\r\n            },\r\n            legendHoverLink: false,\r\n            //symbolSize: [6, 3],\r\n            //symbolOffset: [0, 0],\r\n            symbolSize: [14.8, 4 * -1.5],\r\n            symbolOffset: [x_value[2], 2.5],\r\n            symbolPosition: 'end',\r\n            symbol: 'triangle',\r\n            animation: false,\r\n            data: innerTopData(option_data.item2.data)\r\n        }, { //指标3:柱子底部\r\n            name: option_data.item2.name,\r\n            z: 3,\r\n            type: 'pictorialBar',\r\n            itemStyle: {\r\n                normal: {\r\n                    color: new echarts.graphic.LinearGradient(\r\n                        0, 0, 0, 1, [{\r\n                                offset: 0,\r\n                                color: '#ACE482'\r\n                            },\r\n                            {\r\n                                offset: 0.8,\r\n                                color: '#8ED15D'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#5D873E'\r\n                            }\r\n                        ]\r\n                    )\r\n                }\r\n            },\r\n            legendHoverLink: false,\r\n            symbolSize: [14, 4 * 1.5],\r\n            symbolOffset: [x_value[2], 0],\r\n            symbolPosition: 'start',\r\n            symbol: 'triangle',\r\n            animation: false,\r\n            data: innerTopData(option_data.item2.data)\r\n        }]\r\n    }\r\n}\r\n\r\n// 首次初始化option\r\nvar chart0 = echarts.init(document.getElementById('chart-panel'));\r\nchart0.setOption(initVisualizer([-21.5, 0, 21.5]));\r\n\r\n/*\r\n    图例按钮的点击监听事件\r\n    为了模拟柱子上下两头的浮雕立体效果，使用了两个\r\n    pictorialBar象形柱状图，但是发现使用后，如果\r\n    点击某个图例按钮后，无法跟随它的主人一起位移，\r\n    所以这里自定义了一个图例监听事件，每次点击后\r\n    重新setOption，并动态传入新的位移参数值。\r\n*/\r\nchart0.on('legendselectchanged', function(params) {\r\n\r\n    // 如果三个指标都被选中\r\n    if (params.selected[option_data[\"legend\"][0]] &&\r\n        params.selected[option_data[\"legend\"][1]] &&\r\n        params.selected[option_data[\"legend\"][2]]) {\r\n        chart0.setOption(initVisualizer([-21.5, 0, 21.5]));\r\n    }\r\n\r\n    //如果第一个图例被取消选中\r\n    else if (!params.selected[option_data[\"legend\"][0]] &&\r\n        params.selected[option_data[\"legend\"][1]] &&\r\n        params.selected[option_data[\"legend\"][2]]) {\r\n        chart0.setOption(initVisualizer([null, -8, 14]));\r\n    }\r\n\r\n    //如果第二个图例被取消选中\r\n    else if (params.selected[option_data[\"legend\"][0]] &&\r\n        !params.selected[option_data[\"legend\"][1]] &&\r\n        params.selected[option_data[\"legend\"][2]]) {\r\n        chart0.setOption(initVisualizer([-14, null, 13.5]));\r\n\r\n    }\r\n\r\n    //如果第三个图例被取消选中\r\n    else if (params.selected[option_data[\"legend\"][0]] &&\r\n        params.selected[option_data[\"legend\"][1]] &&\r\n        !params.selected[option_data[\"legend\"][2]]) {\r\n        chart0.setOption(initVisualizer([-14, 8, null]));\r\n    }\r\n\r\n    //如果第一个、第二个图例都被取消选中\r\n    else if (!params.selected[option_data[\"legend\"][0]] &&\r\n        !params.selected[option_data[\"legend\"][1]] &&\r\n        params.selected[option_data[\"legend\"][2]]) {\r\n        chart0.setOption(initVisualizer([null, null, 6]));\r\n    }\r\n\r\n    //如果第二个、第三个图例都被取消选中\r\n    else if (params.selected[option_data[\"legend\"][0]] &&\r\n        !params.selected[option_data[\"legend\"][1]] &&\r\n        !params.selected[option_data[\"legend\"][2]]) {\r\n        chart0.setOption(initVisualizer([-6, null, null]));\r\n    }\r\n\r\n    //如果第一个、第三个图例都被取消选中\r\n    else if (!params.selected[option_data[\"legend\"][0]] &&\r\n        params.selected[option_data[\"legend\"][1]] &&\r\n        !params.selected[option_data[\"legend\"][2]]) {\r\n        chart0.setOption(initVisualizer([null, 0, null]));\r\n    }\r\n});","html":"","externalScripts":"","updaterUID":"bd-1297380066","theme":"default","layout":"","viewCount":7809,"userName":"西***影","commentCount":2,"starCount":13,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xi0BHw0_5I.png?v=1623377896723","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","series-pictorialBar","title","tooltip"],"customTags":["柱状图"],"updaterUserName":"揭***纱"}}