{"status":0,"data":{"cid":"xSyQoZW7GQ","authorUid":"bd-3238471384","authorUserName":"leiris","title":"Awesome Chart123","description":"","latestVersion":4,"alwaysLatest":1,"createTime":"2018-06-29T00:47:23.000Z","lastUpdateTime":"2018-06-29T00:47:23.000Z","auth":2,"uid":"bd-3238471384","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":4,"parentVersion":3,"echartsVersion":"4.1.0","versionCreateTime":"2018-06-29T01:32:31.000Z","code":"var upColor = '#00da3c';\r\nvar downColor = '#ec0000';\r\nvar minDataURL = \"/asset/get/s/data-1530189895288-Hyy8uIMMm.json\";\r\nvar dayDataURL = \"/asset/get/s/data-1530189882975-Bymr_UfGX.json\";\r\n  \r\n// \"time, open, high, low, close\"\r\nvar minData = eval($.get({url:dayDataURL, async:false}).responseText);\r\nvar dayData = eval($.get({url:minDataURL, async:false}).responseText);\r\n\r\nfunction splitData(rawData) {\r\n    var categoryData = [];\r\n    var values = []\r\n    for (var i = 0; i < rawData.length; i++) {\r\n        categoryData.push(rawData[i].splice(0, 1)[0]);\r\n        values.push([rawData[i][0], rawData[i][3], rawData[i][1], rawData[i][2]])\r\n    }\r\n    return {\r\n        categoryData: categoryData,\r\n        values: values\r\n    };\r\n}\r\n\r\n//依据提供的 X 轴 数组插入空值\r\nfunction insertNullData(rawData, categoryData) {\r\n    var dict = {}\r\n    for (var i = 0; i < rawData.length; i++) {\r\n        key = rawData[i].splice(0, 1)[0];\r\n        key = key.slice(0,10) + ' 11:30:00';\r\n        dict[key] = [rawData[i][0], rawData[i][3], rawData[i][1], rawData[i][2]]\r\n    }\r\n    var values = []    \r\n    for (var k = 0; k < categoryData.length; k++) {\r\n        if(categoryData[k] in dict){\r\n            values.push(dict[categoryData[k]])\r\n        }\r\n        else{\r\n            values.push([])\r\n        }\r\n    }\r\n    return {\r\n        categoryData: categoryData,\r\n        values: values\r\n    };\r\n}\r\n\r\ndata = splitData(minData)\r\ndayData = insertNullData(dayData, data.categoryData)\r\nconsole.log(dayData)\r\n\r\n\r\noption = {\r\n    backgroundColor: '#fff',\r\n    animation: false,\r\n    legend: {\r\n        bottom: 10,\r\n        left: 'center',\r\n        data: ['Dow-Jones index',]\r\n    },\r\n    tooltip: {\r\n        trigger: 'axis',\r\n        axisPointer: {\r\n            type: 'cross'\r\n        },\r\n        backgroundColor: 'rgba(245, 245, 245, 0.8)',\r\n        borderWidth: 1,\r\n        borderColor: '#ccc',\r\n        padding: 10,\r\n        textStyle: {\r\n            color: '#000'\r\n        },\r\n        position: function (pos, params, el, elRect, size) {\r\n            var obj = {top: 10};\r\n            obj[['left', 'right'][+(pos[0] < size.viewSize[0] / 2)]] = 30;\r\n            return obj;\r\n        },\r\n        formatter: function (param) {\r\n            paramMin = param[1];\r\n            paramDay = param[0];\r\n            if(isNaN(paramDay.data[1])){\r\n                for (var i = paramDay.data[0]; i < dayData.values.length; i++) {\r\n                    if(isNaN(dayData.values[i][1])){\r\n                        continue;\r\n                    }\r\n                    else{\r\n                        paramDay.data[1] = dayData.values[i][0];\r\n                        paramDay.data[2] = dayData.values[i][1];\r\n                        paramDay.data[3] = dayData.values[i][2];\r\n                        paramDay.data[4] = dayData.values[i][3];\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            return [\r\n                'Date: ' + paramMin.name + '<hr size=1>',\r\n                '1min K线' + '<br>',\r\n                'Open: ' + paramMin.data[1] + '<br>',\r\n                'Close: ' + paramMin.data[2] + '<br>',\r\n                'Highest: ' + paramMin.data[3] + '<br>',\r\n                'Lowest: ' + paramMin.data[4] + '<br>',\r\n                '<hr size=1>',\r\n                '日K线' + '<br>',\r\n                'Open: ' + paramDay.data[1] + '<br>',\r\n                'Close: ' + paramDay.data[2] + '<br>',\r\n                'Highest: ' + paramDay.data[3] + '<br>',\r\n                'Lowest: ' + paramDay.data[4] + '<br>',\r\n            ].join('');\r\n        }\r\n        // extraCssText: 'width: 170px'\r\n    },\r\n    axisPointer: {\r\n        link: {xAxisIndex: 'all'},\r\n        label: {\r\n            backgroundColor: '#777'\r\n        }\r\n    },\r\n    toolbox: {\r\n        feature: {\r\n            dataZoom: {\r\n                yAxisIndex: false\r\n            },\r\n            brush: {\r\n                type: ['lineX', 'clear']\r\n            }\r\n        }\r\n    },\r\n    brush: {\r\n        xAxisIndex: 'all',\r\n        brushLink: 'all',\r\n        outOfBrush: {\r\n            colorAlpha: 0.1\r\n        }\r\n    },\r\n    visualMap: {\r\n        show: false,\r\n        seriesIndex: 5,\r\n        dimension: 2,\r\n        pieces: [{\r\n            value: 1,\r\n            color: downColor\r\n        }, {\r\n            value: -1,\r\n            color: upColor\r\n        }]\r\n    },\r\n    grid: [\r\n        {\r\n            left: '10%',\r\n            right: '8%',\r\n            height: '70%'\r\n        },\r\n        {\r\n            left: '10%',\r\n            right: '8%',\r\n            top: '72%',\r\n            height: '35%'\r\n        }\r\n    ],\r\n    xAxis: [\r\n        {\r\n            type: 'category',\r\n            data: data.categoryData,\r\n            scale: true,\r\n            boundaryGap : false,\r\n            axisLine: {onZero: false},\r\n            splitLine: {show: false},\r\n            splitNumber: 20,\r\n            min: 'dataMin',\r\n            max: 'dataMax',\r\n            axisPointer: {\r\n                z: 100\r\n            }\r\n        },\r\n        {\r\n            type: 'category',\r\n            gridIndex: 1,\r\n            data: data.categoryData,\r\n            scale: true,\r\n            boundaryGap : false,\r\n            axisLine: {onZero: false},\r\n            axisTick: {show: false},\r\n            splitLine: {show: false},\r\n            axisLabel: {show: false},\r\n            splitNumber: 20,\r\n            min: 'dataMin',\r\n            max: 'dataMax'\r\n        }\r\n    ],\r\n    yAxis: [\r\n        {\r\n            scale: true,\r\n            splitArea: {\r\n                show: true\r\n            }\r\n        },\r\n        {\r\n            scale: true,\r\n            gridIndex: 1,\r\n            splitArea: {\r\n                show: true\r\n            }\r\n        }\r\n    ],\r\n    dataZoom: [\r\n        {\r\n            type: 'inside',\r\n            xAxisIndex: [0, 1],\r\n            start: 98,\r\n            end: 100\r\n        },\r\n        {\r\n            show: true,\r\n            xAxisIndex: [0, 1],\r\n            type: 'slider',\r\n            top: '85%',\r\n            start: 98,\r\n            end: 100\r\n        }\r\n    ],\r\n    series: [\r\n        {\r\n            name: '1分钟K线',\r\n            type: 'candlestick',\r\n            data: data.values,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: upColor,\r\n                    color0: downColor,\r\n                    borderColor: null,\r\n                    borderColor0: null\r\n                }\r\n            },\r\n        },\r\n        {\r\n            name: '日K线',\r\n            type: 'candlestick',\r\n            data: dayData.values,\r\n            barWidth: '23500%',\r\n            itemStyle: {\r\n                normal: {\r\n                    color: upColor,\r\n                    color0: downColor,\r\n                    borderColor: null,\r\n                    borderColor0: null,\r\n                    opacity: 0.2\r\n                }\r\n            },\r\n        }\r\n    ]\r\n};","html":"","externalScripts":"","updaterUID":"bd-3238471384","theme":"","layout":"","viewCount":99,"userName":"leiris","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xSyQoZW7GQ.png?v=1530235951142","isCustomThumbnail":0,"builtinTags":["brush","category-work","dataZoom","grid","legend","series-candlestick","toolbox","tooltip","visualMap"],"customTags":[],"updaterUserName":"leiris"}}