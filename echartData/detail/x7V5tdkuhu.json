{"status":0,"data":{"cid":"x7V5tdkuhu","authorUid":"bd-547909240","authorUserName":"i***明","title":"柱状图（立体柱-上升）","description":"柱状图（立体柱-上升）","latestVersion":1,"alwaysLatest":1,"createTime":"2020-06-27T08:32:31.000Z","lastUpdateTime":"2020-06-27T08:32:31.000Z","auth":2,"uid":"bd-547909240","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-06-27T08:32:31.000Z","code":"// 绘制左侧面\r\nconst CubeLeft = echarts.graphic.extendShape({\r\n    shape: {\r\n        x: 0,\r\n        y: 0\r\n    },\r\n    buildPath: function(ctx, shape) {\r\n        // 会canvas的应该都能看得懂，shape是从custom传入的\r\n        const xAxisPoint = shape.xAxisPoint\r\n        console.log(shape)\r\n        const c0 = [shape.x, shape.y]\r\n        const c1 = [shape.x - 13, shape.y - 13]\r\n        const c2 = [xAxisPoint[0] - 13, xAxisPoint[1] - 13]\r\n        const c3 = [xAxisPoint[0], xAxisPoint[1]]\r\n        ctx.moveTo(c0[0], c0[1]).lineTo(c1[0], c1[1]).lineTo(c2[0], c2[1]).lineTo(c3[0], c3[1]).closePath()\r\n    }\r\n})\r\n// 绘制右侧面\r\nconst CubeRight = echarts.graphic.extendShape({\r\n    shape: {\r\n        x: 0,\r\n        y: 0\r\n    },\r\n    buildPath: function(ctx, shape) {\r\n        const xAxisPoint = shape.xAxisPoint\r\n        const c1 = [shape.x, shape.y]\r\n        const c2 = [xAxisPoint[0], xAxisPoint[1]]\r\n        const c3 = [xAxisPoint[0] + 18, xAxisPoint[1] - 9]\r\n        const c4 = [shape.x + 18, shape.y - 9]\r\n        ctx.moveTo(c1[0], c1[1]).lineTo(c2[0], c2[1]).lineTo(c3[0], c3[1]).lineTo(c4[0], c4[1]).closePath()\r\n    }\r\n})\r\n// 绘制顶面\r\nconst CubeTop = echarts.graphic.extendShape({\r\n    shape: {\r\n        x: 0,\r\n        y: 0\r\n    },\r\n    buildPath: function(ctx, shape) {\r\n        const c1 = [shape.x, shape.y]\r\n        const c2 = [shape.x + 18, shape.y - 9]\r\n        const c3 = [shape.x + 5, shape.y - 22]\r\n        const c4 = [shape.x - 13, shape.y - 13]\r\n        ctx.moveTo(c1[0], c1[1]).lineTo(c2[0], c2[1]).lineTo(c3[0], c3[1]).lineTo(c4[0], c4[1]).closePath()\r\n    }\r\n})\r\n// 注册三个面图形\r\necharts.graphic.registerShape('CubeLeft', CubeLeft)\r\necharts.graphic.registerShape('CubeRight', CubeRight)\r\necharts.graphic.registerShape('CubeTop', CubeTop)\r\n\r\n\r\n var data=[800,200,600,500,400]\r\n var xAxisData=['111','222','333','444','555']\r\n \r\n option = {\r\n     color: ['#3398DB'],\r\n     grid: {\r\n         left: '0%',\r\n         right: '0%',\r\n         bottom: '0%',\r\n         containLabel: true\r\n     },\r\n     xAxis: {\r\n         type: 'category',\r\n         axisLabel: { // 文字样式\r\n             color: 'black',\r\n         },\r\n         data: xAxisData\r\n     },\r\n     yAxis: {\r\n         type: 'value',\r\n         axisLabel: {\r\n             color: 'black',\r\n         },\r\n         splitLine: { //分隔线颜色\r\n             lineStyle: {\r\n                 color: ['#162b5f']\r\n             }\r\n         }\r\n     },\r\n     series: [{\r\n        type: 'custom',\r\n        renderItem: (params, api) => {\r\n            const location = api.coord([api.value(0), api.value(1)])\r\n            return {\r\n                type: 'group',\r\n                children: [{\r\n                    type: 'CubeLeft',\r\n                    shape: {\r\n                        api,\r\n                        xValue: api.value(0),\r\n                        yValue: api.value(1),\r\n                        x: location[0],\r\n                        y: location[1],\r\n                        xAxisPoint: api.coord([api.value(0), 0])\r\n                    },\r\n                    style: {\r\n                        fill: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                              offset: 0,\r\n                              color: '#48bbe4'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#48bbe4'\r\n                            }\r\n                        ])\r\n                    }\r\n                }, {\r\n                    type: 'CubeRight',\r\n                    shape: {\r\n                        api,\r\n                        xValue: api.value(0),\r\n                        yValue: api.value(1),\r\n                        x: location[0],\r\n                        y: location[1],\r\n                        xAxisPoint: api.coord([api.value(0), 0])\r\n                    },\r\n                    style: {\r\n                        fill: new echarts.graphic.LinearGradient(0, 0, 0,1, [{\r\n                                offset: 0,\r\n                                color: '#48bbe4'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#48bbe4'\r\n                            }\r\n                        ])\r\n                    }\r\n                }, {\r\n                    type: 'CubeTop',\r\n                    shape: {\r\n                        api,\r\n                        xValue: api.value(0),\r\n                        yValue: api.value(1),\r\n                        x: location[0],\r\n                        y: location[1],\r\n                        xAxisPoint: api.coord([api.value(0), 0])\r\n                    },\r\n                    style: {\r\n                        fill: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                                offset: 1,\r\n                                color: '#48bbe4'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#48bbe4'\r\n                            }\r\n                        ])\r\n                    }\r\n                }]\r\n            }\r\n        },\r\n        data: data,\r\n        animationDelay: 0, //动画延迟时间\r\n        animationDuration: 0, //动画时长\r\n        animationDurationUpdate: 0\r\n    },{\r\n        type: 'custom',\r\n         renderItem: (params, api) => {\r\n            const location = api.coord([api.value(0), api.value(1)])\r\n            return {\r\n                type: 'group',\r\n                children: [{\r\n                    type: 'CubeLeft',\r\n                    shape: {\r\n                        api,\r\n                        xValue: api.value(0),\r\n                        yValue: api.value(1),\r\n                        x: location[0],\r\n                        y: location[1],\r\n                        xAxisPoint: api.coord([api.value(0), 0])\r\n                    },\r\n                    style: {\r\n                        fill: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                                offset: 0,\r\n                                color: '#3b82e1'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#3b82e1'\r\n                            }\r\n                        ])\r\n                    }\r\n                }, {\r\n                    type: 'CubeRight',\r\n                    shape: {\r\n                        api,\r\n                        xValue: api.value(0),\r\n                        yValue: api.value(1),\r\n                        x: location[0],\r\n                        y: location[1],\r\n                        xAxisPoint: api.coord([api.value(0), 0])\r\n                    },\r\n                    style: {\r\n                        fill: new echarts.graphic.LinearGradient(0, 0, 0,1, [{\r\n                                offset: 0,\r\n                                 color: '#3b82e1'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#3b82e1'\r\n                            }\r\n                        ])\r\n                    }\r\n                }, {\r\n                    type: 'CubeTop',\r\n                    shape: {\r\n                        api,\r\n                        xValue: api.value(0),\r\n                        yValue: api.value(1),\r\n                        x: location[0],\r\n                        y: location[1],\r\n                        xAxisPoint: api.coord([api.value(0), 0])\r\n                    },\r\n                    style: {\r\n                        fill: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                                offset: 0,\r\n                                 color: '#3b82e1'\r\n                            },\r\n                            {\r\n                                offset: 1,\r\n                                color: '#3b82e1'\r\n                            }\r\n                        ])\r\n                    }\r\n                }]\r\n            }\r\n        },\r\n        data: data,\r\n        animationDelay: 0, //动画延迟时间\r\n        animationDuration: 0, //动画时长\r\n        animationDurationUpdate: 0\r\n    }\r\n     ]\r\n };\r\n \r\n riseAnimation(data, myChart, option, 10, 50)\r\n\r\n function riseAnimation(data, chart, option, time, speed) {\r\n     var thisYearData = {\r\n         norm: data,\r\n         data1: new Array(5).fill(0),\r\n         data2: [],\r\n     }\r\n     chart.myOption = option\r\n     chart.thisYearData = thisYearData\r\n     function formData(data) {\r\n         var norm = data.norm\r\n         var data1 = data.data1\r\n         var data2 = data.data2\r\n         data2 = norm.map((e, index) => {\r\n             var item = e / ((time * 1000) / speed)\r\n             data1[index] += item\r\n             if (data1[index] >= e) {\r\n                 data1[index] = 0\r\n             }\r\n             return e - data1[index]\r\n         })\r\n         return [data1, data2]\r\n     }\r\n     setInterval(function() {\r\n         var thisYear = formData(this.thisYearData)\r\n         //this.myOption.series[0].data = thisYear[0]\r\n         this.myOption.series[1].data = thisYear[0]\r\n         this.setOption(this.myOption)\r\n     }.bind(chart), speed)\r\n }","html":"","externalScripts":"","updaterUID":"bd-547909240","theme":"","layout":"","viewCount":61,"userName":"i***明","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x7V5tdkuhu.png?v=1593246751849","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-custom"],"customTags":[],"updaterUserName":"i***明"}}