{"status":0,"data":{"cid":"xSy6ax1KYf","authorUid":"bd-1393317740","authorUserName":"枫***轩","title":"累计版本","description":"","latestVersion":2,"alwaysLatest":1,"createTime":"2018-03-16T06:14:29.000Z","lastUpdateTime":"2018-03-16T06:14:29.000Z","auth":2,"uid":"bd-1393317740","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.0.4","versionCreateTime":"2018-03-16T06:41:13.000Z","code":"var myChart = echarts.init(document.getElementById('chart-panel'));\r\nvar selected = {}; //存储选中的状态\r\nvar xdata = ['三人班学费', '一对一学费'];\r\nvar ydata = ['词汇', '阅读理解', '完形填空', '语法填空', '短文改错', '英语写作'];\r\nvar vdata = [\r\n    [1500, 2000, 0],\r\n    [3500, 4000, 40],\r\n    [3500, 4000, 30],\r\n    [1500, 2000, 15],\r\n    [1500, 2000, 10],\r\n    [2000, 2500, 25],\r\n\r\n];\r\nvar series = [];\r\nvar legenddata = ydata;\r\nvar sumData = [];\r\n\r\n//求每一列数据和\r\n$.each(vdata[0], function(i, v) { //0-9\r\n    var sum = 0;\r\n    for (var j = 0; j < vdata.length; j++) { //0-2\r\n        sum += vdata[j][i];\r\n    }\r\n    sumData[i] = parseFloat(toDecimal(sum));\r\n});\r\n\r\n$.each(vdata, function(i, v) {\r\n\r\n    var bs = {\r\n        name: ydata[i],\r\n        type: 'bar',\r\n        smooth: true,\r\n        areaStyle: {\r\n            normal: {}\r\n        },\r\n        data: v,\r\n        barWidth: '40%',\r\n        stack: '总量'\r\n    };\r\n    series.push(bs);\r\n\r\n});\r\n\r\n//总量&平均值\r\nvar bs2 = {\r\n    name: '总量',\r\n    type: 'line',\r\n    data: sumData,\r\n    label: {\r\n        normal: {\r\n            show: true,\r\n            position: 'top'\r\n        }\r\n    },\r\n    lineStyle: {\r\n        normal: {\r\n            color: \"none\"\r\n        }\r\n    },\r\n\r\n\r\n};\r\nseries.push(bs2);\r\n\r\noption = {\r\n    tooltip: {\r\n        trigger: 'axis',\r\n        axisPointer: {\r\n            type: 'shadow',\r\n            crossStyle: {\r\n                color: '#999'\r\n           }\r\n        },\r\n        formatter: function(params) {\r\n            params.pop(); //删除最后一个\r\n            if (params[0]) {\r\n                var res = params[0].name + '<br/>';\r\n                for (var i = 0; i < params.length; i++) {\r\n                    res += (params[i].marker + params[i].seriesName + \" : \" + params[i].value + '<br/>');\r\n                }\r\n                return res;\r\n            }\r\n        }\r\n    },\r\n    legend: {\r\n        data: legenddata,\r\n        top: '6%',\r\n        right: '3%'\r\n    },\r\n    \r\n    \r\n    \r\n    \r\n   \r\n    \r\n    \r\n    xAxis: [{\r\n        data: xdata,\r\n    }],\r\n    yAxis: [{\r\n        name: '',\r\n        type: 'value',\r\n        \r\n            \r\n        \r\n    }],\r\n    \r\n    \r\n    grid: {\r\n        top: '12%',\r\n        left: '3%',\r\n        right: '4%',\r\n        bottom: '4%',\r\n        containLabel: true\r\n    },\r\n    series: series\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//保留一位小数\r\nfunction toDecimal(num) {\r\n    return parseFloat(num).toFixed(1);\r\n}\r\n\r\n//捕捉变化状态\r\nmyChart.on(\"legendselectchanged\", function(params) {\r\n    selected = params.selected;\r\n\r\n    //重新计算sumData\r\n    $.each(vdata[0], function(i, v) { //0-9\r\n        var sum = 0;\r\n        //遍历对象\r\n        for (var key in selected) {\r\n            if (selected[key]) { //获取被选中的元素\r\n                var index = ydata.indexOf(key); //获取被选中key在ydata里的索引\r\n                sum += vdata[index][i];\r\n            }\r\n        }\r\n        sumData[i] = parseFloat(toDecimal(sum));\r\n\r\n    });\r\n    myChart.setOption(option); //重新绘图\r\n\r\n});\r\n\r\n\r\n\r\nmyChart.setOption(option);","html":"","externalScripts":"","updaterUID":"bd-1393317740","theme":"","layout":"","viewCount":52,"userName":"枫***轩","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xSy6ax1KYf.png?v=1521182473444","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","series-line","tooltip"],"customTags":[],"updaterUserName":"枫***轩"}}