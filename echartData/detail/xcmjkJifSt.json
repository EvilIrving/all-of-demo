{"status":0,"data":{"cid":"xcmjkJifSt","authorUid":"obd-oP4yFspLjRVwrJMfdPnGV7KDfYDUc9Q","authorUserName":"宁***群","title":"3D柱状图—可切换为3D折线图","description":"3D柱状图—可切换为3D折线图（折线图搭配散点图提高可视效果）","latestVersion":1,"alwaysLatest":0,"createTime":"2021-09-17T07:22:07.000Z","lastUpdateTime":"2021-09-17T07:22:07.000Z","auth":2,"uid":"obd-oP4yFspLjRVwrJMfdPnGV7KDfYDUc9Q","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"5.2.0","versionCreateTime":"2021-09-17T07:22:07.000Z","code":"// var data = [[0,0,5],[1,0,11],[2,0,3],[3,0,1],[4,0,2],[5,0,2],[6,0,6]];\r\n// 堆叠3D柱状图\r\n// max 自适应\r\n// y轴数据自适应\r\n\r\n// 绘制类型配置\r\nvar t = 0\r\nvar icon = \"path://M675.711586 848.029728l-186.277248-105.922357c-29.21996-18.262475-51.134931-3.652495-51.134931 29.219961v98.617366H146.099802c-51.134931 0-91.312376-40.177446-91.312376-91.312376V263.630519c0-51.134931 40.177446-91.312376 91.312376-91.312377h175.319763V121.183212H146.099802C69.397406 121.183212 3.652495 183.275627 3.652495 263.630519v515.001803c0 76.702396 65.744911 142.447307 142.447307 142.447307h295.8521V986.82454c0 32.872456 21.91497 47.482436 51.134931 29.219961l160.709782-94.964872h7.30499V913.774639l18.262476-10.957485c25.567465-14.60998 25.567465-40.177446-3.652495-54.787426M1070.181052 121.183212h-255.674654V37.175825c0-32.872456-21.91497-47.482436-51.134931-29.21996l-186.277248 105.922356c-29.21996 18.262475-29.21996 43.829941 0 58.439921l186.277248 109.574852c29.21996 18.262475 51.134931 3.652495 51.134931-29.21996V168.665647h255.674654c51.134931 0 91.312376 40.177446 91.312376 91.312377v515.001803c0 51.134931-40.177446 91.312376-91.312376 91.312376h-135.142317v51.134931h135.142317c76.702396 0 142.447307-62.092416 142.447307-142.447307V256.325529c0-73.049901-62.092416-135.142317-142.447307-135.142317\"\r\n\r\n\r\nvar dataset = {\r\n    dimensions: [\"日期\", \"访问用户\", \"访问用户1\"],\r\n\tsource: [\r\n\t\t{ 日期: '1月1日', 访问用户: 1523, 访问用户1: 1111 },\r\n\t\t{ 日期: '1月2日', 访问用户: 1223, 访问用户1: 8611 },\r\n\t\t{ 日期: '1月3日', 访问用户: 2123, 访问用户1: 2311 },\r\n\t\t{ 日期: '1月4日', 访问用户: 4123, 访问用户1: 2411 },\r\n\t\t{ 日期: '1月5日', 访问用户: 3123, 访问用户1: 1111 },\r\n\t\t{ 日期: '1月6日', 访问用户: 7123, 访问用户1: 3111 }\r\n\t]\r\n}\r\n\r\nfunction solve_xData() {\r\n\tconst x = [];\r\n\tfor(let i = 0; i<dataset.source.length; i++){\r\n\t\tx.push(dataset.source[i][dataset.dimensions[0]]);\r\n\t}\r\n\treturn x;\r\n}\r\n// console.log(solve_xData());\r\n\r\nvar type = 'bar3D' // bar3D、line3D\r\n\r\nfunction solve_series() {\r\n\tconst s = [];\r\n\tfor(let i = 1; i<dataset.dimensions.length; i++){\r\n\t\tconst data = [];\r\n\t\tfor(let j = 0; j<dataset.source.length; j++){\r\n\t\t\tdata.push(dataset.source[j][dataset.dimensions[i]]);\r\n\t\t}\r\n\t\ts.push({\r\n\t\t\tname: dataset.dimensions[i],\r\n            // type: 'line3D', // bar3D、line3D\r\n            type: type,\r\n            // stack: 'stack',\r\n\t\t\tdata: data.map(function (item,index) {\r\n\t\t\t //   console.log(item,index)\r\n                return {\r\n                    // value: [index, 0, item],\r\n                    value: [index, i-1, item],\r\n                }\r\n            }),\r\n\t\t\tshading: 'lambert',\r\n            label: {\r\n                textStyle: {\r\n                    fontSize: 16,\r\n                    borderWidth: 1\r\n                }\r\n            },\r\n            lineStyle:{\r\n                width: 3\r\n            },\r\n            emphasis: {\r\n                label: {\r\n                    textStyle: {\r\n                        fontSize: 20,\r\n                        color: '#900'\r\n                    }\r\n                },\r\n                // itemStyle: {\r\n                //     color: '#900'\r\n                // }\r\n            }\r\n\t\t});\r\n\t\tif(type == 'line3D'){\r\n\t\t   s.push({\r\n    \t\t    name: dataset.dimensions[i],\r\n    \t        type: 'scatter3D',\r\n    \t\t\tdata: data.map(function (item,index) {\r\n    \t\t\t //   console.log(item,index)\r\n                    return {\r\n                        // value: [index, 0, item],\r\n                        value: [index, i-1, item],\r\n                    }\r\n                }),\r\n                label: {\r\n                    show:true,\r\n                    textStyle:{\r\n                        color: 'red',\r\n                        borderWidth: 0,\r\n                        borderColor: '#c6c6c6',\r\n                        backgroundColor: 'transparent'\r\n                    }\r\n                }\r\n\t\t    }); \r\n\t\t}\r\n\t}\r\n\treturn s;\r\n}\r\n// console.log(solve_series());\r\n\r\nfunction max(){\r\n\tlet s = []\r\n\tfor(let i = 1; i < dataset.dimensions.length; i++){\r\n    \tfor(let j = 0; j < dataset.source.length; j++){\r\n    \t\ts.push(dataset.source[j][dataset.dimensions[i]])\r\n    \t}  \r\n\t}\r\n    // console.log(s,Math.max.apply(null, s), Math.min.apply(null, s))\r\n\treturn  Math.max.apply(null, s) + Math.min.apply(null, s)\r\n}\r\n// console.log(max())\r\n\r\n// var yData = ['',''];\r\nvar yData = dataset.dimensions.slice(1)\r\n// console.log(dataset.dimensions,yData)\r\n\r\noption = {\r\n    // backgroundColor: '#dee2e6',\r\n    tooltip: {\r\n        formatter: function(params){\r\n            var xIndex = params.value[0]\r\n            var tip = params.seriesName+': '+ params.value[2]\r\n            return dataset.source[xIndex][dataset.dimensions[0]]+ '<br />' +params.marker+tip\r\n        },\r\n        // textStyle:{\r\n        //     color: '#fff'\r\n        // },\r\n    },\r\n    toolbox: {\r\n        show: true,\r\n        feature: {\r\n            myTool:{ //自定义方法 配置   我这是为了实现 饼图切换为柱状图\r\n                show : true,\r\n                title : '切换类型',\r\n                icon : icon,\r\n                onclick : function (){\r\n                    t++\r\n                    if(t%2){\r\n                        type = 'line3D'\r\n                    }else{\r\n                        type = 'bar3D'\r\n                    }\r\n                   \r\n                    option.series = solve_series()\r\n                    myChart.setOption(option, true)\r\n                }\r\n            },\r\n        },\r\n        left: 20,\r\n        top: 20,\r\n    },\r\n    legend:{},\r\n    visualMap: {\r\n        show: false,\r\n        max: max(),\r\n        // inRange: {\r\n        //     color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']\r\n        // }\r\n    },\r\n    xAxis3D: {\r\n        // name:'X',\r\n        nameGap: 1,\r\n        type: 'category',\r\n        data: solve_xData()\r\n    },\r\n    yAxis3D: {\r\n        name:'',\r\n        type: 'category',\r\n        data: yData\r\n    },\r\n    zAxis3D: {\r\n        name:'',\r\n        type: 'value'\r\n    },\r\n    grid3D: {\r\n        boxWidth: 150,\r\n        boxDepth: 20,\r\n        // light: { // 光\r\n        //     main: {\r\n        //         intensity: 1.2,\r\n        //         shadow: true\r\n        //     },\r\n        //     ambient: {\r\n        //         intensity: 0.3\r\n        //     }\r\n        // },\r\n        viewControl:{\r\n            alpha: 5,\r\n            beta: 20,\r\n        }\r\n    },\r\n    series: solve_series()\r\n}","html":"","externalScripts":"https://cdn.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js","updaterUID":"obd-oP4yFspLjRVwrJMfdPnGV7KDfYDUc9Q","theme":"","layout":"","viewCount":0,"userName":"宁***群","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xcmjkJifSt.png?v=1631863327957","isCustomThumbnail":0,"builtinTags":["category-work","grid3D","legend","series-bar3D","toolbox","tooltip","visualMap"],"customTags":[],"updaterUserName":"宁***群"}}