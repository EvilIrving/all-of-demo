{"status":0,"data":{"cid":"x5R8BIF7l-","authorUid":"bd-167860219","authorUserName":"n***1","title":"路网交通指数时变","description":"基于出租车数据得到，100拥挤，0畅通","latestVersion":7,"alwaysLatest":1,"createTime":"2020-05-15T16:05:04.000Z","lastUpdateTime":"2020-05-15T16:05:04.000Z","auth":2,"uid":"bd-167860219","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":7,"parentVersion":6,"echartsVersion":"4.7.0","versionCreateTime":"2020-05-15T16:18:03.000Z","code":"var tsiDataURL = \"/asset/get/s/data-1589533736008-WZ3EgDUbv.json\";\r\nvar osmDataURL = \"/asset/get/s/data-1589533720302-oCMku6fij.json\";\r\n$.getJSON(osmDataURL, function(osmroad) {\r\n    $.getJSON(tsiDataURL, function(data_1) {\r\nmyChart.showLoading();\r\nvar option = {\r\n    baseOption: {\r\n        timeline: {\r\n            axisType: 'category',\r\n            realtime: false,\r\n            // loop: false,\r\n                orient: 'vertical',\r\n                autoPlay: true,\r\n                inverse: true,\r\n            playInterval: 200,\r\n            symbolSize: 12,\r\n                left: null,\r\n                right: 0,\r\n                top: null,\r\n                bottom: 0,\r\n                width: 55,\r\n                height: null,\r\n            // controlStyle: {\r\n            //     position: 'left'\r\n            // },\r\n            data: [],\r\n            tooltip: {\r\n                formatter: 1\r\n            },\r\n        },\r\n        animation: false,\r\n        \r\n        visualMap: {\r\n            min: 0,\r\n            max: 80,\r\n            text: ['High', 'Low'],\r\n            realtime: false,\r\n            calculable: true,\r\n            seriesIndex: 0,\r\n            inRange: {\r\n                color: ['#9DCC42', '#FFFE03', '#F7941D', '#E9420E', '#FF0000']\r\n            }\r\n        },\r\n        //bmap组件是百度地图的参数\r\n        bmap: {\r\n            center: [121.501206, 31.203083],\r\n            zoom: 12,\r\n            roam: true,\r\n            //地图个性化设置\r\n            mapStyle: {\r\n                styleJson: [{\r\n                    'featureType': 'water',\r\n                    'elementType': 'all',\r\n                    'stylers': {\r\n                        'color': '#d1d1d1'\r\n                    }\r\n                }, {\r\n                    'featureType': 'land',\r\n                    'elementType': 'all',\r\n                    'stylers': {\r\n                        'color': '#f3f3f3'\r\n                    }\r\n                }, {\r\n                    'featureType': 'railway',\r\n                    'elementType': 'all',\r\n                    'stylers': {\r\n                        'visibility': 'off'\r\n                    }\r\n                }, {\r\n                    'featureType': 'highway',\r\n                    'elementType': 'all',\r\n                    'stylers': {\r\n                        'color': '#fdfdfd'\r\n                    }\r\n                }, {\r\n                    'featureType': 'highway',\r\n                    'elementType': 'labels',\r\n                    'stylers': {\r\n                        'visibility': 'off'\r\n                    }\r\n                }, {\r\n                    'featureType': 'arterial',\r\n                    'elementType': 'geometry',\r\n                    'stylers': {\r\n                        'color': '#fefefe'\r\n                    }\r\n                }, {\r\n                    'featureType': 'arterial',\r\n                    'elementType': 'geometry.fill',\r\n                    'stylers': {\r\n                        'color': '#fefefe'\r\n                    }\r\n                }, {\r\n                    'featureType': 'poi',\r\n                    'elementType': 'all',\r\n                    'stylers': {\r\n                        'visibility': 'off'\r\n                    }\r\n                }, {\r\n                    'featureType': 'green',\r\n                    'elementType': 'all',\r\n                    'stylers': {\r\n                        'visibility': 'off'\r\n                    }\r\n                }, {\r\n                    'featureType': 'subway',\r\n                    'elementType': 'all',\r\n                    'stylers': {\r\n                        'visibility': 'off'\r\n                    }\r\n                }, {\r\n                    'featureType': 'manmade',\r\n                    'elementType': 'all',\r\n                    'stylers': {\r\n                        'color': '#d1d1d1'\r\n                    }\r\n                }, {\r\n                    'featureType': 'local',\r\n                    'elementType': 'all',\r\n                    'stylers': {\r\n                        'color': '#d1d1d1'\r\n                    }\r\n                }, {\r\n                    'featureType': 'arterial',\r\n                    'elementType': 'labels',\r\n                    'stylers': {\r\n                        'visibility': 'off'\r\n                    }\r\n                }, {\r\n                    'featureType': 'boundary',\r\n                    'elementType': 'all',\r\n                    'stylers': {\r\n                        'color': '#fefefe'\r\n                    }\r\n                }, {\r\n                    'featureType': 'building',\r\n                    'elementType': 'all',\r\n                    'stylers': {\r\n                        'color': '#d1d1d1'\r\n                    }\r\n                }, {\r\n                    'featureType': 'label',\r\n                    'elementType': 'labels.text.fill',\r\n                    'stylers': {\r\n                        'color': '#999999'\r\n                    }\r\n                }]\r\n            }\r\n        },\r\n        series: []\r\n    },\r\n    animationDurationUpdate: 3000,\r\n    animationEasingUpdate: 'quinticInOut',\r\n    options: []\r\n};\r\n\r\n\r\n\r\nfunction matchdata(osmroad, data_1) { \r\n    var data = []\r\n    for (var i = 0; i < data_1.length; i += 1) {\r\n        var value = data_1[i]\r\n        var v = {}\r\n        v.coords = osmroad[i].coords\r\n        v.value = value\r\n        data.push(v)\r\n    }\r\n    return data\r\n}\r\n//读取数据\r\n\r\n        var option1 = {\r\n            options: []\r\n        }\r\n        var times = []\r\n        for (var k = 0; k < data_1.length; k += 1) {\r\n                        if (k % 2==1){\r\n                a='30'\r\n            }else{a='00'}\r\n            times.push((Math.floor(k / 2) + 6).toString()+':'+a)\r\n            var datak = data_1[k]\r\n            var data = matchdata(osmroad, datak)\r\n\r\n            var opt1 = {\r\n                title: {\r\n                    text: \"路网交通指数时变 \" + (Math.floor(k / 2) + 6).toString()+':'+a,\r\n                    left: 10,\r\n                    top: 10,\r\n                    textStyle: {\r\n                        color: 'rgba(18,89,147,1)',\r\n                        fontSize: 40\r\n                    }\r\n                },\r\n                series: [{\r\n                    type: 'lines',\r\n                    coordinateSystem: 'bmap',\r\n                    polyline: true,\r\n                    silent: true,\r\n                    lineStyle: {\r\n                        color: 'rgb(200,200,200)',\r\n                        opacity: 1,\r\n                        width: 2\r\n                    },\r\n                    progressiveThreshold: 0,\r\n                    progressive: 0,\r\n                    data: {},\r\n                }]\r\n            }\r\n            opt1.series[0].data=data\r\n            option1.options.push(opt1)\r\n\r\n        }\r\n\r\n        option.baseOption.timeline.data = times\r\n        option.baseOption.timeline.tooltip.formatter = times\r\n        myChart.setOption(option)\r\n        if (!app.inNode) {\r\n    // 添加百度地图插件\r\n    var bmap = myChart.getModel().getComponent('bmap').getBMap();\r\n    bmap.addControl(new BMap.MapTypeControl());\r\n}\r\n\r\n        myChart.setOption(option1)\r\n        myChart.hideLoading();\r\n    })\r\n\r\n\r\n\r\n})","html":"","externalScripts":"https://api.map.baidu.com/getscript?v=2.0&ak=xfhhaTThl11qYVrqLZii6w8qE5ggnhrY&services=&t=20190123111209,/dep/echarts/latest/extension/bmap.min.js","updaterUID":"bd-167860219","theme":"","layout":"","viewCount":1929,"userName":"n***1","commentCount":6,"starCount":14,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x5R8BIF7l-.png?v=1589558707860","isCustomThumbnail":1,"builtinTags":["category-work"],"customTags":[],"updaterUserName":"n***1"}}