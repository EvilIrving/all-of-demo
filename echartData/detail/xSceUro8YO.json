{"status":0,"data":{"cid":"xSceUro8YO","authorUid":"obd-oE7w2k181ch3IAhFSl9BN2ElvBWU74D","authorUserName":"十***乡","title":"图例控制Y轴展示数量","description":"当一个图表中数据种类过多，对应多种Y轴，可以根据图例显隐动态控制显隐Y轴","latestVersion":1,"alwaysLatest":1,"createTime":"2020-08-11T07:52:50.000Z","lastUpdateTime":"2020-08-11T07:52:50.000Z","auth":1,"uid":"obd-oE7w2k181ch3IAhFSl9BN2ElvBWU74D","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.4.0","versionCreateTime":"2020-08-11T07:52:50.000Z","code":"var app = {};\r\noption = null;\r\napp.title = '多 Y 轴示例';\r\nlet colors, LengData, SelectedData, YaData, SeriesData, DataInfo;\r\ncolors = ['#5793f3', '#d14a61', '#675bba', '#66bbee'];\r\nSelectedData = {\r\n    降水量: true,\r\n    蒸发量: true,\r\n    温度: true,\r\n    温差: true,\r\n}\r\nLengData = ['降水量', '蒸发量', '温度', '温差'];\r\nDataInfo = [{\r\n        name: '降水量',\r\n        type: 'bar',\r\n        yAxisIndex: 0,\r\n        data: [2.6, 5.9, 9.0, 26.4, 28.7, 70.7, 175.6, 182.2, 48.7, 18.8, 6.0, 2.3]\r\n    },\r\n    {\r\n        name: '蒸发量',\r\n        type: 'bar',\r\n        yAxisIndex: 1,\r\n        data: [2.0, 4.9, 7.0, 23.2, 25.6, 76.7, 135.6, 162.2, 32.6, 20.0, 6.4, 3.3]\r\n    },\r\n    {\r\n        name: '温度',\r\n        type: 'line',\r\n        yAxisIndex: 2,\r\n        data: [2.0, 2.2, 3.3, 4.5, 6.3, 10.2, 20.3, 23.4, 23.0, 16.5, 12.0, 6.2]\r\n    },\r\n    {\r\n        name: '温差',\r\n        type: 'line',\r\n        yAxisIndex: 3,\r\n        data: [21.0, 32.2, 23.3, 4.5, 7.3, 14.2, 20.3, 55.4, 23.0, 43.5, 13.4, 16.2]\r\n    }\r\n];\r\n\r\nfunction Init(sel, dataInfo) {\r\n    SelectedData = sel || {};\r\n    YaData = [], SeriesData = [];\r\n    let Datas = JSON.parse(JSON.stringify(dataInfo));\r\n    for (let n = 0, l = LengData.length; n < l; n++) {\r\n        // 如果该图例状态为false时，则跳过 不push\r\n        if (sel[LengData[n]]) {\r\n            YaData.push({\r\n                type: 'value',\r\n                name: LengData[n],\r\n                min: 0,\r\n                max: function(val) {\r\n                    return parseInt(val.max * 1.1).toFixed(2);\r\n                },\r\n                position: YaData.length % 2 == 0 ? 'left' : \"right\",\r\n                offset: (YaData.length + 1) <= 2 ? 0 : (Math.ceil((YaData.length + 1) / 2) - 1) * 80,\r\n                axisLine: {\r\n                    lineStyle: {\r\n                        color: colors[n]\r\n                    }\r\n                },\r\n                axisLabel: {\r\n                    formatter: function(value) {\r\n                        if (n < 2) {\r\n                            return value + 'ml'\r\n                        } else {\r\n                            return value + '°C'\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n            Datas[n].yAxisIndex = YaData.length - 1 < 0 ? 0 : YaData.length - 1;\r\n            SeriesData.push(Datas[n]);\r\n        } else {\r\n            Datas[n].data = [];\r\n            Datas[n].yAxisIndex = YaData.length - 1 < 0 ? 0 : YaData.length - 1;\r\n            SeriesData.push(Datas[n]);\r\n        }\r\n    }\r\n    if (YaData.length == 0) {\r\n        YaData = {\r\n            type: 'value'\r\n        }\r\n    }\r\n    option = {\r\n        color: colors,\r\n        tooltip: {\r\n            trigger: 'axis',\r\n            axisPointer: {\r\n                type: 'cross'\r\n            }\r\n        },\r\n        grid: {\r\n            right: (YaData.length / 2) * 10 + '%',\r\n            left: (YaData.length / 2) * 10 + '%'\r\n        },\r\n        toolbox: {\r\n            feature: {\r\n                dataView: {\r\n                    show: true,\r\n                    readOnly: false\r\n                },\r\n                restore: {\r\n                    show: true\r\n                },\r\n                saveAsImage: {\r\n                    show: true\r\n                }\r\n            }\r\n        },\r\n        legend: {\r\n            data: LengData,\r\n            selected: SelectedData,\r\n        },\r\n        xAxis: [{\r\n            type: 'category',\r\n            axisTick: {\r\n                alignWithLabel: true\r\n            },\r\n            data: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月']\r\n        }],\r\n        yAxis: YaData,\r\n        series: SeriesData\r\n    };\r\n}\r\nInit(SelectedData, DataInfo);\r\nif (option && typeof option === \"object\") {\r\n    myChart.setOption(option, true);\r\n}\r\n/* 选中图例 */\r\nmyChart.on(\"legendselectchanged\", function(params) {\r\n    // 得到当前的图例显示隐藏状态分别有哪些\r\n    SelectedData = params.selected;\r\n    Init(SelectedData, DataInfo);\r\n    if (option && typeof option === \"object\") {\r\n        myChart.setOption(option, true);\r\n    }\r\n})\r\n/* 取消选中图例 */\r\nmyChart.on(\"legendunselected\", function(params) {\r\n    // 得到当前的图例显示隐藏状态分别有哪些\r\n    let selectObj = params.name;\r\n})","html":"","externalScripts":"https://cdn.bootcss.com/echarts/4.4.0-rc.1/echarts-en.common.min.js","updaterUID":"obd-oE7w2k181ch3IAhFSl9BN2ElvBWU74D","theme":"","layout":"","viewCount":159,"userName":"十***乡","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xSceUro8YO.png?v=1597132370683","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","series-line","toolbox","tooltip"],"customTags":[],"updaterUserName":"十***乡"}}