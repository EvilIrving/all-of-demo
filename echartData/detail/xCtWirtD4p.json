{"status":0,"data":{"cid":"xCtWirtD4p","authorUid":"obd-oDlaDs0J42nfV34ZIq3ZyQK0OiRx31H","authorUserName":"林***Y","title":"正方体柱子","description":"正方体柱子","latestVersion":1,"alwaysLatest":0,"createTime":"2021-12-07T02:18:11.000Z","lastUpdateTime":"2021-12-07T02:18:11.000Z","auth":2,"uid":"obd-oDlaDs0J42nfV34ZIq3ZyQK0OiRx31H","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"5.2.2","versionCreateTime":"2021-12-07T02:18:11.000Z","code":"let arr = [];\nlet list = [];\nlet series = [];\nlet legend = [];\nlet fontSize = 16;\nlet barWidth = 26;\nlet barGap = 0;\nlet maxList = [];\nlet max = 460; //背景最大值取y轴刻度线（最后注释部分）\nlet colorStartList = ['transparent', 'transparent', 'transparent', 'transparent'];\nlet colorLeftList = ['#000', '#000', '#000', '#000'];\nlet colorTopList = ['#1E7EFF', '#FFA75A', '#6ACC29', '#9833FF'];\nlet colorEndList = ['#4084EE', '#FF8D28', '#6ACC29', '#9833FF'];\nchartObj = {\n    series: [\n        { name: '当前资源', data: [269, 460, 400, 170] },\n        { name: '其他资源', data: [39, 50, 40, 100] },\n        { name: '资源', data: [15, 200, 80, 60] },\n        { name: '资源2', data: [15, 200, 80, 60] },\n    ],\n    chartList: ['通信', '网络', '能源', '建筑'],\n};\nfunction colorRgba(str, alpha) {\n    let reg = /^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;\n    var sColor = str.toLowerCase();\n    if (sColor == 'transparent') {\n        return 'transparent';\n    }\n    if (sColor && reg.test(sColor)) {\n        if (sColor.length === 4) {\n            var sColorNew = '#';\n            for (let i = 1; i < 4; i += 1) {\n                sColorNew += sColor.slice(i, i + 1).concat(sColor.slice(i, i + 1));\n            }\n            sColor = sColorNew;\n        }\n        //处理六位的颜色值\n        var sColorChange = [];\n        for (let i = 1; i < 7; i += 2) {\n            sColorChange.push(parseInt('0x' + sColor.slice(i, i + 2)));\n        }\n        return 'rgba(' + sColorChange.join(',') + ',' + alpha + ')';\n    } else {\n        return sColor;\n    }\n}\nif (chartObj.series && chartObj.series.length) {\n    chartObj.series.forEach((ele, i) => {\n        arr = arr.concat(ele.data);\n    });\n    maxList = chartObj.series[0].data.map(() => {\n        return max;\n    });\n    list = chartObj.series[0].data.map((item, index) => {\n        return 1;\n    });\n    chartObj.series.forEach((item, index) => {\n        legend.push({\n            name: item.name,\n            itemStyle: {\n                color: colorEndList[index % colorEndList.length],\n            },\n        });\n        //背景顶部切片\n        series.push({\n            data: maxList,\n            type: 'pictorialBar',\n            barMaxWidth: fontSize * 3,\n            itemStyle: {\n                color: colorEndList[index],\n                opacity: 0.1,\n            },\n            tooltip: {\n                show: false,\n            },\n            symbolPosition: 'end',\n            symbol: 'diamond',\n            symbolOffset: [\n                (-0.5 * (chartObj.series.length - 1) +\n                    index +\n                    -0.5 * barGap * 0.01 * (chartObj.series.length - 1) +\n                    barGap * 0.01 * index) *\n                    barWidth,\n                '-50%',\n            ],\n            symbolSize: [barWidth, barWidth * 0.4],\n            zlevel: -1,\n        });\n        //底部切片\n        series.push({\n            data: list,\n            color: colorStartList[index % colorStartList.length],\n            type: 'pictorialBar',\n            tooltip: {\n                show: false,\n            },\n            barMaxWidth: fontSize * 3,\n            symbol: 'diamond',\n            symbolOffset: [\n                (-0.5 * (chartObj.series.length - 1) +\n                    index +\n                    -0.5 * barGap * 0.01 * (chartObj.series.length - 1) +\n                    barGap * 0.01 * index) *\n                    barWidth,\n                '50%',\n            ],\n            symbolSize: [barWidth, barWidth * 0.5],\n        });\n\n        //实际数据顶部切片\n        series.push({\n            data: item.data,\n            type: 'pictorialBar',\n            tooltip: {\n                show: false,\n            },\n            barMaxWidth: fontSize * 3,\n            color: colorTopList[index],\n            symbolPosition: 'end',\n            symbol: 'diamond',\n            symbolOffset: [\n                (-0.5 * (chartObj.series.length - 1) +\n                    index +\n                    -0.5 * barGap * 0.01 * (chartObj.series.length - 1) +\n                    barGap * 0.01 * index) *\n                    barWidth,\n                '-50%',\n            ],\n            symbolSize: [barWidth, barWidth * 0.4],\n            zlevel: 2,\n        });\n        //实际数据侧边切片\n        series.push({\n            data: item.data,\n            type: 'pictorialBar',\n            tooltip: {\n                show: false,\n            },\n            barMaxWidth: fontSize * 3,\n            color: {\n                x: 0,\n                y: 1,\n                x2: 0,\n                y2: 0,\n                type: 'linear',\n                global: false,\n                colorStops: [\n                    {\n                        offset: 0,\n                        color: 'transparent',\n                    },\n                    {\n                        offset: 0.2,\n                        color: colorRgba(colorLeftList[index % colorLeftList.length], 0.2),\n                    },\n                    {\n                        offset: 1,\n                        color: colorRgba(colorLeftList[index % colorLeftList.length], 0.3),\n                    },\n                ],\n            },\n            symbolPosition: 'end',\n            symbol: 'rect',\n            symbolSize: [barWidth / 2, '100%'],\n            symbolOffset: [\n                (-0.5 * (chartObj.series.length - 1) +\n                    index +\n                    -0.5 * barGap * 0.01 * (chartObj.series.length - 1) +\n                    barGap * 0.01 * index -\n                    0.25) *\n                    barWidth,\n                0,\n            ],\n            zlevel: 1,\n        });\n        //柱子\n        series.push({\n            data: item.data,\n            type: 'bar',\n            name: item.name,\n            barGap: barGap + '%',\n            barWidth: barWidth,\n            barMaxWidth: fontSize * 3,\n            label: {\n                show: false,\n                position: 'top',\n                distance: fontSize * 0.3,\n                textStyle: {\n                    color: colorEndList[index % colorEndList.length],\n                    fontSize: fontSize,\n                },\n                // formatter: function (a, b) {\n                //     return a.value==0?'':a.value;\n                // },\n            },\n            showBackground: true,\n            backgroundStyle: {\n                color: {\n                    x: 0,\n                    y: 1,\n                    x2: 0,\n                    y2: 0,\n                    type: 'linear',\n                    global: false,\n                    colorStops: [\n                        {\n                            offset: 0,\n                            color: colorStartList[index % colorStartList.length],\n                        },\n                        {\n                            offset: 0.2,\n                            color: colorRgba(colorEndList[index % colorEndList.length], 0.2),\n                        },\n                        {\n                            offset: 1,\n                            color: colorRgba(colorEndList[index % colorEndList.length], 1),\n                        },\n                    ],\n                },\n                opacity: 0.1,\n            },\n            itemStyle: {\n                color: {\n                    x: 0,\n                    y: 1,\n                    x2: 0,\n                    y2: 0,\n                    type: 'linear',\n                    global: false,\n                    colorStops: [\n                        {\n                            offset: 0,\n                            color: colorStartList[index % colorStartList.length],\n                        },\n                        {\n                            offset: 0.2,\n                            color: colorRgba(colorEndList[index % colorEndList.length], 0.2),\n                        },\n                        {\n                            offset: 1,\n                            color: colorRgba(colorEndList[index % colorEndList.length], 1),\n                        },\n                    ],\n                },\n            },\n        });\n    });\n}\noption = {\n    // backgroundColor: \"#061326\",\n    title: {\n        text: '',\n        top: 20,\n        left: 'center',\n        textStyle: {\n            color: '#fff',\n            fontSize: 20,\n        },\n    },\n    tooltip: {\n        show: true,\n        trigger: 'axis',\n        backgroundColor: 'rgba(116,176,222,0.3)',\n        extraCssText: 'box-shadow: 0 0 8px rgba(0, 128, 255, 0.27) inset;',\n        borderWidth: 0,\n        confine: false,\n        appendToBody: true,\n        formatter: (params) => {\n            ////console.log(params,'---paramsshopping')\n            let result = \"<div style='margin-bottom:5px;'>\" + params[0].name + '</div>';\n            params.forEach((item, index) => {\n                var dotHtml = `<span style=\"display:inline-block;margin-right:5px;border-radius:50%;width:${fontSize}px;height:${fontSize}px;background:${colorEndList[index]}\"></span>`;\n                result +=\n                    \"<div style='display:flex;align-items:center;margin-bottom:5px'>\" +\n                    dotHtml +\n                    item.seriesName +\n                    (item.seriesName ? \"<span style='display:inline-block;margin-right:6px;'></span>\" : '') +\n                    item.data +\n                    '</div>';\n            });\n            return result;\n        },\n        //轴触发提示才有效\n        axisPointer: {\n            type: 'shadow',\n            shadowStyle: {\n                color: 'rgba(35,49,77,0.01)',\n            },\n        },\n        textStyle: {\n            color: '#fff',\n            fontSize: fontSize,\n        },\n    },\n    grid: {\n        top: fontSize * 3.5,\n        left: 5,\n        right: 5,\n        bottom: fontSize,\n        containLabel: true, //包括文本，居中\n    },\n    legend: {\n        show: true,\n        data: legend,\n        selectedMode: false, //图例是否可以点击\n        type: 'scroll',\n        icon: 'circle',\n        itemWidth: fontSize,\n        itemHeight: fontSize,\n        textStyle: {\n            color: '#C3E3F9',\n            fontSize: fontSize,\n        },\n    },\n    xAxis: {\n        data: chartObj.chartList,\n        type: 'category',\n        axisLine: {\n            show: true,\n            lineStyle: {\n                color: '#2B72A1',\n            },\n        },\n        axisLabel: {\n            fontSize: fontSize,\n            color: '#87CCFF',\n        },\n        splitLine: {\n            show: false,\n        },\n        axisTick: {\n            show: false,\n        },\n        interval: 0,\n    },\n    yAxis: [\n        {\n            type: 'value',\n            name: '单位',\n            nameGap: fontSize * 1.5,\n            nameTextStyle: {\n                align: 'center',\n                fontSize: fontSize,\n                color: '#2869A9',\n            },\n            splitNumber: 4,\n            splitLine: {\n                show: true,\n                lineStyle: {\n                    color: 'rgba(255,255,255,0.1)',\n                },\n            },\n            axisLine: {\n                show: false,\n            },\n            axisLabel: {\n                margin: 10,\n                fontSize: fontSize,\n                color: '#2869A9',\n            },\n            axisTick: {\n                show: true,\n                lineStyle: {\n                    color: '#2869A9',\n                },\n            },\n        },\n    ],\n    series: series,\n};\n","html":"","externalScripts":"","updaterUID":"obd-oDlaDs0J42nfV34ZIq3ZyQK0OiRx31H","theme":"","layout":"","viewCount":0,"userName":"林***Y","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xCtWirtD4p.png?v=1638843491762","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","series-pictorialBar","title","tooltip"],"customTags":[],"updaterUserName":"林***Y"}}