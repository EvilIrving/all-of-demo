{"status":0,"data":{"cid":"xBmN5ip2Je","authorUid":"obd-oNSDjtIOBruOxuJQNDd3EaUMy0PAwCN","authorUserName":"o***宁","title":"我的折线图","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2020-12-25T01:33:57.000Z","lastUpdateTime":"2020-12-25T01:33:57.000Z","auth":1,"uid":"obd-oNSDjtIOBruOxuJQNDd3EaUMy0PAwCN","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-12-25T01:33:57.000Z","code":" let data = {\r\n     xData: [\r\n         '2020-08-17',\r\n         '2020-08-18',\r\n         '2020-08-19',\r\n         '2020-08-20',\r\n         '2020-08-21',\r\n         '2020-08-22',\r\n         '2020-08-23',\r\n         '2020-08-24',\r\n         '2020-08-25',\r\n         '2020-08-26'\r\n     ]\r\n     // yData: [0.1, 0.15, 0.18, 0.25, 0.23, 0.32, 0.33, 0.36, 0.57, 0.72, 0.45]\r\n }\r\n\r\n let xData = [\r\n     '2020-08-17',\r\n     '2020-08-18',\r\n     '2020-08-19',\r\n     '2020-08-20',\r\n     '2020-08-21',\r\n     '2020-08-22',\r\n     '2020-08-23',\r\n     '2020-08-24',\r\n     '2020-08-25',\r\n     '2020-08-26'\r\n ]\r\n\r\n let totDay = xData.length\r\n let generateData = []\r\n let spreadData = []\r\n let disappearData = []\r\n let dieData = []\r\n let secondData = []\r\n\r\n let trueData = []\r\n let predictData = []\r\n\r\n let generateDataIdx = [0, 1]\r\n let spreadDataIdx = [0, 1, 2, 3]\r\n let disappearDataIdx = [0, 0, 0, 1, 2, 3]\r\n let dieDataIdx = [0, 0, 0, 0, 0, 1, 2, 3]\r\n let secondDataIdx = [0, 0, 0, 0, 0, 0, 0, 1, 2, 3]\r\n\r\n let predictSet = new Set()\r\n predictSet.add('2020-08-22')\r\n predictSet.add('2020-08-23')\r\n predictSet.add('2020-08-24')\r\n predictSet.add('2020-08-25')\r\n predictSet.add('2020-08-26')\r\n\r\n let colorMap = {\r\n     发生阶段: '#D24136',\r\n     扩散阶段: '#EB8A3E',\r\n     消弥阶段: '#EBB582',\r\n     消亡阶段: '#785A46',\r\n     二次扩散阶段: '#217CA3'\r\n }\r\n\r\n function hex2rgb(a) {\r\n     if (a == '') {\r\n         return ''\r\n     }\r\n     a = a.substring(1)\r\n     a = a.toLowerCase()\r\n     let b = new Array()\r\n     for (let x = 0; x < 3; x++) {\r\n         b[0] = a.substr(x * 2, 2)\r\n         b[3] = '0123456789abcdef'\r\n         b[1] = b[0].substr(0, 1)\r\n         b[2] = b[0].substr(1, 1)\r\n         b[20 + x] = b[3].indexOf(b[1]) * 16 + b[3].indexOf(b[2])\r\n     }\r\n     return 'rgba(' + b[20] + ',' + b[21] + ',' + b[22]\r\n }\r\n\r\n for (let i = 0; i < totDay; i++) {\r\n     generateData.push('-')\r\n     spreadData.push('-')\r\n     disappearData.push('-')\r\n     dieData.push('-')\r\n     secondData.push('-')\r\n     predictData.push('-')\r\n     trueData.push('-')\r\n }\r\n\r\n generateData[0] = 0\r\n for (let i = 0; i < totDay; i++) {\r\n     if (generateDataIdx[i]) {\r\n         generateData[i] = Math.random() * 200\r\n     }\r\n\r\n     if (spreadDataIdx[i] > 1) {\r\n         spreadData[i] = Math.random() * 200\r\n     } else if (spreadDataIdx[i] === 1) {\r\n         spreadData[i] = generateData[i]\r\n     }\r\n\r\n     if (disappearDataIdx[i] > 1) {\r\n         disappearData[i] = Math.random() * 200\r\n     } else if (disappearDataIdx[i] === 1) {\r\n         disappearData[i] = spreadData[i]\r\n     }\r\n\r\n     if (dieDataIdx[i] > 1) {\r\n         dieData[i] = Math.random() * 200\r\n     } else if (dieDataIdx[i] === 1) {\r\n         dieData[i] = disappearData[i]\r\n     }\r\n\r\n     if (secondDataIdx[i] > 1) {\r\n         secondData[i] = Math.random() * 200\r\n     } else if (secondDataIdx[i] === 1) {\r\n         secondData[i] = dieData[i]\r\n     }\r\n }\r\n\r\n console.log(dieData)\r\n\r\n let series = [{\r\n         data: [{\r\n             name: '发生阶段',\r\n             value: 1\r\n         }],\r\n         label: {\r\n             show: true,\r\n             position: 'inside',\r\n             formatter: '{b}',\r\n             offset: [0, 10],\r\n             textStyle: {\r\n                 color: '#D24136'\r\n             }\r\n         },\r\n         type: 'bar',\r\n         barGap: 0,\r\n         barWidth: '11.1%',\r\n         itemStyle: {\r\n             normal: {\r\n                 color: '#fff'\r\n             }\r\n         },\r\n         xAxisIndex: 1,\r\n         yAxisIndex: 1\r\n     },\r\n     {\r\n         data: [{\r\n             name: '扩散阶段',\r\n             value: 1\r\n         }],\r\n         label: {\r\n             show: true,\r\n             position: 'inside',\r\n             formatter: '{b}',\r\n             offset: [0, 10],\r\n             textStyle: {\r\n                 color: '#EB8A3E'\r\n             }\r\n         },\r\n         type: 'bar',\r\n         barGap: 0,\r\n         barWidth: '22.2%',\r\n         itemStyle: {\r\n             normal: {\r\n                 color: '#fff'\r\n             }\r\n         },\r\n         xAxisIndex: 1,\r\n         yAxisIndex: 1\r\n     },\r\n     {\r\n         data: [{\r\n             name: '消弥阶段',\r\n             value: 1\r\n         }],\r\n         label: {\r\n             show: true,\r\n             position: 'inside',\r\n             formatter: '{b}',\r\n             offset: [0, 10],\r\n             textStyle: {\r\n                 color: '#EBB582'\r\n             }\r\n         },\r\n         type: 'bar',\r\n         barGap: 0,\r\n         barWidth: '22.2%',\r\n         itemStyle: {\r\n             normal: {\r\n                 color: '#fff'\r\n             }\r\n         },\r\n         xAxisIndex: 1,\r\n         yAxisIndex: 1\r\n     },\r\n     {\r\n         data: [{\r\n             name: '消亡阶段',\r\n             value: 1\r\n         }],\r\n         label: {\r\n             show: true,\r\n             position: 'inside',\r\n             formatter: '{b}',\r\n             offset: [0, 10],\r\n             textStyle: {\r\n                 color: '#785A46'\r\n             }\r\n         },\r\n         type: 'bar',\r\n         barGap: 0,\r\n         barWidth: '22.2%',\r\n         itemStyle: {\r\n             normal: {\r\n                 color: '#fff'\r\n             }\r\n         },\r\n         xAxisIndex: 1,\r\n         yAxisIndex: 1\r\n     },\r\n     {\r\n         data: [{\r\n             name: '二次扩散阶段',\r\n             value: 1\r\n         }],\r\n         label: {\r\n             show: true,\r\n             position: 'inside',\r\n             formatter: '{b}',\r\n             offset: [0, 10],\r\n             textStyle: {\r\n                 color: '#217CA3'\r\n             }\r\n         },\r\n         type: 'bar',\r\n         barCategoryGap: 0,\r\n         barGap: 0,\r\n         barWidth: '22.2%',\r\n         itemStyle: {\r\n             normal: {\r\n                 color: '#fff'\r\n             }\r\n         },\r\n         xAxisIndex: 1,\r\n         yAxisIndex: 1\r\n     }\r\n ]\r\n series.push({\r\n     name: '发生阶段',\r\n     data: generateData,\r\n     type: 'line',\r\n     xAxisIndex: 0,\r\n     yAxisIndex: 0,\r\n     itemStyle: {\r\n         normal: {\r\n             color: '#D24136',\r\n             lineStyle: {\r\n                 width: 2\r\n             },\r\n             areaStyle: {\r\n                 color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\r\n                         offset: 0,\r\n                         color: hex2rgb('#D24136') + ',0.2)'\r\n                     },\r\n                     {\r\n                         offset: 1,\r\n                         color: hex2rgb('#D24136') + ',0.1)'\r\n                     }\r\n                 ])\r\n             }\r\n         }\r\n     },\r\n     predict: false\r\n })\r\n\r\n series.push({\r\n     name: '扩散阶段',\r\n     data: spreadData,\r\n     type: 'line',\r\n     xAxisIndex: 0,\r\n     yAxisIndex: 0,\r\n     itemStyle: {\r\n         normal: {\r\n             color: '#EB8A3E',\r\n             lineStyle: {\r\n                 width: 2\r\n             },\r\n             areaStyle: {\r\n                 color: new echarts.graphic.LinearGradient(0, 1, 0, 0, [{\r\n                         offset: 0,\r\n                         color: hex2rgb('#EB8A3E') + ',0.2)'\r\n                     },\r\n                     {\r\n                         offset: 1,\r\n                         color: hex2rgb('#EB8A3E') + ',0.1)'\r\n                     }\r\n                 ])\r\n             }\r\n         }\r\n     },\r\n     predict: false\r\n })\r\n\r\n series.push({\r\n     name: '消弥阶段',\r\n     data: disappearData,\r\n     type: 'line',\r\n     xAxisIndex: 0,\r\n     yAxisIndex: 0,\r\n     itemStyle: {\r\n         normal: {\r\n             color: '#EBB582',\r\n             lineStyle: {\r\n                 width: 2\r\n             },\r\n             areaStyle: {\r\n                 color: new echarts.graphic.LinearGradient(0, 1, 0, 0, [{\r\n                         offset: 0,\r\n                         color: hex2rgb('#EBB582') + ',0.2)'\r\n                     },\r\n                     {\r\n                         offset: 1,\r\n                         color: hex2rgb('#EBB582') + ',0.1)'\r\n                     }\r\n                 ])\r\n             }\r\n         }\r\n     },\r\n     markPoint: {\r\n         label: {\r\n             normal: {\r\n                 show: true,\r\n                 align: 'center',\r\n                 color: 'WHITE'\r\n             }\r\n         },\r\n         itemStyle: {\r\n             normal: {\r\n                 color: 'red'\r\n             }\r\n         },\r\n         data: [{\r\n             coord: [4, disappearData[4]]\r\n         }]\r\n     },\r\n     predict: false\r\n })\r\n\r\n series.push({\r\n     name: '消弥阶段',\r\n     data: disappearData,\r\n     type: 'line',\r\n     xAxisIndex: 0,\r\n     yAxisIndex: 0,\r\n     itemStyle: {\r\n         normal: {\r\n             color: '#EBB582',\r\n             lineStyle: {\r\n                 width: 2\r\n             },\r\n             areaStyle: {\r\n                 color: new echarts.graphic.LinearGradient(0, 1, 0, 0, [{\r\n                         offset: 0,\r\n                         color: hex2rgb('#EBB582') + ',0.2)'\r\n                     },\r\n                     {\r\n                         offset: 1,\r\n                         color: hex2rgb('#EBB582') + ',0.1)'\r\n                     }\r\n                 ])\r\n             }\r\n         }\r\n     },\r\n     markPoint: {\r\n         label: {\r\n             normal: {\r\n                 show: true,\r\n                 align: 'center',\r\n                 color: 'WHITE'\r\n             }\r\n         },\r\n         itemStyle: {\r\n             normal: {\r\n                 color: 'red'\r\n             }\r\n         },\r\n         data: [{\r\n             coord: [4, disappearData[4]]\r\n         }]\r\n     },\r\n     predict: false\r\n })\r\n\r\n let disappearData1 = []\r\n for (let i = 0; i < disappearData.length; i++) {\r\n     disappearData1.push('-')\r\n }\r\n disappearData1[4] = disappearData[4]\r\n disappearData1[5] = dieData[5]\r\n disappearData[5] = '-'\r\n\r\n series.push({\r\n     name: '消弥阶段',\r\n     data: disappearData1,\r\n     type: 'line',\r\n     xAxisIndex: 0,\r\n     yAxisIndex: 0,\r\n     itemStyle: {\r\n         normal: {\r\n             color: '#EBB582',\r\n             lineStyle: {\r\n                 width: 2,\r\n                 type: 'dashed' //'dotted'虚线 'solid'实线\r\n             }\r\n         }\r\n     },\r\n     predict: true\r\n })\r\n\r\n series.push({\r\n     name: '消亡阶段',\r\n     data: dieData,\r\n     type: 'line',\r\n     xAxisIndex: 0,\r\n     yAxisIndex: 0,\r\n     itemStyle: {\r\n         normal: {\r\n             color: '#785A46',\r\n             lineStyle: {\r\n                 width: 2,\r\n                 type: 'dashed' //'dotted'虚线 'solid'实线\r\n             }\r\n         }\r\n     },\r\n     markPoint: {\r\n         symbolOffset: [0, '-20%'],\r\n         itemStyle: {\r\n             normal: {\r\n                 color: 'red',\r\n                 label: {\r\n                     color: 'red',\r\n                     position: 'bottom',\r\n                     formatter: function(params) {\r\n                         //格式化展现（标签+值）\r\n                         return '二次扩散起点'\r\n                     }\r\n                 }\r\n             }\r\n         },\r\n         data: [{\r\n             name: '二次扩散起点',\r\n             coord: [7, dieData[7]]\r\n         }]\r\n     },\r\n     predict: true\r\n })\r\n\r\n series.push({\r\n     name: '二次扩散阶段',\r\n     data: secondData,\r\n     type: 'line',\r\n     xAxisIndex: 0,\r\n     yAxisIndex: 0,\r\n     itemStyle: {\r\n         normal: {\r\n             color: '#217CA3',\r\n             lineStyle: {\r\n                 width: 2,\r\n                 type: 'dashed' //'dotted'虚线 'solid'实线\r\n             }\r\n         }\r\n     },\r\n     predict: true\r\n })\r\n\r\n series.push({\r\n     name: '预测',\r\n     data: predictData,\r\n     type: 'line',\r\n     xAxisIndex: 0,\r\n     yAxisIndex: 0,\r\n     itemStyle: {\r\n         normal: {\r\n             color: '#217CA3',\r\n             lineStyle: {\r\n                 width: 2,\r\n                 type: 'dashed' //'dotted'虚线 'solid'实线\r\n             }\r\n         }\r\n     },\r\n     predict: true\r\n })\r\n\r\n series.push({\r\n     name: '实际',\r\n     data: trueData,\r\n     type: 'line',\r\n     xAxisIndex: 0,\r\n     yAxisIndex: 0,\r\n     itemStyle: {\r\n         normal: {\r\n             color: '#217CA3',\r\n             lineStyle: {\r\n                 width: 2,\r\n                 type: 'dashed' //'dotted'虚线 'solid'实线\r\n             }\r\n         }\r\n     },\r\n     predict: true\r\n })\r\n\r\n /**\r\n    双X轴标签对应，伪实现思路：\r\n    底部的标签也是柱状图，对应包含的区域为上方X轴条数占总数的比例，设为宽度即可\r\n*/\r\n option = {\r\n     backgroundColor: '#fff',\r\n     tooltip: {\r\n         trigger: 'axis',\r\n         // axisPointer: {\r\n         //     type: 'shadow'\r\n         // },\r\n         extraCssText: 'padding:5px;display:flex;font-size:12px;line-height:24px;color:black;background:#fff;box-shadow:0 0 3px rgba(0, 0, 0, 0.2)',\r\n         formatter: function(params) {\r\n             let date = ''\r\n             let state = ''\r\n             let value = 0\r\n             for (let i = 0; i < params.length; i++) {\r\n                 let obj = params[i]\r\n                 // console.log(obj.seriesName, \"obj\")\r\n                 if (obj.value !== '-') {\r\n                     value = obj.value\r\n                     date = obj.axisValue\r\n                     state = obj.seriesName\r\n                     break\r\n                 }\r\n             }\r\n             let type = '实际'\r\n             if (predictSet.has(date)) {\r\n                 type = '预测'\r\n             }\r\n             let lineType = type === '实际' ? 'solid' : 'dashed'\r\n\r\n             let html = ''\r\n             html += `<div><span style=\"display:inline-block; margin-bottom:5px; width:20px; height:10px; border-bottom: 1px ${lineType} ${\r\n              colorMap[state]\r\n            }\"></span><span style=\"margin-left:10px\">${type}:</span><span style=\"margin-left:10px;font-weight:500; font-size:18px\">${value.toFixed(\r\n              0\r\n            )}</span><span style=\"padding:5px; margin-left:10px; background:${hex2rgb(\r\n              colorMap[state]\r\n            )}, 0.3);border-radius:4px; color:${colorMap[state]}\">${state}</span> </div>`\r\n             return html\r\n         }\r\n     },\r\n     legend: {\r\n         show: true,\r\n         top: 10,\r\n         itemWidth: 15,\r\n         itemHeight: 15,\r\n         data: [{\r\n                 name: '预测',\r\n                 icon: 'line'\r\n             },\r\n             {\r\n                 name: '实际',\r\n                 icon: 'line',\r\n                 color: 'black'\r\n             },\r\n             {\r\n                 name: '发生阶段',\r\n                 icon: 'rect'\r\n             },\r\n             {\r\n                 name: '扩散阶段',\r\n                 icon: 'rect'\r\n             },\r\n             {\r\n                 name: '消弥阶段',\r\n                 icon: 'rect'\r\n             },\r\n             {\r\n                 name: '消亡阶段',\r\n                 icon: 'rect'\r\n             },\r\n             {\r\n                 name: '二次扩散阶段',\r\n                 icon: 'rect'\r\n             }\r\n         ]\r\n     },\r\n     grid: [{\r\n             top: 50,\r\n             bottom: 60,\r\n             left: 40,\r\n             right: 40\r\n         },\r\n         {\r\n             left: 40,\r\n             right: 40,\r\n             height: 40,\r\n             bottom: 20\r\n         }\r\n     ],\r\n     xAxis: [{\r\n             type: 'category',\r\n             data: data.xData,\r\n             boundaryGap: false,\r\n             gridIndex: 0,\r\n             axisLabel: {\r\n                 color: '#333'\r\n             },\r\n             axisLine: {\r\n                 lineStyle: {\r\n                     color: '#e7e7e7'\r\n                 }\r\n             },\r\n             axisTick: {\r\n                 lineStyle: {\r\n                     color: '#e7e7e7'\r\n                 }\r\n             },\r\n             zlevel: 2\r\n         },\r\n         {\r\n             type: 'category',\r\n             gridIndex: 1,\r\n             axisLine: {\r\n                 show: false\r\n             },\r\n             zlevel: 1\r\n         }\r\n     ],\r\n     yAxis: [{\r\n             type: 'value',\r\n             gridIndex: 0,\r\n             axisLabel: {\r\n                 color: '#333'\r\n             },\r\n             splitLine: {\r\n                 lineStyle: {\r\n                     type: 'dashed'\r\n                 }\r\n             },\r\n             axisLine: {\r\n                 lineStyle: {\r\n                     color: '#ccc'\r\n                 }\r\n             },\r\n             axisTick: {\r\n                 lineStyle: {\r\n                     color: '#ccc'\r\n                 }\r\n             }\r\n         },\r\n         {\r\n             type: 'value',\r\n             gridIndex: 1,\r\n             axisLabel: {\r\n                 show: false\r\n             },\r\n             axisLine: {\r\n                 show: false\r\n             },\r\n             splitLine: {\r\n                 show: false\r\n             },\r\n             axisTick: {\r\n                 show: false\r\n             }\r\n         }\r\n     ],\r\n     series: series\r\n }","html":"","externalScripts":"","updaterUID":"obd-oNSDjtIOBruOxuJQNDd3EaUMy0PAwCN","theme":"","layout":"","viewCount":177,"userName":"o***宁","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xBmN5ip2Je.png?v=1608860037310","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","markPoint","series-bar","series-line","tooltip"],"customTags":[],"updaterUserName":"o***宁"}}