{"status":0,"data":{"cid":"xb2svJFGNN","authorUid":"bd-587655903","authorUserName":"D***n","title":"Try Dragging these Points","description":"测试","latestVersion":8,"alwaysLatest":1,"createTime":"2019-09-17T11:20:36.000Z","lastUpdateTime":"2019-09-17T11:20:36.000Z","auth":2,"uid":"bd-587655903","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":8,"parentVersion":4,"echartsVersion":"4.3.0","versionCreateTime":"2019-09-19T07:14:05.000Z","code":"var symbolSize = 100;\r\nvar data = [\r\n    [0.5, 2]\r\n];\r\n\r\noption = {\r\n    title: {\r\n        text: 'Try Dragging these Points'\r\n    },\r\n    tooltip: {\r\n        triggerOn: 'none',\r\n        formatter: function(params) {\r\n            return '上下拖动调节亮度';\r\n        }\r\n    },\r\n    grid: {},\r\n    xAxis: {\r\n        min: 0,\r\n        max: 1,\r\n        type: 'value',\r\n        axisLine: {\r\n            onZero: false\r\n        }\r\n    },\r\n    yAxis: {\r\n        min: 0,\r\n        max: 3,\r\n        type: 'value',\r\n        axisLine: {\r\n            onZero: false\r\n        }\r\n    },\r\n\r\n    series: [{\r\n        id: 'a',\r\n        type: 'bar',\r\n        smooth: true,\r\n        hoverAnimation: false,\r\n        symbolSize: symbolSize,\r\n        data: data,\r\n        itemStyle: {\r\n            color: {\r\n                type: 'linear',\r\n                x: 0,\r\n                y: 0,\r\n                x2: 0,\r\n                y2: 1,\r\n                colorStops: [{\r\n                    offset: 0,\r\n                    color: '#0dc2fe' // 0% 处的颜色\r\n                }, {\r\n                    offset: 1,\r\n                    color: 'blue' // 100% 处的颜色\r\n                }],\r\n                global: false // 缺省为 false\r\n            },\r\n            barBorderRadius: 20\r\n        }\r\n    }, {\r\n        type: 'pie',\r\n        data: [1],\r\n        radius: '5%',\r\n        center: ['50%', '86%'],\r\n        hoverAnimation: false,\r\n        color: [\"#46d3f3\", \"rgba(203,203,203,.2)\"],\r\n        labelLine: {\r\n            normal: {\r\n                show: false\r\n            }\r\n        },\r\n\r\n    }, {\r\n        id: \"lightLine\",\r\n        type: 'gauge',\r\n        splitNumber: 10, //刻度数量\r\n        min: 0,\r\n        max: 1,\r\n        radius: '8%', //图表尺寸\r\n        center: ['50%', '86%'],\r\n        startAngle: 90,\r\n        endAngle: -269.9999,\r\n        axisLine: {\r\n            show: false,\r\n            lineStyle: {\r\n                width: 0,\r\n                shadowBlur: 0,\r\n                color: [\r\n                    [1, '#0dc2fe']\r\n                ]\r\n            }\r\n        },\r\n        axisTick: {\r\n            show: false,\r\n            lineStyle: {\r\n                color: 'auto',\r\n                width: 1\r\n            },\r\n            length: 20,\r\n            splitNumber: 5\r\n        },\r\n        splitLine: {\r\n            show: true,\r\n            length: -20,\r\n            lineStyle: {\r\n                color: 'auto',\r\n            }\r\n        },\r\n        axisLabel: {\r\n            show: false\r\n        },\r\n        pointer: { //仪表盘指针\r\n            show: 0,\r\n        },\r\n        detail: {\r\n            show: 0,\r\n        },\r\n        z: 2000\r\n    }, ]\r\n};\r\n\r\n\r\nif (!app.inNode) {\r\n    setTimeout(function() {\r\n        // Add shadow circles (which is not visible) to enable drag.\r\n        myChart.setOption({\r\n            graphic: echarts.util.map(data, function(item, dataIndex) {\r\n                //console.log(item)\r\n                return {\r\n                    type: 'rect',\r\n                    position: myChart.convertToPixel('grid', item),\r\n                    left: 'center',\r\n                    bounding: 'all',\r\n                    shape: {\r\n                        //x: 0.5,\r\n                        //y: 0.5,\r\n                        r: 20,\r\n                        width: 500,\r\n                        height: 100\r\n                    },\r\n                    style: {\r\n                        fill: '#000',\r\n                        lineWidth: 4\r\n                    },\r\n                    invisible: false,\r\n                    draggable: true,\r\n                    ondrag: echarts.util.curry(onPointDragging, dataIndex),\r\n                    onmouseover: echarts.util.curry(showTooltip, dataIndex),\r\n                    onmouseout: echarts.util.curry(hideTooltip, dataIndex),\r\n                    ondragend: echarts.util.curry(dragend, dataIndex),\r\n                    z: 1000\r\n                };\r\n            })\r\n        });\r\n    }, 0);\r\n\r\n    window.addEventListener('resize', updatePosition);\r\n}\r\n\r\nmyChart.on('dataZoom', updatePosition);\r\n\r\nfunction updatePosition() {\r\n    console.log('updatePosition');\r\n    myChart.setOption({\r\n        graphic: echarts.util.map(data, function(item, dataIndex) {\r\n            //console.log(myChart.convertToPixel('grid', item))\r\n            return {\r\n                position: myChart.convertToPixel('grid', item)\r\n            };\r\n        })\r\n    });\r\n}\r\n\r\nfunction dragend(dataIndex) {\r\n    var height = -100;\r\n    //if()\r\n    myChart.setOption({\r\n        graphic: echarts.util.map(data, function(item, dataIndex) {\r\n            console.log(item);\r\n            if (item[1] !== 0) {\r\n                height = 100;\r\n            }\r\n            if (item[1] < 0) {\r\n                item[1] = 0.5;\r\n            }\r\n            return {\r\n                type: 'rect',\r\n                position: myChart.convertToPixel('grid', item),\r\n                left: 'center',\r\n                shape: {\r\n                    x: 0.5,\r\n                    y: 0.5,\r\n                    r: 20,\r\n                    width: 500,\r\n                    height: height\r\n                },\r\n                style: {\r\n                    fill: '#000',\r\n                    lineWidth: 4\r\n                },\r\n                invisible: true,\r\n                draggable: true,\r\n                ondrag: echarts.util.curry(onPointDragging, item[1]),\r\n                onmouseover: echarts.util.curry(showTooltip, dataIndex),\r\n                onmouseout: echarts.util.curry(hideTooltip, dataIndex),\r\n                ondragend: echarts.util.curry(dragend, item[1]),\r\n                z: 1000\r\n            };\r\n        })\r\n    });\r\n}\r\n\r\nfunction showTooltip(dataIndex) {\r\n    myChart.dispatchAction({\r\n        type: 'showTip',\r\n        seriesIndex: 0,\r\n        dataIndex: dataIndex\r\n    });\r\n}\r\n\r\nfunction hideTooltip(dataIndex) {\r\n    //console.log('hidden');\r\n    myChart.dispatchAction({\r\n        type: 'hideTip'\r\n    });\r\n}\r\n\r\nfunction onPointDragging(dataIndex, dx, dy) {\r\n    //console.log(dataIndex);\r\n    if (dataIndex == 0.5) {\r\n        dataIndex = 0;\r\n    }\r\n    var xy = myChart.convertFromPixel('grid', this.position);\r\n    //console.log(xy[1], dataIndex);\r\n    xy[0] = 0.5;\r\n    if (xy[1] < dataIndex) {\r\n        xy[1] = dataIndex - Math.ceil(Math.abs(xy[1] - dataIndex));\r\n    } else {\r\n        xy[1] = dataIndex + Math.ceil(Math.abs(xy[1] - dataIndex));\r\n    }\r\n    if (xy[1] > 3) {\r\n        xy[1] = 3;\r\n    }\r\n    if (xy[1] <= 0) {\r\n        xy[1] = 0.5;\r\n    }\r\n    //dx.offsetY=0;\r\n    //console.log(xy);\r\n    data[0] = xy;\r\n    // Update data\r\n    var length = -5;\r\n    if (xy[1] != 0.5) {\r\n        length = (xy[1] + 1) * (-5);\r\n    }\r\n    myChart.setOption({\r\n        series: [{\r\n            id: 'a',\r\n            data: data\r\n        }, {\r\n            id: 'lightLine',\r\n            splitLine: {\r\n                show: true,\r\n                length: length,\r\n                lineStyle: {\r\n                    color: 'auto',\r\n                }\r\n            },\r\n        }]\r\n    });\r\n    //console.log(data)\r\n}","html":"","externalScripts":"","updaterUID":"bd-587655903","theme":"","layout":"","viewCount":164,"userName":"D***n","commentCount":1,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xb2svJFGNN.png?v=1568877245435","isCustomThumbnail":0,"builtinTags":["category-work","graphic","grid","series-bar","series-gauge","series-pie","title","tooltip"],"customTags":[],"updaterUserName":"D***n"}}