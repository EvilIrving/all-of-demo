{"status":0,"data":{"cid":"x_x8e6xxnO","authorUid":"obd-olnf8nC5qKxMZKBlltBwT3HPMXg_m0F","authorUserName":"h***a","title":"带间隙的动态饼图","description":"","latestVersion":2,"alwaysLatest":0,"createTime":"2021-08-25T04:02:50.000Z","lastUpdateTime":"2021-08-25T06:10:14.000Z","auth":2,"uid":"obd-olnf8nC5qKxMZKBlltBwT3HPMXg_m0F","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"5.1.2","versionCreateTime":"2021-08-25T06:10:14.000Z","code":"var data = [100, 200, 300, 400, 500];\nvar sum = 0;\nvar avgValue = 0;\nvar seriesData = [];\nvar index = 0;\nvar curIndex = 0;\nvar timer = null;\ndata.forEach(function (item) {\n  sum += item;\n});\navgValue = sum / 100; //间隙数据\ndata.forEach(function (item, index) {\n  //实际展示数据\n  seriesData.push({\n    name: '测试数据' + (index + 1),\n    value: item,\n    unit: '人',\n  });\n  seriesData.push(\n    //虚拟数据做间隙使用\n    // 实际当前数据是渲染成饼图的一部分，设置了颜色透明，视觉效果是间隙\n    {\n      name: '',\n      value: avgValue, //间隔数据取总数的百分之一\n      itemStyle: {\n        normal: {\n          label: {\n            show: false,\n          },\n          labelLine: {\n            show: false,\n          },\n          color: 'rgba(0, 0, 0, 0)',\n          borderColor: 'rgba(0, 0, 0, 0)',\n          borderWidth: 0,\n        },\n      },\n    }\n  );\n});\nvar colorList = ['#5CEDFF', '#259AF0', '#23C376', '#EE8C2C', '#CD2323'];\nvar option = {\n  grid: {\n    width: '100%',\n    height: '100%',\n    left: 0,\n    top: 0,\n    show: true,\n    backgroundColor: '#000',\n  },\n  legend: [\n    {\n      show: false,\n    },\n  ],\n  title: [\n    {\n      text: seriesData[0].value + seriesData[0].unit,\n      top: '35%',\n      textAlign: 'center',\n      left: '49%',\n      textStyle: {\n        color: '#FFD32D',\n        fontSize: 50,\n        fontFamily: 'SourceHanSansCN',\n      },\n    },\n    {\n      text: seriesData[0].name,\n      top: '55%',\n      textAlign: 'center',\n      left: '49%',\n      textStyle: {\n        color: 'rgba(242, 252, 253, 0.84)',\n        fontSize: 50,\n        fontFamily: 'SourceHanSansCN',\n      },\n    },\n  ],\n  series: [\n    {\n      type: 'pie',\n      z: 3,\n      center: ['50%', '50%'],\n      radius: ['80%', '88%'],\n      clockwise: true,\n      avoidLabelOverlap: true,\n      emphasis: {\n        scale: true,\n        scaleSize: 10,\n      },\n      itemStyle: {\n        normal: {\n          color: function (params) {\n            return colorList[params.dataIndex / 2];\n          },\n        },\n      },\n      labelLine: {\n        show: false,\n      },\n      label: {\n        show: false,\n      },\n      data: seriesData,\n    },\n    {\n      name: '内环',\n      type: 'pie',\n      z: 2,\n      tooltip: {\n        show: false,\n      },\n      center: ['50%', '50%'],\n      radius: ['70%', '75%'],\n      hoverAnimation: false,\n      clockWise: false,\n      itemStyle: {\n        normal: {\n          color: 'rgba(36,68,118,.5)',\n        },\n        emphasis: {\n          color: 'rgba(36,68,118,.5)',\n        },\n      },\n      label: {\n        show: false,\n      },\n      data: [100],\n    },\n  ],\n};\nmyChart.setOption(option);\n\n//设置默认选中高亮部分\nmyChart.dispatchAction({\n  type: 'highlight',\n  seriesIndex: 0,\n  dataIndex: curIndex * 2, //存在间隙 index*2\n});\n//设置高亮\nfunction setEmphasis(index) {\n  if (curIndex != index) {\n    myChart.dispatchAction({\n      type: 'downplay',\n      seriesIndex: 0,\n      dataIndex: curIndex,\n    });\n  }\n  myChart.dispatchAction({\n    type: 'highlight',\n    seriesIndex: 0,\n    dataIndex: index,\n  });\n\n  //修改option参数\n  curIndex = index;\n  option.title[0].text = seriesData[index].value + seriesData[index].unit;\n  option.title[1].text = seriesData[index].name;\n  myChart.setOption(option);\n}\n//自动轮播\nfunction startAnima() {\n  timer = setInterval(function () {\n    if (index >= seriesData.length - 2) {\n      index = 0;\n    } else {\n      index += 2;\n    }\n    setEmphasis(index);\n  }, 2000);\n}\n//取消轮播\nfunction clearAnima() {\n  clearInterval(timer);\n}\n//开始轮播\nstartAnima();\n\n//鼠标移入事件\nmyChart.on('mouseover', function (e) {\n    clearAnima();\n    setEmphasis(e.dataIndex);\n});\nmyChart.on('mouseout', function (e) {\n    startAnima();\n});\n\nwindow.addEventListener('resize', () => {\n  myChart.resize();\n});\n// }\n","html":"","externalScripts":"","updaterUID":"obd-olnf8nC5qKxMZKBlltBwT3HPMXg_m0F","theme":"","layout":"","viewCount":0,"userName":"h***a","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x_x8e6xxnO.png?v=1629871814359","isCustomThumbnail":0,"builtinTags":["category-work","legend","series-pie","title"],"customTags":[],"updaterUserName":"h***a"}}