{"status":0,"data":{"cid":"xkd5X_aQZt","authorUid":"obd-oFdGm4yhYIMTOhGipshh5kh9vCmpR5j","authorUserName":"丫***7","title":"资源汇聚图","description":"","latestVersion":4,"alwaysLatest":1,"createTime":"2020-11-03T06:35:48.000Z","lastUpdateTime":"2020-11-03T06:35:48.000Z","auth":2,"uid":"obd-oFdGm4yhYIMTOhGipshh5kh9vCmpR5j","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":4,"parentVersion":3,"echartsVersion":"4.8.0","versionCreateTime":"2020-11-03T08:32:18.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1604284283597-1ECMDl8MN.json\";\r\n\r\n$.get(uploadedDataURL).done(data => {\r\n    var option = {\r\n        type: \"tree\",\r\n        backgroundColor: \"#002770\",\r\n        toolbox: {\r\n            show: true,\r\n            iconStyle: {\r\n                borderColor: \"#03ceda\"\r\n            },\r\n            feature: {\r\n                restore: {}\r\n            }\r\n        },\r\n        tooltip: {\r\n            trigger: \"item\",\r\n            triggerOn: \"mousemove\",\r\n            backgroundColor: \"rgba(1,70,86,1)\",\r\n            borderColor: \"rgba(0,246,255,1)\",\r\n            borderWidth: 0.5,\r\n            textStyle: {\r\n                fontSize: 10\r\n            },\r\n            formatter: '{b}'\r\n        },\r\n        series: [{\r\n            type: \"tree\",\r\n            hoverAnimation: true,\r\n            data: getdata(JSON.parse(data)),\r\n            top: 0,\r\n            bottom: 0,\r\n            left: 0,\r\n            right: 0,\r\n            layout: \"radial\",\r\n            symbol: \"circle\",\r\n            symbolSize: 10,\r\n            nodePadding: 20,\r\n            animationDurationUpdate: 750,\r\n            expandAndCollapse: true,\r\n            initialTreeDepth: 1,\r\n            roam: true,\r\n            focusNodeAdjacency: true,\r\n            itemStyle: {\r\n                borderWidth: 1,\r\n            },\r\n            label: {\r\n                color: \"#fff\",\r\n                fontSize: 10,\r\n                fontFamily: \"SourceHanSansCN\",\r\n                // position: \"top\",\r\n                // rotate: 0,\r\n            },\r\n            lineStyle: {\r\n                width: 1,\r\n                curveness: 0.5,\r\n            }\r\n        }]\r\n    };\r\n    myChart.setOption(option);\r\n});\r\n\r\nvar colors = [\r\n    \"#00ADD0\",\r\n    \"#FFA12F\",\r\n    \"#B62AFF\",\r\n    \"#604BFF\",\r\n    \"#6E35FF\",\r\n    \"#002AFF\",\r\n    \"#20C0F4\",\r\n    \"#95F300\",\r\n    \"#04FDB8\",\r\n    \"#AF5AFF\"\r\n]\r\n\r\nconst map = new Map();\r\nmap.set('盟住房管理中心', '公积金');\r\nmap.set('盟文体旅游广电旅游局', '文旅');\r\nmap.set('盟林业和草原局', '林草');\r\n\r\nconst getdata = (arr) => {\r\n    let data = {\r\n        name: \"锡大数据中心\",\r\n        value: 0,\r\n        children: []\r\n    };\r\n    const res = arr.reduce((prev, cur, i) => {\r\n        const index = prev.findIndex(_v => _v.name === cur.org);\r\n        if (index > -1) {\r\n            const obj = {\r\n                name: cur.res,\r\n                value: i,\r\n                children: []\r\n            }\r\n            prev[index].children.push(obj);\r\n        } else {\r\n            const obj = {\r\n                name: cur.org,\r\n                value: i,\r\n                children: [{\r\n                    name: cur.res,\r\n                    value: i,\r\n                    children: []\r\n                }]\r\n            }\r\n            prev.push(obj);\r\n        }\r\n        return prev;\r\n    }, []).map(_v => {\r\n        if (map.has(_v.name)) {\r\n            return {\r\n                ..._v,\r\n                name: map.has(_v.name) ? map.get(_v.name) : _v.name\r\n            }\r\n        } else {\r\n            return _v;\r\n        }\r\n    });\r\n\r\n    data.children.push(...res)\r\n    let a = []\r\n    a.push(data)\r\n    a = handle(a, 0)\r\n    return a;\r\n}\r\n\r\nconst handle = (data, index, color = '#00f6ff') => {\r\n    //index标识第几层\r\n    return data.map((item, index2) => {\r\n        //计算出颜色\r\n        if (index == 1) {\r\n            color = colors.find((item, eq) => eq == index2 % 10);\r\n        }\r\n        // 设置节点大小\r\n        if (index === 0 || index === 1) {\r\n            item.label = {\r\n                position: \"inside\"\r\n            }\r\n        }\r\n        // 设置label大小\r\n        switch (index) {\r\n            case 0:\r\n                item.symbolSize = 100\r\n                break;\r\n            case 1:\r\n                item.symbolSize = 50\r\n                break;\r\n            default:\r\n                item.symbolSize = 10\r\n                break;\r\n        }\r\n        // 设置线条颜色\r\n        item.lineStyle = {\r\n            color: color\r\n        }\r\n\r\n        if (item.children) {\r\n            //存在子节点\r\n            item.itemStyle = {\r\n                borderColor: color,\r\n                color: color\r\n            };\r\n            item.children = handle(item.children, index + 1, color)\r\n        } else {\r\n            //不存在\r\n            item.itemStyle = {\r\n                color: 'transparent',\r\n                borderColor: color\r\n            };\r\n        }\r\n        return item\r\n    })\r\n}","html":"","externalScripts":"","updaterUID":"obd-oFdGm4yhYIMTOhGipshh5kh9vCmpR5j","theme":"","layout":"","viewCount":978,"userName":"丫***7","commentCount":1,"starCount":4,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xkd5X_aQZt.png?v=1604392338465","isCustomThumbnail":0,"builtinTags":["category-work","series-tree","toolbox","tooltip"],"customTags":[],"updaterUserName":"丫***7"}}