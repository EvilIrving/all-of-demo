{"status":0,"data":{"cid":"xI6T-rqNcs","authorUid":"bd-540836030","authorUserName":"霸***y","title":"矩形树图","description":"只显示一级的矩形树图","latestVersion":13,"alwaysLatest":1,"createTime":"2021-09-17T08:10:49.000Z","lastUpdateTime":"2021-09-18T07:37:20.000Z","auth":2,"uid":"bd-540836030","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":13,"parentVersion":12,"echartsVersion":"5.2.0","versionCreateTime":"2021-09-18T07:37:20.000Z","code":"// convert #hex notation to rgb array\nvar parseColor = function (hexStr) {\n    return hexStr.length === 4 ? hexStr.substr(1).split('')\n              .map(function (s) {\n                  return 0x11 * parseInt(s, 16);\n              })\n        : [hexStr.substr(1, 2), hexStr.substr(3, 2), hexStr.substr(5, 2)].map(function (s) {\n              return parseInt(s, 16);\n          });\n};\n// zero-pad 1 digit to 2\nvar pad = function (s) {\n    return s.length === 1 ? '0' + s : s;\n};\n// console.log(gradientColors('#00ff00', '#ff0000', 100));\n// console.log(gradientColors('#000', '#fff', 100, 2.2));\n// 两个颜色之间的渐变色值\nvar gradientColors = function (start, end, steps, gamma) {\n    var i,j,ms,me,output = [],so = [];\n    gamma = gamma || 1;\n    var normalize = function (channel) {\n        return Math.pow(channel / 255, gamma);\n    };\n    start = parseColor(start).map(normalize);\n    end = parseColor(end).map(normalize);\n    for (i = 0; i < steps; i++) {\n        ms = i / (steps - 1);\n        me = 1 - ms;\n        for (j = 0; j < 3; j++) {\n            so[j] = pad(Math.round(Math.pow(start[j] * me + end[j] * ms, 1 / gamma) * 255).toString(16));\n        }\n        output.push('#' + so.join(''));\n    }\n    return output;\n};\n\nfunction getData(param){\n    let {\n        len = 100\n    } = param;\n    let arr = [];\n    let ColorArr = gradientColors('#0BE6FF', '#0E58F8', len);\n    let signIndex = 10+Math.ceil(Math.random()*20);\n    console.log(\"52 signIndex\",signIndex);\n    for (let i = 0; i < len; i++) {\n        let itemStyle = {\n            // colorAlpha:[0.3, 0.5],// 渐变色,结合option的color一起使用\n            // colorSaturation:  0.03+0.04*i,// 渐变色,结合option的color一起使用\n            color: ColorArr[i],\n            borderWidth: 0.5,\n            borderColor: '#121E35',\n        };\n        i == signIndex && (itemStyle.color = '#FFF400'); // 设置特殊颜色\n        arr.push({\n            name: 'name' + i,\n            value: [10, i],\n            itemStyle,\n            data: [\n                { name: 'test1', num: '1.71', status: 'top', baseNum: 1.6 },\n                { name: 'test2', num: '1.71', status: 'top', baseNum: 1.6 },\n                { name: 'test3', num: '1.71', status: 'top', baseNum: 1.6 },\n                { name: 'test4', num: '1.71', status: 'top', baseNum: 1.6 },\n            ],\n        });\n    }\n    return arr.reverse();\n}\n\nfunction initChart(){\n    let arr = getData({\n        //len:120+Math.ceil(Math.random()*200),\n        len:200\n    })\n    var option = {\n        backgroundColor: '#121E35',\n        leafDepth: false, // 是否可以下钻\n        tooltip: {\n            backgroundColor: '#222',\n            padding: 5,\n            borderColor: '#222',\n            borderRadius: 8,\n            appendToBody: true, // position锁死了状态,且父元素不能overflow:hidden\n            // position: (point) => [point[0] + 5, point[1] + 5],\n            textStyle: {\n                align: 'left',\n            },\n            formatter: function (e) {\n                if (!e.data.name) return '';\n                let html = '';\n                e.data.data.forEach((item) => {\n                    html += `<div>${item.name}--${item.num}--${item.status}--${item.baseNum}</div>`;\n                });\n                return `\n                        <div style=\"min-height:32px;line-height:32px;font-size: 16px;color:#fff;text-indent:9px;border-bottom: 1px solid #B3BFD2;\">${e.data.name}</div>\n                        ${html}\n                      `;\n            },\n        },\n        series: [\n            {\n                type: 'treemap',\n                height: '10%', // 整体高度\n                top: 0,\n                bottom: 0,\n                left: 0,\n                right: 0,\n                roam: false, // 关闭平移和缩放\n                nodeClick: false,\n                breadcrumb: false, //不显示当前节点\n                label: false,\n                itemStyle: {\n                    show: true,\n                    borderWidth: 1,\n                    borderColor: '#202C4C',\n                },\n                emphasis: {\n                    itemStyle: {\n                        color: '#FFF400',\n                    },\n                },\n                data: arr,\n            },\n        ],\n    };\n    myChart.setOption(option,{\n        notMerge:true,\n        lazyUpdate:false\n    })\n}\ninitChart();\n\nsetInterval(function() {\n    initChart();\n}, 2000);\n\n// myChart.on(\"click\",e => {\n//   console.log(e);\n//   signIndex = e.data.value[1];\n// })\n/*\n还有一种方案是：\noption.color = ['yellowgreen'] // 固定一种颜色\nlet itemStyle = {\n    //colorAlpha:[0.3, 0.5],// 渐变色,结合option的color一起使用\n    colorSaturation:  0.03+0.04*i,// 渐变色,结合option的color一起使用\n    borderWidth: 0.5,\n    borderColor: '#121E35',\n}\n*/\n","html":"","externalScripts":"","updaterUID":"bd-540836030","theme":"","layout":"","viewCount":0,"userName":"霸***y","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xI6T-rqNcs.png?v=1631950640752","isCustomThumbnail":0,"builtinTags":["category-work","series-treemap","tooltip"],"customTags":["一级","渐变","矩形树图"],"updaterUserName":"霸***y"}}