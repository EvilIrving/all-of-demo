{"status":0,"data":{"cid":"xrJnFt8iHz","authorUid":"bd-3054735502","authorUserName":"traehvearb","title":"贵州市地产分布","description":"贵州市173处楼盘地产分布可视化","latestVersion":3,"alwaysLatest":1,"createTime":"2018-01-28T14:09:08.000Z","lastUpdateTime":"2018-01-28T14:09:08.000Z","auth":1,"uid":"bd-3054735502","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":3,"parentVersion":2,"echartsVersion":"3.8.0","versionCreateTime":"2018-01-28T14:13:12.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1517146749952-BkIYzUoHf.js\";\r\n//地图个性化配置\r\nvar mapConfig = [{\r\n        'featureType': 'water',\r\n        'elementType': 'all',\r\n        'stylers': {\r\n            'color': '#d1d1d1'\r\n        }\r\n    },\r\n    {\r\n        'featureType': 'land',\r\n        'elementType': 'all',\r\n        'stylers': {\r\n            'color': '#f3f3f3'\r\n        }\r\n    },\r\n    {\r\n        'featureType': 'railway',\r\n        'elementType': 'all',\r\n        'stylers': {\r\n            'visibility': 'off'\r\n        }\r\n    },\r\n    {\r\n        'featureType': 'highway',\r\n        'elementType': 'all',\r\n        'stylers': {\r\n            'color': '#fdfdfd'\r\n        }\r\n    },\r\n    {\r\n        'featureType': 'highway',\r\n        'elementType': 'labels',\r\n        'stylers': {\r\n            'visibility': 'off'\r\n        }\r\n    },\r\n    {\r\n        'featureType': 'arterial',\r\n        'elementType': 'geometry',\r\n        'stylers': {\r\n            'color': '#fefefe'\r\n        }\r\n    },\r\n    {\r\n        'featureType': 'arterial',\r\n        'elementType': 'geometry.fill',\r\n        'stylers': {\r\n            'color': '#fefefe'\r\n        }\r\n    },\r\n    {\r\n        'featureType': 'poi',\r\n        'elementType': 'all',\r\n        'stylers': {\r\n            'visibility': 'off'\r\n        }\r\n    },\r\n    {\r\n        'featureType': 'green',\r\n        'elementType': 'all',\r\n        'stylers': {\r\n            'visibility': 'off'\r\n        }\r\n    },\r\n    {\r\n        'featureType': 'subway',\r\n        'elementType': 'all',\r\n        'stylers': {\r\n            'visibility': 'off'\r\n        }\r\n    },\r\n    {\r\n        'featureType': 'manmade',\r\n        'elementType': 'all',\r\n        'stylers': {\r\n            'color': '#d1d1d1'\r\n        }\r\n    },\r\n    {\r\n        'featureType': 'local',\r\n        'elementType': 'all',\r\n        'stylers': {\r\n            'color': '#d1d1d1'\r\n        }\r\n    },\r\n    {\r\n        'featureType': 'arterial',\r\n        'elementType': 'labels',\r\n        'stylers': {\r\n            'visibility': 'off'\r\n        }\r\n    },\r\n    {\r\n        'featureType': 'boundary',\r\n        'elementType': 'all',\r\n        'stylers': {\r\n            'color': '#fefefe'\r\n        }\r\n    },\r\n    {\r\n        'featureType': 'building',\r\n        'elementType': 'all',\r\n        'stylers': {\r\n            'color': '#d1d1d1'\r\n        }\r\n    },\r\n    {\r\n        'featureType': 'label',\r\n        'elementType': 'labels.text.fill',\r\n        'stylers': {\r\n            'color': '#000000'\r\n        }\r\n    }\r\n]\r\n//初始化地图背景及散点图数据以外的配置\r\noption = {\r\n    title: {\r\n        text: 'G市楼盘概览 - 百度地图',\r\n        subtext: '大小按评分高低分布',\r\n        left: 'center'\r\n    },\r\n    bmap: {\r\n        center: [106.69, 26.60],\r\n        zoom: 12,\r\n        roam: true,\r\n        mapStyle: {\r\n            styleJson: mapConfig\r\n        }\r\n    },\r\n    series: [{\r\n            name: 'premisesAll',\r\n            type: 'scatter',\r\n            coordinateSystem: 'bmap',\r\n            zlevel: 2,\r\n            data: [],\r\n            label: {\r\n                normal: {\r\n                    formatter: '{b}',\r\n                    position: 'right',\r\n                    show: false\r\n                },\r\n                emphasis: {\r\n                    show: false\r\n                }\r\n            },\r\n            itemStyle: {\r\n                normal: {\r\n                    color: 'purple'\r\n                }\r\n            }\r\n        },\r\n\r\n    ]\r\n};\r\nmyChart.setOption(option);\r\nmyChart.showLoading();\r\nvar premisesAll = [],\r\n    paramData = [];\r\n//ajax获取数据,填充散点\r\n$.ajax({\r\n    url: uploadedDataURL,\r\n    type: \"GET\",\r\n    dataType: \"json\",\r\n    sync: false,\r\n    success: function(data) {\r\n        //若premisesAll不为空，则可以跳过\r\n        if (premisesAll.length === 0) {\r\n            for (let i = 0; i < data.length; i++) {\r\n                premisesAll.push({\r\n                    lat: Number(data[i].lat),\r\n                    lon: Number(data[i].lon),\r\n                    averagePrice: data[i].均价,\r\n                    volumeRate: data[i].容积率,\r\n                    greeningRate: Number(data[i].绿化率),\r\n                    grade: Number(data[i].评分),\r\n                    commentNumber: Number(data[i].评论数),\r\n                    areaCovered: data[i].小区占地面积,\r\n                    builtupArea: data[i].小区建筑面积,\r\n                    propertyFee: data[i].物业费,\r\n                    address: data[i].楼盘地址,\r\n                    name: data[i].名称,\r\n                    feature: data[i].项目特色\r\n                });\r\n                paramData.push({\r\n                    name: premisesAll[i].name,\r\n                    value: [\r\n                        premisesAll[i].lon,\r\n                        premisesAll[i].lat,\r\n                        premisesAll[i].grade,\r\n                        premisesAll[i].address,\r\n                        premisesAll[i].feature,\r\n                        premisesAll[i].averagePrice\r\n                    ],\r\n                });\r\n            }\r\n        }\r\n        myChart.hideLoading(); //关闭loading动画\r\n        //配置tooltip提示框。填充散点图\r\n        myChart.setOption({\r\n            tooltip: {\r\n                trigger: 'item',\r\n                formatter: function(res) {\r\n                    return \"<div style='border-bottom: 1px solid rgba(255,255,255,0.3);\" +\r\n                        \"font-size: 18px; padding-bottom: 7px; margin-bottom: 7px'>\" +\r\n                        res.name + \"</div>\" +\r\n                        res.value[3] + '</br>' +\r\n                        \"特色: \" + res.value[4] + \"</br>\" +\r\n                        \"均价: \" + res.value[5] + \"元/平米</br>\" +\r\n                        \"评分: \" + res.value[2]\r\n                },\r\n            },\r\n            series: [{\r\n                    name: 'premisesAll',\r\n                    data: paramData,\r\n                    symbolSize: function(val) {\r\n                        return (val[2] - 2.9) * 20;\r\n                    },\r\n                },\r\n\r\n            ]\r\n        });\r\n    },\r\n    error: function(XMLHttpRequest, textStatus, errorThrown) {\r\n        alert(XMLHttpRequest.status);\r\n        alert(XMLHttpRequest.readyState);\r\n        alert(textStatus);\r\n    }\r\n});","html":"","externalScripts":"/dep/echarts/latest/extension/bmap.min.js,http://api.map.baidu.com/api?v=2.0&ak=uiFvDcf8kGFFjTj2itxyygxbyPaQbr0E","updaterUID":"bd-3054735502","theme":"","layout":"","viewCount":456,"userName":"traehvearb","commentCount":0,"starCount":4,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xrJnFt8iHz.png?v=1517148548623","isCustomThumbnail":1,"builtinTags":["category-work"],"customTags":["API","bmap","scatter"],"updaterUserName":"traehvearb"}}