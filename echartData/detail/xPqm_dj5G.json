{"status":0,"data":{"cid":"xPqm_dj5G","authorUid":"bd-2589517385","authorUserName":"徐***盟","title":"矩阵图","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2019-11-15T04:10:03.000Z","lastUpdateTime":"2019-11-15T04:10:03.000Z","auth":2,"uid":"bd-2589517385","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.4.0","versionCreateTime":"2019-11-15T04:10:03.000Z","code":"  var  result=[{ydmc:\"0001\",zgy:\"X01\",sl:\"12\",sj:\"201901\"},\r\n                 {ydmc:\"0002\",zgy:\"X01\",sl:\"13\",sj:\"201901\"},\r\n                 {ydmc:\"0003\",zgy:\"X01\",sl:\"14\",sj:\"201901\"},\r\n                 {ydmc:\"0004\",zgy:\"X01\",sl:\"15\",sj:\"201901\"},\r\n                 {ydmc:\"0005\",zgy:\"X01\",sl:\"16\",sj:\"201901\"},\r\n                 \r\n                 {ydmc:\"0001\",zgy:\"X02\",sl:\"41\",sj:\"201901\"},\r\n                 {ydmc:\"0002\",zgy:\"X02\",sl:\"42\",sj:\"201901\"},\r\n                 {ydmc:\"0003\",zgy:\"X02\",sl:\"43\",sj:\"201901\"},\r\n                 {ydmc:\"0004\",zgy:\"X02\",sl:\"44\",sj:\"201901\"},\r\n                 {ydmc:\"0005\",zgy:\"X02\",sl:\"45\",sj:\"201901\"},\r\n                 \r\n                 {ydmc:\"0001\",zgy:\"X03\",sl:\"81\",sj:\"201901\"},\r\n                 {ydmc:\"0002\",zgy:\"X03\",sl:\"82\",sj:\"201901\"},\r\n                 {ydmc:\"0003\",zgy:\"X03\",sl:\"83\",sj:\"201901\"},\r\n                 {ydmc:\"0004\",zgy:\"X03\",sl:\"84\",sj:\"201901\"},\r\n                 {ydmc:\"0005\",zgy:\"X03\",sl:\"200\",sj:\"201901\"},\r\n    \r\n\r\n                 {ydmc:\"0001\",zgy:\"X01\",sl:\"101\",sj:\"201902\"},\r\n                 {ydmc:\"0002\",zgy:\"X01\",sl:\"101\",sj:\"201902\"},\r\n                 {ydmc:\"0003\",zgy:\"X01\",sl:\"101\",sj:\"201902\"},\r\n                 {ydmc:\"0004\",zgy:\"X01\",sl:\"101\",sj:\"201902\"},\r\n                 {ydmc:\"0005\",zgy:\"X01\",sl:\"101\",sj:\"201902\"},\r\n                 \r\n                 {ydmc:\"0001\",zgy:\"X02\",sl:\"102\",sj:\"201902\"},\r\n                 {ydmc:\"0002\",zgy:\"X02\",sl:\"102\",sj:\"201902\"},\r\n                 {ydmc:\"0003\",zgy:\"X02\",sl:\"102\",sj:\"201902\"},\r\n                 {ydmc:\"0004\",zgy:\"X02\",sl:\"102\",sj:\"201902\"},\r\n                 {ydmc:\"0005\",zgy:\"X02\",sl:\"102\",sj:\"201902\"},\r\n                 \r\n                 {ydmc:\"0001\",zgy:\"X03\",sl:\"103\",sj:\"201902\"},\r\n                 {ydmc:\"0002\",zgy:\"X03\",sl:\"103\",sj:\"201902\"},\r\n                 {ydmc:\"0003\",zgy:\"X03\",sl:\"103\",sj:\"201902\"},\r\n                 {ydmc:\"0004\",zgy:\"X03\",sl:\"103\",sj:\"201902\"},\r\n                 {ydmc:\"0005\",zgy:\"X03\",sl:\"190\",sj:\"201902\"}\r\n];\r\nvar zgyarr =[];\r\nvar ydmcarr=[];\r\nvar sjarr  =[];\r\nfor (var i in result) {\r\n  zgyarr.push(result[i].zgy);\r\n  ydmcarr.push(result[i].ydmc);\r\n  sjarr.push(result[i].sj);\r\n}\r\nzgyarr =norepeat(zgyarr);\r\nydmcarr=norepeat(ydmcarr);\r\nsjarr  =norepeat(sjarr);\r\nconsole.log(zgyarr )\r\nconsole.log(ydmcarr)\r\nconsole.log(sjarr  )\r\n\r\nvar maxsl=0;\r\nvar yfjson={};\r\nfor (var s in sjarr) {\r\n    var datajson=[];\r\n    for (var q in zgyarr) {\r\n        for (var w in ydmcarr) {\r\n            for (var e in result) {\r\n                maxsl=(parseInt(result[e].sl)>maxsl?result[e].sl:maxsl)\r\n                 if(result[e].sj==sjarr[s]  && result[e].zgy==zgyarr[q] && result[e].ydmc==ydmcarr[w]){\r\n                   \r\n                    datajson.push([parseInt(q),parseInt(w),parseInt( result[e].sl).toFixed(0)])\r\n                    // datajson.push([q,w,result[e].sl,result[e].ydmc,result[e].zgy,result[e].sj])\r\n                 }\r\n            }\r\n        }\r\n    }\r\n    console.log(datajson)\r\n    yfjson[sjarr[s]]=datajson;\r\n}\r\nconsole.log(yfjson)\r\nconsole.log(\"【最大数】：\"+maxsl)\r\nvar xdata=zgyarr;\r\nvar ydata=ydmcarr;\r\nvar basedata=sjarr;\r\n\r\nvar baseseries=[];\r\nvar optionsdata=[];\r\n\r\nfor (var k in yfjson) {\r\n    baseseries.push({\r\n            // name:k,\r\n\t        type: 'heatmap',\r\n\t        label: {\r\n\t            normal: {\r\n\t                show: true\r\n\t            }\r\n\t        },\r\n\t        itemStyle: {\r\n\t            emphasis: {\r\n\t                shadowBlur: 10,\r\n\t                shadowColor: 'rgba(120, 0, 0, 0.5)'\r\n\t            }\r\n\t        }\r\n        });\r\n    optionsdata.push({\r\n         xAxis: {\r\n\t        type: 'category',\r\n\t        data: xdata,\r\n\t    },\r\n         yAxis: {\r\n\t        type: 'category',\r\n\t        data: ydata,\r\n\t    },\r\n\t     title: {\r\n                text: k\r\n            },\r\n          series: [{\r\n                    data:yfjson[k]\r\n                }\r\n            ]\r\n    });\r\n\r\n}\r\n\r\n////时间轴自定义\r\n// {\r\n//  value: 'T3',\r\n//  tooltip: {\r\n//      formatter: '{b} 自定义提示'\r\n//  },\r\n//  symbol: 'diamond',\r\n//  symbolSize: 16\r\n// }\r\n\r\n\r\noption={\r\n      baseOption: {\r\n        timeline: { \r\n            axisType: 'category', \r\n            autoPlay: true, \r\n            playInterval: 3000, \r\n            data:basedata\r\n        },\r\n        // title: { subtext: '数据来自木可统计局' },\r\n        tooltip: {}, legend: { },\r\n        calculable: true,\r\n         tooltip: {\r\n        position: 'top',\r\n        formatter: function(params) {\r\n            // console.log(params)\r\n            if(params.componentType==\"timeline\"){\r\n                return params.name;\r\n            }else if(params.componentType==\"series\"){\r\n                return params.marker+'<br/>' +'学历：' + ydata[params.value[1]] + '<br/>' + '人数：' + params.data[2]+'<br/>' + '地址：' + params.name;\r\n            }else{\r\n                return \"\";\r\n            }\r\n\t           \r\n\t        }\r\n    },\r\n    animation: false,\r\n    grid: {\r\n\t        left: '3%',\r\n\t        right: '8%',\r\n\t        bottom: '8%',\r\n\t        containLabel: true\r\n\t    },\r\n    xAxis: {\r\n            name: 'X轴',\r\n\t        type: 'category',\r\n\t        data: xdata,\r\n\t\t\taxisLine : {\r\n\t\t\t\t\t\tlineStyle : {\r\n\t\t\t\t\t\t\tcolor : '#000'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\taxisLabel: {  \r\n\t\t\t\t   interval:0,  \r\n\t\t\t\t   rotate:40\r\n\t\t\t\t   \r\n\t\t\t\t} ,\r\n\t        splitArea: {\r\n\t            show: true\r\n\t        },\r\n\t      \r\n\t    },\r\n    yAxis: {\r\n\t        type: 'category',\r\n\t        data: ydata,\r\n\t\t\taxisLine : {\r\n\t\t\t\t\t\tlineStyle : {\r\n\t\t\t\t\t\t\tcolor : '#000'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\taxisLabel: {  \r\n\t\t\t\t   interval:0,  \r\n\t\t\t\t   rotate:40\r\n\t\t\t\t   \r\n\t\t\t\t} ,\r\n\t        splitArea: {\r\n\t            show: true\r\n\t        },\r\n\t        name: 'Y轴'\r\n\t    },\r\n    visualMap: {\r\n\t        min: 1,\r\n\t        max: maxsl,\r\n\t        calculable: true,\r\n\t       // orient: 'horizontal',\r\n\t        left: 'left',\r\n\t        bottom: '1%',\r\n\t\t\ttext: [maxsl,'1'],// 文本，默认为数值文本\r\n\t        //color:['#20a0ff','#D2EDFF'],\r\n\t        calculable: false,\r\n\t\t\tcolor: [\r\n\t        '#22DDDD', '#fec42c', '#80F1BE'\r\n\t    ]\r\n\t    },\r\n        series: baseseries\r\n    }, \r\n    options:optionsdata\r\n}\r\n\r\n\r\n //数组去重\r\n  function norepeat(arr) {\r\n            return arr.filter(function (val, index, array) {\r\n                return array.indexOf(val) === index;\r\n            });\r\n        }","html":"","externalScripts":"","updaterUID":"bd-2589517385","theme":"","layout":"","viewCount":421,"userName":"徐***盟","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xPqm_dj5G.png?v=1573791003683","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-heatmap","timeline","title","tooltip","visualMap"],"customTags":[],"updaterUserName":"徐***盟"}}