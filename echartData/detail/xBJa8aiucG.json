{"status":0,"data":{"cid":"xBJa8aiucG","authorUid":"bd-355306739","authorUserName":"吃货天下第一","title":"滚动legends（基础版测试）","description":"多个legends条件下如何美化显示和简化操作","latestVersion":4,"alwaysLatest":1,"createTime":"2018-03-28T05:51:16.000Z","lastUpdateTime":"2018-03-28T05:51:16.000Z","auth":2,"uid":"bd-355306739","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":4,"parentVersion":3,"echartsVersion":"4.0.4","versionCreateTime":"2018-03-28T09:15:40.000Z","code":"const seriesCount = 14;\nconst seriesLegendShowLimit = 4;\nconst switcherText = ['一键切换为清爽套装', '一键切换为完全体'];\n\nconst getSeries = () => {\n    const series = [];\n    for (let i = 0; i < seriesCount; i++) {\n        const data = Array.from(new Array(7), x => Math.round(Math.random() * 100));\n        const sum = data.reduce((a, b) => a + b);\n        const name = `序列${i+1}-${i%2?'sum':'summary'}${sum}`;\n        series.push({\n            name,\n            type: 'line',\n            smooth: true,\n            data,\n            sum,\n        });\n    }\n    series.push({\n        name: switcherText[0],\n        type: 'line',\n    });\n    return series;\n}\n\nconst getLegend = (series, type) => {\n    const selected = {};\n    const isMoreThanSeriesLimit = series.length > seriesLegendShowLimit;\n    const data = series.map((each, i) => {\n        // console.log(each);\n        const name = each.name;\n        selected[name] = type ? true : (i < seriesLegendShowLimit || i === series.length - 1) ? true : false;\n        return {\n            name,\n            // icon,\n            // textStyle,\n        }\n    });\n    return {\n        type: type || (isMoreThanSeriesLimit ? 'scroll' : 'plain'),\n        left: '2%',\n        width: type ? 'auto' : (isMoreThanSeriesLimit ? '70%' : 'auto'),\n        data,\n        selected,\n        scrollDataIndex: 0,\n    };\n}\n\n// ===============================================\n\nconst series = getSeries();\nconst legend = getLegend(series);\n\noption = {\n    legend,\n    xAxis: {\n        data: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n        boundaryGap: false,\n    },\n    yAxis: {},\n    series,\n};\n\nmyChart.on('legendselectchanged', (params) => {\n    const selectedName = params.name;\n    const selectedList = params.selected\n    if (switcherText[0] === selectedName) {\n        console.log('清爽否');\n        const thisSeries = [];\n        series.forEach(each => {\n            if (selectedList[each.name]) {\n                thisSeries.push(each);\n            }\n        });\n        thisSeries.push({\n            name: switcherText[1],\n            type: 'line',\n            data: [], // 消除历史数据\n        });\n        const thisLegend = getLegend(thisSeries, 'plain');\n        console.log(thisLegend, thisSeries);\n        myChart.setOption({\n            legend: thisLegend,\n            series: thisSeries,\n        });\n    } else if (switcherText[1] === selectedName) {\n        console.log('还清爽吗');\n        const legendSelectedList = legend.selected;\n        Object.keys(legendSelectedList).forEach(name => {\n            legendSelectedList[name] = selectedList[name] ? true : false;\n        });\n        legendSelectedList[switcherText[0]] = true;\n        myChart.setOption({\n            legend,\n            series,\n        });\n    }\n});","html":"","externalScripts":"","updaterUID":"bd-355306739","theme":"","layout":"","viewCount":535,"userName":"吃货天下第一","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xBJa8aiucG.png?v=1522228540389","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-line"],"customTags":[],"updaterUserName":"吃货天下第一"}}