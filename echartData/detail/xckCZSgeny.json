{"status":0,"data":{"cid":"xckCZSgeny","authorUid":"bd-7382906384","authorUserName":"满***6","title":"这个环形图做的太不容易了","description":"图例颜色一一对应","latestVersion":1,"alwaysLatest":1,"createTime":"2020-12-07T03:11:54.000Z","lastUpdateTime":"2020-12-07T03:11:54.000Z","auth":2,"uid":"bd-7382906384","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-12-07T03:11:54.000Z","code":"data = [{\r\n        name: \"aaaa\",\r\n        value: 754\r\n    },\r\n    {\r\n        name: \"bbbb\",\r\n        value: 611\r\n    },\r\n    {\r\n        name: \"dddd\",\r\n        value: 400\r\n    },\r\n    {\r\n        name: \"eeee\",\r\n        value: 200\r\n    }, {\r\n        name: \"ccccc\",\r\n        value: 300\r\n    }\r\n];\r\nlet colorArr = ['#ff8700', '#ffc300', '#07e373', '#019dff','#0033ff'];\r\narrName = getArrayValue(data, \"name\");\r\narrValue = getArrayValue(data, \"value\");\r\nsumValue = eval(arrValue.join('+'));\r\nobjData = array2obj(data, \"name\");\r\noptionData = getData(data)\r\n\r\nfunction getArrayValue(array, key) {\r\n    var key = key || \"value\";\r\n    var res = [];\r\n    if (array) {\r\n        array.forEach(function(t) {\r\n            res.push(t[key]);\r\n        });\r\n    }\r\n    return res;\r\n}\r\n\r\nfunction array2obj(array, key) {\r\n    var resObj = {};\r\n    for (var i = 0; i < array.length; i++) {\r\n        resObj[array[i][key]] = array[i];\r\n    }\r\n    return resObj;\r\n}\r\n\r\nfunction getData(data) {\r\n    var res = {\r\n        series: [],\r\n        yAxis: []\r\n    };\r\n    let center=[\"40%\", \"50%\"];\r\n    for (let i = 0; i < data.length; i++) {\r\n        let radius=[70 - i * 15 + '%', 65 - i * 15 + '%'];\r\n        res.series.push({\r\n            name: '',\r\n            type: 'pie',\r\n            clockWise: false, //顺时加载\r\n            hoverAnimation: false, //鼠标移入变大\r\n             radius,\r\n            center,\r\n            label: {\r\n                show: false\r\n            },\r\n            itemStyle: {\r\n                label: {\r\n                    show: false,\r\n                },\r\n                labelLine: {\r\n                    show: false\r\n                },\r\n                borderWidth: 5,\r\n            },\r\n            data: [{\r\n                value: data[i].value,\r\n                name: data[i].name\r\n            }, {\r\n                value: sumValue - data[i].value,\r\n                name: '',\r\n                itemStyle: {\r\n                    color: \"rgba(0,0,0,0)\",\r\n                    borderWidth: 0\r\n                },\r\n                tooltip: {\r\n                    show: false\r\n                },\r\n                hoverAnimation: false\r\n            }]\r\n        });\r\n        res.series.push({\r\n            name: '',\r\n            type: 'pie',\r\n            silent: true,\r\n            z: 1,\r\n            clockWise: false, //顺时加载\r\n            hoverAnimation: false, //鼠标移入变大\r\n            radius,\r\n            center,\r\n            label: {\r\n                show: false\r\n            },\r\n            itemStyle: {\r\n                label: {\r\n                    show: false,\r\n                },\r\n                labelLine: {\r\n                    show: false\r\n                },\r\n                borderWidth: 5,\r\n            },\r\n            data: [{\r\n                value: 7.5,\r\n                itemStyle: {\r\n                    color: \"rgb(3, 31, 62)\",\r\n                    borderWidth: 0\r\n                },\r\n                tooltip: {\r\n                    show: false\r\n                },\r\n                hoverAnimation: false\r\n            }, {\r\n                value: 2.5,\r\n                name: '',\r\n                itemStyle: {\r\n                    color: \"rgba(0,0,0,0)\",\r\n                    borderWidth: 0\r\n                },\r\n                tooltip: {\r\n                    show: false\r\n                },\r\n                hoverAnimation: false\r\n            }]\r\n        });\r\n        res.yAxis.push((data[i].value / sumValue * 100).toFixed(2) + \"%\");\r\n    }\r\n    return res;\r\n}\r\n// 环形图旁边的圆点颜色样式\r\nlet rich = {};\r\ncolorArr.map((item, index) => {\r\n    rich['circle' + index] = {\r\n        color: item,\r\n        fontSize: 25,\r\n        lineHeight:60\r\n    };\r\n})\r\n// 图例的样式\r\nlet legendRich = {\r\n    value: {\r\n        fontSize: 18,\r\n        lineHeight: 30,\r\n        color: \"#fff\",\r\n    },\r\n    per:{\r\n         fontSize: 14,\r\n        lineHeight: 30,\r\n        color: \"#fff\",\r\n        padding:[0,0,0,20]\r\n    }\r\n};\r\ncolorArr.map((item, index) => {\r\n    legendRich['title' + index] = {\r\n        fontSize: 16,\r\n        lineHeight: 15,\r\n        color: item\r\n    };\r\n})\r\noption = {\r\n    backgroundColor: '#000',\r\n    color: colorArr,\r\n    legend: {\r\n        show: true,\r\n        icon: \"circle\",\r\n        top: \"center\",\r\n        right: '10%',\r\n        data: arrName,\r\n        width: 50,\r\n        padding: [0, 5],\r\n        itemGap: 25,\r\n        formatter: function(name) {\r\n            let str = ``;\r\n            console.log(\"objData\", objData)\r\n            data.map((item, index) => {\r\n                if (item.name == name) {\r\n                    let per=(item.value/sumValue)*100;\r\n                    str = `{${'title'+index}|${name}}\\n{value|${(item.value)}}{per|${per.toFixed(2)}%}`\r\n                }\r\n            })\r\n            return str;\r\n        },\r\n        textStyle: {\r\n            rich: legendRich\r\n        },\r\n    },\r\n    tooltip: {\r\n        show: true,\r\n        trigger: \"item\",\r\n        formatter: \"{a}<br>{b}:{c}({d}%)\"\r\n    },\r\n    grid: {\r\n        top: '15%',\r\n        bottom: '50%',\r\n        left: \"40%\",\r\n        containLabel: false\r\n    },\r\n    yAxis: [{\r\n        type: 'category',\r\n        inverse: true,\r\n        axisLine: {\r\n            show: false\r\n        },\r\n        axisTick: {\r\n            show: false\r\n        },\r\n        axisLabel: {\r\n            show: true,\r\n            interval: 0,\r\n            inside: true,\r\n            position:\"right\",\r\n            formatter: function(v, i) {\r\n                return `{${'circle'+i}|●}`\r\n            },\r\n            rich\r\n\r\n        },\r\n        data: optionData.yAxis\r\n    }],\r\n    xAxis: [{\r\n        show: false\r\n    }],\r\n    series: optionData.series\r\n};","html":"","externalScripts":"","updaterUID":"bd-7382906384","theme":"","layout":"","viewCount":283,"userName":"满***6","commentCount":0,"starCount":4,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xckCZSgeny.png?v=1607310714941","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-pie","tooltip"],"customTags":[],"updaterUserName":"满***6"}}