{"status":0,"data":{"cid":"xTMHv1ELFp","authorUid":"obd-oN6D3qfp-72Q3GmepBJ4XZpEj5XIyCI","authorUserName":"b***n","title":"四分之三当做一的饼状图","description":"四个饼状图，把四分之三当做一","latestVersion":1,"alwaysLatest":1,"createTime":"2020-09-09T08:08:38.000Z","lastUpdateTime":"2020-09-09T08:08:38.000Z","auth":2,"uid":"obd-oN6D3qfp-72Q3GmepBJ4XZpEj5XIyCI","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-09-09T08:08:38.000Z","code":"let colorList = [\r\n    \"rgb(96, 255, 0)\",\r\n    \"rgb(255, 229, 0)\",\r\n    \"rgb(255, 159, 3)\",\r\n    \"rgb(216, 30, 7)\"\r\n];\r\nlet data = [{\r\n        name: \"可控\",\r\n        value: 0,\r\n    },\r\n    {\r\n        name: \"轻微\",\r\n        value: 0,\r\n    },\r\n    {\r\n        name: \"严重\",\r\n        value: 0,\r\n    },\r\n    {\r\n        name: \"非常严重\",\r\n        value: 1,\r\n    }\r\n];\r\n// 计算数据为空的不同条件\r\nlet num = 0;\r\ndata.map((item) => {\r\n    if (item.value == 0) {\r\n        num++\r\n    }\r\n})\r\n\r\n// 总数 100 四分之三 75\r\n\r\nlet center = [\"44%\", \"50%\"];\r\nlet arrName = getArrayValue(data, \"name\"); //名称\r\nlet arrValue = getArrayValue(data, \"value\"); //数值\r\nlet sumValue = eval(arrValue.join(\"+\")); //总和\r\nlet objData = array2obj(data, \"name\");\r\nlet optionData = getData(data);\r\n// console.log(\"objData\", objData);\r\n// console.log(\"arrValue\", arrValue);\r\n// console.log(\"arrName\", arrName);\r\n// console.log(\"sumValue\", sumValue);\r\n// console.log(\"optionData\", optionData);\r\n// console.log(\"data\", data);\r\n\r\nfunction getArrayValue(array, key) {\r\n    var key = key || \"value\";\r\n    var res = [];\r\n    if (array) {\r\n        array.forEach(function(t) {\r\n            res.push(t[key]);\r\n        });\r\n    }\r\n    return res;\r\n}\r\n// 拼凑图例数据\r\nfunction array2obj(array, key) {\r\n    let resObj = {};\r\n    for (let i = 0; i < array.length; i++) {\r\n        let obj = {\r\n            name: array[i].name,\r\n            value: array[i].value,\r\n            percent: sumValue == 0 ? 0 : (array[i].value / sumValue * 100).toFixed(1)\r\n        };\r\n\r\n        data[i].percent = sumValue == 0 ? 0 : (array[i].value / sumValue).toFixed(1)\r\n        resObj[array[i][key]] = obj;\r\n    }\r\n    return resObj;\r\n}\r\n\r\nfunction getData(data) {\r\n    var res = {\r\n        series: [],\r\n        yAxis: []\r\n    };\r\n    for (let i = 0; i < data.length; i++) {\r\n        // console.log([70 - i * 15 + '%', 67 - i * 15 + '%']);\r\n        let seriesData = null\r\n        switch (num) {\r\n            case 3: //有三项未0\r\n                if (data[i].value == 0) {\r\n                    seriesData = [{\r\n                            value: 7.5,\r\n                            name: data[i].name,\r\n                            itemStyle: {\r\n                                color: \"rgba(136,220,255,0.1)\",\r\n                                borderWidth: 0\r\n                            },\r\n                            tooltip: {\r\n                                show: false\r\n                            },\r\n                            hoverAnimation: false\r\n                        },\r\n                        {\r\n                            value: 2.5,\r\n                            name: \"\",\r\n                            itemStyle: {\r\n                                color: \"rgba(0,0,0,0)\",\r\n                                borderWidth: 0\r\n                            },\r\n                            tooltip: {\r\n                                show: false\r\n                            },\r\n                            hoverAnimation: false\r\n                        },\r\n                    ]\r\n                } else {\r\n                    seriesData = [{\r\n                            value: 7.5,\r\n                            name: data[i].name\r\n                        },\r\n                        {\r\n                            value: 2.5,\r\n                            name: \"\",\r\n                            itemStyle: {\r\n                                color: \"rgba(0,0,0,0)\",\r\n                                borderWidth: 0\r\n                            },\r\n                            tooltip: {\r\n                                show: false\r\n                            },\r\n                            hoverAnimation: false\r\n                        },\r\n                    ]\r\n                }\r\n                break;\r\n            case 4: //有四项为0\r\n                seriesData = [{\r\n                    value: 7.5,\r\n                    name: data[i].name,\r\n                    itemStyle: {\r\n                        color: \"rgba(136,220,255,0.1)\",\r\n                        borderWidth: 0\r\n                    },\r\n                    tooltip: {\r\n                        show: false\r\n                    },\r\n                    hoverAnimation: false\r\n                }, {\r\n                    value: 2.5,\r\n                    name: '',\r\n                    itemStyle: {\r\n                        color: \"rgba(0,0,0,0)\",\r\n                        borderWidth: 0\r\n                    },\r\n                    tooltip: {\r\n                        show: false\r\n                    },\r\n                    hoverAnimation: false\r\n                }]\r\n                break;\r\n            default:\r\n                if (data[i].value == 0) {\r\n                    seriesData = [{\r\n                            value: 7.5,\r\n                            name: data[i].name,\r\n                            itemStyle: {\r\n                                color: \"rgba(136,220,255,0.1)\",\r\n                                borderWidth: 0\r\n                            },\r\n                            tooltip: {\r\n                                show: false\r\n                            },\r\n                            hoverAnimation: false\r\n                        },\r\n                        {\r\n                            value: 2.5,\r\n                            name: \"\",\r\n                            itemStyle: {\r\n                                color: \"rgba(0,0,0,0)\",\r\n                                borderWidth: 0\r\n                            },\r\n                            tooltip: {\r\n                                show: false\r\n                            },\r\n                            hoverAnimation: false\r\n                        }\r\n                    ]\r\n                } else {\r\n                    seriesData = [{\r\n                            value: parseFloat(data[i].percent) * 75,\r\n                            name: data[i].name\r\n                        },\r\n                        {\r\n                            value: (1 - parseFloat(data[i].percent)) * 75,\r\n                            name: \"\",\r\n                            itemStyle: {\r\n                                color: \"rgba(136,220,255,0.1)\",\r\n                                borderWidth: 0\r\n                            },\r\n                            tooltip: {\r\n                                show: false\r\n                            },\r\n                            hoverAnimation: false\r\n                        },\r\n                        {\r\n                            value: 25,\r\n                            name: \"\",\r\n                            itemStyle: {\r\n                                color: \"rgba(0,0,0,0)\",\r\n                                borderWidth: 0\r\n                            },\r\n                            tooltip: {\r\n                                show: false\r\n                            },\r\n                            hoverAnimation: false\r\n                        },\r\n                    ]\r\n                }\r\n\r\n                break;\r\n        }\r\n        res.series.push({\r\n            name: \"\",\r\n            type: \"pie\",\r\n            clockWise: false, //顺时加载\r\n            hoverAnimation: false, //鼠标移入变大\r\n            radius: [73 - i * 15 + \"%\", 68 - i * 15 + \"%\"],\r\n            center: center,\r\n            label: {\r\n                show: false\r\n            },\r\n            itemStyle: {\r\n                label: {\r\n                    show: false\r\n                },\r\n                labelLine: {\r\n                    show: false\r\n                },\r\n                borderWidth: 5\r\n            },\r\n            data: seriesData\r\n        });\r\n        // 背景\r\n        res.series.push({\r\n            name: \"\",\r\n            type: \"pie\",\r\n            silent: true,\r\n            z: 1,\r\n            clockWise: false, //顺时加载\r\n            hoverAnimation: false, //鼠标移入变大\r\n            radius: [73 - i * 15 + \"%\", 68 - i * 15 + \"%\"],\r\n            center: center,\r\n            label: {\r\n                show: false\r\n            },\r\n            itemStyle: {\r\n                label: {\r\n                    show: false\r\n                },\r\n                labelLine: {\r\n                    show: false\r\n                },\r\n                borderWidth: 5\r\n            },\r\n            data: [{\r\n                    value: 7.5,\r\n                    itemStyle: {\r\n                        color: \"rgb(3, 31, 62)\",\r\n                        borderWidth: 0\r\n                    },\r\n                    tooltip: {\r\n                        show: false\r\n                    },\r\n                    hoverAnimation: false\r\n                },\r\n                {\r\n                    value: 2.5,\r\n                    name: \"\",\r\n                    itemStyle: {\r\n                        color: \"rgba(0,0,0,0)\",\r\n                        borderWidth: 0\r\n                    },\r\n                    tooltip: {\r\n                        show: false\r\n                    },\r\n                    hoverAnimation: false\r\n                }\r\n            ]\r\n        });\r\n        res.yAxis.push(data[i].percent);\r\n    }\r\n    return res;\r\n}\r\n\r\noption = {\r\n    backgroundColor:\"#666\",\r\n    legend: {\r\n        show: true,\r\n        icon: \"circle\",\r\n        top: \"12%\",\r\n        bottom: \"40%\",\r\n        right: \"0%\",\r\n        data: arrName,\r\n        width: 20,\r\n        padding: [0, 16],\r\n        itemGap: 9,\r\n        formatter: name => {\r\n\r\n            let str =\r\n                \"{title|\" +\r\n                name +\r\n                \"}{value|\" +\r\n                \" \" +\r\n                objData[name].value +\r\n                \" \" +\r\n                \"}{value|(\" +\r\n                objData[name].percent +\r\n                \"%)}\";\r\n            return str;\r\n        },\r\n\r\n        textStyle: {\r\n            rich: {\r\n                title: {\r\n                    fontSize: 12,\r\n                    lineHeight: 12,\r\n                    color: \"#babe83\"\r\n                },\r\n                value: {\r\n                    fontSize: 14,\r\n                    lineHeight: 20,\r\n                    color: \"#fff\"\r\n                }\r\n            }\r\n        }\r\n    },\r\n    tooltip: {\r\n        show: true,\r\n        trigger: \"item\",\r\n        formatter: e => {\r\n            console.log(\"e\", e)\r\n            let str = `${e.marker}${e.name}<br>${objData[e.name].value}(${objData[e.name].percent}%)`;\r\n            return str;\r\n        }\r\n    },\r\n    color: colorList,\r\n    xAxis: [{\r\n        show: false\r\n    }],\r\n    series: optionData.series\r\n};","html":"","externalScripts":"","updaterUID":"obd-oN6D3qfp-72Q3GmepBJ4XZpEj5XIyCI","theme":"","layout":"","viewCount":34,"userName":"b***n","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xTMHv1ELFp.png?v=1599638918805","isCustomThumbnail":0,"builtinTags":["category-work","legend","series-pie","tooltip"],"customTags":["pic"],"updaterUserName":"b***n"}}