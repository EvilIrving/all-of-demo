{"status":0,"data":{"cid":"xdDYQAJSZA","authorUid":"bd-2371199294","authorUserName":"156*****368","title":"双Y轴分割线对不齐问题","description":"双Y轴分割线对不齐问题","latestVersion":1,"alwaysLatest":1,"createTime":"2020-09-28T05:55:20.000Z","lastUpdateTime":"2020-09-28T05:55:20.000Z","auth":1,"uid":"bd-2371199294","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-09-28T05:55:20.000Z","code":"// 双Y轴，分割线不一致问题,且每个刻度都是非零散数值\n\nvar series = [{\n        name: '直接访问',\n        type: 'bar',\n        stack: '总量',\n        label: {\n            show: true,\n            position: 'insideRight'\n        },\n        data: [2, 2, 2, 2, 2, 2, 1]\n    },\n    {\n        name: '邮件营销',\n        type: 'bar',\n        stack: '总量',\n        label: {\n            show: true,\n            position: 'insideRight'\n        },\n        data: [120, 132, 101, 134, 90, 230, 210]\n    },\n    {\n        name: '联盟广告',\n        type: 'bar',\n        stack: '总量',\n        label: {\n            show: true,\n            position: 'insideRight'\n        },\n        data: [220, 182, 191, 234, 290, 330, 310]\n    },\n    {\n        name: '视频广告',\n        type: 'bar',\n        stack: '总量',\n        label: {\n            show: true,\n            position: 'insideRight'\n        },\n        data: [150, 212, 201, 154, 190, 330, 410]\n    },\n    {\n        name: '搜索引擎',\n        type: 'bar',\n        stack: '总量',\n        label: {\n            show: true,\n            position: 'insideRight'\n        },\n        data: [820, 832, 901, 934, 1290, 1330, 1320]\n    },\n    {\n        name: '转化率',\n        type: 'line',\n        data: [90, 60, 80, 30, 15, 68, 77],\n        yAxisIndex: 1\n    }\n]\n\nfunction getSeriesItemMax(array) {\n    console.log(array)\n    var res = [];\n    array.forEach((item) => {\n        item.forEach((i, idx) => {\n            if (!res[idx]) {\n                if (isNaN(i / 1)) {\n                    res[idx] = 0\n                } else {\n                    res[idx] = i / 1\n                }\n            } else {\n                if (isNaN(i / 1)) {\n                    res[idx] += 0\n                } else {\n                    res[idx] += i / 1\n                }\n            }\n        })\n    });\n    return Math.max.apply(null, res)\n}\n\n\n// 刻度最大值\nfunction yAxisMax(maxValue) {\n    if (isNaN(maxValue / 1) || maxValue / 1 < 10) {\n        return 10\n    }\n    const max = Math.ceil(maxValue) + '';\n    const itemValue = Math.ceil(max / 5) + '';\n    const mins = Math.ceil((itemValue / Math.pow(10, itemValue.length - 1)))\n    const item = mins * Math.pow(10, itemValue.length - 1) + '';\n    // item 需要是5的整数倍\n    const res = Math.ceil(item / 5) * 5 * 5;\n    return res\n}\n\n\n\n\nvar y1DataList = [];\nvar y2DataList = []\n\nseries.forEach((item) => {\n    if (item.type === 'bar') {\n        y1DataList.push(item.data)\n    } else if (item.type === 'line') {\n        y2DataList.push(item.data)\n    }\n})\n\nvar y1MaxValue = getSeriesItemMax(y1DataList) // 柱状图最大值\nvar y2MaxValue = getSeriesItemMax(y2DataList) // 折线图最大值\n\nvar y1Max = yAxisMax(y1MaxValue);\nvar y2Max = yAxisMax(y2MaxValue);\n\nvar yAxis = [{\n    type: 'value',\n    min: 0,\n    max: y1Max,\n    splitNumber: 5,\n    interval: y1Max / 5\n\n}, {\n    type: 'value',\n    splitNumber: 5,\n    min: 0,\n    max: y2Max,\n    interval: y2Max / 5,\n    axisLabel: {\n        formatter: '{value}%'\n    }\n}]\n\n\noption = {\n    legend: {\n        data: ['直接访问', '邮件营销', '联盟广告', '视频广告', '搜索引擎']\n    },\n    grid: {\n        left: '3%',\n        right: '4%',\n        bottom: '3%',\n        containLabel: true\n    },\n    xAxis: {\n        type: 'category',\n        data: ['周一', '周二', '周三', '周四', '周五', '周六', '周日']\n\n    },\n    tooltip: {\n        trigger: 'item'\n    },\n    yAxis: yAxis,\n    series: series\n};","html":"","externalScripts":"","updaterUID":"bd-2371199294","theme":"macarons","layout":"","viewCount":231,"userName":"156*****368","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xdDYQAJSZA.png?v=1601272520325","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","series-line","tooltip"],"customTags":["lineyAxis"],"updaterUserName":"156*****368"}}