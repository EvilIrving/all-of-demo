{"status":0,"data":{"cid":"xr1bFgZJYx","authorUid":"bd-3911393345","authorUserName":"wolf赵帅帅","title":"调用关系图","description":"展示各服务的上下游调用关系","latestVersion":1,"alwaysLatest":1,"createTime":"2017-02-13T09:46:32.000Z","lastUpdateTime":"2017-02-13T09:46:32.000Z","auth":2,"uid":"bd-3911393345","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"3.4.0","versionCreateTime":"2017-02-13T09:46:33.000Z","code":"var data = [\n            {\n                \"root\": \"service1\",\n                \"clients\": [\n                    \"service11\",\n                    \"service12\"\n                ]\n            },\n            {\n                \"root\": \"service2\",\n                \"clients\": [\n                    \"service21\",\n                    \"service22\"\n                ],\n                \"servers\": [\n                    \"service12\"\n                ]\n            }\n        ];\n\nfunction get_nodes(data) {\n    var nodes = [];\n    var tmp_nodes = [];\n    for (var root_i in data) {\n        tmp_nodes.push(data[root_i].root);\n        nodes.push(\n            {\n                'name':data[root_i].root,\n                'x':100,\n                'y':(parseInt(root_i)+1)*100,\n                'label': {\n                    'normal': {\n                        'show': true,\n                        textStyle: {\n                            'color': 'red',\n                            'fontSize': 8\n                        }\n                    }\n                }\n            }\n        );\n        var clients = data[root_i].clients;\n        var servers = data[root_i].servers;\n        var coord_i = parseInt(root_i)+1;\n        for (var client_i in clients) {\n            if (tmp_nodes.indexOf(clients[client_i]) >= 0) {\n                continue;\n            }else{\n                tmp_nodes.push(clients[client_i])\n            }\n            nodes.push(\n                {\n                    'name':clients[client_i],\n                    'x':(parseInt(root_i)+1)*200,\n                    'y':(parseInt(coord_i)+parseInt(client_i))*100,\n                    'label': {\n                        'normal': {\n                            'show': true,\n                            textStyle: {\n                                'color': 'red',\n                                'fontSize': 8\n                            }\n                        }\n                    }\n                }\n            );\n            coord_i += 1;\n        }\n        for (var server_i in servers) {\n            if (tmp_nodes.indexOf(servers[server_i]) >= 0) {\n                continue;\n            }else{\n                tmp_nodes.push(servers[server_i])\n            }\n            nodes.push(\n                {\n                    'name':servers[server_i],\n                    'x':(parseInt(root_i)+1)*200,\n                    'y': (parseInt(coord_i)+parseInt(server_i))*100,\n                    'label': {\n                        'normal': {\n                            'show': true,\n                            textStyle: {\n                                'color': 'red',\n                                'fontSize': 8\n                            }\n                        }\n                    }\n                }\n            );\n            coord_i += 1;\n        }\n    }\n    return nodes;\n}\n\nfunction get_links(data) {\n    var links = [];\n    for (var root_i in data) {\n        var clients = data[root_i].clients;\n        var servers = data[root_i].servers;\n        for (var client_i in clients) {\n            links.push({'source': clients[client_i], 'target': data[root_i].root})\n        }\n        for (var server_i in servers) {\n            links.push({'source': data[root_i].root, 'target': servers[server_i]})\n        }\n    }\n    return links;\n}\n\nvar option = {\n    title: {\n        text: '调用关系构建'\n    },\n    tooltip: {},\n    series: [{\n        type: 'graph',\n        legendHoverLink: true,\n        layout: 'none',\n        focusNodeAdjacency: true,\n        symbolSize: 50,\n        roam: true,\n        label: {\n            normal: {\n                show: true\n            }\n        },\n        edgeSymbol: ['circle', 'arrow'],\n        edgeSymbolSize: [4, 10],\n        edgeLabel: {\n            normal: {\n                textStyle: {\n                    fontSize: 8\n                }\n            }\n        },\n        itemStyle: {\n            normal: {\n                color: '#ccc',\n                borderColor: '#1af'\n            }\n        },\n        data: get_nodes(data),\n        links: get_links(data),\n        lineStyle: {\n            normal: {\n                color: '#1af',\n                opacity: 0.9,\n                width: 2,\n                curveness: 0.2\n            }\n        }\n    }]\n};\nmyChart.setOption(option);","html":"","externalScripts":"","updaterUID":"bd-3911393345","theme":"","layout":"","viewCount":4255,"userName":"wolf赵帅帅","commentCount":1,"starCount":9,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xr1bFgZJYx.png?v=1486979193680","isCustomThumbnail":0,"builtinTags":["category-work","series-graph","title","tooltip"],"customTags":[],"updaterUserName":"wolf赵帅帅"}}