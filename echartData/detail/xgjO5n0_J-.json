{"status":0,"data":{"cid":"xgjO5n0_J-","authorUid":"obd-oNxO_0pSiX4Qhzuy4VZap5faODTirCs","authorUserName":"梦***呢","title":"时间轴立体图","description":"","latestVersion":1,"alwaysLatest":0,"createTime":"2021-10-18T13:05:36.000Z","lastUpdateTime":"2021-10-18T13:05:36.000Z","auth":2,"uid":"obd-oNxO_0pSiX4Qhzuy4VZap5faODTirCs","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"5.1.2","versionCreateTime":"2021-10-18T13:05:36.000Z","code":"// mock 数据\nconst dataArr = {\n    xdata: [\n        ['01-01', '01-02', '01-03', '01-04', '01-05', '01-06', '01-07'],\n        ['01-08', '01-09', '01-10', '01-11', '01-12', '01-13', '01-14'],\n    ],\n    result: [\n        {\n            name: '天河',\n            data: [\n                [400, 435, 0, 340, 320, 270, 0],\n                [50, 435, 490, 340, 320, 270, 50],\n            ],\n        },\n        {\n            name: '海珠',\n            data: [\n                [0, 220, 210, 310, 20, 180, 288],\n                [1530, 220, 0, 310, 40, 180, 288],\n            ],\n        },\n        {\n            name: '荔湾',\n            data: [\n                [0, 120, 0, 280, 240, 180, 188],\n                [250, 120, 240, 280, 0, 180, 188],\n            ],\n        },\n    ],\n};\n\n// 头部菱形\n\nlet a = 0;\nconst cee = [];\ndataArr.xdata.forEach((n, j) => {\n    let diamondData = dataArr.result.reduce((pre, cur, index, array) => {\n        pre[index] = dataArr.result[index].data[j].map((el, id) => el + (pre[index - 1] ? pre[index - 1][id] : 0));\n        return pre;\n    }, []);\n    cee[j] = diamondData;\n});\n\nconst arr = [];\n// color\nconst color = [['#0079FA'], ['#00FD9F'], ['#00C2FF']];\nconst color1 = [\n    [\n        { offset: 0, color: '#01C3F5' },\n        { offset: 0.5, color: '#01C3F5' },\n        { offset: 0.5, color: '#2A69FF' },\n        { offset: 1, color: '#2A69FF' },\n    ],\n    [\n        { offset: 0, color: '#44FFBA' },\n        { offset: 0.5, color: '#44FFBA' },\n        { offset: 0.5, color: '#38D58C' },\n        { offset: 1, color: '#38D58C' },\n    ],\n    [\n        { offset: 0, color: '#0EEBFF' },\n        { offset: 0.5, color: '#0EEBFF' },\n        { offset: 0.5, color: '#00C2FF' },\n        { offset: 1, color: '#00C2FF' },\n    ],\n];\n// series\nlet series;\nvar options = [];\nvar yAxis;\ndataArr.xdata.forEach((n, j) => {\n    (yAxis = {\n        inverse: true,\n        // position:'bottom',\n        // offset:'10',\n        splitLine: {\n            show: false,\n        },\n        axisTick: {\n            show: false,\n        },\n        axisLine: {\n            lineStyle: {\n                // color: '#fff',\n                color: new echarts.graphic.LinearGradient(0, 1, 1, 0, [\n                    {\n                        offset: 0,\n                        color: 'rgba(255,255,255,0.8)',\n                    },\n                    {\n                        offset: 1,\n                        color: 'rgba(255,255,255,0)',\n                    },\n                ]),\n                width: 1,\n            },\n        },\n        axisLabel: { textStyle: { fontSize: 16, color: '#fff' } },\n        data: n,\n    }),\n        (series = dataArr.result.reduce((p, c, i, array) => {\n            p.push(\n                {\n                    z: i + 1,\n                    stack: '总量',\n                    type: 'bar',\n                    name: c.name,\n                    barGap: '-100%',\n                    barWidth: 15,\n                    data: dataArr.result[i].data[j],\n                    itemStyle: {\n                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, color1[i]),\n                        opacity: 1,\n                    },\n                },\n                {\n                    z: i + 3,\n                    type: 'pictorialBar',\n                    symbolPosition: 'end',\n                    symbol: 'diamond',\n                    symbolOffset: ['50%', 0],\n                    symbolSize: [7.5, 15],\n                    data: cee[j][i],\n                    itemStyle: {\n                        color: function (params) {\n                            // console.log('params',cee[j][i],c.data[j][params.dataIndex],params,color[i]);\n                            if (c.data[j][params.dataIndex] == 0) {\n                                return 'rgba(0,0,0,0)';\n                            } else {\n                                return new echarts.graphic.LinearGradient(0, 0, 0, 1, color1[i]);\n\n                                // return color[i];\n                                // return '#ffffff'\n                            }\n                        },\n                    },\n                    tooltip: { show: false },\n                }\n            );\n            // 是否最后一个了\n\n            if (p.length === array.length) {\n                console.log(i, j, dataArr, ' dataArr');\n                //   console.log('dataArr.r',cee[j][p.length-1]);\n                p.push({\n                    z: array.length * 2,\n                    type: 'pictorialBar',\n                    symbolPosition: 'end',\n                    data: cee[j][i],\n                    symbol: 'diamond',\n                    symbolOffset: ['50%', 0],\n                    symbolSize: [7.5, 15],\n                    itemStyle: {\n                        color: color[i],\n                    },\n                    tooltip: { show: false },\n                });\n                return p;\n            }\n\n            return p;\n        }, []));\n    options.push({ yAxis, series });\n});\n\n// tooltip\nconst tooltip = { show: true, trigger: 'axis' };\n\n// legend\nconst legend = {\n    data: dataArr.result.map((item) => item.name),\n    textStyle: { fontSize: 14, color: '#fff' },\n    itemWidth: 25,\n    itemHeight: 15,\n    itemGap: 15,\n    top: '5%',\n    // 禁止点击\n    selectedMode: false,\n};\n// grid\nconst grid = { top: '10%', left: '10%', right: '3%', bottom: '15%' };\n\n// xAxis\nconst xAxis = {\n    // boundaryGap:[0,2],\n    axisLabel: {\n        color: '#fff',\n        textStyle: {\n            fontSize: '13',\n        },\n    },\n    splitLine: {\n        show: true,\n        lineStyle: {\n            type: 'dashed',\n            color: 'rgba(255,255,255,0.2)',\n        },\n    },\n    axisLine: {\n        show: false,\n        lineStyle: {\n            color: '#fff',\n            width: 1,\n            opacity: 0.3,\n        },\n    },\n    axisTick: {\n        show: false,\n    },\n    // data: dataArr.xdata,\n};\n\nconst timeline = {\n    //loop: false,\n    axisType: 'category',\n    show: true,\n    autoPlay: true,\n    playInterval: 5000,\n    data: ['天河', '海珠'],\n};\n// 渲染\n// animation: false 加载动画\nvar option = {\n    baseOption: { animation: false, timeline, tooltip, xAxis, grid, legend, backgroundColor: 'rgba(0, 0, 0, .8)' },\n    options,\n};\n","html":"","externalScripts":"","updaterUID":"obd-oNxO_0pSiX4Qhzuy4VZap5faODTirCs","theme":"","layout":"","viewCount":0,"userName":"梦***呢","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xgjO5n0_J-.png?v=1634562337059","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","series-pictorialBar","timeline","tooltip"],"customTags":[],"updaterUserName":"梦***呢"}}