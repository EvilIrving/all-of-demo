{"status":0,"data":{"cid":"xW-rRjQoT","authorUid":"bd-3360351854","authorUserName":"云***包","title":"浙江地图","description":"","latestVersion":5,"alwaysLatest":1,"createTime":"2019-12-13T03:50:17.000Z","lastUpdateTime":"2019-12-13T03:50:17.000Z","auth":2,"uid":"bd-3360351854","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":5,"parentVersion":4,"echartsVersion":"4.4.0","versionCreateTime":"2019-12-16T06:33:14.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1576205687024-qrBjXoL5.json\";\n\n// 点击的地图块\nvar clickMod = new Set()\n// 点击的地图块的名字\nvar clickModName = []\nvar flyDataPushed = false\n\n$.get(uploadedDataURL, function(geoJson) {\n    echarts.registerMap('zhejiang', geoJson);\n    // myChart.setOption(option);\n\n    var geoCoordMap = {\n        '杭州市': [119.553576, 29.987459],\n        '湖州市': [120.102398, 30.667198],\n        '嘉兴市': [120.750865, 30.462653],\n        '绍兴市': [120.582112, 29.697117],\n        '宁波市': [121.549792, 29.668388],\n        '舟山市': [122.106863, 30.216028],\n        '衢州市': [118.37263, 29.041708],\n        '金华市': [120.149506, 29.089524],\n        '台州市': [121.428599, 28.861378],\n        '丽水市': [119.921786, 28.251993],\n        '温州市': [120.672111, 28.200575],\n    }\n    var data = [{\n            name: '杭州市',\n            value: 99\n        },\n        {\n            name: '湖州市',\n            value: 39\n        },\n        {\n            name: '嘉兴市',\n            value: 52\n        },\n        {\n            name: '绍兴市',\n            value: 29\n        },\n        {\n            name: '宁波市',\n            value: 89\n        },\n        {\n            name: '舟山市',\n            value: 52\n        },\n        {\n            name: '衢州市',\n            value: 9\n        },\n        {\n            name: '金华市',\n            value: 32\n        },\n        {\n            name: '台州市',\n            value: 99\n        },\n        {\n            name: '丽水市',\n            value: 39\n        },\n        {\n            name: '温州市',\n            value: 80\n        },\n    ];\n    var data11 = [{\n            name: '杭州市',\n            value: 5\n        },\n        {\n            name: '湖州市',\n            value: 5\n        },\n        {\n            name: '嘉兴市',\n            value: 5\n        },\n        {\n            name: '绍兴市',\n            value: 5\n        },\n        {\n            name: '宁波市',\n            value: 5\n        },\n        {\n            name: '舟山市',\n            value: 5\n        },\n        {\n            name: '衢州市',\n            value: 5\n        },\n        {\n            name: '金华市',\n            value: 5\n        },\n        {\n            name: '台州市',\n            value: 5\n        },\n        {\n            name: '丽水市',\n            value: 5\n        },\n        {\n            name: '温州市',\n            value: 5\n        },\n    ]\n    var goData = [\n        [{\n            name: '杭州市'\n        }, {\n            id: 1,\n            name: '温州市',\n            value: 99\n        }],\n        // [{name: '济南市'},{id: 1,name: '青岛市',value: 160}],\n        // [{name: '济南市'},{id: 1,name: '烟台市',value:300}]\n        //  [{name:'蓟县'}, {name:'宁河',value:95}],\n    ];\n    //值控制圆点大小\n    var backData = [\n        [{\n            name: '温州市'\n        }, {\n            id: 2,\n            name: '杭州市',\n            value: 200\n        }],\n        // [{name: '青岛市'}, { id: 2,name: '济南市',value: 200}],\n        //[{name: '烟台市'}, { id: 2,name: '济南市',value: 100}]\n    ];\n    var planePath = 'path://M1705.06,1318.313v-89.254l-319.9-221.799l0.073-208.063c0.521-84.662-26.629-121.796-63.961-121.491c-37.332-0.305-64.482,36.829-63.961,121.491l0.073,208.063l-319.9,221.799v89.254l330.343-157.288l12.238,241.308l-134.449,92.931l0.531,42.034l175.125-42.917l175.125,42.917l0.531-42.034l-134.449-92.931l12.238-241.308L1705.06,1318.313z';\n    // var planePath = 'path://M15.1,15.00625 L7.6,15.00625 C3.4,15.00625 0.1,11.60625 0.1,7.50625 C0.1,3.40625 3.5,0.00625 7.6,0.00625 C11.7,0.00625 15.1,3.40625 15.1,7.50625 L15.1,15.00625 Z M7.5,1.90625 C4.5,1.90625 2,4.40625 2,7.40625 C2,10.40625 4.5,12.90625 7.5,12.90625 L13,12.90625 L13,7.40625 C13.1,4.40625 10.6,1.90625 7.5,1.90625 Z M24.5,15.00625 L17,15.00625 L17,7.50625 C17,3.30625 20.4,0.00625 24.5,0.00625 C28.6,0.00625 32,3.40625 32,7.50625 C32,11.60625 28.6,15.00625 24.5,15.00625 Z M7.5,31.90625 C3.3,31.90625 0,28.50625 0,24.40625 C0,20.30625 3.4,16.90625 7.5,16.90625 L15,16.90625 L15,24.40625 C15.1,28.50625 11.7,31.90625 7.5,31.90625 Z M24.5,31.90625 C20.3,31.90625 17,28.50625 17,24.40625 L17,16.90625 L24.5,16.90625 C28.7,16.90625 32,20.30625 32,24.40625 C32,28.50625 28.6,31.90625 24.5,31.90625 Z';\n    var arcAngle = function(data) {\n        var j, k;\n        for (var i = 0; i < data.length; i++) {\n            var dataItem = data[i];\n            if (dataItem[1].id == 1) {\n                j = 0.2;\n                return j;\n            } else if (dataItem[1].id == 2) {\n                k = -0.2;\n                return k;\n            }\n        }\n    }\n    var convertData = function(data) {\n        var res = [];\n        for (var i = 0; i < data.length; i++) {\n            var geoCoord = geoCoordMap[data[i].name];\n            if (geoCoord) {\n                res.push({\n                    name: data[i].name,\n                    value: geoCoord.concat(data[i].value),\n                    visualMap: false\n                });\n            }\n        }\n        return res;\n    };\n    var convertData_line = function(data) {\n        var res = [];\n        for (let i = 0; i < data.length; i++) {\n            var dataItem = data[i];\n            var fromCoord = geoCoordMap[dataItem[0].name];\n            var toCoord = geoCoordMap[dataItem[1].name];\n            if (dataItem[1].id == 1) {\n                if (fromCoord && toCoord) {\n                    res.push([{\n                        coord: fromCoord,\n                    }, {\n                        coord: toCoord,\n                        value: dataItem[1].value //线条颜色\n                    }]);\n                }\n            } else if (dataItem[1].id == 2) {\n                if (fromCoord && toCoord) {\n                    res.push([{\n                        coord: fromCoord,\n                    }, {\n                        coord: toCoord\n                    }]);\n                }\n            }\n        }\n        return res;\n    };\n    var series = [\n        {\n          // type: 'effectScatter',\n          type: 'scatter',\n          coordinateSystem: 'geo',\n          zlevel: 9,\n          //波纹效果\n          // rippleEffect: {\n          //   period: 2,\n          //   brushType: 'stroke',\n          //   scale: 3\n          // },\n          // label: {\n          //   normal: {\n          //     show: true,\n          //     color: '#fff',\n          //     position: 'right',\n          //     formatter: '{b}'\n          //   }\n          // },\n          //终点形象(散点图标)\n          symbol: 'pin',\n          // symbol: 'path://M15.1,15.00625 L7.6,15.00625 C3.4,15.00625 0.1,11.60625 0.1,7.50625 C0.1,3.40625 3.5,0.00625 7.6,0.00625 C11.7,0.00625 15.1,3.40625 15.1,7.50625 L15.1,15.00625 Z M7.5,1.90625 C4.5,1.90625 2,4.40625 2,7.40625 C2,10.40625 4.5,12.90625 7.5,12.90625 L13,12.90625 L13,7.40625 C13.1,4.40625 10.6,1.90625 7.5,1.90625 Z M24.5,15.00625 L17,15.00625 L17,7.50625 C17,3.30625 20.4,0.00625 24.5,0.00625 C28.6,0.00625 32,3.40625 32,7.50625 C32,11.60625 28.6,15.00625 24.5,15.00625 Z M7.5,31.90625 C3.3,31.90625 0,28.50625 0,24.40625 C0,20.30625 3.4,16.90625 7.5,16.90625 L15,16.90625 L15,24.40625 C15.1,28.50625 11.7,31.90625 7.5,31.90625 Z M24.5,31.90625 C20.3,31.90625 17,28.50625 17,24.40625 L17,16.90625 L24.5,16.90625 C28.7,16.90625 32,20.30625 32,24.40625 C32,28.50625 28.6,31.90625 24.5,31.90625 Z',\n          //圆点大小\n          symbolSize: function(val) {\n            return val[2] / 2;\n          },\n          label: {\n            normal: {\n              show: true,\n              // show: false,\n              textStyle: {\n                color: '#fff',\n                fontSize: 9,\n              },\n              formatter: function(params) {\n                return params.value[2]\n              }\n            }\n          },\n          itemStyle: {\n            normal: {\n              show: true,\n              color: '#F62157'\n            }\n          },\n          data: convertData(data)\n        },\n        {\n          type: 'scatter',\n          coordinateSystem: 'geo',\n          zlevel: 9,\n          data: convertData(data),\n          symbolSize: function (val) {\n            return 0.1;\n          },\n          label: {\n            normal: {\n              formatter: '{b}',\n              // formatter: 'b',\n              position: 'right',\n              show: true\n            },\n            emphasis: {\n              show: true\n            }\n          },\n          itemStyle: {\n            normal: {\n              color: '#05C3F9'\n            }\n          },\n        },\n        {\n          type: 'map',\n          map: 'zhejiang',\n          data: data11,\n          zlevel: 3,\n          // aspectScale:1,//保持原始比例\n          zoom: 1.24,\n          roam: false,\n          label: {\n            show:true,\n            normal: {\n              show: false,\n              color:\"#fff\",\n            },\n            emphasis: {\n              show: true,\n              fontSize:16,\n              color:\"#fff\"\n            }\n          },\n          itemStyle: {\n            normal: {\n              areaColor: '#323c48',\n              borderColor: '#111'\n            },\n            emphasis: {//鼠标移入高亮显颜色\n              areaColor: '#f46d43'\n            }\n          }\n        }\n      ];\n    // [\n    //     ['1', goData],\n    //     ['2', backData]\n    // ].forEach(function(item, i) {\n    //     series.push({\n    //         name: item[0],\n    //         type: 'lines',\n    //         zlevel: 2,\n    //         //线特效配置\n    //         effect: {\n    //             show: true,\n    //             period: 6, // 运行时间（s）\n    //             trailLength: 0, // 拖影\n    //             symbol: planePath, //标记类型\n    //             symbolSize: 10\n    //         },\n    //         lineStyle: {\n    //             normal: {\n    //                 width: 1,\n    //                 opacity: 0.4,\n    //                 // curveness: arcAngle(item[1]), //弧线角度\n    //                 curveness: 0.2, //弧线角度\n    //                 color: '#fff' // 迁移线颜色\n    //             }\n    //         },\n    //         data: convertData_line(item[1])\n    //     });\n    // });\n    option = {\n        dataRange: {\n            show: false,\n            x: 'left',\n            y: 'bottom',\n            splitList: [{\n                    start: 5,\n                    end: 5,\n                    color: 'rgba(255,255,255,0.1)'\n                }, //当值为5时，区域背景\n                {\n                    start: 10,\n                    end: 10,\n                    color: '#ff6300'\n                }, //当值为10时，区域背景\n                {\n                    start: 15,\n                    end: 15,\n                    color: '#ccc'\n                }, //当值为15时，区域背景\n            ],\n        },\n        backgroundColor: '#404a59', //#154e90\n        //   title: {\n        //   text: '迁徙',\n        //   subtext: '路线',\n        //   left: 'center',\n        //   textStyle: {\n        //     color: '#fff'\n        //   },\n        //   x: 'center'\n        // },\n        tooltip: {\n            trigger: 'item',\n            formatter: \"{b}\"\n        },\n        //线颜色及飞行轨道颜色\n        visualMap: {\n            show: false,\n            min: 0,\n            max: 300,\n            color: ['#02e817', '#e80202', '#0233e8']\n        },\n        //地图相关设置\n        geo: {\n            map: 'zhejiang',\n            //视角缩放比例\n            zoom: 1.24,\n            //显示文本样式\n            label: {\n                normal: {\n                    show: false,\n                    // formatter: '{b}',\n                    position: 'right',\n                    textStyle: {\n                        color: '#fff'\n                    }\n                },\n                emphasis: {\n                    textStyle: {\n                        color: '#fff'\n                    }\n                }\n            },\n            //鼠标缩放和平移\n            roam: true,\n            // regions: [      //对不同的区块进行着色\n            //   {\n            //     name: '杭州市', //区块名称\n            //     itemStyle: {\n            //       normal: {\n            //         areaColor: '#fbd8f3'\n            //       }\n            //     }\n            //   },{\n            //     name: '温州市',\n            //     itemStyle: {\n            //       normal: {\n            //         areaColor: '#fcc8b8'\n            //       }\n            //     }\n            // },{\n            //   name: '宁波市',\n            //   itemStyle: {\n            //     normal: {\n            //       areaColor: '#2b97df'\n            //     }\n            //   }\n            // }],\n            itemStyle: {\n                normal: {\n                    // color: '#ddd',\n                    borderColor: 'rgba(147, 235, 248, 1)',\n                    // borderColor: 'red',\n                    borderWidth: 1,\n                    areaColor: {\n                        type: 'radial',\n                        x: 0.8,\n                        y: 0.5,\n                        r: 0.8,\n                        colorStops: [{\n                            offset: 0,\n                            color: 'rgba(175,238,238, 0)', // 0% 处的颜色\n                            // color: 'red',\n                        }, {\n                            offset: 1,\n                            color: 'rgba(\t47,79,79, .2)' // 100% 处的颜色\n                        }],\n                        globalCoord: false // 缺省为 false\n                    },\n                    shadowColor: 'rgba(128, 217, 248, 1)',\n                    // shadowColor: 'red',\n                    shadowOffsetX: -2,\n                    shadowOffsetY: 2,\n                    shadowBlur: 10\n                },\n                emphasis: {\n                    areaColor: '#389BB7',\n                    // areaColor: 'red',\n                    borderWidth: 0\n                }\n            }\n        },\n        series: series\n    };\n    // let data = []\n    // renderMap('zhejiang', data)\n    //   console.log(option)\n    // option.series.push({\n    //     type: 'map',\n    //     map: 'zhejiang'\n    //   })\n    myChart.setOption(option);\n\n    myChart.on('click', (params) => {\n        for (let i = 0; i < data11.length; i++) {\n            if (params.name == data11[i].name) {\n                data11[i].value = 10;\n                clickMod.add(params.name)\n            }\n        }\n        if (clickMod.size > 2) {\n            for (let i = 0; i < data11.length; i++) {\n                data11[i].value = 5;\n                clickMod.clear()\n            }\n            if (flyDataPushed) {\n                series.pop()\n                flyDataPushed = false\n            }\n        }\n        // console.log(this.clickMod)\n        // console.log(this.clickMod)\n        clickModName = []\n        for (let item of clickMod.values()) {\n            clickModName.push(item)\n        }\n        // series.push({\n        //   name: item[0],\n        //   type: 'lines',\n        //   zlevel: 99,\n        //   //线特效配置\n        //   effect: {\n        //     show: true,\n        //     period: 6, // 运行时间（s）\n        //     trailLength: 0, // 拖影\n        //     symbol: planePath, //标记类型\n        //     symbolSize: 10\n        //   },\n        //   lineStyle: {\n        //     normal: {\n        //       width: 1,\n        //       opacity: 0.4,\n        //       // curveness: arcAngle(item[1]), //弧线角度\n        //       curveness: 0.2, //弧线角度\n        //       color: '#fff' // 迁移线颜色\n        //     }\n        //   },\n        //   data: convertData_line(item[1])\n        // });\n        var flyData = [\n            []\n        ]\n        if (clickModName.length === 2 && !flyDataPushed) {\n            flyData[0].push({\n                name: clickModName[0]\n            }, {\n                id: 1,\n                name: clickModName[1]\n            })\n            series.push({\n                type: 'lines',\n                zlevel: 99,\n                //线特效配置\n                effect: {\n                    show: true,\n                    period: 6, // 运行时间（s）\n                    trailLength: 0, // 拖影\n                    symbol: planePath, //标记类型\n                    symbolSize: 10\n                },\n                lineStyle: {\n                    normal: {\n                        width: 1,\n                        opacity: 0.4,\n                        // curveness: arcAngle(item[1]), //弧线角度\n                        curveness: 0.2, //弧线角度\n                        color: '#fff' // 迁移线颜色\n                    }\n                },\n                data: convertData_line(flyData)\n            })\n            flyDataPushed = true\n        }\n        console.log(flyData)\n        // console.log(this.clickMod.values())\n        // params.data.value = '1'\n        // console.log(this.clickMod)\n        // console.log(this.clickModName)\n        myChart.setOption(option)\n    })\n})","html":"","externalScripts":"","updaterUID":"bd-3360351854","theme":"","layout":"","viewCount":1073,"userName":"云***包","commentCount":0,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xW-rRjQoT.png?v=1576477994763","isCustomThumbnail":0,"builtinTags":["category-work","geo","series-lines","series-map","series-scatter","tooltip","visualMap"],"customTags":[],"updaterUserName":"云***包"}}