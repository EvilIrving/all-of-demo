{"status":0,"data":{"cid":"xwFDjnWqtV","authorUid":"bd-696783921","authorUserName":"n***人","title":"自定义栅格图-高德-京津冀","description":"组合使用简易行政区图-世界、自定义栅格图(地形图，来自天地图)、以及掩模功能，实现了只显示每个区域的地形图的效果。","latestVersion":9,"alwaysLatest":1,"createTime":"2019-01-03T07:35:00.000Z","lastUpdateTime":"2019-08-28T09:44:53.000Z","auth":2,"uid":"bd-696783921","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":9,"parentVersion":8,"echartsVersion":"4.2.1","versionCreateTime":"2019-09-08T09:21:56.000Z","code":"     var map = new AMap.Map('chart-panel', {\n         mapStyle: \"amap://styles/3217e099bb7b1bb4a8e063ce169bbb5b\",\n         pitch: 52,\n         zoom: 7,\n         center: [116.472804, 39.995725],\n         viewMode: '3D', //开启3D视图,默认为关闭\n         buildingAnimation: true, //楼块出现是否带动画                \n         cursor: 'pointer',\n         features: ['road', 'building', 'point']\n     });\n\n\n     map.on('complete', function() {\n         map.plugin(['AMap.ControlBar'], function() {\n             var controlBar = new AMap.ControlBar({\n                 position: {\n                     right: '0',\n                     bottom: '-173px'\n                 }\n             });\n             map.addControl(controlBar);\n         });\n         map.plugin(['AMap.MapType'], function() {\n             var mapType = new AMap.MapType({\n                 liteStyle: true\n             });\n             map.addControl(mapType);\n         });\n         map.plugin(['AMap.Scale'], function() {\n             var scale = new AMap.Scale();\n             map.addControl(scale);\n         });\n         map.plugin(['AMap.ToolBar'], function() {\n             var toolBar = new AMap.ToolBar();\n             map.addControl(toolBar);\n         });\n         map.plugin(['AMap.DistrictLayer'], function() {\n             var disCountry = new AMap.DistrictLayer.Country({\n                 SOC: 'CHN',\n                 depth: 2,\n                 styles: {\n                     'province-stroke': 'cornflowerblue',\n                     'city-stroke': 'white', //中国地级市边界\n                     'county-stroke': 'white', //'#3c648780', //中国区县边界\n                     'fill': 'rgba(0,0,0,0)',\n                 }\n             });\n             disCountry.setMap(map);\n         });\n\n         var layer = new AMap.TileLayer({\n             zIndex: -1,\n             getTileUrl: 'https://t{0,1,2,3,4,5,6,7}.tianditu.gov.cn/DataServer?tk=95f31e3625a164fbdc09ef6ba9b971ad&T=ter_w&x=[x]&y=[y]&l=[z]'\n         });\n         layer.setMap(map);\n         map.on('dblclick', function() {\n             map.remove(layer);\n             layer = new AMap.TileLayer({\n                 zIndex: -1,\n                 getTileUrl: 'http://106.38.83.13/ArcGIS/rest/services/JJJSlope/MapServer/tile/[z]/[y]/[x]'\n             });\n             layer.setMap(map);\n         });\n\n         function drawvisualLayer() {\n             $.getJSON(\"/asset/get/s/data-1544592880173-tRoZbKmvl.json\", function(data) {\n                 var loca = Loca.create(map);\n\n                 var Player = Loca.visualLayer({\n                     container: loca,\n                     type: 'point',\n                     shape: 'circle',\n                 });\n                 Player.setData(data)\n                 Player.setOptions({\n                     lnglat: function(res) {\n                         var data = res.value;\n                         var center = [data.longitude, data.latitude];\n                         return center;\n                     },\n                     style: {\n                         unit: 'meter',\n                         opacity: 0.521,\n                         radius: 2,\n                         fill: function(res) {\n                             var aqi = res.value.aqi;\n                             var color = 'gray';\n                             if (aqi <= 50) {\n                                 color = '#43ce17';\n                             } else if (aqi <= 100) {\n                                 color = '#efdc31';\n                             } else if (aqi <= 150) {\n                                 color = '#fa0';\n                             } else if (aqi <= 200) {\n                                 color = '#ff401a';\n                             } else if (aqi <= 300) {\n                                 color = '#d20040';\n                             } else {\n                                 color = '#9c0a4e';\n                             }\n                             return color;\n                         }\n                     }\n                 });\n                 Player.render();\n\n\n\n\n             });\n         }\n         drawvisualLayer();\n\n         const area = ['河北省', '北京市', '天津市']\n         //area = area.concat($option.prop('value').split(','));\n         map.plugin(['AMap.DistrictSearch'], function() {\n             const district = new AMap.DistrictSearch({\n                 subdistrict: 0, //返回下一级行政区\n                 extensions: 'all', //返回行政区边界坐标组等具体信息\n             });\n             let bounds = [];\n             search();\n\n             function search(index) {\n                 if (!index) {\n                     index = 0;\n                 }\n                 let province = area[index]\n                 if (province) {\n                     district.search(province, function(status, result) {\n                         bounds = bounds.concat(result.districtList[0].boundaries);\n                         index++;\n                         search(index);\n                     });\n                 } else {\n                     function run(bounds) {\n                         var prism = new AMap.Object3D.Wall({\n                             path: bounds,\n                             height: 5000,\n                             color: '#0088ffcc'\n                         });\n                         prism.transparent = true;\n                         var object3Dlayer = new AMap.Object3DLayer({\n                             zIndex: 1\n                         });\n                         object3Dlayer.add(prism)\n                         object3Dlayer.setMap(map);\n\n                         var mask = bounds.map(function(item) {\n                             return [item]\n                         });\n                         map.setMask(mask);\n                     }\n                     run(bounds);\n\n                 }\n             }\n         });\n\n     });","html":"","externalScripts":"//webapi.amap.com/maps?v=1.4.12&key=35a871e5905ecfd749bd998448b9cd03&plugin=AMap.DistrictSearch,//webapi.amap.com/ui/1.0/main.js?v=1.0.11,//webapi.amap.com/loca?v=1.2.0&key=35a871e5905ecfd749bd998448b9cd03","updaterUID":"bd-696783921","theme":"default","layout":"","viewCount":184816,"userName":"n***人","commentCount":0,"starCount":11,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xwFDjnWqtV.png?v=1566985493913","isCustomThumbnail":1,"builtinTags":["category-work"],"customTags":["amap","arcgis"],"updaterUserName":"n***人"}}