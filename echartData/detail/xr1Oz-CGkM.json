{"status":0,"data":{"cid":"xr1Oz-CGkM","authorUid":"bd-1813650783","authorUserName":"y***8","title":"通过天数-控制标准线位置","description":"通过选择当月某一天日期，控制标线显示某个位置，一般是用来显示当月某一天项目完进度","latestVersion":1,"alwaysLatest":1,"createTime":"2017-11-10T07:11:12.000Z","lastUpdateTime":"2017-11-10T07:11:12.000Z","auth":2,"uid":"bd-1813650783","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"3.8.0","versionCreateTime":"2017-11-10T07:11:12.000Z","code":" var bae\r\n setInterval(function (){\r\n      bae = parseInt(Math.random()* 29 + 1)\r\n     console.log(bae)\r\n      var setTime='2017-11-' + bae;\r\n  var set_arr=setTime.split(\"-\");\r\n  var totalDay = mGetDate(set_arr[0],set_arr[1]);\r\n  budget(totalDay,set_arr[2],setTime);\r\n  \t\t\t//budget2(totalDay,set_arr[2],setTime);\r\n  \t\t\t\r\n  \t\t\tconsole.log(setTime);\r\n   \r\n  \t//获取当月天数\r\n  \tfunction mGetDate(year, month){\r\n\t    var d = new Date(year, month, 0);\r\n\t    return d.getDate();\r\n\t}\r\n  \r\n },1000)\r\n \r\n \r\n \r\n\r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\nfunction budget(tomonth,set_arr,atime){\r\n\tconsole.log(atime)\r\n\tvar set_time =(set_arr==null)?15 : set_arr;\r\n \r\n    names =  ['硝酸','硝酸2','硝酸3','硝酸4','硝酸5','硝酸6','硝酸7','硝酸8','硝酸9','硝酸10'];\r\n\tvar values = [220, 182, 191, 234, 290,220, 182, 191, 234, 350];//实际值\r\n\tvar cbthNumber=100;//预算值   用实际值除以预算 = 预算结果\r\n\tvar cbtnarr=[0];\r\n\tfor(var i=0; i<values.length;i++){\r\n\t\tcbtnarr.push(parseInt(values[i]/cbthNumber*30))\r\n\t}\r\n\tconsole.log(cbtnarr);\r\n\tvar values2 = [120, 112, 111, 134, 120,130, 122, 141, 134, 150];\r\n\tvar max = values[0];\r\n\tvar max = 900;\r\n\t\t for(var i=0; i<values.length;i++){\r\n\t\t \tif(max<values[i]){\r\n\t\t \t\tmax=values[i];\r\n\t\t \t}\r\n\t \t};\r\n \r\n\t \tvar  marklines={\r\n            data : [{\r\n                    name: 'Y 轴值为 100 的水平线',\r\n                    yAxis: max/tomonth*set_time,\r\n                 }],\r\n            symbol:'arrow',\r\n        };\r\n \r\n\toption = {\r\n    color: ['#3398DB'],\r\n \ttooltip:{\r\n \t\ttrigger: 'axis',\r\n \t     formatter: function (params, ticket, callback) {//atime  空\r\n \t\tvar forname = params[0].axisValue;//获取名称\r\n \t\tvar fordata = params[0].data;//获取名称对应的数据\r\n \t\tvar forcbdata =  cbtnarr[params[0].dataIndex];//获取名称对应的数据\r\n \t\tvar Saleer= '销售完成率';\r\n   \t\tvar abox = '<div><p>'+forname+':'+fordata+'</p><p>'+Saleer+':'+forcbdata+'%</p><p>'+atime+'</p></div>'\r\n    return abox;\r\n}\r\n \t},\r\n    legend: {\r\n        show: true,\r\n        icon:'bar',\r\n        itemWidth:15,\r\n        data: names\r\n    },\r\n    xAxis: {\r\n        data:names\r\n    },\r\n\r\n   grid: {\r\n\t    \ttop:'13%',\r\n\t        left: '3%',\r\n\t        right: '2%',\r\n\t        bottom: '5%',\r\n\t        containLabel: true\r\n\t},\r\n \r\n    yAxis:[ \r\n      {\r\n            type: 'value',\r\n            scale: true,\r\n            name: '价格',\r\n\r\n            max: 100,\r\n            min: 0,\r\n             axisLabel: {\r\n\t            formatter: '{value}  %'\r\n\t        }\r\n        },\r\n        {\r\n            type: 'value',\r\n            scale: true,\r\n            name: '预购量',\r\n            max: 900,\r\n            min: 0,\r\n            splitLine:{\r\n            \tshow:false\r\n            }\r\n        }\r\n    ],\r\n    series: [\r\n    {\r\n    \ttype: 'bar',\r\n\t    markLine : marklines,\r\n\t    barWidth: '10%',\r\n\t    data: values,\r\n\t    yAxisIndex: 1,\r\n\t    itemStyle:{\r\n            normal:{\r\n                color:'#3398DB'\r\n            }\r\n        }\r\n    }, { \r\n\t    type: 'bar',\r\n\t    barWidth: '10%',\r\n\t    barWidth : 5,\r\n\t    data: values2,\r\n\t    yAxisIndex: 1,\r\n\t    itemStyle:{\r\n            normal:{\r\n                color:'#62c0d0',\r\n                borderType:'dashed'\r\n            }\r\n        }\r\n\t    \r\n    },{\r\n        type: 'scatter',\r\n        name: '硝酸'\r\n    }, {\r\n        type: 'scatter',\r\n        name: '硝酸2'\r\n    }, {\r\n        type: 'scatter',\r\n        name: '硝酸3'\r\n    }, {\r\n        type: 'scatter',\r\n        name: '硝酸4'\r\n    }, {\r\n        type: 'scatter',\r\n        name: '硝酸5'\r\n    }, {\r\n        type: 'scatter',\r\n        name: '硝酸6'\r\n    }, {\r\n        type: 'scatter',\r\n        name: '硝酸7'\r\n    }, {\r\n        type: 'scatter',\r\n        name: '硝酸8'\r\n    }, {\r\n        type: 'scatter',\r\n        name: '硝酸9'\r\n    }, {\r\n        type: 'scatter',\r\n        name: '硝酸10'\r\n    }]\r\n};\r\n\r\nmyChart.on('legendselectchanged', function(params) {\r\n    var option = {};\r\n    var newNames = [];\r\n    var newValues = [];\r\n    for(var i = 0; i < names.length ;i ++){\r\n        if(params.selected[names[i]] == true){\r\n            newNames.push(names[i]);\r\n            newValues.push(values[i]);\r\n        }\r\n    }\r\n    \r\n    myChartbudget.setOption({\r\n        xAxis: {\r\n        data: newNames\r\n    },\r\n    yAxis: {},\r\n    series: [{\r\n        type: 'bar',\r\n        data: newValues\r\n    }]\r\n    })\r\n});\r\n\t\t myChart.setOption(option);\r\n\t \r\n};\r\n","html":"","externalScripts":"","updaterUID":"bd-1813650783","theme":"","layout":"","viewCount":242,"userName":"y***8","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xr1Oz-CGkM.png?v=1510297872259","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","markLine","series-bar","series-scatter","tooltip"],"customTags":[],"updaterUserName":"y***8"}}