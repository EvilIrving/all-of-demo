{"status":0,"data":{"cid":"xTEL9kA-sj","authorUid":"bd-943272051","authorUserName":"啊很古","title":"内含生成文字过长而缩略的图片的方法","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2019-04-25T09:08:02.000Z","lastUpdateTime":"2019-04-25T09:08:02.000Z","auth":1,"uid":"bd-943272051","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.2.1","versionCreateTime":"2019-04-25T09:08:02.000Z","code":"option = {\n    title: {\n        text: 'Awesome Chart'\n    },\n    xAxis: {\n        data: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']\n    },\n    yAxis: {},\n    series: [{\n        type: 'line',\n        data:[220, 182, 191, 234, 290, 330, 310]\n    }]\n};\n\n\nfunction buildEllipsisTextRect(text, style, isGetSeries) {\n    let option = {\n      series : [],\n      backgroundColor:'transparent',\n    };\n\n    let seriesItem = {\n      name:'矩形图',\n      type:'treemap',\n      roam: false,\n      backgroundColor: 'transparent',\n      width: '100%',\n      height: '100%',\n      bottom: '0%',\n      label:{\n        formatter: text,\n        color: style.color || '#8E9CB9',\n        backgroundColor:'transparent',\n        lineHeight: style.lineHeight || 19,\n        fontSize: style.fontSize || 14,\n        margin: [0,0,0,0],\n        padding:[0,0,0,0],\n        verticalAlign: 'middle'\n      },\n      itemStyle: {\n        normal: {\n          show: false,\n          borderWidth: 0,\n          borderColor: '#00000000',\n        },\n        emphasis: {\n          label: {\n            show: true\n          }\n        }\n      },\n      data:[\n        // {\n        //   color:'transparent',\n        //   name: text,\n        //   value: 6\n        // },\n      ],\n      breadcrumb:{\n        show: false\n      }\n    };\n\n    option.series.push( seriesItem );\n\n    let newDiv = document.createElement(\"div\");\n    newDiv.style.height = `${style.lineHeight || 19}px`;\n    newDiv.style.width = `${style.maxWidth || 80}px`;\n\n    let ellipsisTextChart = echarts.init(  newDiv );\n    ellipsisTextChart.setOption(option);\n\n    // let dataUrl1 = ellipsisTextChart.getDataURL( {\n    //   type: 'png',\n    //   pixelRatio: 1, //2可以避免图片文字像素模糊 //缩放二倍图原理, 否则backgroundSize行宽一致\n    //   backgroundColor: 'transparent',\n    // });\n    //\n    // if( text == '水表' ){\n    //   $('#logo').attr('src', dataUrl1);\n    // }\n\n    // return ellipsisTextChart.getDom();\n\n    let dataUrl = ellipsisTextChart.getRenderedCanvas( {   //返回 HTMLCanvasElement\n      pixelRatio: 1,\n      backgroundColor: 'transparent',\n    });\n\n    if( isGetSeries ){\n      return seriesItem;\n    }\n\n    return  dataUrl\n\n\n\n    // 导出的格式，可选 png, jpeg\n    // type: 'png',\n    // 导出的图片分辨率比例，默认为 1。\n    // pixelRatio?: number,\n    // 导出的图片背景色，默认使用 option 里的 backgroundColor\n    // backgroundColor: 'transparent',\n    // 忽略组件的列表，例如要忽略 toolbox 就是 ['toolbox']\n    // excludeComponents?: Array.<string>\n\n  }","html":"","externalScripts":"","updaterUID":"bd-943272051","theme":"","layout":"","viewCount":10,"userName":"啊很古","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xTEL9kA-sj.png?v=1556183282529","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-line","title"],"customTags":[],"updaterUserName":"啊很古"}}