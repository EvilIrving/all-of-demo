{"status":0,"data":{"cid":"xufhUULjIG","authorUid":"obd-o0g9jBjdwuMiVXfUf6jz6R5aqm27vF1","authorUserName":"w***i","title":"条形图堆叠轮播展示","description":"卡口摄像机过车统计排名轮播展示","latestVersion":2,"alwaysLatest":1,"createTime":"2020-06-05T08:36:27.000Z","lastUpdateTime":"2020-06-05T08:36:27.000Z","auth":2,"uid":"obd-o0g9jBjdwuMiVXfUf6jz6R5aqm27vF1","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.8.0","versionCreateTime":"2020-06-05T08:38:22.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1591344758953-j1Y7QqUmH.json\";\n\nmyChart.showLoading();\n$.getJSON(uploadedDataURL,function(data){\n    if(data.carCountRank){\n        var statData = data.carCountRank;\n        var page = 0;\n        var size = 4;\n        var count = statData.length;\n        var pages = Math.ceil(count / size);\n        \n        \n        let option = {\n            grid: [{\n                //左侧的柱状图grid\n                left:'4%',\n                top: '20%',\n                right: '4%',\n                bottom: '1%'\n            }],\n            tooltip: {\n                trigger: 'axis',\n                axisPointer: {            // 坐标轴指示器，坐标轴触发有效\n                    type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'\n                }\n            },\n            xAxis: [{\n                //左侧柱状图的X轴\n                gridIndex: 0, //x 轴所在的 grid 的索引\n                show: false\n            }],\n            legend: {\n                data:['小型车','中型车','大型车','特大型车','摩托车'],\n                top:30\n            },\n            yAxis: [{\n                //左侧柱状图的Y轴\n                gridIndex: 0, //y轴所在的 grid 的索引\n                splitLine: 'none',\n                axisTick: 'none',\n                axisLine: 'none',\n                axisLabel: {\n                    verticalAlign: 'bottom',\n                    align: 'left',\n                    padding: [0, 0, 15, 15],\n                    textStyle: {\n                        color: '#fff',\n                        fontSize: '14',\n                    }\n                },\n                data:  [],\n                inverse: true,\n            },\n                {\n                    //左侧柱状图的Y轴\n                    gridIndex: 0, //y轴所在的 grid 的索引\n                    splitLine: 'none',\n                    axisTick: 'none',\n                    axisLine: 'none',\n                    data:  [],\n                    inverse: true,\n                    axisLabel: {\n                        show: true,\n                        verticalAlign: 'bottom',\n                        align: 'right',\n                        padding: [0, 20, 15, 0],\n                        textStyle: {\n                            color: '#fff',\n                            fontSize: '16',\n                        },\n                        formatter: function(value) {\n                            return '{x|' + value + '}  {y|' + \"辆}\"\n                        },\n                        rich: {\n                            y: {\n                                color: '#befbff',\n                                fontSize: 16\n                            },\n                            x: {\n                                color: '#f6cf42',\n                                fontSize: 16\n                            }\n                        }\n                    }\n                },\n                {\n                    //左侧柱状图的Y轴\n                    gridIndex: 0, //y轴所在的 grid 的索引\n                    splitLine: 'none',\n                    axisTick: 'none',\n                    axisLine: 'none',\n                    data: []\n                }\n            ],\n            series: [\n                {\n                    name: '小型车',\n                    stack: '总量',\n                    type: 'bar',\n                    xAxisIndex: 0, //使用的 x 轴的 index，在单个图表实例中存在多个 x 轴的时候有用。\n                    yAxisIndex: 0, //使用的 y 轴的 index，在单个图表实例中存在多个 y轴的时候有用。\n                    barWidth: 15,\n                    z:2,\n                    label: {\n                        show: true,\n                        position: 'insideRight'\n                    },\n                    data: []\n                },\n                {\n                    name: '中型车',\n                    stack: '总量',\n                    type: 'bar',\n                    xAxisIndex: 0, //使用的 x 轴的 index，在单个图表实例中存在多个 x 轴的时候有用。\n                    yAxisIndex: 0, //使用的 y 轴的 index，在单个图表实例中存在多个 y轴的时候有用。\n                    barWidth: 15,\n                    z: 2,\n                    label: {\n                        show: true,\n                        position: 'insideRight'\n                    },\n                    data: []\n                },\n                {\n                    name: '大型车',\n                    stack: '总量',\n                    type: 'bar',\n                    xAxisIndex: 0, //使用的 x 轴的 index，在单个图表实例中存在多个 x 轴的时候有用。\n                    yAxisIndex: 0, //使用的 y 轴的 index，在单个图表实例中存在多个 y轴的时候有用。\n                    barWidth: 15,\n                    z:2,\n                    label: {\n                        show: true,\n                        position: 'insideRight'\n                    },\n                    data: []\n                },\n                {\n                    name: '特大型车',\n                    stack: '总量',\n                    type: 'bar',\n                    xAxisIndex: 0, //使用的 x 轴的 index，在单个图表实例中存在多个 x 轴的时候有用。\n                    yAxisIndex: 0, //使用的 y 轴的 index，在单个图表实例中存在多个 y轴的时候有用。\n                    barWidth: 15,\n                    z:2,\n                    label: {\n                        show: true,\n                        position: 'insideRight'\n                    },\n                    data: []\n                },\n                {\n                    name: '摩托车',\n                    stack: '总量',\n                    type: 'bar',\n                    xAxisIndex: 0, //使用的 x 轴的 index，在单个图表实例中存在多个 x 轴的时候有用。\n                    yAxisIndex: 0, //使用的 y 轴的 index，在单个图表实例中存在多个 y轴的时候有用。\n                    barWidth: 15,\n                    z:2,\n                    label: {\n                        show: true,\n                        position: 'insideRight'\n                    },\n                    data: []\n                },\n                {\n                    name: '外框',\n                    type: 'bar',\n                    xAxisIndex: 0, //使用的 x 轴的 index，在单个图表实例中存在多个 x 轴的时候有用。\n                    yAxisIndex: 2, //使用的 y 轴的 index，在单个图表实例中存在多个 y轴的时候有用。\n                    barGap: '-100%',\n                    data: [],\n                    barWidth: 15,\n                    itemStyle: {\n                        normal: {\n                            color: '#2d5271',\n                            barBorderRadius: 0,\n                        }\n                    },\n                    z: 0\n                }]\n        };\n        \n        \n        setInterval(function(){\n            let yAxisData = [];\n            let seriesData = [];\n            let small = [];\n            let middle = [];\n            let big = [];\n            let large = [];\n            let motor = [];\n            \n            let currentData = statData.slice(page * size, (page + 1) * size);\n            \n            $.each(currentData,function(idx,val){\n                for(let key in val){\n                    yAxisData.push(key);\n                    seriesData.push(val[key].total);\n                    small.push(val[key].small);\n                    middle.push(val[key].middle);\n                    big.push(val[key].big);\n                    large.push(val[key].large);\n                    motor.push(val[key].motor);\n                }\n            })\n\n            page = ++page % pages;\n\n            let maxLevel = Math.max(...seriesData);\n            let maxLevels = [maxLevel,maxLevel,maxLevel,maxLevel];\n            option.yAxis[0].data = yAxisData;\n            option.yAxis[1].data = seriesData;\n            option.series[0].data = small;\n            option.series[1].data = middle;\n            option.series[2].data = big;\n            option.series[3].data = large;\n            option.series[4].data = motor;\n            option.series[5].data = maxLevels;\n            \n            \n            myChart.setOption(option);\n            myChart.hideLoading();\n            \n        },5000)\n        \n        var index = 0; //播放所在下标\n        var mTime = setInterval(function() {\n            myChart.dispatchAction({\n                type: 'showTip',\n                seriesIndex: 0,\n                dataIndex: index\n                });\n            index++;\n            if(index > size) {\n                index = 0;\n            }\n        }, 1000);\n    }\n})\n\n/**\n * 参考了某位大牛的样例改的，忘记了他的gallery地址，\n * 感谢这位大哥^_^\n*/","html":"","externalScripts":"","updaterUID":"obd-o0g9jBjdwuMiVXfUf6jz6R5aqm27vF1","theme":"dark","layout":"","viewCount":4484,"userName":"w***i","commentCount":2,"starCount":15,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xufhUULjIG.png?v=1591346302672","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","tooltip"],"customTags":["码上生花"],"updaterUserName":"w***i"}}