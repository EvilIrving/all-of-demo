{"status":0,"data":{"cid":"xm_aUTfsq0","authorUid":"bd-3154358575","authorUserName":"a***5","title":"补单售后单占比统计图","description":"柱状图与饼图使用","latestVersion":10,"alwaysLatest":1,"createTime":"2019-09-07T03:59:35.000Z","lastUpdateTime":"2019-09-07T03:59:35.000Z","auth":2,"uid":"bd-3154358575","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":10,"parentVersion":9,"echartsVersion":"4.2.1","versionCreateTime":"2019-09-12T01:43:56.000Z","code":"var bTestData = [],\n    cTestData = [];\nfor (var i = 0; i < 12; i++) {\n    var stdCount = Math.random() * 100;\n    var totalCount = stdCount + Math.random() * 150;\n    bTestData.push([i, (stdCount / totalCount * 100.0).toFixed(2), stdCount.toFixed(0), totalCount.toFixed(0)]);\n}\nfor (var i = 0; i < 12; i++) {\n    var stdCount = Math.random() * 100;\n    var totalCount = stdCount + Math.random() * 150;\n    cTestData.push([i, (stdCount / totalCount * 100.0).toFixed(2), stdCount.toFixed(0), totalCount.toFixed(0)]);\n}\nvar resonArr = ['设计', '安装', '物流', '工厂'];\nvar bPieData = [];\nfor (var i = 0; i < resonArr.length; i++) {\n    bPieData.push({\n        name: resonArr[i],\n        // value: Math.round(Math.random() * 1000)\n        value: i % 2 ? Math.round(Math.random() * 1000) : 0\n    });\n}\nvar cPieData = [];\n\nfunction cp1() {\n    cPieData = [];\n    for (var i = 0; i < resonArr.length; i++) {\n        cPieData.push({\n            name: resonArr[i],\n            value: Math.round(Math.random() * 1000)\n        });\n    }\n    return cPieData;\n}\noption = {\n    title: [{\n        id: 'barTitle',\n        text: '2019年补单占比统计图',\n        x: 'center',\n        // textAlign: 'center'\n    }, {\n        id: 'pieTitle1',\n        text: '9月销售补单下单原因占比',\n        x: '25%',\n        y: '59%',\n        textAlign: 'center'\n    }, {\n        id: 'pieTitle2',\n        text: '9月售后补单下单原因占比',\n        x: '75%',\n        y: '59%',\n        textAlign: 'center'\n    }],\n    toolbox: {\n        feature: {\n            dataView: {\n                show: true,\n                readOnly: false\n            },\n            magicType: {\n                show: true,\n                type: ['line', 'bar']\n            },\n            restore: {\n                show: true\n            },\n            saveAsImage: {\n                show: true\n            }\n        }\n    },\n\n    tooltip: {\n        trigger: 'axis',\n        axisPointer: { // 坐标轴指示器，坐标轴触发有效\n            // type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'\n            type: 'cross',\n            crossStyle: {\n                color: '#999'\n            }\n        },\n        formatter: '柱状图专用'\n    },\n    // legend: {},\n    grid: {\n        bottom: '46%',\n        containLabel: false,\n        left: '50',\n        right: '30'\n    },\n    xAxis: [{\n        type: 'category',\n        data: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],\n        axisPointer: {\n            type: 'shadow'\n        }\n    }],\n    yAxis: {\n        type: 'value',\n        name: '单数',\n        // min: 0,\n        // max: 100,\n        // interval: 25,\n        axisLabel: {\n            formatter: '{value}'\n        }\n    },\n    series: [{\n        name: 'B单占比',\n        type: 'bar',\n        data: bTestData,\n        label: {\n            show: true,\n            position: 'top',\n            formatter: '{@[1]} %'\n        }\n    }, {\n        name: 'C单占比',\n        type: 'bar',\n        data: cTestData,\n        label: {\n            show: true,\n            position: 'top',\n            formatter: '{@[1]} %'\n        }\n    }, {\n        name: '销售补单下单原因占比',\n        type: 'pie',\n        radius: '28%',\n        center: ['25%', '83%'],\n        label: {\n            formatter: '{b}: {d}%'\n        },\n        data: bPieData,\n        tooltip: {\n            //饼图专用\n            trigger: 'item',\n            formatter: '饼图专用<br/>{a}/{b}/{c}/{d}'\n        }\n    }, {\n        name: '售后补单下单原因占比',\n        type: 'pie',\n        radius: '28%',\n        center: ['75%', '83%'],\n        label: {\n            formatter: '{b}:{c}单 {d}%'\n        },\n        data: cp1(),\n        tooltip: {\n            //饼图专用\n            trigger: 'item',\n            formatter: '饼图专用<br/>{a}/{b}/{c}/{d}'\n        }\n    }]\n};\n\nmyChart.getZr().on('click', params => {\n    console.log('点击zr');\n    const pointInPixel = [params.offsetX, params.offsetY];\n    if (myChart.containPixel('grid', pointInPixel)) {\n        let xIndex = myChart.convertFromPixel({\n            seriesIndex: 0\n        }, [params.offsetX, params.offsetY])[0];\n        /*事件处理代码书写位置*/\n        console.log(xIndex);\n        //这里可以根据X轴的索引来改变charts的数据显示\n        myChart.setOption({\n            title: [{\n                id: 'pieTitle1',\n                text: (xIndex + 1) + '月饼图1'\n            }, {\n                id: 'pieTitle2',\n                text: (xIndex + 1) + '月饼图2'\n            }],\n            series: {\n                name: '售后补单下单原因占比',\n                data: cp1()\n            }\n        });\n    }\n});\n//普通click只能相应系列元素的“点击”事件，\n//要对axisPointer进行鼠标事件监听，需要使用getZr(),另外处理\n// myChart.on('click',function(params){\n//   console.log(params);\n//   alert('点击了');\n// });\n// setInterval(function() {\n//     myChart.setOption({\n//         title: [{\n//             id: 'pieTitle1',\n//             text: '饼图1'\n//         }, {\n//             id: 'pieTitle2',\n//             text: '饼图2'\n//         }],\n//         series:{\n//              name: '售后补单下单原因占比',\n//              data: cp1()\n//         }\n//     });\n// }, 3000);","html":"","externalScripts":"","updaterUID":"bd-3154358575","theme":"","layout":"","viewCount":254,"userName":"a***5","commentCount":0,"starCount":4,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xm_aUTfsq0.png?v=1568252636728","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-bar","series-pie","title","toolbox","tooltip"],"customTags":["pie"],"updaterUserName":"a***5"}}