{"status":0,"data":{"cid":"xxmoMHPN2Z","authorUid":"bd-2302755999","authorUserName":"159*****209","title":"指标下钻","description":"月指标查询日指标或者特征值","latestVersion":1,"alwaysLatest":1,"createTime":"2019-01-22T04:42:10.000Z","lastUpdateTime":"2019-01-22T04:42:10.000Z","auth":2,"uid":"bd-2302755999","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.2.0","versionCreateTime":"2019-01-22T04:42:10.000Z","code":"var now = new Date(),\n    data = [],\n    mark = {\n        sj: [{\n            name: \"暑假\",\n            xAxis: '',\n            itemStyle: {\n                borderWidth: 0\n            }\n        }, {\n            xAxis: ''\n        }],\n        wy: [{\n            name: \"五一\",\n            xAxis: ''\n        }, {\n            xAxis: ''\n        }],\n\n    },\n    markArea = [];\nfor (var i = 0; i < 12; i++) {\n    var year = now.getFullYear();\n    var month = (now.getMonth() + 1) - i;\n    var time = new Date(year, month, 0);\n    var text = [time.getFullYear(), (time.getMonth() + 1), time.getDate()];\n    if (7 == text[1]) {\n        mark.sj[0].xAxis = text.join('/');\n    }\n    if (9 == text[1]) {\n        mark.sj[1].xAxis = text.join('/')\n    }\n    if (5 == text[1]) {\n        mark.wy[0].xAxis = text.join('/')\n        mark.wy[1].xAxis = text.join('/')\n    }\n    var val = Math.random() * 500;\n    data.push([text.join('/'), val]);\n}\nObject.keys(mark).map(function(v) {\n    markArea.push(mark[v]);\n\n})\n\nvar subData = {\n    \"暑假\": {\n        dates: []\n    },\n    \"五一\": {\n        dates: []\n    }\n};\nvar s = mark.sj[0].xAxis,\n    e = mark.sj[0].xAxis;\nvar date = new Date(s),\n    endDate = new Date(e);\ndate.setDate(1);\nvar dateDiff = endDate.getTime() - date.getTime();\ndayDiff = Math.floor(dateDiff / (24 * 3600 * 1000));\nvar dates = subData[\"暑假\"].dates,\n    y = date.getFullYear(),\n    m = date.getMonth() + 1,\n    day = date.getDate();\nfor (var i = 0; i < dayDiff; i++) {\n    var time = new Date(y, m, (day + i))\n    var text = [time.getFullYear(), (time.getMonth() + 1), time.getDate()];\n    dates.push(text.join('/'));\n}\nvar _data = [];\ndates.map(function(d) {\n    _data.push([d, Math.random() * 100]);\n})\nsubData[\"暑假\"].data = _data;\noption = {\n    grid: [{\n        top: '10%'\n    }, {\n\n        bottom: '60%'\n    }],\n    title: {\n        text: '指标下钻'\n    },\n    xAxis: [{\n        gridIndex: 0,\n        type: \"time\",\n        axisLabel: {\n            formatter: function(value, index) {\n                // 格式化成月/日，只在第一个刻度显示年份\n                var date = new Date(value);\n                var texts = [date.getFullYear(), (date.getMonth() + 1)];\n                return texts.join('-');\n            }\n        },\n        boundaryGap: [0, '100%']\n    }, {\n        gridIndex: 1,\n        type: \"time\",\n        show: false,\n        axisLabel: {\n            formatter: function(value, index) {\n                // 格式化成月/日，只在第一个刻度显示年份\n                var date = new Date(value);\n                var texts = [date.getFullYear(), (date.getMonth() + 1)];\n                var texts = [date.getFullYear(), (date.getMonth() + 1), date.getDate()];\n                return texts.join('-');\n            }\n        },\n        boundaryGap: [0, '100%']\n    }],\n    yAxis: [{\n        gridIndex: 0\n    }, {\n        gridIndex: 1,\n        show: false\n    }],\n    series: [{\n        gridIndex: 0,\n        type: 'line',\n        data: data,\n        markArea: {\n            itemStyle: {\n                borderWidth: 2\n            },\n            data: markArea\n        }\n\n    }, {\n        type: 'line',\n        xAxisIndex: 1,\n        yAxisIndex: 1,\n        data: []\n    }]\n};\n\nmyChart.on(\"click\", function(params) {\n    var isMark = (params.componentType == 'markArea');\n    if (isMark) {\n        var selected = markArea[0][0].selected;\n        if (typeof markArea[0][0].selected == \"undefined\") {\n            selected = false\n        } else {\n            selected = markArea[0][0].selected\n        }\n        selected = !selected;\n        markArea[0][0].selected = selected;\n        if (selected) {\n            option.grid[0].top = \"55%\";\n            option.xAxis[1].show = true;\n            option.yAxis[1].show = true;\n            option.series[1].data = subData[\"暑假\"].data;\n        } else {\n            option.grid[0].top = \"10%\";\n            option.xAxis[1].show = false;\n            option.yAxis[1].show = false;\n            option.series[1].data = []\n        }\n\n        myChart.setOption(option);\n    }\n})","html":"","externalScripts":"","updaterUID":"bd-2302755999","theme":"","layout":"","viewCount":361,"userName":"159*****209","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xxmoMHPN2Z.png?v=1548132130774","isCustomThumbnail":0,"builtinTags":["category-work","grid","markArea","series-line","title"],"customTags":[],"updaterUserName":"159*****209"}}