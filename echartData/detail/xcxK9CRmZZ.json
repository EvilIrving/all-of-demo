{"status":0,"data":{"cid":"xcxK9CRmZZ","authorUid":"bd-3205003534","authorUserName":"xiaoniaozhijia","title":"中国新一线城市房价","description":"房价和工资","latestVersion":4,"alwaysLatest":1,"createTime":"2019-03-29T07:39:02.000Z","lastUpdateTime":"2019-03-29T07:39:02.000Z","auth":2,"uid":"bd-3205003534","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":4,"parentVersion":3,"echartsVersion":"4.2.1","versionCreateTime":"2019-03-30T03:26:37.000Z","code":"// 一线城市\r\n// var title_n = '一线城市房价与工资（2018年第一季度）';\r\n// var geoCoordMap = {\r\n//     '深圳': [114.07, 22.62], \r\n//     '广州': [112.23, 23.16], \r\n//     '北京': [116.46, 39.92], \r\n//     '上海': [121.48, 31.22]\r\n// };\r\n// //城市最新房价数据，爬取自安居客网站\r\n// var rawData = {\r\n//     '深圳': [49592, 9030],\r\n//     '广州': [28299, 8007],\r\n//     '北京': [56465, 10310],\r\n//     '上海': [51475, 9655]\r\n// };\r\n\r\n// 新一线城市\r\nvar title_n = '新一线城市房价与工资（2018年第一季度）';\r\nvar geoCoordMap = {\r\n    '天津': [117.2, 39.13],\r\n    '杭州': [120.19, 30.26],\r\n    '成都': [104.06, 30.67],\r\n    '东莞': [113.75, 23.04],\r\n    '沈阳': [123.38, 41.8],\r\n    '南京': [118.78, 32.04],\r\n    '苏州': [120.62, 31.32],\r\n    '无锡': [120.29, 31.59],\r\n    '青岛': [120.33, 36.07],\r\n    '郑州': [113.65, 34.76],\r\n    '武汉': [114.31, 30.52],\r\n    '宁波': [121.56, 29.86],\r\n    '长沙': [113.0, 28.21],\r\n    '重庆': [106.54, 29.59],\r\n    '西安': [108.95, 34.27]\r\n};\r\n//城市最新房价数据，爬取自安居客网站\r\nvar rawData = {\r\n    '天津': [21604, 6978],\r\n    '杭州': [21420, 8434],\r\n    '成都': [12580, 7185],\r\n    '东莞': [14083, 8023],\r\n    '沈阳': [8060, 6173],\r\n    '南京': [25764, 7616],\r\n    '苏州': [15588, 7450],\r\n    '无锡': [9627, 7154],\r\n    '青岛': [19226, 6787],\r\n    '郑州': [12748, 6815],\r\n    '武汉': [16306, 7266],\r\n    '宁波': [17434, 8062],\r\n    '长沙': [9968, 7048],\r\n    '重庆': [7242, 7348],\r\n    '西安': [9235, 6393]\r\n};\r\n\r\n\r\nfunction makeMapData(rawData) {\r\n    var mapData = [];\r\n    for (var i = 0; i < rawData.length; i++) {\r\n        var geoCoord = geoCoordMap[rawData[i][0]];\r\n        if (geoCoord) {\r\n            mapData.push({\r\n                name: rawData[i][0],\r\n                value: geoCoord.concat(rawData[i].slice(1))\r\n            });\r\n        }\r\n    }\r\n    return mapData;\r\n};\r\n\r\noption = {\r\n    animation: false,\r\n    // 背景颜色\r\n    backgroundColor: '#eee',\r\n    title:{\r\n    \t        text: title_n,\r\n    \t        subtext: '红色为房价，黄色为平均工资',\r\n    \t        left: 'center',\r\n    \t        textStyle : {\r\n    \t            color: '#000'\r\n    \t        }\r\n    },\r\n    geo: {\r\n        scaleLimit: {\r\n            min: 1,\r\n            max: 1\r\n        },\r\n        map: 'china',\r\n        // silent: true,\r\n        roam: true,\r\n        zoom: 1.155, // 地图初始大小\r\n        center: [102.925798, 35.296079], // 初始中心位置\r\n        label: {\r\n\r\n            emphasis: {\r\n                show: true,\r\n                areaColor: '#75a8f9'\r\n            }\r\n        },\r\n\r\n        // 地区块儿颜色\r\n        itemStyle: {\r\n            normal: {\r\n\r\n                borderColor: '#05dcd9',\r\n                borderWidth: 1,\r\n                // shadowColor: '#ffffff',\r\n                // shadowBlur: 10,\r\n                areaColor: '#929499',\r\n            },\r\n            emphasis: {\r\n                show: true,\r\n                areaColor: '#5e97f2'\r\n            }\r\n        }\r\n    },\r\n\r\n    series: []\r\n};\r\n\r\nfunction renderEachCity() {\r\n    var option = {\r\n        xAxis: [],\r\n        yAxis: [],\r\n        grid: [],\r\n\r\n        series: []\r\n    };\r\n\r\n    echarts.util.each(rawData, function(dataItem, idx) {\r\n        // console.log('dataItem, idx',dataItem, idx)\r\n        //geoCoord 经纬度\r\n        var geoCoord = geoCoordMap[idx];\r\n        var coord = myChart.convertToPixel('geo', geoCoord);\r\n        var bar_height = rawData[idx]\r\n\r\n        idx += '';\r\n\r\n        inflationData = dataItem;\r\n\r\n        option.xAxis.push({\r\n            id: idx,\r\n            gridId: idx,\r\n            type: 'category',\r\n            name: idx,\r\n\r\n            nameLocation: 'middle',\r\n            nameGap: 3,\r\n            splitLine: {\r\n                show: false\r\n            },\r\n            axisTick: {\r\n                show: false\r\n            },\r\n            axisLabel: {\r\n                show: false\r\n            },\r\n            axisLine: {\r\n                onZero: false,\r\n                lineStyle: {\r\n                    color: '#000',\r\n                    width: 1\r\n                }\r\n            },\r\n            // data: xAxisCategory,\r\n            data: [\"数据A\", '数据B'],\r\n            z: 100\r\n\r\n        });\r\n\r\n\r\n        option.yAxis.push({\r\n            id: idx,\r\n            gridId: idx,\r\n            splitLine: {\r\n                show: false\r\n            },\r\n            axisTick: {\r\n                show: false\r\n            },\r\n            axisLabel: {\r\n                show: false\r\n            },\r\n            axisLine: {\r\n                show: false,\r\n                lineStyle: {\r\n                    color: '#1C70B6'\r\n                }\r\n            },\r\n            z: 100\r\n        });\r\n        option.grid.push({\r\n            id: idx,\r\n            width: 30,\r\n            height: bar_height[0] * 0.001,\r\n            left: coord[0],\r\n            top: coord[1] + 5 - bar_height[0] * 0.001,\r\n            z: 100\r\n        });\r\n        option.series.push({\r\n            id: idx,\r\n            type: 'bar',\r\n            xAxisId: idx,\r\n            yAxisId: idx,\r\n            barGap: 0,\r\n            barCategoryGap: 0,\r\n            // data: inflationData,\r\n            data: inflationData,\r\n            z: 100,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: function(params) {\r\n                        // 柱状图每根柱子颜色\r\n                        var colorList = ['red', 'yellow', '#15e178'];\r\n                        return colorList[params.dataIndex];\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    });\r\n    // console.time('a');\r\n    myChart.setOption(option);\r\n    // console.timeEnd('a');\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nsetTimeout(renderEachCity, 0);\r\n// 缩放和拖拽\r\nfunction throttle(fn, delay, debounce) {\r\n\r\n    var currCall;\r\n    var lastCall = 0;\r\n    var lastExec = 0;\r\n    var timer = null;\r\n    var diff;\r\n    var scope;\r\n    var args;\r\n\r\n    delay = delay || 0;\r\n\r\n    function exec() {\r\n        lastExec = (new Date()).getTime();\r\n        timer = null;\r\n        fn.apply(scope, args || []);\r\n    }\r\n\r\n    var cb = function() {\r\n        currCall = (new Date()).getTime();\r\n        scope = this;\r\n        args = arguments;\r\n        diff = currCall - (debounce ? lastCall : lastExec) - delay;\r\n\r\n        clearTimeout(timer);\r\n\r\n        if (debounce) {\r\n            timer = setTimeout(exec, delay);\r\n        } else {\r\n            if (diff >= 0) {\r\n                exec();\r\n            } else {\r\n                timer = setTimeout(exec, -diff);\r\n            }\r\n        }\r\n\r\n        lastCall = currCall;\r\n    };\r\n\r\n    return cb;\r\n}\r\n\r\nvar throttledRenderEachCity = throttle(renderEachCity, 0);\r\n\r\n// // 点击显示柱状图\r\nmyChart.on('click', function(e) {\r\n    console.log('点击显示柱状图', e)\r\n\r\n\r\n    if (e.seriesId) {\r\n        console.log('图表', e.seriesId)\r\n    } else {\r\n        console.log('地图', e.region.name)\r\n\r\n    }\r\n\r\n    // if(e.componentSubType == \"bar\"){\r\n    //     // 先清除所有柱状图\r\n    $('.tongJiTu').remove();\r\n\r\n\r\n\r\n\r\n    // }\r\n    return;\r\n});","html":"","externalScripts":"/dep/echarts/map/js/china.js","updaterUID":"bd-3205003534","theme":"","layout":"","viewCount":794,"userName":"xiaoniaozhijia","commentCount":0,"starCount":4,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xcxK9CRmZZ.png?v=1553916397546","isCustomThumbnail":0,"builtinTags":["category-work","geo","grid","series-bar","title"],"customTags":[],"updaterUserName":"xiaoniaozhijia"}}