{"status":0,"data":{"cid":"xS1WSRv43M","authorUid":"bd-387531609","authorUserName":"walle_zhang","title":"各城市占比","description":"主要解决柱状图带背景，但是数据又已背景定位且label颜色又必须和柱子颜色一样。","latestVersion":1,"alwaysLatest":1,"createTime":"2018-04-18T07:05:29.000Z","lastUpdateTime":"2018-04-18T07:05:29.000Z","auth":2,"uid":"bd-387531609","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.0.4","versionCreateTime":"2018-04-18T07:05:29.000Z","code":" const baifenbi = [0.111, 0.333, 0.444, 0.222, 0.333, 0.333, 0.46];\r\n const bgBar = [1, 1, 1, 1, 1, 1, 1];\r\n const _baifenbi = [];\r\n const colors = ['#11D0A8', '#FF9F01', '#781414', '#03A6AB', '#E8B47B', '#F54323', '#D011C9']\r\n const city = ['北京', '上海', '西安', '广州', '深圳', '重庆', '武汉'];\r\n const richs = {};\r\n //定义富文本样式，为了匹配label字体的样式\r\n city.forEach((ele, i) => {\r\n     let a = 'a' + i\r\n     richs[a] = {\r\n         color: colors[i],\r\n         fontSize: 15,\r\n     }\r\n })\r\n console.log(richs)\r\n baifenbi.forEach((ele, i) => {\r\n     _baifenbi.push({\r\n         name: city[i],\r\n         value: ele,\r\n         itemStyle: {\r\n             normal: {\r\n                 color: colors[i]\r\n             }\r\n         }\r\n     })\r\n })\r\n option = {\r\n     title: {\r\n         text: '各城市占比',\r\n         left: 'left',\r\n         top: '0%',\r\n         textStyle: {\r\n             fontSize: 20,\r\n         }\r\n     },\r\n     grid: {\r\n         left: '2%',\r\n         bottom: '2%',\r\n         right: '5%',\r\n         top: '7%',\r\n     },\r\n     xAxis: {\r\n         show: false,\r\n     },\r\n     yAxis: {\r\n         type: 'category',\r\n         axisLabel: {\r\n             show: false, //让Y轴数据不显示\r\n         },\r\n         itemStyle: {\r\n\r\n         },\r\n         axisTick: {\r\n             show: false, //隐藏Y轴刻度\r\n         },\r\n         axisLine: {\r\n             show: false, //隐藏Y轴线段\r\n         },\r\n         data: city,\r\n     },\r\n     series: [\r\n         //背景色--------------------我是分割线君------------------------------//\r\n         {\r\n             show: true,\r\n             type: 'bar',\r\n             barGap: '-100%', //两列柱子都设置成-100%可以保证他们重合\r\n             barCategoryGap: '50%',\r\n             barWidth: 30, //统计条宽度 \r\n             itemStyle: {\r\n                 normal: {\r\n                     color: 'rgba(14, 26, 36,1)'\r\n                 },\r\n             },\r\n             z: 1,\r\n             data: bgBar,\r\n             label: {\r\n                 normal: {\r\n                     show: true,\r\n                     position: 'insideRight',\r\n                     //这种用HTML样式的方法不行\r\n                     // formatter: function(data) {\r\n                     //     // console.log(\"bg\",data)\r\n                     //     // console.log(option.series[1].data)\r\n                     //     const series1 = option.series[1].data;\r\n                     //     let str = \"\"\r\n                     //     series1.forEach(ele => {\r\n                     //         if(ele.name===data.name){\r\n                     //             const aa = '#d011c9'\r\n                     //             str+='<div style=\"color:\\''+aa+'\\'\">'\r\n                     //             // str+=\"<div style='color:'\"+ele.itemStyle.normal.color+\"'\"+\">\"\r\n                     //             str+=  data.name+'  '+(baifenbi[data.dataIndex] * 100).toFixed(1) + '%';\r\n                     //         }\r\n\r\n                     //     });\r\n                     //     str+=\"</div>\"\r\n                     //     console.log(str)\r\n                     //     return str;\r\n                     //     // return data.name+'  '+(baifenbi[data.dataIndex] * 100).toFixed(1) + '%'\r\n                     // },\r\n                     //为了让label用背景色去定位，且label字体颜色必须和柱子颜色一样\r\n                     formatter: function(data) {\r\n                         const series1 = option.series[1].data;\r\n                         let str = \"\"\r\n                         series1.forEach((ele, i) => {\r\n                             if (ele.name === data.name) {\r\n                                 let aa = \"a\" + i\r\n                                 str += '{' + aa + '| ' + data.name + '  ' + (baifenbi[data.dataIndex] * 100).toFixed(1) + '%' + '}';\r\n                             }\r\n\r\n                         });\r\n                         return str;\r\n                     },\r\n                     rich: richs\r\n                 }\r\n             },\r\n         },\r\n         //蓝条--------------------我是分割线君------------------------------//\r\n         {\r\n             show: true,\r\n             type: 'bar',\r\n             barGap: '-100%',\r\n             barCategoryGap: '50%',\r\n             barWidth: 30, //统计条宽度\r\n             max: 1,\r\n             labelLine: {\r\n                 show: false,\r\n             },\r\n             z: 2,\r\n             data: _baifenbi,\r\n         },\r\n     ]\r\n }","html":"","externalScripts":"","updaterUID":"bd-387531609","theme":"","layout":"","viewCount":143,"userName":"walle_zhang","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xS1WSRv43M.png?v=1524035129310","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-bar","title"],"customTags":[],"updaterUserName":"walle_zhang"}}