{"status":0,"data":{"cid":"x_4Io_XMvE","authorUid":"bd-1277561159","authorUserName":"执***开","title":"仪表盘速度图","description":"","latestVersion":2,"alwaysLatest":1,"createTime":"2019-05-24T07:39:53.000Z","lastUpdateTime":"2019-05-24T07:39:53.000Z","auth":2,"uid":"bd-1277561159","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.2.1","versionCreateTime":"2019-07-24T01:13:07.000Z","code":"var bg = \"/asset/get/s/data-1558682977554-T9P2HTfDR.png\";\r\n\r\nvar ma = \"/asset/get/s/data-1557476825388-EOu-7uwpi.png\";\r\n\r\nvar tu = \"/asset/get/s/data-1557476829205-pC1W8Hc32.png\";\r\n\r\nvar wugui = \"/asset/get/s/data-1557476832002-bIcP0vhB2.png\";\r\n\r\nlet data = [{\r\n        \"name\": \"A\",\r\n        \"speed\": 100\r\n    },\r\n    {\r\n        \"name\": \"C\",\r\n        \"speed\": 268\r\n    }\r\n]\r\nconst canvas = document.querySelector('#chart-panel')\r\ncanvas.style.background = 'url(\"' + bg + '\") no-repeat'\r\ncanvas.style.backgroundPositionX = 'center'\r\ncanvas.style.backgroundPositionY = 'center'\r\ncanvas.style.backgroundSize = '490px'\r\nconst [left, right] = data\r\nsetInterval(function() {\r\n    data.map(v=>{\r\n        v.speed = (Math.random()*268).toFixed(0)\r\n    })\r\n    option = {\r\n    series: [{\r\n            name: 'left',\r\n            type: 'gauge',\r\n            center: ['50%', '50%'],\r\n            radius: '87%',\r\n            startAngle: 268,\r\n            // 防止一个0和一个1时全部填满红色，全部为268时没有间隔\r\n            endAngle: 268 - 176 * (left.speed / 268),\r\n            splitNumber: -1,\r\n            z: 5,\r\n            min: 0,\r\n            max: 268,\r\n            axisTick: {\r\n                show: false\r\n            },\r\n            markLine: {\r\n                symbol: 'none',\r\n                lineStyle: {\r\n                    type: 'solid'\r\n                },\r\n                symbolSize: 25,\r\n                data: [\r\n                    [{\r\n                            x: '50%',\r\n                            y: '32.5%',\r\n                            lineStyle: {\r\n                                width: 1,\r\n                                color: '#d1d1d1'\r\n                            }\r\n                        },\r\n                        {\r\n                            x: '50%',\r\n                            y: '67.5%'\r\n                        }\r\n                    ]\r\n                ]\r\n            },\r\n            splitLine: {\r\n                show: false\r\n            },\r\n            axisLine: {\r\n                show: false, // 坐标轴线\r\n                lineStyle: {\r\n                    // 属性lineStyle控制线条样式\r\n                    width: 26,\r\n                    color: [\r\n                        [268, getColorBySpeed(left.speed)]\r\n                    ],\r\n                    shadowColor: '#e9e9e9'\r\n                }\r\n            },\r\n            pointer: {\r\n                show: false\r\n            },\r\n            title: getTitleStyleObj(true, left.speed),\r\n            detail: getDetailStyleObj(true, left.speed),\r\n            data: [{\r\n                value: left.speed,\r\n                name: left.name\r\n            }]\r\n        },\r\n        {\r\n            name: 'right',\r\n            type: 'gauge',\r\n            center: ['50%', '50%'],\r\n            startAngle: 450 - 180 * ((268 - right.speed) / 268),\r\n            endAngle: 270,\r\n            z: 5,\r\n            splitNumber: -1,\r\n            min: 268,\r\n            max: 0,\r\n            radius: '87%',\r\n            axisLine: {\r\n                show: false, // 坐标轴线\r\n                lineStyle: {\r\n                    // 属性lineStyle控制线条样式\r\n                    width: 26,\r\n                    color: [\r\n                        [268, getColorBySpeed(right.speed)]\r\n                    ],\r\n                    shadowColor: '#e9e9e9'\r\n                }\r\n            },\r\n            splitLine: {\r\n                show: false\r\n            },\r\n            data: [{\r\n                value: right.speed,\r\n                name: right.name\r\n            }],\r\n            axisTick: {\r\n                show: false\r\n            },\r\n            pointer: {\r\n                show: false\r\n            },\r\n            title: getTitleStyleObj(false, right.speed),\r\n            detail: getDetailStyleObj(false, right.speed)\r\n        }\r\n    ]\r\n}\r\n    myChart.setOption(option);\r\n}, 1000);\r\n\r\n\r\nfunction getDetailStyleObj(isLeft, speed) {\r\n    const title = data[isLeft ? 0 : 1].name\r\n    return {\r\n        fontFamily: 'PingFang SC Regular',\r\n        color: getTextColorBySpeed(speed),\r\n        offsetCenter: [isLeft ? '-40%' : '40%', '15%'],\r\n        formatter: function(paramas) {\r\n            return '{number|' + paramas + '}{speed|m/m}' + '\\n\\n' + '{title| ' + title + '}'\r\n        },\r\n        width: 193 / 4,\r\n        height: 235 / 4,\r\n        rich: {\r\n            number: {\r\n                fontSize: 40,\r\n                color: getTextColorBySpeed(speed)\r\n            },\r\n            speed: {\r\n                fontSize: 25,\r\n                color: '#333'\r\n            },\r\n            title: {\r\n                fontSize: 40,\r\n                color: '#333'\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction getTitleStyleObj(isLeft, speed) {\r\n    const image = speed < 170 ? wugui : speed < 186 ? tu : ma\r\n    return {\r\n        fontFamily: 'PingFang SC Regular',\r\n        fontSize: 40,\r\n        color: 'transparent',\r\n        offsetCenter: [isLeft ? '-40%' : '40%', '-25%'],\r\n        formatter: '2',\r\n        rich: {},\r\n        width: 400 / 3,\r\n        height: 260 / 3,\r\n        backgroundColor: {\r\n            image: image\r\n        }\r\n    }\r\n}\r\n\r\nfunction getColorBySpeed(speed) {\r\n    if (speed < 170) {\r\n        return new echarts.graphic.LinearGradient(0, 0, 1, 0, [{\r\n            offset: 0,\r\n            color: '#eb3349'\r\n        }, {\r\n            offset: 1,\r\n            color: '#ea162c'\r\n        }], false)\r\n    } else if (speed < 186) {\r\n        return new echarts.graphic.LinearGradient(0, 0, 1, 0, [{\r\n            offset: 0,\r\n            color: '#27e164'\r\n        }, {\r\n            offset: 1,\r\n            color: '#20c556'\r\n        }], false)\r\n    } else if (speed > 185) {\r\n        return new echarts.graphic.LinearGradient(0, 0, 1, 0, [{\r\n            offset: 0,\r\n            color: '#509aff'\r\n        }, {\r\n            offset: 1,\r\n            color: '#387bd6'\r\n        }], false)\r\n    }\r\n}\r\n\r\nfunction getTextColorBySpeed(speed) {\r\n    if (speed < 170) {\r\n        return '#f81129'\r\n    } else if (speed < 186) {\r\n        return '#0dd64f'\r\n    } else if (speed > 185) {\r\n        return '#5095f3'\r\n    }\r\n}","html":"","externalScripts":"","updaterUID":"bd-1277561159","theme":"","layout":"","viewCount":3048,"userName":"执***开","commentCount":0,"starCount":35,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x_4Io_XMvE.png?v=1563930787475","isCustomThumbnail":0,"builtinTags":["category-work","markLine","series-gauge"],"customTags":[],"updaterUserName":"执***开"}}