{"status":0,"data":{"cid":"xByi473iZz","authorUid":"bd-1177841325","authorUserName":"i***o","title":"测试2","description":"测试2","latestVersion":1,"alwaysLatest":1,"createTime":"2017-12-11T07:26:43.000Z","lastUpdateTime":"2017-12-11T07:26:43.000Z","auth":2,"uid":"bd-1177841325","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"3.8.0","versionCreateTime":"2017-12-11T07:26:43.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1482909900836-H1BC_1WHg.json\";\r\nmyChart.showLoading();\r\n$.getJSON(uploadedDataURL, function(geoJson) {\r\n    echarts.registerMap('shanghai', geoJson);\r\n    myChart.hideLoading();\r\n    var geoCoordMap = {\r\n        '黄浦区': [121.490317, 31.222771],\r\n        '徐汇区': [121.43752, 31.179973],\r\n        '长宁区': [121.4222, 31.218123],\r\n        '静安区': [121.448224, 31.229003],\r\n        '普陀区': [121.392499, 31.241701],\r\n        '闸北区': [121.465689, 31.25318],\r\n        '虹口区': [121.491832, 31.26097],\r\n        '杨浦区': [121.522797, 31.270755],\r\n        '闵行区': [121.375972, 31.111658],\r\n        '宝山区': [121.489934, 31.398896],\r\n        '嘉定区': [121.250333, 31.383524],\r\n        '浦东新区': [121.567706, 31.245944],\r\n        '金山区': [121.330736, 30.724697],\r\n        '松江区': [121.223543, 31.03047],\r\n        '青浦区': [121.113021, 31.151209],\r\n        '奉贤区': [121.458472, 30.912345],\r\n        '崇明县': [121.397516, 31.626946],\r\n    }\r\n    var data = [{\r\n        name: '黄浦区',\r\n        value: 219\r\n    }, {\r\n        name: '徐汇区',\r\n        value: 339\r\n    }, {\r\n        name: '长宁区',\r\n        value: 412\r\n    }, {\r\n        name: '静安区',\r\n        value: 429\r\n    }, {\r\n        name: '普陀区',\r\n        value: 389\r\n    }, {\r\n        name: '闸北区',\r\n        value: 352\r\n    }, {\r\n        name: '虹口区',\r\n        value: 329\r\n    }, {\r\n        name: '杨浦区',\r\n        value: 532\r\n    }, {\r\n        name: '闵行区',\r\n        value: 299\r\n    }, {\r\n        name: '宝山区',\r\n        value: 139\r\n    }, {\r\n        name: '嘉定区',\r\n        value: 440\r\n    }, {\r\n        name: '浦东新区',\r\n        value: 89\r\n    }, {\r\n        name: '金山区',\r\n        value: 652\r\n    }, {\r\n        name: '松江区',\r\n        value: 415\r\n    }, {\r\n        name: '青浦区',\r\n        value: 329\r\n    }, {\r\n        name: '奉贤区',\r\n        value: 752\r\n    }, {\r\n        name: '崇明县',\r\n        value: 399\r\n    }, ];\r\n    var max = 1000,\r\n        min = 0; // todo \r\n    var maxSize4Pin = 100,\r\n        minSize4Pin = 0;\r\n\r\n    var convertData = function(data) {\r\n        var res = [];\r\n        for (var i = 0; i < data.length; i++) {\r\n            var geoCoord = geoCoordMap[data[i].name];\r\n            if (geoCoord) {\r\n                res.push({\r\n                    name: data[i].name,\r\n                    value: geoCoord.concat(data[i].value)\r\n                });\r\n            }\r\n        }\r\n        return res;\r\n    };\r\n\r\n\r\n    option = {\r\n        backgroundColor: '#0f0c29',\r\n        title: {\r\n            text: '上海',\r\n            subtext: 'data from Map',\r\n            x: 'left',\r\n            textStyle: {\r\n                color: '#ccc'\r\n            }\r\n        },\r\n        tooltip: {\r\n            trigger: 'item',\r\n            backgroundColor: 'rgba(12, 204, 104, 0.92)',\r\n            borderColor: '#FFFFCC',\r\n            showDelay: 0,\r\n            hideDelay: 0,\r\n            enterable: true,\r\n            transitionDuration: 0,\r\n            extraCssText: 'z-index:100',\r\n            formatter: function(params, ticket, callback) {\r\n                //根据业务自己拓展要显示的内容\r\n                var res = \"\";\r\n                var name = params.name;\r\n                var value = params.value;\r\n                res = \"<span style='color:#fff;'>\" + name + \"</span><br/>数据：\" + value;\r\n                return res;\r\n            }\r\n        },\r\n        legend: {\r\n            orient: 'vertical',\r\n            y: 'bottom',\r\n            x: 'right',\r\n            data: ['credit_pm2.5'],\r\n            textStyle: {\r\n                color: '#fff'\r\n            }\r\n        },\r\n        visualMap: {\r\n            show: true,\r\n            min: 0,\r\n            max: 1000,\r\n            left: 'left',\r\n            top: 'bottom',\r\n            text: ['高', '低'], // 文本，默认为数值文本\r\n            calculable: true,\r\n            seriesIndex: [1],\r\n            dimension: 0,\r\n            inRange: {\r\n                color: ['#0f0c29', '#302b63', '#24243e'] // 黑紫黑\r\n\r\n            },\r\n            textStyle: {\r\n                color: '#fff'\r\n            }\r\n        },\r\n        geo: {\r\n            map: 'shanghai',\r\n            label: {\r\n                emphasis: {\r\n                    show: false\r\n                }\r\n            },\r\n            roam: true, //是否允许缩放\r\n            layoutCenter: ['50%', '50%'], //地图位置\r\n            layoutSize: \"95%\",\r\n            itemStyle: {\r\n                normal: {\r\n                    color: 'rgba(51, 69, 89, .5)', //地图背景色\r\n                    borderColor: 'rgba(100,149,237,1)' //省市边界线\r\n                },\r\n                emphasis: {\r\n                    color: 'rgba(37, 43, 61, .5)' //悬浮背景\r\n                }\r\n            }\r\n        },\r\n        series: [{\r\n                name: 'credit_pm2.5',\r\n                type: 'scatter',\r\n                coordinateSystem: 'geo',\r\n                data: convertData(data),\r\n                symbolSize: function(val) {\r\n                    return val[2] / 30;\r\n                },\r\n                label: {\r\n                    normal: {\r\n                        formatter: '{b}',\r\n                        position: 'right',\r\n                        show: true\r\n                    },\r\n                    emphasis: {\r\n                        show: true\r\n                    }\r\n                },\r\n                itemStyle: {\r\n                    normal: {\r\n                        color: '#05C3F9'\r\n                    }\r\n                }\r\n            }, {\r\n                type: 'map',\r\n                map: 'shanghai',\r\n                geoIndex: 0,\r\n                aspectScale: 0.75, //长宽比\r\n                showLegendSymbol: false, // 存在legend时显示\r\n                label: {\r\n                    normal: {\r\n                        show: false\r\n                    },\r\n                    emphasis: {\r\n                        show: false,\r\n                        textStyle: {\r\n                            color: '#fff'\r\n                        }\r\n                    }\r\n                },\r\n                roam: true,\r\n                itemStyle: {\r\n                    normal: {\r\n                        areaColor: '#031525',\r\n                        borderColor: '#3B5077',\r\n                    },\r\n                    emphasis: {\r\n                        areaColor: '#2B91B7'\r\n                    }\r\n                },\r\n                animation: false,\r\n                data: data\r\n            }, {\r\n                name: '前五名',\r\n                type: 'effectScatter',\r\n                coordinateSystem: 'geo',\r\n                data: convertData(data.sort(function(a, b) {\r\n                    return b.value - a.value;\r\n                }).slice(0, 5)),\r\n                symbolSize: function(val) {\r\n                    return val[2] / 30;\r\n                },\r\n                showEffectOn: 'render',\r\n                rippleEffect: {\r\n                    brushType: 'stroke'\r\n                },\r\n                hoverAnimation: true,\r\n                label: {\r\n                    normal: {\r\n                        formatter: '{b}',\r\n                        position: 'right',\r\n                        show: true\r\n                    }\r\n                },\r\n                itemStyle: {\r\n                    normal: {\r\n                        color: '#eac736',\r\n                        shadowBlur: 10,\r\n                        shadowColor: '#05C3F9'\r\n                    }\r\n                },\r\n                zlevel: 1\r\n            },\r\n\r\n        ]\r\n    };\r\n    myChart.setOption(option);\r\n\r\n    var counts = option.series[0].data.length; //获取所有闪动圆环数量\r\n    var dataIndex = 0;\r\n    //让圆环的提示框自动触发轮播显示\r\n    function autoHoverTip() {\r\n        for (var i = 0; i < counts; i++) {\r\n            (function(i) {\r\n                ts = setTimeout(function() {\r\n                    myChart.dispatchAction({\r\n                        type: 'showTip',\r\n                        seriesIndex: 1,\r\n                        dataIndex: i\r\n                    });\r\n                }, 5000 * i);\r\n            })(i);\r\n        }\r\n    }\r\n\r\n    setTimeout(function() {\r\n        autoHoverTip();\r\n        tv = setInterval(autoHoverTip, counts * 1000);\r\n    }, 500);\r\n});","html":"","externalScripts":"","updaterUID":"bd-1177841325","theme":"","layout":"","viewCount":10934,"userName":"i***o","commentCount":4,"starCount":29,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xByi473iZz.png?v=1512977203540","isCustomThumbnail":0,"builtinTags":["category-work","geo","legend","series-effectScatter","series-map","series-scatter","title","tooltip","visualMap"],"customTags":[],"updaterUserName":"i***o"}}