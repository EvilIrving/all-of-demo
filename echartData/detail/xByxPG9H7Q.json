{"status":0,"data":{"cid":"xByxPG9H7Q","authorUid":"bd-599414847","authorUserName":"A***M","title":"custom自定义图","description":"需求给出一个特殊的图\n先说弊端\n不支持自适应 \n不支持在矩形上面写文字\n不支持矩形的圆角展示\n需要遇到相同的问题公共解决\n如有更简单方法展示这种图 请分享 ","latestVersion":1,"alwaysLatest":1,"createTime":"2018-07-13T02:45:44.000Z","lastUpdateTime":"2018-07-13T02:45:44.000Z","auth":1,"uid":"bd-599414847","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.1.0","versionCreateTime":"2018-07-13T02:45:44.000Z","code":"var myValue = [40, 60, 29, 70, 100] //矩形数值\r\nvar name = '提示描述信息'\r\nvar lineColor = '#C4C9D3'\r\nvar rectColor = ['#7091C4', '#5170A2', '#A6A6A6', '#C4C9D3', '#3FA7DC'] //矩形颜色\r\nvar rectHeight = 24 //矩形高度\r\nvar step = 12 //矩形上线间距\r\nvar lineWidth = 2 //连线宽度\r\nvar originX = 350; //距离左上 0 0 x的距离\r\nvar originY = 100; //距离画布左上0 0 y的距离\r\n\r\nvar rectValue = [] //[[0,10],[0,80]...]\r\nvar lineValue = [] //[[0,20,29,30],[0,20,29,30],[...],...]\r\n\r\nvar maxValue = Math.max(...myValue)\r\nvar heightStep = rectHeight + step\r\n\r\n\r\nmyValue.map(function(item) {\r\n    rectValue.push([0, item])\r\n})\r\nvar rectData = [] // [[x,y,width],]\r\nrectValue.forEach(function(item, index) {\r\n    var i = (maxValue - item[1]) / 2;\r\n    var j = heightStep * index;\r\n    rectData.push([i, j, item[1]])\r\n})\r\n\r\nvar tempArr = []\r\nmyValue.map(function(item, index) {\r\n    var a = [\r\n        [maxValue - item] / 2, heightStep * index\r\n    ]\r\n    var b = [\r\n        [maxValue - item] / 2 + item, heightStep * index\r\n    ]\r\n    var c = [\r\n        [maxValue - item] / 2 + item, heightStep * index + rectHeight\r\n    ]\r\n    var d = [\r\n        [maxValue - item] / 2, heightStep * index + rectHeight\r\n    ]\r\n    var obj = {\r\n        a: a,\r\n        b: b,\r\n        c: c,\r\n        d: d\r\n    }\r\n    tempArr.push([obj])\r\n})\r\n\r\ntempArr.map(function(item, index) {\r\n    let len = myValue.length\r\n    if ((index + 1) < len) {\r\n        var nextItem = tempArr[index + 1]\r\n        lineValue.push([\r\n            item[0].c[0], item[0].c[1], nextItem[0].b[0], nextItem[0].b[1]\r\n        ])\r\n        lineValue.push(\r\n            [item[0].d[0], item[0].d[1], nextItem[0].a[0], nextItem[0].a[1]],\r\n        )\r\n    }\r\n})\r\n\r\n\r\nfunction getLineItem(param, api) {\r\n    let pointx1 = originX + api.size([2, 1])[1] + api.value(0)\r\n    let pointy1 = originY + api.size([2, 1])[1] + api.value(1)\r\n    let pointx2 = originX + api.size([2, 1])[1] + api.value(2)\r\n    let pointy2 = originY + api.size([2, 1])[1] + api.value(3)\r\n    return {\r\n        type: 'line',\r\n        shape: {\r\n            x1: pointx1,\r\n            y1: pointy1,\r\n            x2: pointx2,\r\n            y2: pointy2\r\n        },\r\n        style: api.style({\r\n            fill: null,\r\n            stroke: lineColor,\r\n            lineWidth: lineWidth,\r\n\r\n        })\r\n    };\r\n}\r\n\r\nfunction getRectItem(param, api) {\r\n    let dataIndex = param.dataIndex\r\n    let pointx = originX + api.size([2, 1])[1] + rectData[dataIndex][0]\r\n    let pointy = originY + api.size([2, 1])[1] + rectData[dataIndex][1]\r\n    let height = api.size([2, 1])[1] + rectHeight\r\n    let width = api.size([2, 1])[1] + rectData[dataIndex][2]\r\n    let _color = rectColor[dataIndex]\r\n\r\n    return {\r\n        type: 'rect',\r\n        shape: {\r\n            x: pointx,\r\n            y: pointy,\r\n            width: width,\r\n            height: height,\r\n        },\r\n        style: api.style({\r\n            fill: _color,\r\n            stroke: _color,\r\n            lineWidth: 1,\r\n        })\r\n    };\r\n}\r\n\r\n\r\noption = {\r\n\r\n    title: {\r\n        text: 'custom自定义图',\r\n        left: 'center'\r\n    },\r\n    grid: {\r\n        left: '15',\r\n        right: '15',\r\n        bottom: '25',\r\n    },\r\n    tooltip: {\r\n        show: false,\r\n        formatter: function(params) {\r\n            let str = `${params.seriesName}:${params.value[1]}`;\r\n            return str\r\n        }\r\n    },\r\n    xAxis: {\r\n        //   max:100,\r\n        // type: 'value',\r\n        show: false,\r\n\r\n    },\r\n    yAxis: {\r\n        // max:100,\r\n        show: false,\r\n        // type: 'value',\r\n    },\r\n    series: [{\r\n        type: 'custom',\r\n        name: name,\r\n        renderItem: getLineItem,\r\n        data: lineValue\r\n    }, {\r\n        type: 'custom',\r\n        name: name,\r\n        label: {\r\n            normal: {\r\n                show: true,\r\n                color: '#fff',\r\n                fontSize: 12,\r\n                position: 'inside'\r\n            }\r\n        },\r\n        renderItem: getRectItem,\r\n        data: rectValue\r\n    }]\r\n};","html":"","externalScripts":"","updaterUID":"bd-599414847","theme":"","layout":"","viewCount":1304,"userName":"A***M","commentCount":0,"starCount":10,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xByxPG9H7Q.png?v=1531449944250","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-custom","title","tooltip"],"customTags":["line","rect"],"updaterUserName":"A***M"}}