{"status":0,"data":{"cid":"xb4pAmxTV","authorUid":"bd-1581080321","authorUserName":"p***若","title":"迁徙图","description":"选择性展示省份地图","latestVersion":2,"alwaysLatest":1,"createTime":"2019-11-19T10:01:46.000Z","lastUpdateTime":"2019-11-19T10:01:46.000Z","auth":2,"uid":"bd-1581080321","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.4.0","versionCreateTime":"2019-11-20T01:36:29.000Z","code":"var avg = 45;\r\nvar colors = [\"#77f90b\", \"#0efffe\", \"#fada37\", \"#fd4747\"];\r\nvar geoCoordMap = {\r\n    '房山区': [115.928155, 39.697183],\r\n    '昌平区': [116.247808, 40.247465],\r\n    '大兴区': [116.392687, 39.375762],\r\n    '密云区': [117.008996, 40.520052],\r\n    '顺义区': [116.756034, 40.137236],\r\n    '东城区': [116.418757, 39.917544],\r\n    '西城区': [116.366794, 39.915309],\r\n    '朝阳区': [116.756034, 40.137236],\r\n    '石景区': [116.195445, 39.914601],\r\n    '丰台区': [116.286968, 39.863642],\r\n    '石家庄市': [114.502461, 38.045474],\r\n    '邯郸市': [114.490686, 36.612273],\r\n    '沧州市': [116.857461, 38.310582],\r\n    '廊坊市': [116.704441, 39.523927],\r\n    '保定市': [115.482331, 38.867657],\r\n    '承德市': [117.939152, 40.976204],\r\n    '西青区': [117.012247, 39.139446],\r\n    '武清区': [117.057959, 39.376925],\r\n    '东丽区': [117.313967, 39.087764]\r\n}\r\n\r\nvar BJData = {\r\n    eare1: [\r\n        [{\r\n            name: '丰台区'\r\n        }, {\r\n            name: '石家庄市',\r\n            value: 45\r\n        }],\r\n        [{\r\n            name: '丰台区'\r\n        }, {\r\n            name: '廊坊市',\r\n            value: 70\r\n        }],\r\n        [{\r\n            name: '丰台区'\r\n        }, {\r\n            name: '廊坊市',\r\n            value: 170\r\n        }],\r\n        [{\r\n            name: '丰台区'\r\n        }, {\r\n            name: '保定市',\r\n            value: 170\r\n        }],\r\n    ],\r\n    eare2: [\r\n        [{\r\n            name: '丰台区'\r\n        }, {\r\n            name: '西青区',\r\n            value: 100\r\n        }],\r\n        [{\r\n            name: '丰台区'\r\n        }, {\r\n            name: '武清区',\r\n            value: 150\r\n        }],\r\n        [{\r\n            name: '丰台区'\r\n        }, {\r\n            name: '东丽区',\r\n            value: 50\r\n        }]\r\n    ]\r\n};\r\n\r\n//从两个地图的的地理坐标 转换为飞线数据\r\nvar convertData = function(data) {\r\n    var res = [];\r\n    for (let index in data) {\r\n        var dataItem = data[index];\r\n        var _dex = parseInt(index.replace(\"eare\", \"\"));\r\n        for (var i = 0; i < dataItem.length; i++) {\r\n            var childItem = dataItem[i];\r\n            var from = myChart.convertToPixel({\r\n                geoIndex: 0\r\n            }, geoCoordMap[childItem[0].name]);\r\n            from = myChart.convertFromPixel('grid', from);\r\n            var to = myChart.convertToPixel({\r\n                geoIndex: _dex\r\n            }, geoCoordMap[childItem[1].name]);\r\n            to = myChart.convertFromPixel('grid', to);\r\n            res.push({\r\n                coords: [from, to],\r\n                value: childItem[1].value,\r\n                fromName: childItem[0].name,\r\n                toName: childItem[1].name\r\n            });\r\n        }\r\n\r\n    }\r\n    return res;\r\n};\r\n\r\nvar option = {\r\n    backgroundColor: \"#edf7f7\",\r\n    tooltip: {\r\n        trigger: 'item',\r\n        backgroundColor: 'rgba(0, 0, 0, 0.3)',\r\n        borderColor: '#ffc',\r\n        enterable: true,\r\n        padding: [0, 10],\r\n        formatter: function(params) {\r\n            var name = params.name;\r\n            var value = params.value[2];\r\n            if (name == undefined || value == undefined) {\r\n                return;\r\n            } else {\r\n                var res = \"\";\r\n                res = \"<span style='color:#fff;'>\" + name + \"</span><br/>数据：\" + value;\r\n                return res;\r\n            }\r\n\r\n        }\r\n    },\r\n    xAxis: {\r\n        type: 'value',\r\n        show: false,\r\n        min: 0,\r\n        max: 100,\r\n        position: 'top'\r\n    },\r\n    yAxis: {\r\n        type: 'value',\r\n        show: false,\r\n        min: 0,\r\n        max: 100,\r\n        inverse: true\r\n    },\r\n    geo: [{\r\n            id: '北京',\r\n            map: '北京',\r\n            roam: false,//控制地图是否可以缩放\r\n            center: [117.6, 40.3],\r\n            zoom: 0.8,\r\n            label: {\r\n                normal: { //静态的时候展示样式\r\n                    show: true, //是否显示地图省份得名称\r\n                    textStyle: {\r\n                        color: 'rgb(249, 249, 249)',\r\n                        fontSize: 12,\r\n                        fontFamily: \"Arial\"\r\n                    }\r\n                },\r\n                emphasis: { //动态展示的样式\r\n                    color: '#43d0d6',\r\n                },\r\n            },\r\n            itemStyle: {\r\n                normal: {\r\n                    color: 'rgba(1, 57, 84, .8)', //地图背景色\r\n                    borderColor: '#516a89', //省市边界线\r\n                    borderWidth: 1\r\n                },\r\n                emphasis: {\r\n                    color: 'rgba(1, 57, 84, 0.9)' //悬浮背景\r\n                }\r\n            }\r\n        },\r\n        {\r\n            id: '河北',\r\n            map: '河北',\r\n            roam: false,\r\n            center: [112, 37],\r\n            zoom: 0.7,\r\n            label: {\r\n                normal: { //静态的时候展示样式\r\n                    show: false, //是否显示地图省份得名称\r\n                    textStyle: {\r\n                        color: 'rgb(249, 249, 249)',\r\n                        fontSize: 10,\r\n                        fontFamily: \"Arial\"\r\n                    }\r\n                },\r\n                emphasis: { //动态展示的样式\r\n                    color: 'transparent',\r\n                },\r\n            },\r\n            itemStyle: {\r\n                normal: {\r\n                    color: 'rgba(1, 57, 84, .8)', //地图背景色\r\n                    borderColor: '#516a89', //省市边界线00fcff 516a89\r\n                    borderWidth: 1\r\n                },\r\n                emphasis: {\r\n                    color: 'rgba(1, 57, 84, 0.9)' //悬浮背景\r\n                }\r\n            }\r\n        },\r\n        {\r\n            id: '天津',\r\n            map: '天津',\r\n            roam: false,\r\n            center: [115.9, 39.6],\r\n            zoom: 0.7,\r\n            label: {\r\n                normal: { //静态的时候展示样式\r\n                    show: false, //是否显示地图省份得名称\r\n                    textStyle: {\r\n                        color: 'rgb(249, 249, 249)',\r\n                        fontSize: 10,\r\n                        fontFamily: \"Arial\"\r\n                    }\r\n                },\r\n                emphasis: { //动态展示的样式\r\n                    color: 'transparent',\r\n                },\r\n            },\r\n            itemStyle: {\r\n                normal: {\r\n                    color: 'rgba(1, 57, 84, .8)', //地图背景色\r\n                    borderColor: '#516a89', //省市边界线00fcff 516a89\r\n                    borderWidth: 1\r\n                },\r\n                emphasis: {\r\n                    color: 'rgba(1, 57, 84, 0.9)' //悬浮背景\r\n                }\r\n            }\r\n        }\r\n    ],\r\n    series: []\r\n};\r\nsetTimeout(function() {\r\n    myChart.setOption({\r\n        series: [{\r\n                type: 'lines',\r\n                coordinateSystem: 'cartesian2d',\r\n                xAxisIndex: 0,\r\n                yAxisIndex: 0,\r\n                zlevel: 2,\r\n                effect: {\r\n                    show: true,\r\n                    period: 4, //箭头指向速度，值越小速度越快\r\n                    trailLength: 0.04, //特效尾迹长度[0,1]值越大，尾迹越长重\r\n                    symbol: 'arrow', //箭头图标\r\n                    symbolSize: 7, //图标大小\r\n                    color: \"#fff\",\r\n                },\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: function(params) {\r\n                            var num = params.value;\r\n                            if (num > 0 && num <= avg) {\r\n                                return colors[0];\r\n                            } else if (num > avg && num <= 2 * avg) {\r\n                                return colors[1];\r\n                            } else if (num > 2 * avg && num <= 3 * avg) {\r\n                                return colors[2];\r\n                            }\r\n                        },\r\n                        width: 1, //尾迹线条宽度\r\n                        opacity: 1, //尾迹线条透明度\r\n                        curveness: .3 //尾迹线条曲直度\r\n                    }\r\n                },\r\n                data: convertData(BJData)\r\n            },\r\n            {\r\n                type: 'effectScatter',\r\n                coordinateSystem: 'cartesian2d',\r\n                zlevel: 3,\r\n                rippleEffect: { //涟漪特效\r\n                    period: 4, //动画时间，值越小速度越快\r\n                    brushType: 'stroke', //波纹绘制方式 stroke, fill\r\n                    scale: 4 //波纹圆环最大限制，值越大波纹越大\r\n                },\r\n                label: {\r\n                    normal: {\r\n                        show: true,\r\n                        position: 'right', //显示位置\r\n                        offset: [5, 0], //偏移设置\r\n                        formatter: function(params) { //圆环显示文字\r\n                            return params.data.name;\r\n                        },\r\n                        fontSize: 13\r\n                    },\r\n                    emphasis: {\r\n                        show: true,\r\n                        label: {\r\n                            show: true,\r\n                        }\r\n                    }\r\n                },\r\n                symbol: 'circle',\r\n                symbolSize: function(val) {\r\n                    return 10; //圆环大小\r\n                },\r\n                itemStyle: {\r\n                    normal: {\r\n                        show: false,\r\n                        color: function(params) {\r\n                            var num = params.value[2];\r\n                            if (num > 0 && num <= avg) {\r\n                                return colors[0];\r\n                            } else if (num > avg && num <= 2 * avg) {\r\n                                return colors[1];\r\n                            } else if (num > 2 * avg && num <= 3 * avg) {\r\n                                return colors[2];\r\n                            }\r\n                        },\r\n                    }\r\n                },\r\n                data: convertData(BJData).map(function(dataItem) {\r\n                    return {\r\n                        name: dataItem.toName,\r\n                        value: dataItem.coords[1].concat([dataItem.value])\r\n                    };\r\n                }),\r\n            },\r\n        ]\r\n    });\r\n}, 10);","html":"","externalScripts":"https://gallerybox.echartsjs.com/dep/echarts/map/js/province/beijing.js,https://gallerybox.echartsjs.com/dep/echarts/map/js/province/hebei.js,https://gallerybox.echartsjs.com/dep/echarts/map/js/province/tianjin.js","updaterUID":"bd-1581080321","theme":"","layout":"","viewCount":1007,"userName":"p***若","commentCount":4,"starCount":4,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xb4pAmxTV.png?v=1574213789631","isCustomThumbnail":0,"builtinTags":["category-work","geo","grid","series-effectScatter","series-lines","tooltip"],"customTags":[],"updaterUserName":"p***若"}}