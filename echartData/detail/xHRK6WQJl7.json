{"status":0,"data":{"cid":"xHRK6WQJl7","authorUid":"bd-2652911079","authorUserName":"囧***哥","title":"自定义扇形弧度坐标文本（雷达图）","description":"包含自动计算扇形弧度坐标","latestVersion":7,"alwaysLatest":0,"createTime":"2021-05-10T08:27:37.000Z","lastUpdateTime":"2021-05-10T08:27:37.000Z","auth":2,"uid":"bd-2652911079","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":7,"parentVersion":6,"echartsVersion":"5.1.1","versionCreateTime":"2021-05-10T09:29:39.000Z","code":"var radarStyle = document.createElement('style');\nvar str = `\n    #radar:after {\n\t  content: ' ';\n\t  display: block;\n\t  background-image: linear-gradient(44deg, rgba(0, 255, 51, 0) 50%, #00ff33 100%);\n\t  width: 250px;\n\t  height: 250px;\n\t  position: absolute;\n\t  top: 30px;\n\t  left: 5px;\n\t  animation: radar-beam 4s infinite;\n\t  animation-timing-function: linear;\n\t  transform-origin: bottom right;\n\t  border-radius: 100% 0 0 0;\n\t}\n\t@keyframes radar-beam {\n\t  0% {\n\t    transform: rotate(0deg);\n\t  }\n\t  100% {\n\t    transform: rotate(360deg);\n\t  }\n\t}\n`;\nif (radarStyle.styleSheet) {\n    //ie下\n    radarStyle.styleSheet.cssText = str;\n} else {\n    radarStyle.innerHTML = str;\n}\ndocument.getElementsByTagName('head')[0].appendChild(radarStyle);\nvar radarDiv = document.createElement('div');\nradarDiv.id = 'radar';\nradarDiv.style.position = 'relative';\nradarDiv.style.width = '500px';\nradarDiv.style.height = '500px';\nradarDiv.style.margin = '0 auto';\n// radarDiv.style.backgroundColor = '#333';\nvar body = document.querySelector('body');\nbody.appendChild(radarDiv);\n\nlet datas = [10, 60];\n\nsetInterval(() => {\n    datas[0] = Math.floor(Math.random() * (100 - 10)) + 10;\n    datas[1] = Math.floor(Math.random() * (200 - 110)) + 110;\n    myChart.setOption(option, 'dark');\n}, 3000);\n\nfunction renderItem(params = {}, api = {}) {\n    const { cx, cy, r, r0 } = params.coordSys || {};\n    const [start, end] = datas;\n    const startAngle = (start * Math.PI) / 180;\n    const endAngle = (end * Math.PI) / 180;\n    // console.log({coord: api.coord([api.value(0), api.value(1)]),size: api.size([1, 1], [api.value(0), api.value(1)])});\n    const angle = (a) => ({\n        text: `[角度值：${a}]`,\n        x: cx + r * Math.cos((a * Math.PI) / 180),\n        y: cy + r * Math.sin((a * Math.PI) / 180),\n        fill: '#090',\n    });\n    // console.log({ cx, cy, r, r0, startAngle, endAngle, angle });\n    return {\n        type: 'group',\n        children: [\n            {\n                type: 'sector',\n                morph: true,\n                textContent: { type: 'text', style: { text: `范围：【${datas.join()}】` } },\n                shape: { cx, cy, r0, r, startAngle, endAngle },\n                style: api.style({ fill: api.visual('color') }),\n            },\n            { type: 'text', x: 10, style: { ...angle(start) } },\n            { type: 'text', x: 10, style: { ...angle(end) } },\n            {\n                type: 'line',\n                shape: {\n                    x1: cx,\n                    x2: angle(start).x,\n                    y1: cy,\n                    y2: angle(start).y,\n                },\n                style: {\n                    fill: '#903',\n                    stroke: '#f09',\n                    lineWidth: 1,\n                },\n            },\n            {\n                type: 'line',\n                shape: {\n                    x1: cx,\n                    x2: angle(end).x,\n                    y1: cy,\n                    y2: angle(end).y,\n                },\n                style: {\n                    fill: '#903',\n                    stroke: '#f09',\n                    lineWidth: 1,\n                },\n            },\n        ],\n    };\n}\n\noption = {\n    polar: {},\n    tooltip: {},\n    grid: {\n        width: 500,\n        height: 500,\n        x: 0,\n        y: 0,\n    },\n    backgroundColor: '#060f4c',\n    darkMode: true,\n    angleAxis: {\n        type: 'category',\n        data: ['270', '315', '0', '45', '90', '135', '180', '225'],\n        boundaryGap: false,\n        splitLine: { show: true, lineStyle: { color: '#eee', type: 'dashed' } },\n        axisLine: { show: false },\n    },\n    radiusAxis: { type: 'category', data: [], z: 100 },\n    series: [\n        {\n            name: '自定义阈值扇形图',\n            type: 'custom',\n            coordinateSystem: 'polar',\n            itemStyle: { color: '#d14a61' },\n            renderItem: renderItem,\n            data: datas,\n        },\n    ],\n};\n","html":"","externalScripts":"","updaterUID":"bd-2652911079","theme":"","layout":"","viewCount":0,"userName":"囧***哥","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xHRK6WQJl7.png?v=1620638979593","isCustomThumbnail":0,"builtinTags":["category-work","polar","series-custom","tooltip"],"customTags":[],"updaterUserName":"囧***哥"}}