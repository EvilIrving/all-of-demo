{"status":0,"data":{"cid":"xSy0sf8hBW","authorUid":"bd-1731291088","authorUserName":"走***a","title":"树图 --treemap","description":"利用树图建立结构关系--treemap\n","latestVersion":19,"alwaysLatest":1,"createTime":"2017-07-19T03:31:49.000Z","lastUpdateTime":"2017-07-19T03:31:49.000Z","auth":2,"uid":"bd-1731291088","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":19,"parentVersion":18,"echartsVersion":"3.6.2","versionCreateTime":"2017-07-19T08:42:52.000Z","code":"var struct_colors = [\r\n    '#ed6f6d', '#f3765d', '#f77a57', '#f98866', '#f99579',\r\n    '#ff9f3b', '#f0a732', '#e6a840', '#e9b253', '#ebbb66',\r\n    '#78b7e8', '#59b1f3', '#66bbf5', '#6ec3f2', '#75cae2',\r\n    '#70cccc', '#5dc4c4', '#4dbebd', '#4cc1a7', '#4fca96',\r\n    '#4cc686'\r\n];\r\n\r\nvar info2 = {\r\n    'children': [{\r\n        'value': 2,\r\n        'name': '一级结构',\r\n        'manage': 'liang-01',\r\n    }, {\r\n        'value': 42,\r\n        'name': 'fds-------test--------------------------yy----',\r\n        'manage': 'liang-01',\r\n    }, {\r\n        'children': [{\r\n            'name': '二级组织结构-1',\r\n            'value': 20,\r\n            'manage': 'liang-01',\r\n        }, {\r\n            'name': '二级组织结构-2',\r\n            'value': 20,\r\n            'manage': 'liang-01',\r\n        }, {\r\n\r\n            'children': [{\r\n                'name': '三级-1',\r\n                'value': 10,\r\n                'manage': 'liang-01',\r\n            }, {\r\n                'name': '三级-2',\r\n                'value': 20,\r\n                'manage': 'liang-01',\r\n            }],\r\n            'name': '二级-03',\r\n            'manage': 'liang-02',\r\n        }],\r\n        'name': 'has children',\r\n        'manage': 'liang-01',\r\n    }, {\r\n        'name': 'fds no children',\r\n        'value': 100,\r\n        'manage': 'liang-01',\r\n        // 'color': struct_colors[index],\r\n    }]\r\n};\r\nvar structs_datas = [];\r\nvar formatUtil = echarts.format;\r\n\r\nfunction format_struct_data(children, structs_datas) {\r\n    // 添加每个单位的颜色\r\n    for (var prop in children) {\r\n        var index = Math.floor(Math.random() * 20);\r\n        var tmp = {\r\n            itemStyle: {\r\n                normal: {\r\n                    color: struct_colors[index]\r\n                }\r\n            },\r\n            name: children[prop].name,\r\n            manage: children[prop].manage,\r\n            value: children[prop].value,\r\n            children: []\r\n        }\r\n        format_struct_data(children[prop].children, tmp.children);\r\n        if(tmp.children.length === 0){\r\n            delete tmp.children;\r\n        }\r\n        structs_datas.push(tmp);\r\n        // return structs_datas;\r\n\r\n    }\r\n\r\n}\r\n\r\nfunction showMenu(param) {\r\n    // 可在此处添加右击操作内容\r\n    console.log('showMenu==============', param);\r\n    var event = param.event;\r\n    var pageX = event.offsetX;\r\n    var pageY = event.offsetY;\r\n    console.log('showMenu========', pageX, pageY);\r\n\r\n}\r\nformat_struct_data(info2.children, structs_datas);\r\nmyChart.setOption(option = {\r\n    title: {\r\n        text: '树图构建组织结构',\r\n        subtext: '2017/07 by liang',\r\n        left: 'leafDepth'\r\n    },\r\n    tooltip: {\r\n        formatter: function(info) {\r\n            // console.log('tool------', info);\r\n            var value = info.value;\r\n            var name = info.name;\r\n\r\n            return [\r\n                '<h4>' + name + '</h4>',\r\n                '<p> 资产数量：' + value + '</p>',\r\n            ].join('');\r\n        }\r\n    },\r\n\r\n    series: [{\r\n        name: 'org',\r\n        type: 'treemap',\r\n        visibleMin: 300,\r\n        // data: format_struct_data(info2.children, structs_datas),\r\n        data: structs_datas,\r\n        leafDepth: 1,\r\n        label: {\r\n            normal: {\r\n                show: true,\r\n                position: 'insideTopLeft',\r\n                formatter: function(a) {\r\n                    console.log('formatter==label=======', a);\r\n                    return a.name + \"\\n\\n资产数量 : \" + a.data.value + \"\\n管理员 ： \" + a.data.manage;\r\n                    // return [\r\n                    //     '<div><h1>' + a.name + '</h1></div>',\r\n                    //     '<div><p>' + a.value + '</></div>',\r\n                    // ].join('');\r\n                },\r\n                textStyle: {\r\n                    // color: '',  label的字体颜色\r\n                    fontSize: '14',\r\n                    fontWeight: 'bold'\r\n                }\r\n            },\r\n            // emphasis: {\r\n            //     show: true,\r\n            //     position: 'insideTopLeft',\r\n            //     formatter: function(a) {\r\n            //         console.log('formatter===label======', a);\r\n            //         return a.name + \"\\n\\n\" + \"资产数量 : \" + a.data.value + \"\\n等级得分\";\r\n            //     },\r\n            //     textStyle: {\r\n            //         fontSize: '14',\r\n            //         fontWeight: 'bold'\r\n            //     }\r\n            // }\r\n        },\r\n        levels: [{\r\n            itemStyle: {\r\n                normal: {\r\n                    borderWidth: 0,\r\n                    gapWidth: 2\r\n                }\r\n            }\r\n        }, {\r\n            itemStyle: {\r\n                normal: {\r\n                    gapWidth: 2\r\n                }\r\n            }\r\n        }, {\r\n            // colorSaturation: [0.35, 0.5],\r\n            itemStyle: {\r\n                normal: {\r\n                    gapWidth: 2,\r\n                    // borderColorSaturation: 0.6\r\n                }\r\n            }\r\n        }],\r\n        breadcrumb: {\r\n            show: true,\r\n            // \"height\": 22,\r\n            left: \"10%\",\r\n            top: \"93%\",\r\n            emptyItemWidth: 25,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: \"#fff\",\r\n                    borderColor: \"rgba(255,255,255,0.7)\",\r\n                    borderWidth: 1,\r\n                    shadowColor: \"rgba(150,150,150,1)\",\r\n                    shadowBlur: 3,\r\n                    shadowOffsetX: 0,\r\n                    shadowOffsetY: 0,\r\n                    textStyle: {\r\n                        color: \"#000\",\r\n                        fontWeight: 'bold'\r\n                    }\r\n                },\r\n                emphasis: {\r\n                    textStyle: {}\r\n                }\r\n            }\r\n        },\r\n    }]\r\n});\r\n\r\ndocument.oncontextmenu = function() {\r\n    return false;\r\n};\r\nmyChart.on('contextmenu', showMenu);","html":"","externalScripts":"","updaterUID":"bd-1731291088","theme":"","layout":"","viewCount":1401,"userName":"走***a","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xSy0sf8hBW.png?v=1500453772401","isCustomThumbnail":0,"builtinTags":["category-work","series-treemap","title","tooltip"],"customTags":[],"updaterUserName":"走***a"}}