{"status":0,"data":{"cid":"xT3Ohxcjhw","authorUid":"bd-4240785066","authorUserName":"小***丶","title":"全国热力图","description":"通过高德api获取geoJson渲染热力图","latestVersion":5,"alwaysLatest":1,"createTime":"2020-06-23T02:18:32.000Z","lastUpdateTime":"2020-06-23T02:18:32.000Z","auth":1,"uid":"bd-4240785066","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":5,"parentVersion":4,"echartsVersion":"4.9.0","versionCreateTime":"2021-05-19T10:16:12.000Z","code":"getGeoJson(100000);\n\nfunction getGeoJson(adcode) {\n    var map = new AMap.Map('map', {\n        resizeEnable: true,\n        center: [116.30946, 39.937629],\n        zoom: 3,\n    });\n    AMapUI.loadUI(['geo/DistrictExplorer'], (DistrictExplorer) => {\n        var districtExplorer = (window.districtExplorer = new DistrictExplorer({\n            eventSupport: true, //打开事件支持\n            map: map,\n        }));\n        districtExplorer.loadAreaNode(adcode, function (error, areaNode) {\n            if (error) {\n                console.error(error);\n                return;\n            }\n            let Json = areaNode.getSubFeatures();\n\n            //去获取数据\n            getMapData(Json);\n        });\n    });\n}\n\n//获取数据，这里我们用随机数模拟数据\n\nfunction getMapData(Json) {\n    let mapData = Json.map((item) => {\n        return {\n            name: item.properties.name,\n            value: [item.properties.center[0], item.properties.center[1], 40],\n        };\n    });\n    let mapData1 = Json.map((item) => {\n        return {\n            name: item.properties.name,\n            value: parseInt(Math.random() * (150 - 20 + 1) + 20, 10),\n        };\n    });\n    let mapJson = {};\n    //geoJson必须这种格式\n    mapJson.features = Json;\n\n    //去渲染echarts\n    initEcharts(mapData, mapJson, mapData1);\n}\n\nfunction initEcharts(mapData, mapJson, mapData1) {\n    console.log(mapData1);\n    //注册\n    echarts.registerMap('Map', mapJson);\n\n    //这里加true是为了让地图重新绘制，不然如果你有筛选的时候地图会飞出去\n    myChart.setOption({\n        // backgroundColor:'#ED272F',\n        tooltip: {\n            triggerOn: 'click',\n            formatter: function (e, t, n) {\n                return 0.5 == e.value ? e.name + '：有疑似病例' : e.seriesName + '<br />' + e.name + '：' + e.value;\n            },\n        },\n        visualMap: [\n            {\n                show: true,\n                left: '2%',\n                bottom: '1%',\n                min: 0,\n                max: 150,\n                text: ['150', '0'],\n                seriesIndex:0,\n                inRange: {\n                    color: ['#f6d189', '#eeaf80', '#e67f5a', '#e55036','#c43621'],\n                },\n                textStyle: {\n                    color: '#0fccff',\n                    fontSize: 12,\n                },\n            },\n            {\n                min: 0,\n                max: 1000,\n                left: 60,\n                bottom: '1%',\n                showLabel: !0,\n                text: ['高', '低'],\n                seriesIndex:1,\n                pieces: [\n                    {\n                        gt: 100,\n                        label: '> 100 人',\n                        color: '#fa9d38',\n                    },\n                    {\n                        gte: 10,\n                        lte: 100,\n                        label: '10 - 100 人',\n                        color: '#fea662',\n                    },\n                    {\n                        gte: 1,\n                        lt: 10,\n                        label: '1 - 9 人',\n                        color: '#ffba70',\n                    },\n                    {\n                        gt: 0,\n                        lt: 1,\n                        label: '疑似',\n                        color: '#fad189',\n                    },\n                ],\n                show: !0,\n            },\n        ],\n        geo: {\n            map: 'Map', //使用\n            roam: !1,\n            scaleLimit: {\n                min: 1,\n                max: 2,\n            },\n            zoom: 1.23,\n            top: 120,\n            label: {\n                normal: {\n                    show: !0,\n                    fontSize: '14',\n                    color: 'rgba(0,0,0,0.7)',\n                },\n            },\n            itemStyle: {\n                normal: {\n                    show: true,\n                    areaColor: 'rgba(0,0,0,0)',\n                    borderColor: '#E18B26',\n                    borderWidth: '1',\n                    shadowColor: '#FEFEFC',\n                    shadowBlur: 20,\n                },\n                emphasis: {\n                    areaColor: '#f2d5ad',\n                    shadowOffsetX: 0,\n                    shadowOffsetY: 0,\n                    borderWidth: 0,\n                },\n            },\n        },\n        series: [\n            {\n                name: '地图',\n                geoIndex: 0,\n                type: 'heatmap',\n                data: mapData,\n                coordinateSystem: 'geo',\n                pointSize: 20, //修改热力图点的半径\n                blurSize: 15, //阴影的大小\n            },\n            {\n                name: '确诊病例',\n                type: 'map',\n                geoIndex:0,\n                data: mapData1,\n            },\n            \n        ],\n    });\n}\n","html":"","externalScripts":"https://webapi.amap.com/maps?v=1.3&key=73cddabc2173e0166a622f4483d3592a&plugin=AMap.DistrictSearch,https://webapi.amap.com/maps?v=1.3&key=73cddabc2173e0166a622f4483d3592a,https://webapi.amap.com/ui/1.0/main.js","updaterUID":"obd-olzfCSZCumgHKulBoTFBtiDlRcIlD0u","theme":"","layout":"","viewCount":3152,"userName":"小***丶","commentCount":0,"starCount":9,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xT3Ohxcjhw.png?v=1621419372528","isCustomThumbnail":0,"builtinTags":["category-work","geo","series-heatmap","title","toolbox","tooltip","visualMap"],"customTags":[],"updaterUserName":"佑***杰"}}