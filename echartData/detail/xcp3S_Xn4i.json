{"status":0,"data":{"cid":"xcp3S_Xn4i","authorUid":"bd-3660930699","authorUserName":"一***乱","title":"彩虹旭日图","description":"对任意树结构对象计算出颜色","latestVersion":2,"alwaysLatest":1,"createTime":"2020-06-29T09:57:11.000Z","lastUpdateTime":"2020-06-29T09:57:11.000Z","auth":2,"uid":"bd-3660930699","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.8.0","versionCreateTime":"2020-06-30T02:35:10.000Z","code":"var data = [{\n    children: [{\n        value: 5,\n        children: [{\n            value: 1\n        }, {\n            value: 2,\n            children: [{\n                value: 1\n            }]\n        }, {\n            children: [{\n                value: 1\n            }]\n        }]\n    }, {\n        value: 10,\n        children: [{\n            value: 6,\n            children: [{\n                value: 1\n            }, {\n                value: 1\n            }, {\n                value: 1\n            }, {\n                value: 1\n            }]\n        }, {\n            value: 2,\n            children: [{\n                value: 1\n            }]\n        }, {\n            children: [{\n                value: 1\n            }]\n        }]\n    }]\n}, {\n    value: 9,\n    children: [{\n        value: 4,\n        children: [{\n            value: 2\n        }, {\n            children: [{\n                value: 1\n            }]\n        }]\n    }, {\n        children: [{\n            value: 3,\n            children: [{\n                value: 1\n            }, {\n                value: 1\n            }]\n        }]\n    }]\n}, {\n    value: 7,\n    children: [{\n        children: [{\n            value: 1\n        }, {\n            value: 3,\n            children: [{\n                value: 1\n            }, {\n                value: 1\n            }]\n        }, {\n            value: 2,\n            children: [{\n                value: 1\n            }, {\n                value: 1\n            }]\n        }]\n    }]\n}, {\n    children: [{\n        value: 6,\n        children: [{\n            value: 1\n        }, {\n            value: 2,\n            children: [{\n                value: 2\n            }]\n        }, {\n            value: 1\n        }]\n    }, {\n        value: 3,\n        children: [{\n            value: 1,\n        }, {\n            children: [{\n                value: 1\n            }]\n        }, {\n            value: 1\n        }]\n    }]\n}];\n\nconst getSum = (data) => {\n    let sum = 0;\n    for(let item of data) {\n        if (item.children != null) {\n            item.sum = getSum(item.children);\n        } else {\n            item.sum = item.value;\n        }\n        sum += item.sum;\n    }\n    return sum;\n};\n\nconst buildColor = (data, sum, min, max, level) => {\n    const range = max - min;\n    let start = min;\n    for(let item of data) {\n        const r = range * item.sum / sum;\n        const end = start + r;\n        if (item.children) {\n\t\t\tconst itemSum = item.value > item.sum ? item.value : item.sum;\n            buildColor(item.children, itemSum, start, end, level + 1);\n        }\n        item.itemStyle = {color : `hsl(${(start + end) / 2},95%,${70 - level * 10}%)`};\n        start += r;\n    }\n};\nconst sum = getSum(data);\nbuildColor(data, sum, 0 ,360, 0);\n\noption = {\n    series: {\n        radius: ['15%', '80%'],\n        type: 'sunburst',\n        sort: null,\n        highlightPolicy: 'ancestor',\n        data: data,\n        label: {\n            rotate: 'radial'\n        },\n        levels: [],\n        itemStyle: {\n            color: '#ddd',\n            borderWidth: 2\n        }\n    }\n};\n","html":"","externalScripts":"","updaterUID":"bd-3660930699","theme":"","layout":"","viewCount":85,"userName":"一***乱","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xcp3S_Xn4i.png?v=1593484510907","isCustomThumbnail":0,"builtinTags":["category-work","series-sunburst"],"customTags":[],"updaterUserName":"一***乱"}}