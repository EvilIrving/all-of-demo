{"status":0,"data":{"cid":"xN2HMuxG5B","authorUid":"bd-135386625","authorUserName":"橙***料","title":"轮播饼图","description":"轮播饼图","latestVersion":2,"alwaysLatest":1,"createTime":"2019-03-20T12:38:06.000Z","lastUpdateTime":"2019-03-20T12:38:06.000Z","auth":2,"uid":"bd-135386625","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.4.0","versionCreateTime":"2020-02-09T10:31:29.000Z","code":"var animationTime = 3000; //动画定时时间\nvar index = 0; //第几个显示\n//数据\nvar datas = [{\n        name: '第一人民医院',\n        value: '220'\n    },\n    {\n        name: '第二人民医院',\n        value: '182'\n    },\n    {\n        name: '第三人民医院',\n        value: '191'\n    },\n    {\n        name: '第四人民医院',\n        value: '234'\n    },\n    {\n        name: '第五人民医院',\n        value: '290'\n    },\n    {\n        name: '第六人民医院',\n        value: '310'\n    },\n]\n\n//动画函数\nvar animation = function(chart, seriesIndex) {\n    if (!seriesIndex) seriesIndex = 0; //默认是0\n\n    var options = chart.getOption();\n    options.series[seriesIndex].data.forEach(function(data, i) {\n        options.series[seriesIndex].data[i].label.emphasis = {\n            show: index == i\n        };\n        options.series[seriesIndex].data[i].labelLine.emphasis = {\n            show: index == i\n        };\n    });\n\n    chart.setOption(options);\n    if (index > 0) {\n        chart.dispatchAction({\n            type: 'downplay',\n            seriesIndex: 0,\n            dataIndex: index - 1\n        });\n    }\n\n    chart.dispatchAction({\n        type: 'highlight',\n        seriesIndex: 0,\n        dataIndex: index\n    })\n    index++\n    if (index >= options.series[seriesIndex].data.length) {\n        index = 0\n    }\n};\n\n//数据组装\nvar getPieData = function(dataMap) {\n    var dataArr = [];\n    datas.forEach(function(data, i) {\n        dataArr.push({\n            name: data.name,\n            value: data.value,\n            label: {\n                normal: {\n                    show: false,\n                    position: 'outside'\n                }\n            },\n            labelLine: {\n                normal: {\n                    show: false\n                }\n            }\n        });\n    });\n\n    return dataArr;\n};\n\noption = {\n    title: {\n        text: '轮播饼图',\n        subtext: '100%',\n        textStyle: {\n            color: '#ff9d19',\n            fontSize: 40,\n        },\n        subtextStyle: {\n            fontSize: 30,\n            color: ['#ff9d19']\n        },\n        x: 'center',\n        y: 'center',\n    },\n    series: [{\n        type: 'pie',\n        center: ['50%', '50%'],\n        radius: ['45%', '65%'],\n        selectedMode: 'single',\n        label: {\n            normal: {\n                formatter: '{b}{c}({d}%)\\n',\n            },\n            emphasis: {\n\n            }\n        },\n        data: getPieData(datas)\n    }]\n};\n\n\nvar myechart = echarts.getInstanceByDom(document.getElementById(\"chart-panel\"));\nmyechart.setOption(option);\nfunction downloadFile(content, fileName) { //下载base64图片\n    var base64ToBlob = function(code) {\n        var parts = code.split(';base64,');\n        var contentType = parts[0].split(':')[1];\n        var raw = window.atob(parts[1]);\n        var rawLength = raw.length;\n        var uInt8Array = new Uint8Array(rawLength);\n        for(let i = 0; i < rawLength; ++i) {\n            uInt8Array[i] = raw.charCodeAt(i);\n        }\n        return new Blob([uInt8Array], {\n            type: contentType\n        });\n    };\n    var aLink = document.createElement('a');\n    var blob = base64ToBlob(content); //new Blob([content]);\n    var evt = document.createEvent(\"HTMLEvents\");\n    evt.initEvent(\"click\", true, true); //initEvent 不加后两个参数在FF下会报错  事件类型，是否冒泡，是否阻止浏览器的默认行为\n    aLink.download = fileName;\n    aLink.href = URL.createObjectURL(blob);\n    aLink.click();\n};\n\n\nsetTimeout(function() {\n    downloadFile(myechart.getDataURL({\n        type: 'png',\n        backgroundColor:'rgba(21,52,122, 1) '\n    }), 'qqq')\n}, 1000);\n//animation(myechart);\nsetInterval(function() {\n   // animation(myechart, 0);\n    \n    /*\n      setTimeout(function() {\n          downloadFile(myechart.getDataURL({\n            type: 'png',\n        }));\n    }, 1000);*/\n    \n    \n}, animationTime)","html":"","externalScripts":"","updaterUID":"bd-135386625","theme":"macarons","layout":"","viewCount":360,"userName":"橙***料","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xN2HMuxG5B.png?v=1581244289866","isCustomThumbnail":0,"builtinTags":["category-work","series-pie","title"],"customTags":[],"updaterUserName":"橙***料"}}