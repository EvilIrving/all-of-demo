{"status":0,"data":{"cid":"xSEdy0J7e5","authorUid":"bd-4045335863","authorUserName":"80608989","title":"江苏地图","description":"江苏地图","latestVersion":1,"alwaysLatest":1,"createTime":"2019-03-07T03:25:22.000Z","lastUpdateTime":"2019-03-07T03:25:22.000Z","auth":2,"uid":"bd-4045335863","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.2.1","versionCreateTime":"2019-03-07T03:25:22.000Z","code":"//var jiangsu = \"/asset/get/s/data-1518338017111-rJK1gtpUM.json\";\r\nvar jiangsu = \"/asset/get/s/data-1551928769808-M7YfbgDR9.json\";\r\necharts.extendsMap = function(id, opt){\r\n    // 实例\r\n    var chart = this.init(document.getElementById(id));\r\n    var geoCoordMap = {\r\n        '盐城市': [120.2234,33.5577],\r\n        '徐州市': [117.5208, 34.3268],\r\n        '南通市': [121.1023, 32.1625],\r\n        '淮安市': [118.927, 33.4039],\r\n        '苏州市': [120.6519, 31.3989],\r\n        '宿迁市': [118.5535, 33.7775],\r\n        '连云港市': [119.1248, 34.552],\r\n        '扬州市': [119.4653, 32.8162],\r\n        '南京市': [118.8062, 31.9208],\r\n        '泰州市': [120.0586, 32.5525],\r\n        '无锡市': [120.3442, 31.5527],\r\n        '常州市': [119.4543, 31.5582],\r\n        '镇江市': [119.4763, 31.9702]\r\n    };\r\n    var levelColorMap = {\r\n        '1': 'rgba(241, 109, 115, .8)',\r\n        '2': 'rgba(255, 235, 59, .7)',\r\n        '3': 'rgba(147, 235, 248, 1)'\r\n    };\r\n\r\n\tvar defaultOpt = {\r\n\t\tmapName: 'china',     // 地图展示\r\n\t\tgoDown: false,        // 是否下钻\r\n\t\tbgColor: '#404a59',   // 画布背景色\r\n        activeArea: [],       // 区域高亮,同echarts配置项\r\n        data: [],\r\n        // 下钻回调(点击的地图名、实例对象option、实例对象)\r\n        callback: function(name, option, instance){}\r\n\t};\r\n\tif(opt) opt = this.util.extend(defaultOpt, opt);\r\n    var handleEvents = {\r\n        /**\r\n         * name 地图名\r\n        **/\r\n        createBreadcrumb: function(name){\r\n            var cityToPinyin = {\r\n                \"盐城市\": \"yancheng\",\r\n                \"徐州市\": \"xuzhou\",\r\n                \"南通市\": \"nantong\",\r\n                \"淮安市\": \"huaian\",\r\n                \"苏州市\": \"suzhou\",\r\n                \"宿迁市\": \"suqian\",\r\n                \"连云港市\": \"lianyungang\",\r\n                \"扬州市\": \"yangzhou\",\r\n                \"南京市\": \"nanjing\",\r\n                \"泰州市\": \"taizhou\",\r\n                \"无锡市\": \"wuxi\",\r\n                \"常州市\": \"changzhou\",\r\n                \"镇江市\": \"zhenjiang\"\r\n            };\r\n            var breadcrumb = {\r\n                type: 'group',\r\n                id: name,\r\n                left: pos.leftCur + pos.leftPlus,\r\n                top: pos.top + 3,\r\n                children: [{\r\n                    type: 'polyline',\r\n                    left: -90,\r\n                    top: -5,\r\n                    shape: {\r\n                        points: line\r\n                    },\r\n                    style: {\r\n                        stroke: '#fff',\r\n                        key: name\r\n                        // lineWidth: 2,\r\n                    },\r\n                    onclick: function(){\r\n                        var name = this.style.key;\r\n                        handleEvents.resetOption(chart, option, name);\r\n                    }\r\n                }, {\r\n                    type: 'text',\r\n                    left: -68,\r\n                    top: 'middle',\r\n                    style: {\r\n                        text: name,\r\n                        textAlign: 'center',\r\n                        fill: style.textColor,\r\n                        font: style.font\r\n                    },\r\n                    onclick: function(){\r\n                        var name = this.style.text;\r\n                        handleEvents.resetOption(chart, option, name);\r\n                    }\r\n                }, {\r\n                    type: 'text',\r\n                    left: -68,\r\n                    top: 10,\r\n                    style: {\r\n\r\n                        name: name,\r\n                        text: cityToPinyin[name] ? cityToPinyin[name].toUpperCase() : '',\r\n                        textAlign: 'center',\r\n                        fill: style.textColor,\r\n                        font: '12px \"Microsoft YaHei\", sans-serif',\r\n                    },\r\n                    onclick: function(){\r\n                        // console.log(this.style);\r\n                        var name = this.style.name;\r\n                        handleEvents.resetOption(chart, option, name);\r\n                    }\r\n                }]\r\n            }\r\n\r\n            pos.leftCur += pos.leftPlus;\r\n\r\n            return breadcrumb;\r\n        },\r\n\r\n        // 设置effectscatter\r\n        initSeriesData: function(data){\r\n            var temp = [];\r\n            for(var i = 0;i < data.length;i++){\r\n                var geoCoord = geoCoordMap[data[i].name];\r\n                if(geoCoord){\r\n                    temp.push({\r\n                        name: data[i].name,\r\n                        value: geoCoord.concat(data[i].value, data[i].level)\r\n                    });\r\n                }\r\n            };\r\n            return temp;\r\n        },\r\n\r\n        zoomAnimation: function(){\r\n            var count = null;\r\n            var zoom = function(per){\r\n                if(!count) count = per;\r\n                count = count + per;\r\n                // console.log(per,count);\r\n                chart.setOption({\r\n                    geo: {\r\n                        zoom: count\r\n                    }\r\n                });\r\n                if(count < 1) window.requestAnimationFrame(function(){\r\n                    zoom(0.2);\r\n                });\r\n            };\r\n            window.requestAnimationFrame(function(){\r\n                zoom(0.2);\r\n            });\r\n        }\r\n    };\r\n    \r\n    var option = {\r\n    \tbackgroundColor: opt.bgColor,\r\n    \ttooltip: {\r\n            trigger: 'item',\r\n            formatter: function (params) {\r\n              if(typeof(params.value)[2] == \"undefined\"){\r\n              \treturn params.name + ' : ' + params.value;\r\n              }else{\r\n              \treturn params.name + ' : ' + params.value[2];\r\n              }\r\n            }\r\n        },\r\n    \t\r\n        geo: {\r\n        \tmap: opt.mapName,\r\n            // roam: true,\r\n            zoom: 1,\r\n        \tlabel: {\r\n                normal: {\r\n                    show: true,\r\n                    textStyle: {\r\n                        color: '#fff'\r\n                    }\r\n                },\r\n                emphasis: {\r\n                    textStyle: {\r\n                        color: '#fff'\r\n                    }\r\n                }\r\n            },\r\n            itemStyle: {\r\n                normal: {\r\n                    borderColor: 'rgba(147, 235, 248, 1)',\r\n                    borderWidth: 1,\r\n                    areaColor: {\r\n                        type: 'radial',\r\n                        x: 0.5,\r\n                        y: 0.5,\r\n                        r: 0.8,\r\n                        colorStops: [{\r\n                            offset: 0, \r\n                            color: 'rgba(147, 235, 248, 0)' // 0% 处的颜色\r\n                        }, {\r\n                            offset: 1, \r\n                            color: 'rgba(147, 235, 248, .2)' // 100% 处的颜色\r\n                        }],\r\n                        globalCoord: false // 缺省为 false\r\n                    },\r\n                    shadowColor: 'rgba(128, 217, 248, 1)',\r\n                    // shadowColor: 'rgba(255, 255, 255, 1)',\r\n                    shadowOffsetX: -2,\r\n                    shadowOffsetY: 2,\r\n                    shadowBlur: 10\r\n                },\r\n                emphasis: {\r\n                    areaColor: '#389BB7',\r\n                    borderWidth: 0\r\n                }\r\n            },\r\n            regions: opt.activeArea.map(function(item){\r\n                if(typeof item !== 'string'){\r\n                    return {\r\n                        name: item.name,\r\n                        itemStyle: {\r\n                            normal: {\r\n                                areaColor: item.areaColor || '#389BB7'\r\n                            }\r\n                        },\r\n                        label: {\r\n                            normal: {\r\n                                show: item.showLabel,\r\n                                textStyle: {\r\n                                    color: '#fff'\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }else{\r\n                    return {\r\n                        name: item,\r\n                        itemStyle: {\r\n                            normal: {\r\n                                borderColor: '#91e6ff',\r\n                                areaColor: '#389BB7'\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n        },\r\n        series: [{\r\n            type: 'effectScatter',\r\n            coordinateSystem: 'geo',\r\n            // symbol: 'diamond',\r\n            showEffectOn: 'render',\r\n            rippleEffect: {\r\n                period: 15,\r\n                scale: 6,\r\n                brushType: 'fill'\r\n            },\r\n            hoverAnimation: true,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: function(params){\r\n                        return levelColorMap[params.value[3]];\r\n                    },\r\n                    shadowBlur: 10,\r\n                    shadowColor: '#333'\r\n                }\r\n            },\r\n            data: handleEvents.initSeriesData(opt.data)\r\n        }]\r\n    };\r\n\r\n    chart.setOption(option);\r\n\r\n};\r\n\r\n$.getJSON(jiangsu, function(geoJson){\r\n    echarts.registerMap('江苏', geoJson);\r\n    var myChart = echarts.extendsMap('chart-panel', {\r\n    \tbgColor: '#154e90', // 画布背景色\r\n    \tmapName: '江苏',    // 地图名\r\n    \tgoDown: false,       // 是否下钻\r\n    \t// 下钻回调\r\n    \tcallback: function(name, option, instance){\r\n    \t\tconsole.log(name, option, instance);\r\n    \t},\r\n        // 数据展示            \t\r\n    \tdata: [{\r\n    \t\tname: '南京市',\r\n    \t\tvalue: 0,\r\n    \t\tlevel: 2\r\n    \t}, {\r\n    \t\tname: '无锡市',\r\n    \t\tvalue: 12,\r\n    \t\tlevel: 4\r\n    \t}, {\r\n    \t\tname: '南通市',\r\n    \t\tvalue: 11,\r\n    \t\tlevel: 3\r\n    \t}, {\r\n    \t\tname: '宿迁市',\r\n    \t\tvalue: 16,\r\n    \t\tlevel: 2\r\n    \t}, {\r\n    \t\tname: '徐州市',\r\n    \t\tvalue: 12,\r\n    \t\tlevel: 1\r\n    \t}]\r\n    });\r\n})\r\n","html":"","externalScripts":"","updaterUID":"bd-4045335863","theme":"","layout":"","viewCount":958,"userName":"80608989","commentCount":1,"starCount":7,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xSEdy0J7e5.png?v=1551929122246","isCustomThumbnail":0,"builtinTags":["category-work","geo","series-effectScatter","tooltip"],"customTags":["jiangsu","jiangsusheng","江苏","江苏省"],"updaterUserName":"80608989"}}