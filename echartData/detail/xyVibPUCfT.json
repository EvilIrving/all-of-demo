{"status":0,"data":{"cid":"xyVibPUCfT","authorUid":"bd-859018119","authorUserName":"omglhw","title":"漏斗 转化率（待优化）","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2018-10-12T07:42:30.000Z","lastUpdateTime":"2018-10-12T07:42:30.000Z","auth":2,"uid":"bd-859018119","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.2.0","versionCreateTime":"2018-10-12T07:42:30.000Z","code":"const funnelData =[\n                {value: 60, name: '访问',type:'funnel'},\n                {value: 50, name: '咨询',type:'funnel'},\n                {value: 20, name: '订单',type:'funnel',\n                itemStyle:{\n                    \n                    normal:{\n                        color: '#E25424'\n                    }\n                }},\n                {value: 80, name: '点击',type:'funnel'},\n                {value: 100, name: '展现',type:'funnel',\n                itemStyle:{\n                    \n                    normal:{\n                        color: {\n    type: 'linear',\n    x: 0,\n    y: 0,\n    x2: 1,\n    y2: 1,\n    colorStops: [{\n        offset: 0, color: 'red' // 0% 处的颜色\n    }, {\n        offset: 1, color: 'blue' // 100% 处的颜色\n    }],\n    globalCoord: false // 缺省为 false\n}\n                    }\n                }\n                    \n                }\n            ];\n       \n    \nconst cvsWidth =950;\nconst cvsHeight =793;\nconst optTop = 60;\nconst optBottom=60;\nconst maxs = 80;\nconst maxSize = maxs + '%';\nconst colorList = ['#E25424','#FCBB13','6DC0AC','#22B14C','#B5E61D'];\nconst rx =  (10+maxs) +'%';\nconst lx ='10%';\nlet lineData =[];\nlet pointData =[{\n            name: '总转化率10%',\n            x: '50%',\n            y: 10,\n            symbol:'roundRect',\n            symbolSize:[110,25],\n            symbolOffset:[0,5],\n             itemStyle:{\n                 normal:{\n                    color:'#ffffff',\n                    align:'right',\n                 },\n                 \n            },\n             label:{\n                 normal:{\n                    color:'#000000',\n                    fontSize:16,\n                    align:'center',\n\n                 },\n                 emphasis:{\n                     color:'#007DFD'\n                 }\n                 \n            }\n        }];\n\n//const d = (80/100)*\nconst funnelHeight =cvsHeight-optTop-optBottom;\nconst funnelItemHeight = funnelHeight/funnelData.length;\nfunnelData.sort((a,b)=>a.value<b.value).forEach((item,index)=>{\n    // 好像是maxsize为125% ft 满屏\n    const itemWidth =item.value*(maxs/125);\n    const y = index*funnelItemHeight + funnelItemHeight/2+optTop;\n    \n    lineData.push( [\n        {   \n            \n            name: '两个屏幕坐标之间的标线',\n            x: (50+(itemWidth/2)) + '%',\n            y:y\n        },\n        {\n            x: rx,\n            y: y,\n            symbolSize:[1,1]\n\n        }\n    ]);\n    lineData.push( [\n        {   \n            \n            name: '两个屏幕坐标之间的标线',\n            x: (50-(itemWidth/2)) + '%',\n            y:y\n        },\n        {\n            x: lx,\n            y: y,\n            symbolSize:[1,1]\n\n        }\n    ]);\n    pointData.push({\n            name: '',\n            x: rx,\n            y: y-10,\n            symbol:'circle',\n            symbolSize:[10,10],\n            symbolOffset:[15,10],\n            itemStyle:{\n                normal:{\n                    color:colorList[index]\n                }\n            }\n        });\n         pointData.push({\n            name: '进入列表名称',\n            x: rx,\n            y: y-10,\n            symbol:'circle',\n            symbolSize:[0,1],\n             symbolOffset:[35,0],\n        \n            label:{\n                 normal:{\n                 color:'#7D7D7D',\n                  align:'left',\n                  fontSize:14,\n                 }\n                \n            }\n        });\n        \n        pointData.push({\n            name: '10000000000',\n            x: rx,\n            y: y-10,\n            symbol:'circle',\n            symbolSize:[0,1],\n            symbolOffset:[35,25],\n            label:{\n                 normal:{\n                    color:'#000000',\n                    fontSize:24,\n                    align:'left',\n                 }\n            }\n        });\n        \n        pointData.push({\n            name: '转化率',\n            x: lx,\n            y: y-10,\n            symbol:'circle',\n            symbolSize:[0,1],\n             symbolOffset:[-15,0],\n        \n            label:{\n                 normal:{\n                 color:'#7D7D7D',\n                  align:'right',\n                  fontSize:14,\n                 }\n                \n            }\n        });\n        pointData.push({\n            type:'converRate',\n            name: '90%',\n            x: lx,\n            y: y-10,\n            symbol:'roundRect',\n            symbolSize:[60,25],\n            symbolOffset:[-35,25],\n            itemStyle:{\n                 normal:{\n                    color:'#ffffff',\n                    align:'right',\n                 },\n                 \n            },\n            label:{\n                 normal:{\n                    color:'#000000',\n                    fontSize:24,\n                    align:'right',\n                    position:[55,0]\n                 },\n                 emphasis:{\n                     color:'#007DFD'\n                 }\n                 \n            }\n        });\n        \n});\noption = {\n    tooltip: {\n        trigger: 'item',\n        formatter: function(tp){\n            if(tp.data.type==='funnel'){\n                return tp.value;\n            }\n            return '';\n        },\n    },\n    calculable: true,\n    series: [\n        {\n            name:'漏斗图',\n            type:'funnel',\n            top: optTop,\n            //x2: 80,\n            bottom: optBottom,\n            // height: {totalHeight} - y - y2,\n            min: 0,\n            max: 100,\n            minSize: '0%',\n            maxSize: maxSize,\n            sort: 'descending',\n            markPoint:{\n            \n                label:{\n                    normal:{\n                    show:true,\n                    formatter:function(pt){\n                        return pt.name;\n                    }\n                    }\n                },\n                data: pointData\n            },\n            markLine:{\n                silent:true,\n                lineStyle:{\n                    normal:{\n                        color:'#eeeeee',\n                        type:'solid'\n                    }\n                   \n                },\n                label:{\n                    normal:{\n                    show:false,\n                    },\n                    \n                },\n                data: lineData\n            },\n            gap: 2,\n            label: {\n                normal: {\n                    show: false,\n                },\n                emphasis: {\n                     show: false,\n                    textStyle: {\n                        fontSize: 20\n                    }\n                }\n            },\n            data: funnelData,\n            }\n    ]\n};\nmyChart.on('click', function (params) {\n   if(params.data.type==='converRate'){\n       \n       console.log(params,'converRate');\n   }\n});\n\n","html":"","externalScripts":"","updaterUID":"bd-859018119","theme":"","layout":"","viewCount":1330,"userName":"omglhw","commentCount":2,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xyVibPUCfT.png?v=1539330151021","isCustomThumbnail":0,"builtinTags":["category-work","markLine","markPoint","series-funnel","tooltip"],"customTags":[],"updaterUserName":"omglhw"}}