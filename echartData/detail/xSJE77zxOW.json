{"status":0,"data":{"cid":"xSJE77zxOW","authorUid":"bd-658419289","authorUserName":"经***4","title":"业务信息飞线图","description":"江苏省江阴市","latestVersion":1,"alwaysLatest":1,"createTime":"2017-08-15T06:22:19.000Z","lastUpdateTime":"2017-08-15T06:22:19.000Z","auth":2,"uid":"bd-658419289","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"3.6.2","versionCreateTime":"2017-08-15T06:22:19.000Z","code":"var uploadedDataURL_jiangyin = \"/asset/get/s/data-1502776163655-BynDiZe_b.json\";\r\n\r\nvar uploadedDataURL_data = \"/asset/get/s/data-1502774981085-HJaaUZgd-.json\";\r\n\r\n// var jiangyin_map = echarts.init(document.getElementById(\"jiangyin_map\"));\r\n$.getJSON(uploadedDataURL_data, function(map_data) {\r\n    $.getJSON(uploadedDataURL_jiangyin, function(jiangyin_map) {\r\n        echarts.registerMap('jiangyin', jiangyin_map);\r\n    var JYData = map_data.JYdata; //接受信息的数据\r\n    var convertData2 = function(data) {\r\n        var res = [];\r\n        for (var i = 0; i < data.length; i++) {\r\n            var geoCoord = map_data.jiangyin_geoCoordMap[data[i].name];\r\n            if (geoCoord) {\r\n                res.push({\r\n                    name: data[i].name,\r\n                    value: geoCoord.concat(data[i].value)\r\n                });\r\n            }\r\n        }\r\n        return res;\r\n    }; //接受信息的地区与其经纬匹配的方法\r\n    var convertData1 = function(data) {\r\n        var res = [];\r\n        for (var i = 0; i < data.length; i++) {\r\n            var geoCoord = map_data.jiangyin_geoCoordMap[data[i][0].name];\r\n            if (geoCoord) {\r\n                res.push({\r\n                    name: data[i][0].name,\r\n                    value: geoCoord.concat(data[i][1].value)\r\n                });\r\n            }\r\n        }\r\n        return res;\r\n    }; //各地区重要性与其经纬度匹配的方法\r\n\r\n    var convertData = function(data) {\r\n        var res = [];\r\n        for (var i = 0; i < data.length; i++) {\r\n            var dataItem = data[i];\r\n            var fromCoord = map_data.jiangyin_geoCoordMap[dataItem[0].name];\r\n            var toCoord = map_data.jiangyin_geoCoordMap[dataItem[1].name];\r\n            if (fromCoord && toCoord) {\r\n                res.push({\r\n                    fromName: dataItem[0].name,\r\n                    toName: dataItem[1].name,\r\n                    coords: [fromCoord, toCoord]\r\n                });\r\n            }\r\n        }\r\n        return res;\r\n    }; //飞线起点和终点的方法\r\n\r\n    var color = ['#f4e925']; //线的颜色\r\n    var JYseries = [];\r\n    [\r\n        ['主机', JYData]\r\n    ].forEach(function(item, i) {\r\n        JYseries.push({\r\n                name: '飞线',\r\n                type: 'lines', //类型为线型\r\n                zlevel: 2, //浮现在模板上面\r\n                effect: {\r\n                    animation: false,\r\n                    show: true,\r\n                    constantSpeed: 70, //速度\r\n                    trailLength: 0.5, //尾巴长度\r\n                    color: '#fff', //颜色\r\n                    symbolSize: 3 //宽度\r\n                }, //效果\r\n                lineStyle: {\r\n                    normal: {\r\n                        color: color[i], //颜色\r\n                        width: 0, //外框\r\n                        curveness: 0.2 //弧度\r\n                    }\r\n                }, //线的效果\r\n                data: convertData(item[1])\r\n            } //飞线\r\n            , {\r\n                name: '地区',\r\n                type: 'scatter',\r\n                coordinateSystem: 'geo',\r\n                data: convertData2(map_data.jiangyin_value),\r\n                symbolSize: function(val) {\r\n                    return val[2] / 15; //重要性比例\r\n                },\r\n                label: {\r\n                    normal: {\r\n                        formatter: '{b}',\r\n                        position: 'right',\r\n                        show: false\r\n                    },\r\n                    //标签显示\r\n                    emphasis: {\r\n                        show: true\r\n                    }\r\n                },\r\n                itemStyle: {\r\n                    normal: {\r\n                        color: '#BBA02C' //地区颜色\r\n\r\n                    },\r\n\r\n                }\r\n            } //各地区具体显示\r\n            , {\r\n                name: '接收点',\r\n                type: 'effectScatter',\r\n                coordinateSystem: 'geo',\r\n                data: convertData2(map_data.jiangyin_value.sort(function(a, b) {\r\n                    return b.value - a.value;\r\n                }).slice(0, 1)),\r\n                symbolSize: function(val) {\r\n                    return val[2] / 10; //接受点的重要性比例\r\n                },\r\n                showEffectOn: 'render',\r\n                rippleEffect: {\r\n                    brushType: 'stroke'\r\n                },\r\n                hoverAnimation: true,\r\n                label: {\r\n                    normal: {\r\n                        formatter: '{b}',\r\n                        position: 'right',\r\n                        show: true\r\n                    }\r\n                }, //标签\r\n                itemStyle: {\r\n                    normal: {\r\n                        color: '#f4e925',\r\n                        shadowBlur: 10, //阴影大小\r\n                        shadowColor: '#333' //阴影颜色\r\n                    }\r\n                },\r\n                zlevel: 1\r\n            } //接收点\r\n            , {\r\n                name: '发出点',\r\n                type: 'effectScatter',\r\n                coordinateSystem: 'geo',\r\n                data: convertData1(JYData),\r\n                symbolSize: function(val) {\r\n                    return val[2] / 10; //比例\r\n                },\r\n                showEffectOn: 'render',\r\n                rippleEffect: {\r\n                    brushType: 'stroke'\r\n                },\r\n                hoverAnimation: true,\r\n                label: {\r\n                    normal: {\r\n                        formatter: '{b}',\r\n                        position: 'right',\r\n                        show: true\r\n                    }\r\n                },\r\n                itemStyle: {\r\n                    normal: {\r\n                        color: '#f4e925',\r\n                        shadowBlur: 10,\r\n                        shadowColor: '#333'\r\n                    } //阴影效果\r\n                },\r\n                zlevel: 1\r\n            }, //发出点的形态\r\n            {\r\n                name: '报警',\r\n                type: 'effectScatter',\r\n                coordinateSystem: 'geo',\r\n                data: convertData1(map_data.JYalarmdata),\r\n                symbolSize: function(val) {\r\n                    return val[2] / 10; //比例\r\n                },\r\n                showEffectOn: 'render',\r\n                rippleEffect: {\r\n                    brushType: 'stroke'\r\n                },\r\n                hoverAnimation: true,\r\n                label: {\r\n                    normal: {\r\n                        formatter: '{b}',\r\n                        position: 'right',\r\n                        show: true\r\n                    }\r\n                },\r\n                itemStyle: {\r\n                    normal: {\r\n                        color: 'red',\r\n                        shadowBlur: 10,\r\n                        shadowColor: '#333'\r\n                    } //阴影效果\r\n                },\r\n                zlevel: 1\r\n            } //长时间没发出消息点的形态\r\n        );\r\n    });\r\n\r\n    option = {\r\n        backgroundColor: '#404a59', //整体背景颜色\r\n        title: [{\r\n                text: '业务信息',\r\n                subtext: '江苏省江阴市',\r\n                left: '45%',\r\n                textStyle: {\r\n                    color: '#fff'\r\n                }\r\n            } //标题属性\r\n        ],\r\n\r\n        tooltip: {\r\n            trigger: 'item'\r\n        }, //信息显示\r\n        grid: {\r\n            right: 40,\r\n            top: 100,\r\n            bottom: 40,\r\n            width: '30%'\r\n        },\r\n        legend: {\r\n            orient: 'vertical',\r\n            top: 'bottom',\r\n            left: 'right',\r\n            data: ['主机信息'],\r\n            textStyle: {\r\n                color: '#fff'\r\n            },\r\n            selectedMode: 'single'\r\n        },\r\n        geo: {\r\n            map: 'jiangyin', //地图名称\r\n            label: {\r\n                emphasis: {\r\n                    show: false\r\n                }\r\n            }, //地图标签\r\n            roam: true,\r\n            itemStyle: {\r\n                normal: {\r\n                    areaColor: '#323c48', //内部颜色\r\n                    borderColor: '#404a59' //外部颜色\r\n                },\r\n                emphasis: {\r\n                    areaColor: '#2a333d' //触摸后的颜色\r\n                }\r\n            }\r\n        }, //地图信息\r\n        series: JYseries\r\n    };\r\n    myChart.setOption(option);\r\n    });\r\n});","html":"","externalScripts":"","updaterUID":"bd-658419289","theme":"","layout":"","viewCount":3498,"userName":"经***4","commentCount":0,"starCount":7,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xSJE77zxOW.png?v=1502778139737","isCustomThumbnail":0,"builtinTags":["category-work","geo","legend","series-effectScatter","series-lines","series-scatter","title","tooltip"],"customTags":[],"updaterUserName":"经***4"}}