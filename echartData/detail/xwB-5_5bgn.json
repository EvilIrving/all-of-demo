{"status":0,"data":{"cid":"xwB-5_5bgn","authorUid":"obd-o2wgiLCNpsY76_mhWRjiALnELcIpTBi","authorUserName":"七***乐","title":"myself","description":"","latestVersion":2,"alwaysLatest":1,"createTime":"2020-04-08T12:43:54.000Z","lastUpdateTime":"2020-04-08T12:43:54.000Z","auth":2,"uid":"obd-o2wgiLCNpsY76_mhWRjiALnELcIpTBi","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.7.0","versionCreateTime":"2020-04-08T12:44:40.000Z","code":"var nodes = [{\r\n    \"name\": \"字节跳动\"\r\n}, {\r\n    \"name\": \"美团\"\r\n}, {\r\n    \"name\": \"百度\"\r\n}, {\r\n    \"name\": \"阿里\"\r\n}, {\r\n    \"name\": \"京东\"\r\n}, {\r\n    \"name\": \"饿了么\"\r\n}];\r\n\r\nvar links = [{\r\n    \"source\": \"字节跳动\",\r\n    \"target\": \"美团\"\r\n}, {\r\n    \"source\": \"字节跳动\",\r\n    \"target\": \"百度\"\r\n}, {\r\n    \"source\": \"字节跳动\",\r\n    \"target\": \"阿里\"\r\n}, {\r\n    \"source\": \"美团\",\r\n    \"target\": \"京东\"\r\n}, {\r\n    \"source\": \"美团\",\r\n    \"target\": \"饿了么\"\r\n}, {\r\n    \"source\": \"美团\",\r\n    \"target\": \"百度\"\r\n}]\r\n\r\n\r\n\r\n// 第一处\r\nlet searchedValue = '';\r\nlet resOld = '';\r\nif (!document.getElementById('searchInput')) {\r\n    document.getElementById('chart-panel').style.marginTop = '100px'\r\n    var text = document.createElement('span');\r\n    text.innerHTML = '名称搜索：';\r\n    text.style.fontSize = '12px';\r\n    document.body.appendChild(text);\r\n    var input = document.createElement('input');\r\n    input.id = 'searchInput';\r\n    document.body.appendChild(input);\r\n}\r\nsetInterval(() => {\r\n    searchedValue = document.getElementById('searchInput').value;\r\n    if (resOld !== searchedValue) {\r\n        init();\r\n    }\r\n    resOld = searchedValue;\r\n}, 1000);\r\n\r\n\r\n\r\nfunction init() {\r\n    // 第二处 - 将主要逻辑封装为init函数（注意下面的nodes，使用JSON.parse(JSON.stringify(nodes))）\r\n    let data = {\r\n        nodes: JSON.parse(JSON.stringify(nodes)),\r\n        links: links,\r\n    }\r\n    const color1 = '#006acc';\r\n    const color2 = '#ff7d18';\r\n    const color3 = '#10a050';\r\n    data.nodes.forEach(node => {\r\n        if (node.category === 0) {\r\n            node.symbolSize = 100;\r\n            node.itemStyle = {\r\n                color: color1\r\n            };\r\n        } else if (node.category === 1) {\r\n            node.itemStyle = {\r\n                color: color2\r\n            };\r\n        }\r\n        //  第三处\r\n        //  精准匹配\r\n        // if (searchedValue &&  node.name === searchedValue) {\r\n        \r\n        // 模糊匹配\r\n        if (searchedValue && node.name.toLowerCase().indexOf(searchedValue.toLowerCase()) > -1) {\r\n            node.itemStyle = {\r\n                color: 'black'\r\n            };\r\n        }\r\n    });\r\n\r\n    data.links.forEach(link => {\r\n        link.label = {\r\n            align: 'center',\r\n            fontSize: 12\r\n        };\r\n\r\n        if (link.name === '参股') {\r\n            link.lineStyle = {\r\n                color: color2\r\n            }\r\n        } else if (link.name === '董事') {\r\n            link.lineStyle = {\r\n                color: color1\r\n            }\r\n        } else if (link.name === '法人') {\r\n            link.lineStyle = {\r\n                color: color3\r\n            }\r\n        }\r\n    });\r\n\r\n    let categories = [{\r\n            name: '公司',\r\n            itemStyle: {\r\n                color: color1\r\n            }\r\n        },\r\n        {\r\n            name: '董事',\r\n            itemStyle: {\r\n                color: color2\r\n            }\r\n        }\r\n    ]\r\n\r\n    option = {\r\n        title: {\r\n            text: '知识图谱',\r\n        },\r\n        legend: [{\r\n            // selectedMode: 'single',\r\n            data: categories.map(x => x.name),\r\n            // icon: 'circle'\r\n        }],\r\n        series: [{\r\n            type: 'graph',\r\n            layout: 'force',\r\n            symbolSize: 58,\r\n            draggable: true,\r\n            roam: true,\r\n            focusNodeAdjacency: true,\r\n            categories: categories,\r\n            edgeSymbol: ['', 'arrow'],\r\n            // edgeSymbolSize: [80, 10],\r\n            edgeLabel: {\r\n                normal: {\r\n                    show: true,\r\n                    textStyle: {\r\n                        fontSize: 20\r\n                    },\r\n                    formatter(x) {\r\n                        return x.data.name;\r\n                    }\r\n                }\r\n            },\r\n            label: {\r\n                show: true,\r\n            },\r\n            force: {\r\n                repulsion: 2000,\r\n                edgeLength: 120\r\n            },\r\n            data: data.nodes,\r\n            links: data.links\r\n        }]\r\n    }\r\n    // 第四处：\r\n    myChart.setOption(option);\r\n}\r\n\r\n\r\n// 第五处\r\ninit();","html":"","externalScripts":"","updaterUID":"obd-o2wgiLCNpsY76_mhWRjiALnELcIpTBi","theme":"","layout":"","viewCount":1016,"userName":"七***乐","commentCount":0,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xwB-5_5bgn.png?v=1586349881102","isCustomThumbnail":0,"builtinTags":["category-work","legend","series-graph","title"],"customTags":[],"updaterUserName":"七***乐"}}