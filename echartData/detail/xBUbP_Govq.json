{"status":0,"data":{"cid":"xBUbP_Govq","authorUid":"obd-oFgGb1zRPm8v36ucmrb-EtcmkUK1v5z","authorUserName":"付***3","title":"CPU风扇","description":"可拖拽折线并可限制X/Y轴拖拽范围","latestVersion":1,"alwaysLatest":0,"createTime":"2021-07-28T07:36:59.000Z","lastUpdateTime":"2021-07-28T07:36:59.000Z","auth":2,"uid":"obd-oFgGb1zRPm8v36ucmrb-EtcmkUK1v5z","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"5.1.2","versionCreateTime":"2021-07-28T07:36:59.000Z","code":"    var top = 40,\n\t  left = 70,\n\t  right = 18,\n\t  bottom = 30;\n    var minX =  '',\n      maxX = '',\n      minY = '',\n      maxY =  '';\n\t var xName = '风扇转速',\n\t yName = '温度',\n\t text = 'CPU风扇',\n\t xUnit = '℃',\n\t yUnit = '%';\n\tvar symbolSize = 30;\n\t var list = [\n\t\t    [10, 20],\n\t\t    [30, 40],\n\t\t    [60, 70],\n\t\t    [100, 90]\n\t\t];\n\tvar maxVal = 0\n    var _data = list.map(item => {\n      return item[0]\n    })\n    _data.sort((a, b) => b - a)\n    if (_data.length > 0) {\n      maxVal = _data[0]\n    }\noption = {\n      title: {\n        text: text,\n        x: 'left',\n        textStyle: {\n          color: '#333',\n          fontWeight: 400,\n          fontSize: 14\n        }\n      },\n      tooltip: {\n        triggerOn: 'none',\n        // trigger: 'axis',\n        backgroundColor: '#39404D',\n        borderColor: 'rgba(234, 247, 255, 0.3)',\n        textStyle: {\n          color: '#EAF7FF',\n          fontSize: 13\n\n        },\n        borderRadius: 'none',\n        formatter(params) {\n          return params.data[0].toFixed(0) + xUnit + ' ' + '/' + ' ' + params.data[1].toFixed(0) + yUnit\n        },\n        padding: [\n          4, // 上\n          8, // 右\n          4, // 下\n          8 // 左\n        ]\n      },\n      grid: {\n        top: top+'px',\n        left: left+ 'px',\n        right: right+'px',\n        bottom: bottom+'px',\n      },\n      xAxis: {\n        min: 0,\n        max: maxVal,\n        // interval: maxVal,\n        type: 'value',\n        name: xName,\n        nameLocation: 'start',\n        // nameGap: 20,\n        axisLabel: {\n          showMaxLable: true, // 显示最大值\n          showMinLable: false, // 显示最小值\n          formatter(value) {\n            if (value !== maxVal) {\n              return ''\n            }\n            return value + xUnit // 格式时间显示方式\n          }\n        },\n        splitLine: {\n          // 网格线\n          lineStyle: {\n            type: 'dashed', // 设置网格线类型 dotted：虚线   solid:实线\n            width: 0.5,\n            color: '#39404D'\n          },\n          show: true // 隐藏或显示\n        },\n        axisLine: { onZero: false }\n      },\n      yAxis: {\n        min: 0,\n        max: 100,\n        type: 'value',\n        name: yName,\n        nameLocation: 'start',\n        // nameGap: 20,\n        axisLine: { onZero: false },\n        axisLabel: {\n          color: 'rgba(234, 247, 255, 0.4)',\n          showMaxLable: true, // 显示最大值\n          showMinLable: false, // 显示最小值\n          formatter(value) {\n            if (value === 0) {\n              return ''\n            }\n            return value + yUnit // 格式时间显示方式\n          }\n        },\n        splitLine: {\n          // 网格线\n          lineStyle: {\n            type: 'dashed', // 设置网格线类型 dotted：虚线   solid:实线\n            width: 0.5,\n            color: '#39404D'\n          },\n          show: true // 隐藏或显示\n        }\n      },\n      dataZoom: {\n        show: false\n      },\n      series: [\n        {\n          id: 'a',\n          type: 'line',\n          smooth: true,\n        //   symbol: this.symbol,\n          symbolSize: 30,\n          data: list,\n\n          legendHoverLink: false,\n          emphasis: {\n            scale: false\n          },\n         \n          areaStyle: {\n            normal: {\n              color: {\n                x: 0,\n                y: 0,\n                x2: 0,\n                y2: 1,\n                colorStops: [{\n                  offset: 0,\n                  color: 'rgba(234, 247, 255, 0.3)' // 0% 处的颜色\n                }, {\n                  offset: 1,\n                  color: 'rgba(234, 247, 255, 0)' // 100% 处的颜色\n                }],\n                globalCoord: false // 缺省为 false\n              }\n            }\n          }\n        }\n      ]\n    }\nsetTimeout(function () {\n    // Add shadow circles (which is not visible) to enable drag.\n    myChart.setOption({\n      graphic: echarts.util.map(list, (dataItem, dataIndex) => {\n        const that = this // 因为ondrag函数必须在回调内使用this.position获取实时坐标，此处必须用that替换this\n        return {\n          type: 'circle',\n          shape: {\n            // 圆点的半径。\n            r: symbolSize / 2\n          },\n          position: myChart.convertToPixel('grid', dataItem),\n          invisible: true,\n          draggable: true,\n          z: 100,\n          ondrag: function(dx, dy) {\n\t\t\t  // 临界值判断并处理\n\t\t\t\tif (this.y > maxY) {\n\t\t\t\t\t this.y = maxY-1\n\t\t\t\t} else if (this.y < minY) {\n\t\t\t\t\tthis.y = minY+1\n\t\t\t\t}\n\t\t\t\tif (this.x > maxX) {\n\t\t\t\t\t this.x = maxX-1\n\t\t\t\t} else if (this.x < minX) {\n\t\t\t\t\tthis.x = minX-1\n\t\t\t\t}\n\t\t\t\tonPointDragging(dataIndex, [this.x, this.y])\n\t\t  },\n          onmousemove: function() {\n            showTooltip(dataIndex)\n          },\n          onmousedown: function() {\n\t\t\t// 鼠标按下时获取当前远点 上一个及下一个原点位置 并计算出最大和最小x、y轴运动范围\n\t\t\tlet pre = null\n\t\t\tif(list[dataIndex - 1]){\n\t\t\t\tpre = myChart.convertToPixel('grid', list[dataIndex - 1]) // 得到上一个圆点原始位置\n\t\t\t}\n\t\t\tlet next = null\n\t\t\tif(list[dataIndex + 1]){\n\t\t\t\tnext = myChart.convertToPixel('grid', list[dataIndex + 1]) // 得到下一个圆点原始位置\n\t\t\t}\n\t\t\tlet cur = myChart.convertToPixel('grid', list[dataIndex]) // 得到当前圆点原始位置\n\t\t\tvar x1 = 0,y1 = 0,x2 = 0,y2 = 0;\n            if (pre) {\n              x1 = pre[0]\n              y1 = pre[1]\n            } else {\n\t\t\t\tif(next){\n\t\t\t\t\tif(cur[1]>next[1]){ //当前圆点在下一个点的左下方\n\t\t\t\t\t\tx1 = left+1\n\t\t\t\t\t\ty1 = myChart.getHeight()-bottom\n\t\t\t\t\t}else{\n\t\t\t\t\t\tx1 = left+1\n\t\t\t\t\t\ty1 = next[1]\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tx1 = myChart.getWidth()-(right+1)\n\t\t\t\t\ty1 = myChart.getHeight()-bottom\n\t\t\t\t}\n              \n            }\n            if (next) {\n             x2 = next[0]\n             y2 = next[1]\n            } else {\n\t\t\t\tif(pre){\n\t\t\t\t\tif(cur[1]>pre[1]){ //当前圆点在下一个点的右下方\n\t\t\t\t\t\tx2 = myChart.getWidth()-(right+1)\n\t\t\t\t\t\ty2 = myChart.getHeight()-bottom\n\t\t\t\t\t}else{\n\t\t\t\t\t\tx2 = myChart.getWidth()-(right+1)\n\t\t\t\t\t\ty2 = top\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tx1 = myChart.getWidth()-(right+1)\n\t\t\t\t\ty1 = myChart.getHeight()-bottom\n\t\t\t\t}\n            }\n\t\t\t\n\t\t\t\n\t\t\tif(x1>=x2){\n\t\t\t\tminX = x2\n\t\t\t    maxX = x1\n\t\t\t}else{\n\t\t\t\tminX = x1\n\t\t\t    maxX = x2\n\t\t\t}\n\t\t\tif(y1>=y2){\n\t\t\t\tminY = y2\n\t\t\t\tmaxY = y1\n\t\t\t}else{\n\t\t\t\tminY = y1\n\t\t\t\tmaxY = y2\n\t\t\t}\n          },\n          onmouseout: function() {\n            hideTooltip(dataIndex)\n          }\n        }\n      })\n    })\n}, 0);\n\n function showTooltip(dataIndex) {\n     myChart.dispatchAction({\n        type: 'showTip',\n        seriesIndex: 0,\n        dataIndex: dataIndex\n      })\n    }\n    function hideTooltip(dataIndex) {\n      myChart.dispatchAction({\n        type: 'hideTip'\n      })\n    }\nfunction onPointDragging(dataIndex, pos) {\n\t\tlet postion = myChart.convertFromPixel('grid', pos)\n\t\t  list[dataIndex][0] = postion[0]\n\t\t  list[dataIndex][1] = postion[1]\n      // Update data\n     myChart.setOption({\n        series: [{\n          id: 'a',\n          data: list\n        }]\n      })\n    }\n\n","html":"","externalScripts":"","updaterUID":"obd-oFgGb1zRPm8v36ucmrb-EtcmkUK1v5z","theme":"","layout":"","viewCount":0,"userName":"付***3","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xBUbP_Govq.png?v=1627457819293","isCustomThumbnail":0,"builtinTags":["category-work","dataZoom","graphic","grid","series-line","title","tooltip"],"customTags":[],"updaterUserName":"付***3"}}