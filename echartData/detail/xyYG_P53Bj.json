{"status":0,"data":{"cid":"xyYG_P53Bj","authorUid":"obd-oNSDCqu42JEySyKzZOfcy6UjgFt5dCi","authorUserName":"逆***h","title":"票面库存统计","description":"单位：万元","latestVersion":1,"alwaysLatest":1,"createTime":"2020-05-18T07:28:56.000Z","lastUpdateTime":"2020-05-18T07:28:56.000Z","auth":2,"uid":"obd-oNSDCqu42JEySyKzZOfcy6UjgFt5dCi","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.7.0","versionCreateTime":"2020-05-18T07:28:56.000Z","code":"var oldData = [{\n        \"DENOMINATION\": \"100\",\n        \"COFFERS_NAME\": \"第一金库\",\n        \"sumAmt\": 243.35\n    },\n    {\n        \"DENOMINATION\": \"50\",\n        \"COFFERS_NAME\": \"第一金库\",\n        \"sumAmt\": 40\n    },\n    {\n        \"DENOMINATION\": \"20\",\n        \"COFFERS_NAME\": \"第一金库\",\n        \"sumAmt\": 300\n    },\n    {\n        \"DENOMINATION\": \"10\",\n        \"COFFERS_NAME\": \"第一金库\",\n        \"sumAmt\": 40\n    },\n    {\n        \"DENOMINATION\": \"5\",\n        \"COFFERS_NAME\": \"第一金库\",\n        \"sumAmt\": 100\n    },\n    {\n        \"DENOMINATION\": \"100\",\n        \"COFFERS_NAME\": \"第二金库\",\n        \"sumAmt\": 100\n    },\n    {\n        \"DENOMINATION\": \"50\",\n        \"COFFERS_NAME\": \"第二金库\",\n        \"sumAmt\": 341.4514\n    },\n    {\n        \"DENOMINATION\": \"20\",\n        \"COFFERS_NAME\": \"第二金库\",\n        \"sumAmt\": 45.78\n    },\n    {\n        \"DENOMINATION\": \"10\",\n        \"COFFERS_NAME\": \"第二金库\",\n        \"sumAmt\": 40\n    },\n    {\n        \"DENOMINATION\": \"5\",\n        \"COFFERS_NAME\": \"第二金库\",\n        \"sumAmt\": 200\n    },\n    {\n        \"DENOMINATION\": \"100\",\n        \"COFFERS_NAME\": \"第三金库\",\n        \"sumAmt\": 89.6\n    },\n    {\n        \"DENOMINATION\": \"50\",\n        \"COFFERS_NAME\": \"第三金库\",\n        \"sumAmt\": 25.645\n    },\n    {\n        \"DENOMINATION\": \"20\",\n        \"COFFERS_NAME\": \"第三金库\",\n        \"sumAmt\": 7.685\n    },\n    {\n        \"DENOMINATION\": \"10\",\n        \"COFFERS_NAME\": \"第三金库\",\n        \"sumAmt\": 40\n    },\n    {\n        \"DENOMINATION\": \"5\",\n        \"COFFERS_NAME\": \"第三金库\",\n        \"sumAmt\": 300\n    },\n];\n\n\nvar datavalue = {\n    source: [\n        ['product']\n    ]\n};\n\nlet coffersArr = [],\n    denominationArr = [];\noldData.forEach((item) => {\n    if (denominationArr.indexOf(item.DENOMINATION) < 0) {\n        denominationArr.push(item.DENOMINATION);\n    }\n    if (coffersArr.indexOf(item.COFFERS_NAME) < 0) {\n        coffersArr.push(item.COFFERS_NAME);\n    }\n});\n\nfor (var i = 0; i < denominationArr.length + 1; i++) {\n    if (i === 0) {\n        for (var j = 0; j < coffersArr.length; j++) {\n            datavalue.source[i][j + 1] = coffersArr[j];\n        }\n    } else {\n        datavalue.source[i] = [];\n        datavalue.source[i][0] = denominationArr[i - 1];\n    }\n}\n\nfor (var i = 1; i < datavalue.source.length; i++) {\n    for (var j = 1; j < datavalue.source[0].length; j++) {\n        for (var k = 0; k < oldData.length; k++) {\n            //console.log(i+'-'+j+'-'+k);\n            if (datavalue.source[i][0] == oldData[k].DENOMINATION &&\n                datavalue.source[0][j] == oldData[k].COFFERS_NAME) {\n                datavalue.source[i][j] = oldData[k].sumAmt;\n            }\n        }\n    }\n}\nconsole.log(datavalue);\n/*\nvar datavalue ={\n    source: [\n        ['product', '第一金库', '第二金库', '第三金库'],\n        ['100', 41.1, 30.4, 65.1],\n        ['50', 86.5, 92.1, 85.7],\n        ['20', 24.1, 67.2, 79.5]\n    ]\n}\n*/\nsetTimeout(function() {\n\n    option = {\n        title: {\n            text: '票面库存统计',\n            subtext: '单位：万元',\n            left: 'center'\n        },\n\n        legend: {\n          right: '0'\n        },\n        tooltip: {\n            trigger: 'axis',\n            showContent: true,\n            position: 'outside'\n        },\n        dataset: datavalue,\n        xAxis: {\n            type: 'category'\n        },\n        yAxis: {\n            gridIndex: 0\n        },\n        grid: {\n            top: '55%'\n        },\n        series: [{\n                type: 'line',\n                smooth: true,\n                seriesLayoutBy: 'row'\n            },\n            {\n                type: 'line',\n                smooth: true,\n                seriesLayoutBy: 'row'\n            },\n            {\n                type: 'line',\n                smooth: true,\n                seriesLayoutBy: 'row'\n            },\n            {\n                type: 'line',\n                smooth: true,\n                seriesLayoutBy: 'row'\n            },\n            {\n                type: 'line',\n                smooth: true,\n                seriesLayoutBy: 'row'\n            },\n            {\n                type: 'line',\n                smooth: true,\n                seriesLayoutBy: 'row'\n            },\n            {\n                type: 'pie',\n                id: 'pie',\n                radius: ['30%', '20%'],\n                center: ['50%', '30%'],\n                label: {\n                    position: 'outside',\n                    formatter: '{b}: ({d}%)'\n                    //   formatter:function(data){\n                    //         console.log(data);\n                    //         return  data.name+\"：(\"+data.percent.toFixed(1)+\"%)\";\n                    //     }\n\n                },\n                encode: {\n                    itemName: 'product'\n                }\n            }\n        ]\n    };\n\n    myChart.on('updateAxisPointer', function(event) {\n        var xAxisInfo = event.axesInfo[0];\n        if (xAxisInfo) {\n            var dimension = xAxisInfo.value + 1;\n            myChart.setOption({\n                series: {\n                    id: 'pie',\n\n                    label: {\n                        formatter: '{b}: {@[' + dimension + ']} ({d}%)'\n                    },\n                    encode: {\n                        value: dimension,\n                        tooltip: dimension\n                    }\n                }\n            });\n        }\n    });\n\n    myChart.setOption(option);\n\n});","html":"","externalScripts":"","updaterUID":"obd-oNSDCqu42JEySyKzZOfcy6UjgFt5dCi","theme":"","layout":"","viewCount":67,"userName":"逆***h","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xyYG_P53Bj.png?v=1589786936514","isCustomThumbnail":0,"builtinTags":["category-work","dataset","grid","legend","series-line","series-pie","title","tooltip"],"customTags":[],"updaterUserName":"逆***h"}}