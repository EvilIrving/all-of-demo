{"status":0,"data":{"cid":"xkaj197GB1","authorUid":"bd-2552167583","authorUserName":"z***g","title":"区域折线图标记","description":"","latestVersion":24,"alwaysLatest":1,"createTime":"2020-08-26T04:22:38.000Z","lastUpdateTime":"2020-08-26T04:22:38.000Z","auth":2,"uid":"bd-2552167583","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":24,"parentVersion":23,"echartsVersion":"4.8.0","versionCreateTime":"2020-08-28T10:13:49.000Z","code":"function minArray(array) {\n    var min = array[0];\n    var len = array.length;\n    for (var i = 1; i < len; i++) {\n        if ((array[i] && array[i] < min) || array[i] == 0 && array[i] < min) {\n            min = array[i];\n        }\n    }\n    return Number(min);\n}\n\nfunction maxArray(array) {\n    var max = array[0];\n    var len = array.length;\n    for (var i = 0; i < len; i++) {\n        if ((array[i] && array[i] > max) || array[i] == 0 && array[i] > max) {\n            max = array[i];\n        }\n    }\n    return Number(max);\n}\n\nvar echartData = {\n    \"xAxis\": [\"2019-11-01 10:21:30\", \"2019-11-02 09:20:47\", \"2019-11-03 18:24:46\", \"2019-11-04 18:10:53\", \"2019-11-05 16:43:33\", \"2019-11-06 15:14:13\", \"2019-11-07 15:02:29\", \"2019-11-08 14:49:56\", \"2019-11-09 14:43:40\", \"2019-11-10 14:26:08\", \"2019-11-11 10:21:30\", \"2019-11-12 09:20:47\", \"2019-11-13 18:24:46\", \"2019-11-14 18:10:53\", \"2019-11-15 16:43:33\", \"2019-11-16 15:14:13\", \"2019-11-17 15:02:29\", \"2019-11-18 14:49:56\", \"2019-11-19 14:43:40\", \"2019-11-20 14:26:08\", \"2019-11-21 10:21:30\", \"2019-11-22 09:20:47\", \"2019-11-23 18:24:46\", \"2019-11-24 18:10:53\", \"2019-11-25 16:43:33\", \"2019-11-26 15:14:13\", \"2019-11-27 15:02:29\", \"2019-11-28 14:49:56\", \"2019-11-29 14:43:40\", \"2019-11-30 14:26:08\", \"2019-11-31 10:21:30\", \"2019-11-32 09:20:47\", \"2019-11-33 18:24:46\", \"2019-11-34 18:10:53\", \"2019-11-35 16:43:33\", \"2019-11-36 15:14:13\", \"2019-11-37 15:02:29\", \"2019-11-38 14:49:56\", \"2019-11-39 14:43:40\", \"2019-11-40 14:26:08\"],\n    \"data\": [73, 60, 87, 78, 78, 78, 72, 68, 68, 68, 73, 60, 87, 78, 78, 78, 72, 68, 68, 68, 73, 60, 87, 78, 78, 78, 72, 68, 68, 68, 73, 60, 87, 78, 78, 78, 72, 68, 68, 68]\n}\n\n//如果数据条数为1个，坐标标记出来，否则看不见\nvar sigle_point = {};\nif (echartData.xAxis.length == 1) {\n    sigle_point = {\n        data: [{\n            value: echartData.data[0],\n            xAxis: echartData.xAxis[0],\n            yAxis: echartData.data[0]\n        }]\n    };\n}\nvar configData = {\n    \"unit\": \"次/分\",\n    \"name\": \"心电\",\n    \"ymin\": 0,\n    \"ymax\": 0,\n    \"markYmin\": 60,\n    \"markYmax\": 100\n};\n\nvar minarr = minArray((echartData.data).concat([configData.markYmin])),\n    maxarr = maxArray((echartData.data).concat([configData.markYmax]));\nvar scale = Number(((maxarr - minarr) / 100 + 1).toFixed(2).slice(0, -1));\nconfigData.ymin = minarr / (scale == 1 ? 1.05 : scale);\nconfigData.ymax = maxarr * (scale == 1 ? 1.05 : scale);\n\n\noption = {\n    backgroundColor: \"#FFFFFF\",\n    title: {\n        text: `${configData.name}趋势图 {unit|${configData.unit}}`,\n        textStyle: {\n            color: \"#666666\",\n            fontSize: 14,\n            fontWeight: \"normal\",\n            rich: {\n                unit: {\n                    color: '#999999',\n                    fontSize: 12,\n                }\n\n            }\n        },\n        top: \"0\",\n        left: \"3%\"\n    },\n    tooltip: {\n        trigger: 'axis',\n        axisPointer: { // 坐标轴指示器，坐标轴触发有效\n            type: 'line', // 默认为直线，可选为：'line' | 'shadow'\n            lineStyle: { // 直线指示器样式设置\n                color: '#2AA2AA',\n                type: 'solid',\n                width: 1,\n                opacity: 0.8\n            }\n        },\n        enterable: true,\n        confine: true,\n        position: function(point, params, dom, rect, size) {\n            // 固定在顶部\n            //return [point[0], '20%'];\n\n            var point = point[0],\n                toowidth = 40;\n            if (point < toowidth + 10) {\n                toowidth = 5;\n            } else if (point + toowidth > size.viewSize[0] - toowidth) {\n                toowidth = toowidth * 2;\n            }\n            return [point - toowidth, '20%'];\n        },\n        formatter: function(params, ticket, callback) {\n            params[0].name = params[0].seriesName;\n            var detatime = \"\",\n                detaildate = '';\n            var detailcolor = '';\n            var detailseries = '';\n            var heartRate = '';\n            for (var i = 0; i < params.length; i++) {\n\n                detatime = params[i].axisValue;\n                var a = detatime.split(\" \"),\n                    b = a[0].split(\"-\"),\n                    c = a[1].split(\":\");\n                detaildate = b[1] + \"-\" + b[2] + \" \" + c[0] + \":\" + c[1];\n                detailcolor = params[i].color;\n                detailseries = params[i].name;\n                heartRate = params[i].value;\n            }\n\n            //回显\n            var html = \"\";\n            html += '<div style=\"width:80px;\">' + detaildate + '' +\n                '<br/><span style=\"display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:' + detailcolor + '\"></span>' + detailseries + '：' + heartRate +\n                '</div>';;\n            return html;\n        }\n    },\n    legend: {\n        show: true,\n        top: \"0\",\n        right: '12',\n        textStyle: {\n            color: \"#666666\",\n            fontWeight: \"normal\"\n        },\n        selectedMode: false\n    },\n    grid: {\n        left: '3%',\n        right: '3%',\n        top: '30',\n        bottom: '10',\n        containLabel: true\n    },\n    xAxis: {\n        type: 'category',\n        splitLine: {\n            show: false\n        },\n        boundaryGap: false,\n        inverse: true, //箭头是否反向显示\n        data: echartData.xAxis,\n        axisLabel: {\n            formatter: function(xVal) {\n                var x = xVal.split(\" \")[0].split(\"-\") /*,ddd=xVal.split(\" \")[1].split(\":\")*/ ;\n                return x[1] + \"-\" + x[2];\n            },\n            fontSize: \"13\",\n            color: \"#999999\"\n        },\n        axisLine: {\n            lineStyle: {\n                width: '0.5',\n                color: \"#B3B3B3\"\n            }\n        },\n        axisTick: {\n            show: false\n        }\n    },\n    yAxis: [{\n            type: 'value',\n            splitLine: {\n                show: false\n            },\n            position: 'left',\n            axisLine: {\n                lineStyle: {\n                    width: '0.5',\n                    color: \"#B3B3B3\"\n                }\n            },\n            axisTick: {\n                show: false\n            },\n            axisLabel: {\n                formatter: ''\n            },\n            min: configData.ymin.toFixed(0) < 10 ? 0 : configData.ymin.toFixed(0),\n            max: configData.ymax.toFixed(0) < 10 ? 10 : configData.ymax.toFixed(0)\n        },\n        {\n            type: 'value',\n            splitLine: {\n                show: false\n            },\n            position: 'right',\n            axisLine: {\n                lineStyle: {\n                    width: '0.5',\n                    color: \"#E7E7E7\"\n                }\n            },\n            axisTick: {\n                show: false\n            }\n        }\n    ],\n    series: [{\n            name: configData.name,\n            type: 'line',\n            symbol: \"emptyCircle\",\n            symbolSize: 8,\n            showAllSymbol: true,\n            smooth: false,\n            data: echartData.data,\n            markPoint: sigle_point,\n            markArea: {\n                silent: true,\n                show: true,\n                itemStyle: {\n                    normal: {\n                        color: \"#F4F9F0\",\n                        opacity: '1'\n                    }\n                },\n                data: [\n                    [{\n                        yAxis: configData.markYmin\n                    }, {\n                        yAxis: configData.markYmax\n                    }]\n                ]\n            },\n            lineStyle: {\n\n                color: \"#2AA2AA\",\n                width: '2'\n\n            },\n            itemStyle: {\n                color: \"#2AA2AA\",\n                opacity: '1'\n\n            },\n            markLine: {\n                silent: true,\n                show: true,\n                animation: false,\n                symbol: 'none', //是否显示箭头\n                lineStyle: {\n                    normal: {\n                        type: 'solid',\n                        color: \"#D7D7D7\",\n                        width: '0.5'\n                    }\n                },\n                tooltip: {\n                    formatter: ''\n                },\n                data: [{\n                        xAxis: 0,\n                        yAxis: configData.markYmax,\n                        label: {\n                            normal: {\n                                formatter: configData.markYmax,\n                                position: 'end',\n                                color: \"#999999\"\n                            }\n                        }\n                    },\n                    {\n                        xAxis: 0,\n                        yAxis: configData.markYmin,\n                        label: {\n                            normal: {\n                                formatter: configData.markYmin,\n                                position: 'end',\n                                color: \"#999999\"\n                            }\n                        }\n                    }\n                ]\n            }\n        },\n        {\n            name: '正常区间',\n            type: 'bar',\n            itemStyle: {\n                color: \"#E8F5E8\",\n                opacity: '1'\n            },\n            data: []\n        }\n    ]\n};","html":"","externalScripts":"","updaterUID":"bd-2552167583","theme":"","layout":"","viewCount":333,"userName":"z***g","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xkaj197GB1.png?v=1598609629583","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","markArea","markLine","markPoint","series-bar","series-line","title","tooltip"],"customTags":[],"updaterUserName":"z***g"}}