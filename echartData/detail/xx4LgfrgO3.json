{"status":0,"data":{"cid":"xx4LgfrgO3","authorUid":"bd-4111265691","authorUserName":"y***洋","title":"关系图","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2020-11-03T02:12:24.000Z","lastUpdateTime":"2020-11-03T02:12:24.000Z","auth":2,"uid":"bd-4111265691","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-11-03T02:12:24.000Z","code":"let data = [\n\t\t{\n\t\t\t\"id\": 1,\n\t\t\t\"personNo\": \"10020160141568900\",\n\t\t\t\"focusName\": \"唐孟先\",\n\t\t\t\"contactName\": \"王贵元\",\n\t\t\t\"message\": \"13948572295\",\n\t\t\t\"relation\": \"通联关系\"\n\t\t},\n\t\t{\n\t\t\t\"id\": 2,\n\t\t\t\"personNo\": \"10020160141568900\",\n\t\t\t\"focusName\": \"唐孟先\",\n\t\t\t\"contactName\": \"谢飞\",\n\t\t\t\"message\": \"乾隆首府B12栋\",\n\t\t\t\"relation\": \"同户关系\"\n\t\t},\n\t\t{\n\t\t\t\"id\": 3,\n\t\t\t\"personNo\": \"10020160141568900\",\n\t\t\t\"focusName\": \"唐孟先\",\n\t\t\t\"contactName\": \"陈诚\",\n\t\t\t\"message\": \"乾隆首府B12栋458室\",\n\t\t\t\"relation\": \"同住关系\"\n\t\t},\n\t\t{\n\t\t\t\"id\": 4,\n\t\t\t\"personNo\": \"10020160141568900\",\n\t\t\t\"focusName\": \"唐孟先\",\n\t\t\t\"contactName\": \"陈诚\",\n\t\t\t\"message\": \"18455294052\",\n\t\t\t\"relation\": \"通联关系\"\n\t\t},\n\t\t{\n\t\t\t\"id\": 5,\n\t\t\t\"personNo\": \"10020160141568900\",\n\t\t\t\"focusName\": \"唐孟先\",\n\t\t\t\"contactName\": \"张华\",\n\t\t\t\"message\": \"铁道学院-开福寺\",\n\t\t\t\"relation\": \"同行关系\"\n\t\t}\n\t]\n    \n    let seriesList = [], seriesData = [], categories = []\n      let linksData = [], legendData = []\n      data.forEach((item, index) => {\n          \n        //   item.name = item.contactName\n        //     item.category = item.relation\n            // seriesData.push({\n            //     name: item.contactName + index,\n            //     category: item.relation,\n            //     message: item.message,\n            //     draggable: true,\n            // })\n        \n        if (seriesList.indexOf(item.focusName) === -1) {\n          seriesList.push(item.focusName)\n        }\n        if (seriesList.indexOf(item.contactName) === -1) {\n          seriesList.push(item.contactName)\n          seriesData.push({\n            name: item.contactName,\n            category: item.relation,\n            message: item.message,\n            draggable: true,\n          })\n          linksData.push({\n            source: item.focusName,\n            target: item.contactName,\n            value: item.relation\n          })\n        } else {\n          seriesList.push(item.contactName + ' ')\n          seriesData.push({\n            name: item.contactName + ' ',\n            category: item.relation,\n            message: item.message,\n            draggable: true,\n          })\n          linksData.push({\n            source: item.focusName,\n            target: item.contactName + ' ',\n            value: item.relation\n          })\n        }\n        \n        if (categories.indexOf(item.relation) === -1) {\n          legendData.push(item.relation)\n        }\n        categories.push({\n          name: item.relation\n        })\n        \n      })\n  \n      //   seriesData = data\n        seriesData.push({\n          name: data[0].focusName,\n          draggable: true,\n          category: data[0].category\n        })\n    \n      // console.log(seriesList)\n      // seriesList.forEach((item, index) => {\n      //     seriesData.push({\n      //       name: item,\n      //       draggable: true,\n      //       itemStyle: {\n      //           color: '#0E4583'\n      //       }\n      //     })\n      // })\n        console.log(seriesList)\n       console.log(seriesData)\n       console.log(categories)\n       console.log(linksData)\n       console.log(legendData)\n\n option = {\n          color:['#199855', '#FF8C40', '#1EB0C1', '#C11E5B', '#0E4583'],\n          tooltip: {\n              trigger: 'item',\n              formatter: params => {\n                  console.log(params)\n                  let { data, dataType } = params\n                  if (dataType === \"node\") {\n                    let str = data.message ? `: ${data.message}` : ''\n                     return data.name + str\n                  }\n                  return ''\n              },\n              backgroundColor: \"#ff7f50\", //提示标签背景颜色 \n              textStyle: {\n                  color: \"#fff\"\n              } //提示标签字体颜色 \n          },\n          animationDurationUpdate: 1500,\n          animationEasingUpdate: 'quinticInOut',\n          label: {\n              normal: {\n                  show: true,\n                  textStyle: {\n                      fontSize: 12\n                  },\n              }\n          },\n          legend: {\n              right: 50,\n                top:50,\n              show: true,\n              data: legendData,\n              textStyle: {\n                  \n              }\n          },\n          series: [\n              {\n                  type: 'graph',\n                  layout: 'force',\n                  symbolSize: 45,\n                  focusNodeAdjacency: true,\n                  roam: true,\n                  categories: categories,\n                  label: {\n                      normal: {\n                          show: true,\n                          textStyle: {\n                              fontSize: 12\n                          },\n                        //   formatter: params => {\n                        //       console.log(params)\n                        //       let { data } = params\n                        //       let str = data.message ? `: ${data.message}` : ''\n                        //       return data.name + str\n                        //   },\n                      }\n                  },\n                  force: {\n                      repulsion: 1000\n                  },\n                  edgeSymbolSize: [4, 50],\n                  edgeLabel: {\n                      normal: {\n                          show: true,\n                          textStyle: {\n                              fontSize: 10\n                          },\n                          formatter: \"{c}\"\n                      }\n                  },\n                  data: seriesData,\n                  links: linksData,\n                  lineStyle: {\n                      normal: {\n                          opacity: 0.9,\n                          width: 1,\n                          curveness: 0\n                      }\n                  }\n              }\n          ]\n      };","html":"","externalScripts":"","updaterUID":"bd-4111265691","theme":"","layout":"","viewCount":320,"userName":"y***洋","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xx4LgfrgO3.png?v=1604369544832","isCustomThumbnail":0,"builtinTags":["category-work","legend","series-graph","tooltip"],"customTags":[],"updaterUserName":"y***洋"}}