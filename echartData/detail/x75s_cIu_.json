{"status":0,"data":{"cid":"x75s_cIu_","authorUid":"bd-899837472","authorUserName":"g***y","title":"环境计划安排-甘特图","description":"多任务甘特图，打mark点","latestVersion":2,"alwaysLatest":1,"createTime":"2019-12-11T07:45:26.000Z","lastUpdateTime":"2019-12-11T07:45:26.000Z","auth":2,"uid":"bd-899837472","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.4.0","versionCreateTime":"2019-12-11T07:50:00.000Z","code":"var series = [];\r\nvar data = [{\r\n        name: \"版本检验测试\",\r\n        data: [new Date(\"2018-10-01\"), new Date(\"\"), new Date(\"2018-05-01\"), new Date(\"2018-05-01\")],\r\n        type: 1,\r\n\r\n        stack: 't0',\r\n        prodDate: [\"2018-08-01\", \"\", \"2018-04-25\", \"2018-04-20\"],\r\n    },\r\n    {\r\n        name: \"版本检验测试\",\r\n        data: [new Date(\"2018-03-01T00:00:00.000Z\"), new Date(\"\"), new Date(\"2018-04-01T00:00:00.000Z\"), new Date(\"2018-04-01T00:00:00.000Z\")],\r\n\r\n        type: 0,\r\n        stack: 't0'\r\n    },\r\n\r\n    {\r\n        name: \"版本检验测试\",\r\n        data: [new Date(\"2018-03-01\"), new Date(\"2018-04-14\"), new Date(\"2018-04-01\"), new Date(\"2018-04-01\")],\r\n\r\n        type: 1,\r\n        stack: 't00',\r\n        prodDate: [\"2018-02-01\", \"2018-03-01\", \"2018-03-01\", \"2018-03-20\"],\r\n    },\r\n    {\r\n        name: \"版本检验测试\",\r\n        data: [new Date(\"2018-01-18\"), new Date(\"2018-02-01\"), new Date(\"2018-01-01\"), new Date(\"2018-01-01\")],\r\n\r\n        type: 0,\r\n        stack: 't00'\r\n    },\r\n\r\n    {\r\n        name: \"应用组装&用户测试\",\r\n        data: [new Date(\"2018-01-10\"), new Date(\"2018-01-10\"), new Date(\"2018-03-30\"), new Date(\"2018-03-30\")],\r\n\r\n        type: 1,\r\n        stack: 't1',\r\n        prodDate: [\"2018-01-05\", \"2018-01-06\", \"2018-03-20\", \"2018-03-20\"],\r\n    },\r\n    {\r\n        name: \"应用组装&用户测试\",\r\n        data: [new Date(\"2018-01-02\"), new Date(\"2018-01-02\"), new Date(\"2018-03-16\"), new Date(\"2018-03-16\")],\r\n\r\n        type: 0,\r\n        stack: 't1'\r\n    },\r\n\r\n    {\r\n        name: \"版本安装检验\",\r\n        data: [new Date(\"2018-02-20\"), new Date(\"2018-01-20\"), new Date(\"2018-04-10\"), new Date(\"2018-04-10\")],\r\n\r\n        type: 1,\r\n        stack: 't2',\r\n        prodDate: [\"2018-02-05\", \"2018-01-16\", \"2018-04-07\", \"2018-04-07\"],\r\n    },\r\n    {\r\n        name: \"版本安装检验\",\r\n        data: [new Date(\"2018-02-01\"), new Date(\"2018-01-12\"), new Date(\"2018-04-01\"), new Date(\"2018-04-01\")],\r\n\r\n        type: 0,\r\n        stack: 't2'\r\n    },\r\n\r\n]\r\nfor (var i in data) {\r\n    if (data[i].type == 1) {\r\n        series.push({\r\n            name: data[i].name,\r\n            type: \"bar\",\r\n            stack: data[i].stack,\r\n            markPoint: {\r\n                data: [{\r\n                        name: '投产点',\r\n                        value: data[i].prodDate[0],\r\n                        xAxis: data[i].prodDate[0],\r\n                        yAxis: 'VT'\r\n                    },\r\n                    {\r\n                        name: '投产点',\r\n                        value: data[i].prodDate[1],\r\n                        xAxis: data[i].prodDate[1],\r\n                        yAxis: 'PL2'\r\n                    },\r\n                    {\r\n                        name: '投产点',\r\n                        value: data[i].prodDate[2],\r\n                        xAxis: data[i].prodDate[2],\r\n                        yAxis: 'PL3'\r\n                    },\r\n                    {\r\n                        name: '投产点',\r\n                        value: data[i].prodDate[3],\r\n                        xAxis: data[i].prodDate[3],\r\n                        yAxis: 'PL4'\r\n                    },\r\n                ],\r\n                symbolSize: 40,\r\n                itemStyle: {\r\n                    color: {\r\n                        type: 'linear',\r\n                        x: 0,\r\n                        y: 0,\r\n                        x2: 0,\r\n                        y2: 1,\r\n                        colorStops: [{\r\n                            offset: 0,\r\n                            color: 'yellow' // 0% 处的颜色\r\n                        }, {\r\n                            offset: 1,\r\n                            color: 'blue' // 100% 处的颜色\r\n                        }],\r\n                        global: false // 缺省为 false\r\n                    }\r\n                },\r\n                label: {\r\n                    formatter: function(params) {\r\n\r\n                        return params.value\r\n                    }\r\n                }\r\n\r\n            },\r\n            label: {\r\n                normal: {\r\n                    show: true,\r\n                    color: \"#000\",\r\n                    position: \"right\",\r\n                    formatter: function(params) {\r\n                        return params.seriesName\r\n                    }\r\n                }\r\n            },\r\n            itemStyle: {\r\n                normal: {\r\n                    //color: data[i].color,\r\n                    borderColor: \"#fff\",\r\n                    borderWidth: 2,\r\n                },\r\n\r\n            },\r\n            zlevel: -1,\r\n            data: data[i].data\r\n        }, )\r\n    } else {\r\n        series.push({\r\n            name: data[i].name,\r\n            type: \"bar\",\r\n            stack: data[i].stack,\r\n            itemStyle: {\r\n                normal: {\r\n                    color: '#fff',\r\n                }\r\n            },\r\n            zlevel: -1,\r\n            z: 3,\r\n            data: data[i].data\r\n        })\r\n    }\r\n}\r\n\r\nvar option = {\r\n    backgroundColor: \"#fff\",\r\n    title: {\r\n        text: \"环境计划安排\",\r\n        left: 'center',\r\n        padding: 20,\r\n        position: 'center',\r\n        textStyle: {\r\n            fontSize: 17,\r\n            fontWeight: \"bolder\",\r\n            color: \"#333\"\r\n        },\r\n    },\r\n    legend: {\r\n\r\n        data: [\"版本检验测试\", \"应用组装&用户测试\", \"版本安装检验\"],\r\n\r\n        top: 50\r\n    },\r\n    grid: {\r\n        containLabel: true,\r\n        show: false,\r\n        right: 130,\r\n        left: 40,\r\n        bottom: 40,\r\n        top: 90\r\n    },\r\n    xAxis: {\r\n        type: \"time\",\r\n        maxInterval: 3600 * 1000 * 24 * 30,\r\n\r\n        axisLabel: {\r\n            \"show\": true,\r\n            \"interval\": 0\r\n        }\r\n    },\r\n    yAxis: {\r\n        splitLine: {\r\n            show: true\r\n        },\r\n        name: '所属环境',\r\n        axisLabel: {\r\n            show: true,\r\n            interval: 0,\r\n            formatter: function(value, index) {\r\n                //console.log(value,index)\r\n                var last = \"\"\r\n                var max = 5;\r\n                var len = value.length;\r\n                var hang = Math.ceil(len / max);\r\n                if (hang > 1) {\r\n                    for (var i = 0; i < hang; i++) {\r\n                        var start = i * max;\r\n                        var end = start + max;\r\n                        var temp = value.substring(start, end) + \"\\n\";\r\n                        last += temp; //凭借最终的字符串\r\n                    }\r\n                    return last;\r\n                } else {\r\n                    return value;\r\n                }\r\n            }\r\n        },\r\n\r\n        data: [\"VT\", \"PL2\", \"PL3\", \"PL4\"]\r\n    },\r\n    tooltip: {\r\n        trigger: \"axis\",\r\n        axisPointer: { // 坐标轴指示器，坐标轴触发有效\r\n            type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'\r\n        },\r\n        formatter: function(params) {\r\n            //console.log(params[1])\r\n            var res = \"\";\r\n            var name = \"\";\r\n            var start0 = \"\";\r\n            var start = \"\";\r\n            var end0 = \"\";\r\n            var end = \"\";\r\n            for (var i in params) {\r\n                var k = i % 2;\r\n                if (!k) { //偶数\r\n                    start0 = params[i].data;\r\n                    // console.log(start0)\r\n                    start = start0.getFullYear() + \"-\" + (start0.getMonth() + 1) + \"-\" + start0.getDate();\r\n                }\r\n                if (k) { //奇数\r\n                    name = params[i].seriesName;\r\n                    end0 = params[i].data;\r\n                    end = end0.getFullYear() + \"-\" + (end0.getMonth() + 1) + \"-\" + end0.getDate();\r\n                    res += name + \" : \" + end + \"~\" + start + \"</br>\";\r\n\r\n                }\r\n            }\r\n            return res;\r\n        }\r\n    },\r\n    series: series\r\n}","html":"","externalScripts":"","updaterUID":"bd-899837472","theme":"","layout":"","viewCount":1934,"userName":"g***y","commentCount":0,"starCount":4,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x75s_cIu_.png?v=1576050600340","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","markPoint","series-bar","title","tooltip"],"customTags":["甘特图"],"updaterUserName":"g***y"}}