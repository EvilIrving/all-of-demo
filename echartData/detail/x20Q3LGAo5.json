{"status":0,"data":{"cid":"x20Q3LGAo5","authorUid":"bd-4214232518","authorUserName":"苏***1","title":"方便配置的节点关系图","description":"定义边关系和节点信息，节点类别和边类别支持自定义，使用tooltip展示节点全部属性信息和边信息。","latestVersion":1,"alwaysLatest":1,"createTime":"2020-03-21T09:33:56.000Z","lastUpdateTime":"2020-03-21T09:33:56.000Z","auth":2,"uid":"bd-4214232518","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.4.0","versionCreateTime":"2020-03-21T09:33:56.000Z","code":"// =======================\n// 人员关系数据\nvar links = [\n    ['陈卫东', '赵英杰', '朋友'],\n    ['赵英杰', '郑志勇', '同学'],\n    ['赵英杰', '徐建云', '同学'],\n]\n// =======================\n// 人员信息数据\nvar nodes = [{\n        '姓名': '陈卫东',\n        '身份证号': '2220',\n        '住址': 'xxxxx',\n        '类别': '二类节点',\n    },\n    {\n        '姓名': '赵英杰',\n        '身份证号': '2220',\n        '住址': 'xxxxx',\n        '类别': '三类节点',\n    },\n    {\n        '姓名': '郑志勇',\n        '身份证号': '2220',\n        '住址': 'xxxxx',\n        '类别': '一类节点',\n    },\n    {\n        '姓名': '徐建云',\n        '身份证号': '2220',\n        '住址': 'xxxxx',\n        '类别': '一类节点',\n    }\n]\n// =======================\n\n//数据正确性检查\n//检查节点是否有重复人名\nvar infos = {};\nfor (var node of nodes){\n    if(node['姓名'] in infos){\n        window.alert('人名重复，请修改: ' + node['姓名'])\n    }\n    infos[node['姓名']] = Object.assign({}, node);\n}\n// 检查边的links的姓名是否都出现在nodes中\nfor(var link of links){\n    if( !( (link[0] in infos) && (link[1] in infos) ) ){\n        window.alert('人员未出现导致边非法:' + link)\n    }\n}\n\n//格式化输入数据\nvar legend = new Set()\nfor (var node of nodes){\n    legend.add(node['类别']);\n}\nlegend = Array.from(legend);\nlegend.sort(); \n\nechar_data = []\nfor (var node of nodes){\n    echar_data.push({\n                name: node['姓名'],\n                category:  legend.findIndex((element) => element == node['类别']),\n                draggable: true,\n            })\n}\n\nechar_links = []\nfor(var link of links){\n    echar_links.push({\n                source: link[0],\n                target: link[1],\n                value: link[2]\n            })\n} \n\noption = {\n    title: {\n        text: '人员关系信息'\n    },\n    tooltip: {\n        trigger: 'item',\n        formatter: function(params) {\n            if(params.dataType == 'edge'){\n                var info = '<p style=\"font-size:14px\">' + params.name + '</p>'\n                info = info + '<p style=\"font-size:14px\">' + params.value + '</p>'\n                return info;\n            }\n            \n            if (params.name in infos) {\n                var info = '<p style=\"font-size:14px\">' + params.name + '</p>'\n                for (var p in infos[params.name]) {\n                    info = info + '<p style = \"font-size:12px\" >' + p + ':' + infos[params.name][p] + '</p>'\n                }\n                return info;\n            }\n        },\n        backgroundColor: \"#ff7f50\", //提示标签背景颜色 \n        textStyle: {\n            color: \"#fff\"\n        } //提示标签字体颜色 \n    },\n    animationDurationUpdate: 1500,\n    animationEasingUpdate: 'quinticInOut',\n    label: {\n        normal: {\n            show: true,\n            textStyle: {\n                fontSize: 12\n            },\n        }\n    },\n    legend: {\n        x: \"center\",\n        show: true,\n        data: legend \n    },\n    series: [\n\n        {\n            type: 'graph',\n            layout: 'force',\n            symbolSize: 45,\n            focusNodeAdjacency: true,\n            roam: true,\n            categories: [{\n                name: legend[0],\n                itemStyle: {\n                    normal: {\n                        color: \"#009800\",\n                    }\n                }\n            }, {\n                name: legend[1],\n                itemStyle: {\n                    normal: {\n                        color: \"#4592FF\",\n                    }\n                }\n            }, {\n                name: legend[2],\n                itemStyle: {\n                    normal: {\n                        color: \"#3592F\",\n                    }\n                }\n            },\n             {\n                name: legend[3],\n                itemStyle: {\n                    normal: {\n                        color: \"#3592F\",\n                    }\n                }\n            },\n             {\n                name: legend[4],\n                itemStyle: {\n                    normal: {\n                        color: \"#3592F\",\n                    }\n                }\n            }],\n            label: {\n                normal: {\n                    show: true,\n                    textStyle: {\n                        fontSize: 12\n                    },\n                }\n            },\n            force: {\n                repulsion: 1000\n            },\n            edgeSymbolSize: [4, 50],\n            edgeLabel: {\n                normal: {\n                    show: true,\n                    textStyle: {\n                        fontSize: 10\n                    },\n                    formatter: \"{c}\"\n                }\n            },\n            data: echar_data,\n            links: echar_links,\n            lineStyle: {\n                normal: {\n                    opacity: 0.9,\n                    width: 1,\n                    curveness: 0\n                }\n            }\n        }\n    ]\n};","html":"","externalScripts":"","updaterUID":"bd-4214232518","theme":"","layout":"","viewCount":2137,"userName":"苏***1","commentCount":0,"starCount":4,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x20Q3LGAo5.png?v=1584783236335","isCustomThumbnail":0,"builtinTags":["category-work","legend","series-graph","title","tooltip"],"customTags":["edit","force","graph","legend","tooltip"],"updaterUserName":"苏***1"}}