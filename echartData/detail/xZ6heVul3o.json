{"status":0,"data":{"cid":"xZ6heVul3o","authorUid":"bd-3677049418","authorUserName":"c***e","title":"实时配送","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2019-08-29T13:27:00.000Z","lastUpdateTime":"2019-08-29T13:27:00.000Z","auth":2,"uid":"bd-3677049418","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.2.1","versionCreateTime":"2019-08-29T13:27:00.000Z","code":"var uploadedDataURL= \"/asset/get/s/data-1566436989733-sRoy1-ji5.json\";\r\n\r\n$.getJSON(uploadedDataURL, function(geoJson) {\r\n    echarts.registerMap('yuhang', geoJson);\r\n    myChart.setOption({\r\n        series: [{\r\n            type: 'map',\r\n            map: 'yuhang'\r\n        }]\r\n    });\r\nvar geoCoordMap = {\r\n   '余杭中心库': [120.3024800000,30.4536300000],\r\n        '余杭供电所': [119.9383, 30.25933],\r\n        '瓶窑供电所': [119.9750500000, 30.3751100000],\r\n        '良渚供电所': [120.0912700000, 30.3512900000],\r\n        '南苑供电所': [120.3072900000, 30.4342200000],\r\n        '塘栖供电所': [120.0890960000, 30.4417230000],\r\n        '东湖供电所': [120.3064930000, 30.4252520000],\r\n        '科技城供电所': [119.9794080000, 30.2742200000],\r\n\r\n};\r\n\r\nvar goData = [\r\n    [{\r\n        name: '余杭中心库'\r\n    }, {\r\n        id: 1,\r\n        name: '余杭供电所',\r\n        value: 60\r\n    }],\r\n     [{\r\n        name: '余杭中心库'\r\n    }, {\r\n        id: 1,\r\n        name: '瓶窑供电所',\r\n        value: 60\r\n    }],\r\n     [{\r\n        name: '余杭中心库'\r\n    }, {\r\n        id: 1,\r\n        name: '良渚供电所',\r\n        value: 30\r\n    }],\r\n    [{\r\n        name: '余杭中心库'\r\n    }, {\r\n        id: 1,\r\n        name: '南苑供电所',\r\n        value: 20\r\n    }],\r\n    [{\r\n        name: '余杭中心库'\r\n    }, {\r\n        id: 1,\r\n        name: '塘栖供电所',\r\n        value: 60\r\n    }],\r\n[{\r\n        name: '余杭中心库'\r\n    }, {\r\n        id: 1,\r\n        name: '东湖供电所',\r\n        value: 20\r\n    }],\r\n    [{\r\n        name: '余杭中心库'\r\n    }, {\r\n        id: 1,\r\n        name: '科技城供电所',\r\n        value: 30\r\n    }],\r\n    //  [{name:'蓟县'}, {name:'宁河',value:95}],\r\n];\r\n//值控制圆点大小\r\nvar backData = [\r\n   [{\r\n        name: '余杭供电所'\r\n    }, {\r\n        id: 2,\r\n        name: '余杭中心库',\r\n        value: 75\r\n    }],\r\n     [{\r\n        name: '瓶窑供电所'\r\n    }, {\r\n        id: 2,\r\n        name: '余杭中心库',\r\n        value: 75\r\n    }],\r\n     [{\r\n        name: '良渚供电所'\r\n    }, {\r\n        id: 2,\r\n       name: '余杭中心库' ,\r\n        value: 75\r\n    }],\r\n    [{\r\n       name: '南苑供电所' \r\n    }, {\r\n        id: 2,\r\n        name: '余杭中心库',\r\n        value: 75\r\n    }],\r\n    [{\r\n        name: '塘栖供电所' \r\n    }, {\r\n        id: 2,\r\n       name: '余杭中心库',\r\n        value: 75\r\n    }],\r\n[{\r\n       name: '东湖供电所' \r\n    }, {\r\n        id: 2,\r\n       name: '余杭中心库' ,\r\n        value: 75\r\n    }],\r\n    [{\r\n        name: '科技城供电所'\r\n    }, {\r\n        id: 2,\r\n        name: '余杭中心库',\r\n        value: 75\r\n    }],\r\n];\r\n\r\nvar planePath = 'circle';\r\nvar arcAngle = function(data) {\r\n    var j, k;\r\n    for (var i = 0; i < data.length; i++) {\r\n        var dataItem = data[i];\r\n        if (dataItem[1].id == 1) {\r\n            j = 0.2;\r\n            return j;\r\n        } else if (dataItem[1].id == 2) {\r\n            k = -0.2;\r\n            return k;\r\n        }\r\n    }\r\n};\r\n\r\nvar convertData = function(data) {\r\n    var res = [];\r\n    for (var i = 0; i < data.length; i++) {\r\n        var dataItem = data[i];\r\n        var fromCoord = geoCoordMap[dataItem[0].name];\r\n        var toCoord = geoCoordMap[dataItem[1].name];\r\n        if (dataItem[1].id == 1) {\r\n            if (fromCoord && toCoord) {\r\n                res.push([{\r\n                    coord: fromCoord,\r\n                }, {\r\n                    coord: toCoord,\r\n                    value: dataItem[1].value //线条颜色\r\n\r\n                }]);\r\n            }\r\n        } else if (dataItem[1].id == 2) {\r\n            if (fromCoord && toCoord) {\r\n                res.push([{\r\n                    coord: fromCoord,\r\n                }, {\r\n                    coord: toCoord\r\n                }]);\r\n            }\r\n        }\r\n    }\r\n    return res;\r\n};\r\n\r\nvar color = ['#fff', '#FF1493', '#0000FF'];\r\nvar series = [];\r\n[\r\n    ['1', goData],\r\n    ['2', backData]\r\n].forEach(function(item, i) {\r\n    series.push({\r\n        name: item[0],\r\n        type: 'lines',\r\n        zlevel: 2,\r\n        //线特效配置\r\n        effect: {\r\n            show: true,\r\n            period: 2,\r\n            trailLength: 0,\r\n            symbol: planePath, //标记类型\r\n            symbolSize: 5\r\n        },\r\n        lineStyle: {\r\n            normal: {\r\n                width: 1,\r\n                opacity: 0.4,\r\n                curveness: arcAngle(item[1]), //弧线角度\r\n                color: '#fff'\r\n            }\r\n        },\r\n        data: convertData(item[1])\r\n    }, {\r\n        type: 'effectScatter',\r\n        coordinateSystem: 'geo',\r\n        zlevel: 2,\r\n        //波纹效果\r\n        rippleEffect: {\r\n            period: 2,\r\n            brushType: 'stroke',\r\n            scale: 5\r\n        },\r\n        label: {\r\n            normal: {\r\n                show: true,\r\n                color: '#fff',\r\n                position: 'right',\r\n                formatter: '{b}'\r\n            }\r\n        },\r\n        //终点形象\r\n        symbol: 'circle',\r\n        //圆点大小\r\n        symbolSize: function(val) {\r\n            return val[2] / 8;\r\n        },\r\n        itemStyle: {\r\n            normal: {\r\n                show: true\r\n            }\r\n        },\r\n        data: item[1].map(function(dataItem) {\r\n            return {\r\n                name: dataItem[1].name,\r\n                value: geoCoordMap[dataItem[1].name].concat([dataItem[1].value])\r\n            };\r\n        })\r\n\r\n    });\r\n\r\n});\r\n\r\noption = {\r\n      backgroundColor: '#031f2d',\r\n    title: {\r\n        text: '',\r\n        subtext: '',\r\n        left: 'center',\r\n        textStyle: {\r\n            color: '#fff'\r\n        }\r\n    },\r\n    tooltip: {\r\n        trigger: 'item',\r\n        formatter: \"{b}<br />今日需配送物资金额：8832元<br />计划配送次数：6次<br />已配送物资金额：7900元<br />已完成配送次数：4次<br />常规配送任务数：6次<br />在途配送应急调配任务数：0次<br />跨库调配任务数：0次\"\r\n    },\r\n    //线颜色及飞行轨道颜色\r\n    visualMap: {\r\n        show: false,\r\n        min: 0,\r\n        max: 100,\r\n        color: ['#a6c84c', '#ffa022', '#46bee9']\r\n    },\r\n    //地图相关设置\r\n    geo: {\r\n        map: 'yuhang',\r\n        //视角缩放比例\r\n        zoom: 1,\r\n        //显示文本样式\r\n        label: {\r\n            normal: {\r\n                show: false,\r\n                textStyle: {\r\n                    color: '#fff'\r\n                }\r\n            },\r\n            emphasis: {\r\n                textStyle: {\r\n                    color: '#fff'\r\n                }\r\n            }\r\n        },\r\n        //鼠标缩放和平移\r\n        roam: true,\r\n        itemStyle: {\r\n            normal: {\r\n                //          \tcolor: '#ddd',\r\n                borderColor: 'rgba(147, 235, 248, 1)',\r\n                borderWidth: 1,\r\n                areaColor: {\r\n                    type: 'radial',\r\n                    x: 0.5,\r\n                    y: 0.5,\r\n                    r: 0.8,\r\n                    colorStops: [{\r\n                        offset: 0,\r\n                        color: 'rgba(147, 235, 248, 0)' // 0% 处的颜色\r\n                    }, {\r\n                        offset: 1,\r\n                        color: 'rgba(147, 235, 248, .2)' // 100% 处的颜色\r\n                    }],\r\n                    globalCoord: false // 缺省为 false\r\n                },\r\n                shadowColor: 'rgba(128, 217, 248, 1)',\r\n                // shadowColor: 'rgba(255, 255, 255, 1)',\r\n                shadowOffsetX: -2,\r\n                shadowOffsetY: 2,\r\n                shadowBlur: 10\r\n            },\r\n            emphasis: {\r\n                areaColor: '#389BB7',\r\n                borderWidth: 0\r\n            }\r\n        }\r\n    },\r\n    series: series\r\n};\r\n myChart.setOption(option);\r\n});\r\n","html":"","externalScripts":"","updaterUID":"bd-3677049418","theme":"","layout":"","viewCount":385,"userName":"c***e","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xZ6heVul3o.png?v=1567085220524","isCustomThumbnail":0,"builtinTags":["category-work","geo","series-effectScatter","series-lines","title","tooltip","visualMap"],"customTags":[],"updaterUserName":"c***e"}}