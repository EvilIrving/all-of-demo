{"status":0,"data":{"cid":"xz-aGvgst4","authorUid":"bd-3797133147","authorUserName":"专***年","title":"堆叠百分比","description":"","latestVersion":1,"alwaysLatest":0,"createTime":"2021-10-16T09:24:55.000Z","lastUpdateTime":"2021-10-16T09:24:55.000Z","auth":2,"uid":"bd-3797133147","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"5.2.1","versionCreateTime":"2021-10-16T09:24:56.000Z","code":"var data = {\r\n \r\n        area: ['新荣区', '平城区', '云冈区', '云州区', '阳高县', '天镇县', '广灵县', '浑源县', '左云县'],\r\n        legend: ['因病', '因残', '因学', '因灾', '缺土地', '缺水', '缺技术', '缺资金', '交通条件落后', '自身发展动力不足', '其他原因'],\r\n        data: [\r\n            [1320, 1302, 901, 634, 1390, 1330, 1320, 1000, 500],\r\n            [320, 302, 301, 334, 390, 330, 320, 100, 50],\r\n            [320, 302, 301, 334, 390, 330, 320, 100, 50],\r\n            [320, 302, 301, 334, 390, 330, 320, 100, 50],\r\n            [320, 302, 301, 334, 390, 330, 320, 100, 50],\r\n            [320, 302, 301, 334, 390, 330, 320, 100, 50],\r\n            [320, 302, 301, 334, 390, 330, 320, 100, 50],\r\n            [320, 302, 301, 334, 390, 330, 320, 100, 50],\r\n            [320, 302, 301, 334, 390, 330, 320, 100, 50],\r\n            [320, 302, 301, 334, 390, 330, 320, 100, 50],\r\n            [320, 302, 301, 334, 390, 330, 320, 100, 50],\r\n        ]\r\n    \r\n\r\n}\r\nvar colors = ['#4C98FB', '#83CCE7', '#26C7C8', '#73DEBD', '#26C978', '#8CDF6C', '#FBD657', '#F56679', '#E07BCE', '#9D50E0', '#634FDA']\r\n//多维数组重组\r\nvar array =data.data;\r\nvar newarr = [];\r\nfunction getCol(matrix, col) {\r\n  var column = [];\r\n  for (var i = 0; i < matrix.length; i++) {\r\n    column.push(matrix[i][col]);\r\n  }\r\n\r\n  return column;\r\n}\r\n\r\n//数组求百分比\r\nfunction countPercentage(countArray) {\r\n  var j = eval(countArray.join('+'));\r\n  var resultArray = [];\r\n  for (var i = 0; i < countArray.length; i++) {\r\n     var k = Math.floor((countArray[i] / j) * 100) ;\r\n    \r\n    resultArray.push(k);\r\n  }\r\n  return resultArray;\r\n}\r\nvar arr2 = [];\r\n\r\nfor (var i = 0; i < array[0].length; i++) {\r\n  let list = getCol(array, i);\r\n  newarr.push(list)\r\n\r\n  arr2.push(countPercentage(list));\r\n}\r\nconsole.log(newarr);\r\nconsole.log(arr2);\r\n//还原数据结构\r\nvar newdata =[];\r\nfor (var i = 0; i < arr2[0].length; i++) {\r\n\r\n   let list = getCol(arr2, i);\r\nnewdata.push(list)\r\n}\r\n\r\n\r\nvar option = {\r\n    title: {\r\n        text: '大同市致贫原因分析',\r\n        left: 19,\r\n        top: 15,\r\n        textStyle: {\r\n            color: '#fff'\r\n        }\r\n    },\r\n    color: colors,\r\n  \r\n    legend: {\r\n        top: 10,\r\n        left: 200,\r\n        itemWidth: 10,\r\n        itemHeight: 10,\r\n        // padding: [5, 10],\r\n        textStyle: {\r\n            fontSize: 14,\r\n            color: '#96A4F4',\r\n            padding: [3, 0, 0, 0]\r\n        },\r\n        data: data.legend\r\n    },\r\n    grid: {\r\n        left: '3%',\r\n        right: '4%',\r\n        bottom: '13%',\r\n        containLabel: true\r\n    },\r\n    xAxis: {\r\n        type: 'category',\r\n        axisLabel: {\r\n            color: '#96A4F4'\r\n        },\r\n        axisLine: {\r\n            lineStyle: {\r\n                color: '#96A4F4'\r\n            },\r\n            width: 5\r\n        },\r\n        axisTick: {\r\n            show: false,\r\n        },\r\n        data: data.area\r\n    },\r\n    yAxis: {\r\n        type: 'value',\r\n        axisLabel: {\r\n            color: '#96A4F4'\r\n        },\r\n        axisLine: {\r\n            lineStyle: {\r\n                color: '#96A4F4'\r\n            },\r\n            width: 5\r\n        },\r\n        axisTick: {\r\n            show: false,\r\n        },\r\n        splitLine: {\r\n            lineStyle: {\r\n                color: 'rgba(150, 164, 244, 0.3)'\r\n            }\r\n        },\r\n    },\r\n    series: [\r\n\r\n    ]\r\n};\r\nfor (var i = 0; i < data.legend.length; i++) {\r\n    option.series.push({\r\n        name: data.legend[i],\r\n        type: 'bar',\r\n        stack: '总量',\r\n        barWidth: '45%',\r\n        label: {\r\n            show: true,\r\n          formatter: '{c}%',\r\n          \r\n        },\r\n        data: newdata[i]\r\n    })\r\n}\r\nmyChart.setOption(option);","html":"","externalScripts":"","updaterUID":"bd-3797133147","theme":"","layout":"","viewCount":0,"userName":"专***年","commentCount":0,"starCount":4,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xz-aGvgst4.png?v=1634376296211","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","title"],"customTags":[],"updaterUserName":"专***年"}}