{"status":0,"data":{"cid":"xr1o2ghvYf","authorUid":"bd-3057512055","authorUserName":"keagydzhu","title":"折线饼图交互混搭实","description":"参考2.0版 http://echarts.baidu.com/echarts2/doc/example/mix12.html","latestVersion":2,"alwaysLatest":1,"createTime":"2018-03-15T08:37:07.000Z","lastUpdateTime":"2018-03-15T08:37:07.000Z","auth":2,"uid":"bd-3057512055","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.0.4","versionCreateTime":"2018-03-15T08:40:00.000Z","code":"// original\nvar data = [30, 20, 54, 21, 90, 30, 10];\n\nvar gap = 0;\nvar total = 0;\nvar maxIndex;\nvar dataArray = (function() {\n    var max = Math.max.apply(Math, data);\n    var min = Math.min.apply(Math, data);\n    gap = Math.round((max - min));\n    var nd = [{\n        value: data[0] + gap,\n        symbol: 'none'\n    }];\n    for (var i = 0, l = data.length; i < l; i++) {\n        if (data[i] == max) {\n            maxIndex = i;\n        }\n        total += data[i];\n        nd.push(data[i] + gap);\n    }\n    nd.push({\n        value: data[data.length - 1] + gap,\n        symbol: 'none'\n    });\n    return nd;\n})();\n\noption = {\n    backgroundColor: '#fff',\n    title: {\n        text: '折线饼图交互混搭实',\n        subtext: '参考2.0版 http://echarts.baidu.com/echarts2/doc/example/mix12.html',\n        x: 'center'\n    },\n    legend: {\n        data: ['销量', '占比'],\n        x: 'left',\n        orient: 'vertical',\n        selectedMode: false\n    },\n    tooltip: {\n        trigger: 'item',\n        formatter: function(params) {\n            if (params.seriesName == '占比') {\n                return '总量 : ' + total + '<br/>' +\n                    params.name + ' : ' + params.value + '<br/>' +\n                    '占比 : ' + params.percent + '%';\n            } else if (params.name != '占位') {\n                update(params);\n                return params.seriesName + '<br/>' +\n                    params.name + ' : ' + params.value;\n            }\n        },\n        axisPointer: {\n            type: 'none'\n        }\n    },\n    grid: {\n        show: true,\n        backgroundColor: '#ccc',\n        borderWidth: 0,\n        left: '250',\n        right: '250',\n        top: '200',\n        bottom: '200'\n    },\n    xAxis: [{\n        type: 'category',\n        boundaryGap: false,\n        show: false,\n        data: ['占位', '周一', '周二', '周三', '周四', '周五', '周六', '周日', '占位']\n    }],\n    yAxis: [{\n        type: 'value',\n        boundaryGap: [0, 0.5],\n        show: false\n    }],\n    animation: false,\n    series: [{\n            name: '销量',\n            type: 'line',\n            symbol: 'emptyCircle',\n            symbolSize: 6,\n            showAllSymbol: true,\n            smooth: true,\n            itemStyle: {\n                normal: {\n                    areaStyle: {\n                        type: 'default'\n                    }\n                }\n            },\n            data: dataArray\n        },\n        {\n            name: '遮罩',\n            type: 'pie',\n            clickable: false,\n            hoverOffset: 0,\n            tooltip: {\n                show: false\n            },\n            radius: [260, 400],\n            itemStyle: {\n                normal: {\n                    color: '#fff',\n                    label: {\n                        show: false\n                    },\n                    labelLine: {\n                        show: false\n                    }\n                },\n                emphasis: {\n                    color: 'rgba(255,255,255,1)'\n                }\n            },\n            data: [{\n                value: 100,\n                name: '直接访问'\n            }],\n            z: 10\n        },\n        {\n            name: '占比',\n            type: 'pie',\n            clickable: false,\n            clockWise: true,\n            radius: [300, 325],\n            z: 20,\n            data: [{\n                    itemStyle: {\n                        normal: {\n                            label: {\n                                position: 'inside',\n                                formatter: '\\n{b} : {c}\\n\\n( {d}% )',\n                                textStyle: {\n                                    fontSize: 15,\n                                    baseline: 'top',\n                                    color: '#1e90ff'\n                                }\n                            },\n                            labelLine: {\n                                show: false\n                            }\n                        }\n                    }\n                },\n                {\n                    name: '其他',\n                    tooltip: {\n                        show: false\n                    },\n                    itemStyle: {\n                        normal: {\n                            color: '#fff',\n                            label: {\n                                show: false\n                            },\n                            labelLine: {\n                                show: false\n                            }\n                        }\n                    }\n                }\n            ]\n        }\n    ]\n};\n\nfunction changePieSeries(params) {\n    var curData = params.value - gap;\n    option.series[2].startAngle = -90 + (curData / total * 360) / 2;\n    option.series[2].data[0].name = params.name;\n    option.series[2].data[0].value = curData;\n    option.series[2].data[1].value = total - curData;\n\n    // for (var i = 1, l = option.series[0].data.length - 1; i < l; i++) {\n    //     if (option.series[0].data[i].symbol) {\n    //         option.series[0].data[i].symbol = 'emptyCircle';\n    //         option.series[0].data[i].symbolSize = 6;\n    //     }\n    // }\n    // option.series[0].data[params.dataIndex] = {\n    //     name : params.name,\n    //     value : params.value,\n    //     symbol: 'emptyDiamond',\n    //     symbolSize: 10\n    // }\n}\n\nfunction update(params) {\n    changePieSeries(params);\n    option.animation = true;\n    myChart.setOption(option);\n}\nchangePieSeries({\n    name: option.xAxis[0].data[maxIndex + 1],\n    value: option.series[0].data[maxIndex + 1],\n    dataIndex: maxIndex + 1\n});","html":"","externalScripts":"","updaterUID":"bd-3057512055","theme":"","layout":"","viewCount":617,"userName":"keagydzhu","commentCount":0,"starCount":4,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xr1o2ghvYf.png?v=1521103027409","isCustomThumbnail":1,"builtinTags":["category-work","grid","legend","series-line","series-pie","title","tooltip"],"customTags":[],"updaterUserName":"keagydzhu"}}