{"status":0,"data":{"cid":"xS1qm890eG","authorUid":"bd-805518474","authorUserName":"8***5","title":"重庆公交查询展示","description":"基于百度地图的重庆公交数据查询展示","latestVersion":11,"alwaysLatest":1,"createTime":"2017-12-01T08:43:13.000Z","lastUpdateTime":"2017-12-01T08:43:13.000Z","auth":2,"uid":"bd-805518474","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":11,"parentVersion":10,"echartsVersion":"3.8.0","versionCreateTime":"2017-12-01T09:02:24.000Z","code":"//要查询的公交线路数组，可设为动态加载\nvar lineList = [\n        \"108\", \"112\", \"113\", \"114\", \"115\", \"118\", \"120\", \"125\", \"133\", \"138\", \"139\", \"149\", \"181\", \"183\",\n        \"202\", \"268\", \"299\",\n        \"319\",\n        \"401\", \"403\", \"411\", \"412\", \"413\", \"416\", \"421\", \"462\", \"465\", \"466\", \"476\",\n        \"601\", \"606\", \"612\", \"630\", \"636\",\n        \"809\", \"818\", \"819\", \"821\", \"829\", \"842\", \"871\", \"872\", \"873\", \"886\"\n    ];\nvar lineData = new Array();\nvar busline=null;\nvar lineTag=0;\nvar hStep = 300 / (lineList.length - 1);\noption = {\n    bmap: {\n        center: [106.558434, 29.568996],\n        zoom: 12,\n        roam: true,\n        enableMapClick: false,\n        mapStyle: {\n            'styleJson': [{\n                \"featureType\": \"water\",\n                \"elementType\": \"all\",\n                \"stylers\": {\n                    \"color\": \"#021019\"\n                }\n            }, {\n                \"featureType\": \"highway\",\n                \"elementType\": \"geometry.fill\",\n                \"stylers\": {\n                    \"color\": \"#000000\"\n                }\n            }, {\n                \"featureType\": \"highway\",\n                \"elementType\": \"geometry.stroke\",\n                \"stylers\": {\n                    \"color\": \"#147a92\"\n                }\n            }, {\n                \"featureType\": \"arterial\",\n                \"elementType\": \"geometry.fill\",\n                \"stylers\": {\n                    \"color\": \"#000000\"\n                }\n            }, {\n                \"featureType\": \"arterial\",\n                \"elementType\": \"geometry.stroke\",\n                \"stylers\": {\n                    \"color\": \"#0b3d51\"\n                }\n            }, {\n                \"featureType\": \"local\",\n                \"elementType\": \"geometry\",\n                \"stylers\": {\n                    \"color\": \"#000000\"\n                }\n            }, {\n                \"featureType\": \"land\",\n                \"elementType\": \"all\",\n                \"stylers\": {\n                    \"color\": \"#08304b\"\n                }\n            }, {\n                \"featureType\": \"railway\",\n                \"elementType\": \"geometry.fill\",\n                \"stylers\": {\n                    \"color\": \"#000000\"\n                }\n            }, {\n                \"featureType\": \"railway\",\n                \"elementType\": \"geometry.stroke\",\n                \"stylers\": {\n                    \"color\": \"#08304b\"\n                }\n            }, {\n                \"featureType\": \"subway\",\n                \"elementType\": \"geometry\",\n                \"stylers\": {\n                    \"lightness\": -70\n                }\n            }, {\n                \"featureType\": \"building\",\n                \"elementType\": \"geometry.fill\",\n                \"stylers\": {\n                    \"color\": \"#000000\"\n                }\n            }, {\n                \"featureType\": \"all\",\n                \"elementType\": \"labels.text.fill\",\n                \"stylers\": {\n                    \"color\": \"#857f7f\"\n                }\n            }, {\n                \"featureType\": \"all\",\n                \"elementType\": \"labels.text.stroke\",\n                \"stylers\": {\n                    \"color\": \"#000000\"\n                }\n            }, {\n                \"featureType\": \"building\",\n                \"elementType\": \"geometry\",\n                \"stylers\": {\n                    \"color\": \"#022338\"\n                }\n            }, {\n                \"featureType\": \"green\",\n                \"elementType\": \"geometry\",\n                \"stylers\": {\n                    \"color\": \"#062032\"\n                }\n            }, {\n                \"featureType\": \"boundary\",\n                \"elementType\": \"all\",\n                \"stylers\": {\n                    \"color\": \"#1e1c1c\"\n                }\n            }, {\n                \"featureType\": \"manmade\",\n                \"elementType\": \"all\",\n                \"stylers\": {\n                    \"color\": \"#022338\"\n                }\n            }]\n        }\n    },\n    series: [{\n        type: 'lines',\n        coordinateSystem: 'bmap',\n        polyline: true,\n        data: lineData,\n        silent: true,\n        lineStyle: {\n            normal: {\n                opacity: 0.2,\n                width: 1\n            }\n        },\n        progressiveThreshold: 500,\n        progressive: 100\n    }, {\n        type: 'lines',\n        coordinateSystem: 'bmap',\n        polyline: true,\n        data: lineData,\n        lineStyle: {\n            normal: {\n                width: 0.02\n            }\n        },\n        effect: {\n            constantSpeed: 40,\n            show: true,\n            trailLength: 0.02,\n            symbolSize: 2\n        },\n        zlevel: 1\n    }]\n};\n//动态添加查询到的线路数据\nvar addLineData= function(points) {\n    var bPoints = new Array();\n    for (var i = 0; i < points.length; i++) {\n        bPoints.push([points[i].lng, points[i].lat]);\n    }\n    lineData.push({ \"coords\": bPoints, lineStyle: { \"normal\": { \"color\": echarts.color.modifyHSL('#5A94DF', Math.round(hStep * lineTag)) } } });\n\n    var tmpOption ={\n        series: [\n            {\n                data: lineData\n            },\n            {\n                data: lineData\n            }\n        ]\n    };\n    myChart.setOption(tmpOption);\n};\n//查询线路数据\nvar searchBusLine = function (busName) {\n    if (busline == null) {\n        busline = new BMap.BusLineSearch(\"重庆\", {\n            //renderOptions: {panel: \"r-result\", autoViewport: false },\n            onGetBusListComplete: function (result) {\n                if (result) {\n                    var fstLine = result.getBusListItem(0);\n                    busline.getBusLine(fstLine);\n                }\n            },\n            onGetBusLineComplete: function (e) {\n                console.log(e.getPath());\n                addLineData(e.getPath());\n                lineTag++;\n                if (lineTag < lineList.length) {\n                    searchBusLine(lineList[lineTag]);\n                }\n            }\n        });\n    }\n    busline.getBusList(busName);\n};\n\n$(function(){\n    searchBusLine(lineList[lineTag]);\n});","html":"","externalScripts":"/dep/echarts/latest/extension/bmap.min.js,http://api.map.baidu.com/api?v=2.0&ak=toAFwIKnTOGUAhwCErLtHCh1kDBFIGMQ","updaterUID":"bd-805518474","theme":"","layout":"","viewCount":309,"userName":"8***5","commentCount":0,"starCount":5,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xS1qm890eG.png?v=1512117797497","isCustomThumbnail":1,"builtinTags":["category-work"],"customTags":[],"updaterUserName":"8***5"}}