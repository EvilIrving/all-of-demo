{"status":0,"data":{"cid":"xDci-jNeuU","authorUid":"obd-oAl5M2T541FKFgGONpz0eRe3pPLhW7N","authorUserName":"a***7","title":"各类型线路收入占比分析","description":"","latestVersion":10,"alwaysLatest":1,"createTime":"2020-08-20T03:34:00.000Z","lastUpdateTime":"2020-08-20T03:34:00.000Z","auth":2,"uid":"obd-oAl5M2T541FKFgGONpz0eRe3pPLhW7N","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":10,"parentVersion":9,"echartsVersion":"4.8.0","versionCreateTime":"2020-08-25T02:31:23.000Z","code":"const startAlpha = 1;\nconst endAlpha = 0;\nconst color = [{\n        r: 70,\n        g: 240,\n        b: 255\n    },\n    {\n        r: 26,\n        g: 255,\n        b: 198\n    },\n    {\n        r: 54,\n        g: 90,\n        b: 206\n    },\n    {\n        r: 143,\n        g: 114,\n        b: 244\n    }\n]\n\nconst data = [{\n    name: \"广州公交   6025.76   60%\",\n    value: 6025.76,\n    _startArc: 0,\n    _endArc: 3.0471975511965976,\n    _color: \"#46F0FF\",\n    _percent: 0.16666666666666666\n}, {\n    name: \"佛山公交   2221.06   20%\",\n    value: 2221.06,\n    _startArc: 3.0471975511965976,\n    _endArc: 3.665191429188092,\n    _color: \"#1AFFC6\",\n    _percent: 0.4166666666666667\n}, {\n    name: \"广州地区   2000.01   10%\",\n    value: 2000.01,\n    _startArc: 3.665191429188092,\n    _endArc: 7.9269908169872414,\n    _color: \"#365ACE\",\n    _percent: 0.041666666666666664\n}, {\n    name: \"外围六区   1236.23   10%\",\n    value: 1236.23,\n    _startArc: 3.9269908169872414,\n    _endArc: 5.759586531581288,\n    _color: \"#8F72F4\",\n    _percent: 0.2916666666666667\n}]\n\n/**\n * 线性渐变起止方向的计算方法\n * \n *\n * @param {*} startArc 开始角度\n * @param {*} endArc 结束角度\n * @returns 四个坐标 x,y,x2,y2\n */\nfunction getCoordinates(startArc, endArc) {\n    const posi = [\n        Math.sin(startArc),\n        -Math.cos(startArc),\n        Math.sin(endArc),\n        -Math.cos(endArc)\n    ]\n    const dx = posi[2] - posi[0]\n    const dy = posi[3] - posi[1]\n    \n    return getLocation(dx, dy)\n}\n\nfunction getLocation(dx, dy) {\n  const tanV = dx / dy\n  const directSign = Math.abs(tanV) < 1\n  const t = directSign ? tanV : 1 / tanV\n  \n  const sign1 = t > 0 ? 1 : -1\n  const sign2 = dx > 0 ? 1 : -1\n  const sign = directSign ? sign1 * sign2 : sign2\n  \n  const group1 = [ 0.5 - sign * t / 2, 0.5 + sign * t / 2]\n  const group2 = sign > 0 ? [0, 1] : [1, 0]\n  const group = [...group1, ...group2]\n  const keys = directSign ? ['x', 'x2', 'y', 'y2'] : ['y', 'y2', 'x', 'x2' ]\n\n  let res = {}\n  keys.forEach((k, idx) => {\n    res[k] = group[idx]\n  })\n  return res\n}\n\n/**\n * 给数据写入 样式(线性渐变)\n *\n * @param {*} datas 数据\n * @param {*} colorlist 颜色列表\n * @param {*} startAlpha 开始颜色的透明度\n * @param {*} endAlpha 结束颜色透的明度\n * @returns 带样式的数据\n */\nfunction setGradientColorInItemSyle(datas, colorlist, startAlpha, endAlpha) {\n    for (let i = 0; i < datas.length; i++) {\n        const color = colorlist[i];\n        const startArc = datas[i]._startArc;\n        const endArc = datas[i]._endArc;\n        // 这里计算了 线性渐变的起止方向\n        const coordinates = getCoordinates(startArc, endArc);\n        datas[i].itemStyle = {\n            color: {\n                ...coordinates,\n                type: \"linear\",\n                global: false,\n                // 这里给了 线性渐变的起止颜色\n                colorStops: [{\n                    offset: 0,\n                    color: `rgba(${color.r}, ${color.g}, ${color.b}, ${startAlpha})`\n                }, {\n                    offset: 1,\n                    color: `rgba(${color.r}, ${color.g}, ${color.b}, ${endAlpha})`\n                }]\n            }\n        }\n    }\n    return datas\n}\n\noption = {\n    backgroundColor: '#101736',\n    title: {\n        text: \"各类型线路收入占比分析\",\n        x: \"4%\",\n        width: 173,\n        height: 163,\n        fontSize: 22,\n        textStyle: {\n            color: '#fff',\n            fontSize: '22'\n        },\n        subtextStyle: {\n            color: '#90979c',\n            fontSize: '16',\n        },\n    },\n    color: ['#46F0FF', '#1AFFC6', '#365ACE', '#8F72F4'],\n    tooltip: {\n        trigger: \"item\",\n        formatter: \"{b}\"\n    },\n    legend: {\n        orient:'vertical',\n        icon: 'circle', //图例形状\n        bottom:'25%',\n        right:'10%',\n        itemWidth: 14, // 图例标记的图形宽度。[ default: 25 ]\n        itemHeight: 14, // 图例标记的图形高度。[ default: 14 ]\n        itemGap: 21, // 图例每项之间的间隔。[ default: 10 ]横向布局时为水平间隔，纵向布局时为纵向间隔。\n        textStyle: {\n            fontSize: 14,\n            color: '#fff',\n        }\n\t},\n    series: [{\n        type: \"pie\",\n        data: setGradientColorInItemSyle(data, color, startAlpha, endAlpha),\n        // \"animation\": false,\n        radius: [50, 60],\n        center: [\"30%\", \"50%\"],\n        labelLine: {\n          show: false\n        },\n        label:{\n            show: false\n        }\n        \n    }]\n};","html":"","externalScripts":"","updaterUID":"obd-oAl5M2T541FKFgGONpz0eRe3pPLhW7N","theme":"","layout":"","viewCount":3515,"userName":"a***7","commentCount":0,"starCount":18,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xDci-jNeuU.png?v=1598322683858","isCustomThumbnail":0,"builtinTags":["category-work","graphic","legend","series-pie","title","toolbox","tooltip"],"customTags":[],"updaterUserName":"a***7"}}