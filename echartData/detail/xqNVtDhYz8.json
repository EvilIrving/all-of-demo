{"status":0,"data":{"cid":"xqNVtDhYz8","authorUid":"bd-1627449234","authorUserName":"l***w","title":"虚构疫情状况 练习","description":"","latestVersion":3,"alwaysLatest":1,"createTime":"2020-06-04T06:48:57.000Z","lastUpdateTime":"2020-06-04T06:48:57.000Z","auth":2,"uid":"bd-1627449234","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":3,"parentVersion":2,"echartsVersion":"4.8.0","versionCreateTime":"2020-06-04T10:06:39.000Z","code":"\r\n// function getOffsetDays(time1, time2) {\r\n//     var offsetTime = Math.abs(time2 - time1);\r\n//     return Math.floor(offsetTime / (3600 * 24 * 1e3));\r\n// };\r\n\r\nvar geoCoordMap = {\r\n             '郑州市': [113.665412,34.757975],\r\n         '开封市': [114.341447,34.797049],\r\n         '洛阳市':[112.434468,34.663041],\r\n         '平顶山市': [113.300848978, 33.7453014565],\r\n         '安阳市': [114.351806508, 36.1102667222],\r\n         '鹤壁市': [114.297769838, 35.7554258742],\r\n         '新乡市': [113.912690161, 35.3072575577],\r\n         '焦作市': [113.211835885, 35.234607555],\r\n         '濮阳市': [115.026627441, 35.7532978882],\r\n         '漯河市': [114.0460614, 33.5762786885],\r\n         '三门峡市': [111.181262093, 34.7833199411],\r\n         '南阳市': [112.542841901, 33.0114195691],\r\n         \"商丘市\": [115.641885688, 34.4385886402],\r\n         '信阳市': [114.085490993, 32.1285823075],\r\n         '周口市': [114.654101942, 33.6237408181],\r\n         '许昌市': [113.83531246, 34.0267395887],\r\n         '驻马店市': [114.049153547, 32.9831581541]\r\n}\r\n\r\nvar data = [{\r\n        name: \"郑州市\",\r\n        value: 39000\r\n    },\r\n    {\r\n        name: \"开封市\",\r\n        value: 0111\r\n    },\r\n    {\r\n        name: \"洛阳市\",\r\n        value: 990\r\n    },\r\n    {\r\n        name: \"平顶山市\",\r\n        value: 3010\r\n     },\r\n    // {\r\n    //     name: \"香港\",\r\n    //     value: 400\r\n    // },\r\n    // {\r\n    //     name: \"澳门\",\r\n    //     value: 90\r\n    // },\r\n    // {\r\n    //     name: \"台湾\",\r\n    //     value: 18\r\n    // },\r\n    // {\r\n    //     name: \"武汉\",\r\n    //     value: 32994\r\n    // },\r\n    // {\r\n    //     name: \"黄石\",\r\n    //     value: 911\r\n    // },\r\n    // {\r\n    //     name: \"十堰\",\r\n    //     value: 562\r\n    // },\r\n    // {\r\n    //     name: \"襄阳\",\r\n    //     value: 1101\r\n    // },\r\n    // {\r\n    //     name: \"宜昌\",\r\n    //     value: 810\r\n    // },\r\n    // {\r\n    //     name: \"荆州\",\r\n    //     value: 1431\r\n    // },\r\n    // {\r\n    //     name: \"荆门\",\r\n    //     value: 972\r\n    // },\r\n    // {\r\n    //     name: \"鄂州\",\r\n    //     value: 1065\r\n    // },\r\n    // {\r\n    //     name: \"孝感\",\r\n    //     value: 35\r\n    // },\r\n    // {\r\n    //     name: \"黄冈\",\r\n    //     value: 2662\r\n    // },\r\n    // {\r\n    //     name: \"咸宁\",\r\n    //     value: 534\r\n    // },\r\n    // {\r\n    //     name: \"随州\",\r\n    //     value: 1160\r\n    // },\r\n    // {\r\n    //     name: \"恩施\",\r\n    //     value: 229\r\n    // },\r\n    // {\r\n    //     name: \"仙桃\",\r\n    //     value: 480\r\n    // },\r\n    // {\r\n    //     name: \"天门\",\r\n    //     value: 362\r\n    // },\r\n    // {\r\n    //     name: \"潜江\",\r\n    //     value: 94\r\n    // },\r\n    // {\r\n    //     name: \"神农架\",\r\n    //     value: 10\r\n    // },\r\n]\r\n\r\nvar convertData = function(data) {\r\n    var res = [];\r\n    for (var i = 0; i < data.length; i++) {\r\n        var geoCoord = geoCoordMap[data[i].name];\r\n        if (geoCoord) {\r\n            res.push({\r\n                name: data[i].name,\r\n                value: geoCoord.concat(data[i].value)\r\n            });\r\n        }\r\n    }\r\n    return res;\r\n};\r\n\r\nvar convertedData = [\r\n    convertData(data),\r\n    convertData(data.sort(function(a, b) {\r\n        return b.value - a.value;\r\n    }).slice(0, 6))\r\n];\r\n\r\nmyChart.showLoading({\r\n    animation: 'QuarticIn',\r\n    text: 'Loading',\r\n});\r\n\r\nvar option = {\r\n    baseOption: {\r\n        \r\n\r\n        backgroundColor: {\r\n            type: 'linear',\r\n            x: 0,\r\n            y: 0,\r\n            x2: 1,\r\n            y2: 1,\r\n            colorStops: [{\r\n                offset: 0,\r\n                color: '#0f378f' // 0% 处的颜色\r\n            }, {\r\n                offset: 1,\r\n                color: '#00091a' // 100% 处的颜色\r\n            }],\r\n            globalCoord: false // 缺省为 false\r\n        },\r\n\r\n        animationDurationUpdate: 1000,\r\n\r\n       \r\n        title: {\r\n            padding: 20,\r\n            text: '虚构疫情状况',\r\n            subtext: '国家卫健委测',\r\n            sublink: 'http://www.nhc.gov.cn',\r\n            x: 'left',\r\n            textStyle: {\r\n                color: '#fff'\r\n            },\r\n            subtextStyle: {\r\n                fontStyle: 'italic'\r\n            }\r\n        },\r\n\r\n        legend: {\r\n            icon: 'circle',\r\n            orient: 'vertical',\r\n            top: '7%',\r\n            left: 'right',\r\n            data: [{\r\n                    name: 'Top5',\r\n                },\r\n                {\r\n                    name: '散点',\r\n                },\r\n                {\r\n                    name: '热图',\r\n                }\r\n            ],\r\n            textStyle: {\r\n                color: '#fff'\r\n            }\r\n        },\r\n\r\n        // brush: {     //top5 涟漪效果\r\n        //     outOfBrush: {\r\n        //         color: 'gray'\r\n        //     },\r\n        //     brushStyle: {\r\n        //         borderWidth: 2,\r\n        //         color: 'rgba(255,255,255,0.2)',\r\n        //         borderColor: 'rgba(0,0,0,0.5)',\r\n        //     },\r\n        //     seriesIndex: [1],\r\n        //     brushMode: 'multiple',\r\n        //     throttleType: 'debounce',\r\n        //     throttleDelay: 300,\r\n        //     geoIndex: 0\r\n        // },\r\n\r\n        // toolbox: {   //工具栏\r\n        //     iconStyle: {\r\n        //         normal: {\r\n        //             borderColor: '#fff'\r\n        //         },\r\n        //         emphasis: {\r\n        //             borderColor: '#abc'\r\n        //         }\r\n        //     },\r\n        //     feature: {\r\n        //         restore: {},\r\n        //         saveAsImage: {}\r\n        //     }\r\n        // },\r\n\r\n        tooltip: {\r\n            trigger: 'item'\r\n        },\r\n\r\n        grid: {\r\n            right: '2%',\r\n            top: '20%',\r\n            bottom: '15%',\r\n            width: '15%'\r\n        },\r\n\r\n        xAxis: {\r\n            type: 'value',\r\n            scale: true,\r\n            position: 'top',\r\n            boundaryGap: false,\r\n            splitNumber: 4,\r\n            splitLine: {\r\n                show: false\r\n            },\r\n            axisLine: {\r\n                show: false\r\n            },\r\n            axisTick: {\r\n                show: false\r\n            },\r\n            axisLabel: {\r\n                margin: 2,\r\n                textStyle: {\r\n                    color: '#aaa'\r\n                }\r\n            },\r\n        },\r\n\r\n        yAxis: {\r\n            type: 'category',\r\n            nameGap: 95,\r\n            axisLine: {\r\n                show: false\r\n            },\r\n            axisTick: {\r\n                show: false\r\n            },\r\n            axisLabel: {\r\n                interval: 0,\r\n                textStyle: {\r\n                    color: '#fff'\r\n                }\r\n            },\r\n            data: []\r\n        },\r\n\r\n        visualMap: {\r\n            show: false,\r\n            min: 0,\r\n            max: 40000,\r\n            pieces: [{\r\n                    min: 2000\r\n                },\r\n                {\r\n                    min: 1500,\r\n                    max: 2000\r\n                },\r\n                {\r\n                    min: 1000,\r\n                    max: 1500\r\n                },\r\n                {\r\n                    min: 500,\r\n                    max: 1000\r\n                },\r\n                {\r\n                    min: 300,\r\n                    max: 500\r\n                },\r\n                {\r\n                    min: 200,\r\n                    max: 300\r\n                },\r\n                {\r\n                    min: 5,\r\n                    max: 200\r\n                },\r\n                {\r\n                    max: 5\r\n                }\r\n            ],\r\n            inRange: {\r\n                color: ['#50a3ba', '#eac736', '#d94e5d']\r\n            },\r\n            textStyle: {\r\n                color: '#fff'\r\n            }\r\n        },\r\n\r\n        geo: {\r\n            //center:[121.487899,31.249162],//视角的中心点为上海\r\n            roam: true, //缩放平移\r\n            scaleLimit: {\r\n                min: 0.5,\r\n                max: 10,\r\n            },\r\n\r\n            map: 'henan',\r\n            \r\n            // scaleLimit：{\r\n            //     min:1\r\n            // },\r\n            \r\n            // nameMap: {\r\n            //     selectedMode:single\r\n            // },\r\n             label: {\r\n                    normal: {\r\n                        show: true,\r\n                        color:'#00ffff',\r\n                        fontSize:14,\r\n                    },\r\n                    emphasis: {\r\n                        textStyle: {\r\n                            color: '#fff'\r\n                        }\r\n                    }\r\n                },\r\n            itemStyle: { //地图区块颜色\r\n                normal: {\r\n                    areaColor: '#3a7fd5',\r\n                    borderColor: '#0a53e9', //线\r\n                    shadowColor: '#092f8f', //外发光\r\n                    shadowBlur: 20\r\n                },\r\n                emphasis: {\r\n                    areaColor: '#0a2dae', //悬浮区背景\r\n                }\r\n            },\r\n            emphasis: {\r\n                itemStyle: {\r\n                    areaColor: '#123555',\r\n                    shadowColor: '#000',\r\n                    shadowBlur: 10\r\n                },\r\n                label: {\r\n                    show: false\r\n                }\r\n            },\r\n\r\n            /*regions: [{      //突出显示\r\n                name: '南阳市',\r\n                itemStyle: {\r\n                    areaColor: '#222222'\r\n                },\r\n                emphasis: {            //鼠标悬浮背景颜色\r\n                    itemStyle: {\r\n                        areaColor: '#111111',\r\n                        shadowColor: '#000',\r\n                        shadowBlur: 10\r\n                    },\r\n                }\r\n            }],*/\r\n        },\r\n\r\n        series: [{\r\n                name: '热图',\r\n                type: 'heatmap',\r\n                coordinateSystem: 'geo',\r\n                data: convertedData[0]\r\n            },\r\n            {\r\n                name: '散点',\r\n                type: 'scatter',\r\n                coordinateSystem: 'geo',\r\n                data: convertedData[0],\r\n                symbolSize: function(val) {\r\n                    return (5 + Math.log2(val[2]));\r\n                },\r\n                label: {\r\n                    normal: {\r\n                        formatter: '{b}',\r\n                        position: 'right',\r\n                        show: false\r\n                    },\r\n                    emphasis: {\r\n                        show: true\r\n                    }\r\n                },\r\n                itemStyle: {\r\n                    normal: {\r\n                        color: '#ddb926'\r\n                    }\r\n                },\r\n                tooltip: {\r\n                    trigger: 'item',\r\n                    formatter: function(params) {\r\n                        return params.name + ' : ' + params.value[2];\r\n                    }\r\n                },\r\n            },\r\n            // {\r\n            //     name: 'Top5',\r\n            //     type: 'effectScatter',\r\n            //     coordinateSystem: 'geo',\r\n            //     data: convertData(data.sort(function(a, b) {\r\n            //         return b.value - a.value;\r\n            //     }).slice(0, 5)),\r\n            //     symbolSize: function(val) {\r\n            //         return (6 + Math.log2(val[2]));\r\n            //     },\r\n            //     showEffectOn: 'render',\r\n            //     rippleEffect: {\r\n            //         brushType: 'stroke'\r\n            //     },\r\n            //     hoverAnimation: true,\r\n            //     label: {\r\n            //         normal: {\r\n            //             formatter: '{b}',\r\n            //             position: 'right',\r\n            //             show: true\r\n            //         }\r\n            //     },\r\n            //     itemStyle: {\r\n            //         normal: {\r\n            //             color: '#f4e925',\r\n            //             shadowBlur: 10,\r\n            //             shadowColor: '#333'\r\n            //         }\r\n            //     },\r\n            //     tooltip: {\r\n            //         trigger: 'item',\r\n            //         formatter: function(params) {\r\n            //             return params.name + ' : ' + params.value[2];\r\n            //         }\r\n            //     },\r\n            //     zlevel: 1\r\n            // },\r\n            {\r\n                id: 'bar',\r\n                zlevel: 2,\r\n                type: 'bar',\r\n                symbol: 'none',\r\n                itemStyle: {\r\n                    color: '#ddd',\r\n                },\r\n                emphasis: {\r\n                    color: '#fff',\r\n                    shadowColor: 'rgba(255, 0, 0, 0.5)',\r\n                    shadowBlur: 10\r\n                },\r\n                data: []\r\n            }\r\n        ]\r\n    },\r\n    options: []\r\n}\r\n\r\n\r\nmyChart.hideLoading();\r\nmyChart.setOption(option);\r\n// myChart.on('brushselected', renderBrushed);\r\n\r\n// setTimeout(function() {\r\n//     myChart.dispatchAction({\r\n//         type: 'brush',\r\n//         // areas: [{\r\n//         //     geoIndex: 0,\r\n//         //     brushType: 'polygon',\r\n//         //     coordRange: [\r\n//         //         [116, 29],\r\n//         //         [116, 34],\r\n//         //         [108, 34],\r\n//         //         [108, 29]\r\n//         //     ]\r\n//         // }]\r\n//     });\r\n// }, 0);\r\n\r\n// function renderBrushed(params) {\r\n//     var mainSeries = params.batch[0].selected[0];\r\n//     var selectedItems = [];\r\n//     var categoryData = [];\r\n//     var barData = [];\r\n//     var maxBar = 30;\r\n//     var sum = 0;\r\n//     var count = 0;\r\n\r\n//     for (var i = 0; i < mainSeries.dataIndex.length; i++) {\r\n//         var rawIndex = mainSeries.dataIndex[i];\r\n//         var dataItem = convertedData[0][rawIndex];\r\n//         var Value = dataItem.value[2];\r\n//         sum += Value;\r\n//         count++;\r\n//         selectedItems.push(dataItem);\r\n//     }\r\n\r\n//     selectedItems.sort(function(a, b) {\r\n//         return a.value[2] - b.value[2];\r\n//     });\r\n\r\n//     for (var i = 0; i < Math.min(selectedItems.length, maxBar); i++) {\r\n//         categoryData.push(selectedItems[i].name);\r\n//         barData.push(selectedItems[i].value[2]);\r\n//     }\r\n\r\n//     this.setOption({\r\n//         yAxis: {\r\n//             data: categoryData,\r\n//         },\r\n\r\n//         xAxis: {\r\n//             axisLabel: {\r\n//                 show: !!count,\r\n//             }\r\n//         },\r\n\r\n//         title: {\r\n//             id: 'statistic',\r\n//             right: '8%',\r\n//             top: '10%',\r\n//             text: count ? '区域内总和: ' + (sum) : '',\r\n//             textStyle: {\r\n//                 color: '#fff'\r\n//             },\r\n//         },\r\n\r\n//         series: {\r\n//             id: 'bar',\r\n//             data: barData\r\n//         }\r\n//     });\r\n// }","html":"","externalScripts":"/asset/get/s/data-1591252907761-po2vasjs3.js","updaterUID":"bd-1627449234","theme":"","layout":"","viewCount":1193,"userName":"l***w","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xqNVtDhYz8.png?v=1591265199842","isCustomThumbnail":0,"builtinTags":["brush","category-work","geo","grid","legend","series-bar","series-effectScatter","series-heatmap","series-scatter","title","toolbox","tooltip","visualMap"],"customTags":[],"updaterUserName":"l***w"}}