{"status":0,"data":{"cid":"x9YeU8CEqy","authorUid":"obd-oNg2ZYdQu5G_JeoojKjpV5hVlM6aCCP","authorUserName":"T***靈","title":"波形模拟","description":"波形图谱模拟","latestVersion":5,"alwaysLatest":0,"createTime":"2021-12-31T04:49:48.000Z","lastUpdateTime":"2022-01-10T07:54:55.000Z","auth":2,"uid":"obd-oNg2ZYdQu5G_JeoojKjpV5hVlM6aCCP","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":5,"parentVersion":4,"echartsVersion":"5.2.2","versionCreateTime":"2022-01-10T07:54:55.000Z","code":"// 本质是两个柱体叠加后隐藏重叠部分形成，参考echarts实例：阶梯瀑布图（柱状图模拟）\n// https://echarts.apache.org/examples/zh/editor.html?c=bar-waterfall2\n\nlet one = [],\n    two = [];\nlet datas = {\n    xData: [],\n    arrStar: [],\n    arrRise: [],\n    tooltip: [],\n    colorSet: [],\n};\nfor (let i = 0; i < 500; i++) {\n    one.push(Number((Math.random() * 100).toFixed(2)));\n    two.push(Number((Math.random() * 100).toFixed(2)));\n}\n\nsets(one, two);\n\nfunction sets(one, two) {\n    let a = JSON.parse(JSON.stringify(one)),\n        b = JSON.parse(JSON.stringify(two));\n    for (let index = 0; index < a.length; index++) {\n        datas.xData.push(index);\n        if (Math.abs(Number(two[index])) < Math.abs(Number(one[index]))) {\n            b[index] = one[index];\n            a[index] = two[index];\n        }\n\n        if (datas.arrStar.length > a.length * 2 && datas.arrRise.length > a.length * 2) {\n            datas.arrStar.shift();\n            datas.arrRise.shift();\n            datas.xData.shift();\n            datas.tooltip.shift();\n            datas.colorSet.shift();\n            datas.xData.push(Number(datas.xData[datas.xData.length - 1]) + 1);\n        }\n        datas.tooltip.push([a[index], b[index]]);\n\n        if (a[index] <= 0 && b[index] > 0) {\n            datas.arrRise.push(Number(b[index]));\n            datas.colorSet.push('#5470c6');\n            datas.arrStar.push(Number(a[index]));\n            continue;\n        }\n\n        if (a[index] > 0 && b[index] <= 0) {\n            datas.arrRise.push(Number(b[index]));\n            datas.colorSet.push('#5470c6');\n            datas.arrStar.push(Number(a[index]));\n            continue;\n        }\n\n        if (a[index] > 0 && b[index] > 0) {\n            if (a[index] < b[index]) datas.arrRise.push(Number(b[index] - a[index]));\n            else datas.arrRise.push(Number(a[index] - b[index]));\n            datas.colorSet.push('transparent');\n            datas.arrStar.push(Number(a[index]));\n            continue;\n        }\n\n        if (a[index] <= 0 && b[index] <= 0) {\n            if (a[index] < b[index]) datas.arrRise.push(Number(b[index] - a[index]));\n            else datas.arrRise.push(Number(a[index] - b[index]));\n            datas.colorSet.push('transparent');\n            datas.arrStar.push(Number(a[index]));\n            continue;\n        }\n    }\n}\n\noption = {\n    animation: false,\n    title: {\n        text: 'Accumulated Waterfall Chart',\n    },\n    tooltip: {\n        trigger: 'axis',\n        axisPointer: {\n            type: 'shadow',\n        },\n        formatter: function (params) {\n            let tar;\n            if (params[1].value !== '-') {\n                tar = params[1];\n            } else {\n                tar = params[0];\n            }\n            return (\n                tar.name +\n                '<br/>' +\n                tar.seriesName +\n                ' : ' +\n                tar.value.toFixed(2) +\n                '<br/>' +\n                datas.tooltip[tar.dataIndex][0] +\n                ' ~ ' +\n                datas.tooltip[tar.dataIndex][1]\n            );\n        },\n    },\n    legend: {\n        data: ['Income'],\n        animation: false,\n    },\n    grid: {\n        left: '3%',\n        right: '4%',\n        bottom: '3%',\n        containLabel: true,\n    },\n    xAxis: {\n        type: 'category',\n        triggerEvent: true, // 鼠标经过轴文字时事件生效\n        axisTick: {\n            show: true,\n            alignWithLabel: true,\n            interval: 'auto',\n        },\n        // splitNumber: 8,\n        axisLabel: {\n            interval: 'auto',\n            // showMaxLabel: true, //强制显示最后一个数据的刻度，为true时动态添加数据会出现数据显示问题\n        },\n        axisLine: {\n            onZero: false,\n        },\n        splitLine: {\n            show: false,\n        },\n        data: datas.xData,\n    },\n    yAxis: {\n        type: 'value',\n        splitLine: {\n            show: true,\n        },\n        axisLine: {\n            onZero: false,\n        },\n        // data: [-2, -1, 0, 1, 2],\n        axisTick: {\n            show: true,\n            alignWithLabel: true,\n        },\n    },\n    dataZoom: [\n        {\n            show: true,\n            type: 'inside',\n            filterMode: 'none',\n            xAxisIndex: [0],\n            start: 0,\n            end: 100,\n        },\n    ],\n    series: [\n        {\n            name: 'Placeholder',\n            type: 'bar',\n            stack: 'Total',\n            itemStyle: {\n                borderColor: 'transparent',\n                color: function (params) {\n                    return datas.colorSet[params.dataIndex];\n                },\n            },\n            data: datas.arrStar,\n        },\n        {\n            name: '波动',\n            type: 'bar',\n            stack: 'Total',\n            data: datas.arrRise,\n            itemStyle: {\n                borderColor: 'transparent',\n                color: '#5470c6',\n            },\n        },\n    ],\n};\n","html":"","externalScripts":"","updaterUID":"obd-oNg2ZYdQu5G_JeoojKjpV5hVlM6aCCP","theme":"","layout":"","viewCount":0,"userName":"T***靈","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x9YeU8CEqy.png?v=1641801295962","isCustomThumbnail":0,"builtinTags":["category-work","dataZoom","grid","legend","series-bar","title","tooltip"],"customTags":[],"updaterUserName":"T***靈"}}