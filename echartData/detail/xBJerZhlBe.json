{"status":0,"data":{"cid":"xBJerZhlBe","authorUid":"bd-2500662229","authorUserName":"虚***顶","title":"上海十大高楼","description":"根据指定点的经纬度展示部分地图区域","latestVersion":3,"alwaysLatest":1,"createTime":"2016-12-28T03:27:52.000Z","lastUpdateTime":"2016-12-28T03:27:52.000Z","auth":2,"uid":"bd-2500662229","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":3,"parentVersion":2,"echartsVersion":"3.8.0","versionCreateTime":"2018-01-13T07:14:35.000Z","code":"var imgs = [\"/asset/get/s/data-1482837966337-HJLA1R1re.jpg\",\n\n    \"/asset/get/s/data-1482837970905-HJjR1AySl.jpg\",\n\n    \"/asset/get/s/data-1482837974987-SJJJl0JSe.jpg\",\n\n    \"/asset/get/s/data-1482837980256-ByVyeC1He.jpg\",\n\n    \"/asset/get/s/data-1482837985048-B1tJl0kBe.jpg\",\n\n    \"/asset/get/s/data-1482837988459-Sk3JlA1rg.jpg\",\n\n    \"/asset/get/s/data-1482837991259-By1ggAyHx.jpg\",\n\n    \"/asset/get/s/data-1482837994637-r17leC1re.jpg\",\n\n    \"/asset/get/s/data-1482837997091-B1rlx0kBl.jpg\",\n\n    \"/asset/get/s/data-1482838000573-r1KxxAkrx.jpg\"\n];\n\n\n\n\nvar startPoint = {\n    x: 121.511781,\n    y: 31.239064\n};\n// 地图自定义样式\nvar bmap = {\n    center: [startPoint.x, startPoint.y],\n    zoom: 14,\n    roam: true,\n    mapStyle: {\n        styleJson: [{\n            \"featureType\": \"water\",\n            \"elementType\": \"all\",\n            \"stylers\": {\n                \"color\": \"#044161\"\n            }\n        }, {\n            \"featureType\": \"land\",\n            \"elementType\": \"all\",\n            \"stylers\": {\n                \"color\": \"#004981\"\n            }\n        }, {\n            \"featureType\": \"boundary\",\n            \"elementType\": \"geometry\",\n            \"stylers\": {\n                \"color\": \"#064f85\"\n            }\n        }, {\n            \"featureType\": \"railway\",\n            \"elementType\": \"all\",\n            \"stylers\": {\n                \"visibility\": \"off\"\n            }\n        }, {\n            \"featureType\": \"highway\",\n            \"elementType\": \"geometry\",\n            \"stylers\": {\n                \"color\": \"#004981\"\n            }\n        }, {\n            \"featureType\": \"highway\",\n            \"elementType\": \"geometry.fill\",\n            \"stylers\": {\n                \"color\": \"#005b96\",\n                \"lightness\": 1\n            }\n        }, {\n            \"featureType\": \"highway\",\n            \"elementType\": \"labels\",\n            \"stylers\": {\n                \"visibility\": \"off\"\n            }\n        }, {\n            \"featureType\": \"arterial\",\n            \"elementType\": \"geometry\",\n            \"stylers\": {\n                \"color\": \"#004981\"\n            }\n        }, {\n            \"featureType\": \"arterial\",\n            \"elementType\": \"geometry.fill\",\n            \"stylers\": {\n                \"color\": \"#00508b\"\n            }\n        }, {\n            \"featureType\": \"poi\",\n            \"elementType\": \"all\",\n            \"stylers\": {\n                \"visibility\": \"off\"\n            }\n        }, {\n            \"featureType\": \"green\",\n            \"elementType\": \"all\",\n            \"stylers\": {\n                \"color\": \"#056197\",\n                \"visibility\": \"off\"\n            }\n        }, {\n            \"featureType\": \"subway\",\n            \"elementType\": \"all\",\n            \"stylers\": {\n                \"visibility\": \"off\"\n            }\n        }, {\n            \"featureType\": \"manmade\",\n            \"elementType\": \"all\",\n            \"stylers\": {\n                \"visibility\": \"off\"\n            }\n        }, {\n            \"featureType\": \"local\",\n            \"elementType\": \"all\",\n            \"stylers\": {\n                \"visibility\": \"off\"\n            }\n        }, {\n            \"featureType\": \"arterial\",\n            \"elementType\": \"labels\",\n            \"stylers\": {\n                \"visibility\": \"off\"\n            }\n        }, {\n            \"featureType\": \"boundary\",\n            \"elementType\": \"geometry.fill\",\n            \"stylers\": {\n                \"color\": \"#029fd4\"\n            }\n        }, {\n            \"featureType\": \"building\",\n            \"elementType\": \"all\",\n            \"stylers\": {\n                \"color\": \"#1a5787\"\n            }\n        }, {\n            \"featureType\": \"label\",\n            \"elementType\": \"all\",\n            \"stylers\": {\n                \"visibility\": \"off\"\n            }\n        }]\n    }\n}\n\nvar data = [{\n    name: '上海信息大楼',\n    value: 282,\n    img: '9.jpg'\n}, {\n    name: '上海香港新世界大厦',\n    value: 278,\n    img: '10.jpg'\n}, {\n    name: '上海中心大厦',\n    value: 632,\n    img: '1.jpg'\n}, {\n    name: '上海环球金融中心',\n    value: 492,\n    img: '2.jpg'\n}, {\n    name: '东方明珠广播电视塔',\n    value: 467.9,\n    img: '3.jpg'\n}, {\n    name: '金茂大厦',\n    value: 420.5,\n    img: '4.jpg'\n}, {\n    name: '上海世茂国际广场',\n    value: 333,\n    img: '5.jpg'\n}, {\n    name: '会德丰国际大厦',\n    value: 298,\n    img: '6.jpg'\n}, {\n    name: '恒隆广场',\n    value: 288,\n    img: '7.jpg'\n}, {\n    name: '明天广场',\n    value: 285,\n    img: '8.jpg'\n}];\nvar geoCoordMap = {\n    '上海信息大楼': [121.517318, 31.241235],\n    '上海环球金融中心': [121.514175, 31.240237],\n    '上海中心大厦': [121.511781, 31.239064],\n    '上海香港新世界大厦': [121.479966, 31.229652],\n    '会德丰国际大厦': [121.451237, 31.228197],\n    '恒隆广场': [121.46013, 31.233977],\n    '明天广场': [121.476317, 31.236369],\n    '上海世茂国际广场': [121.482365, 31.240334],\n    '东方明珠广播电视塔': [121.506271, 31.245414],\n    '金茂大厦': [121.511578, 31.240468]\n};\n\nvar convertData = function(data) {\n    var res = [];\n    for (var i = 0; i < data.length; i++) {\n        var geoCoord = geoCoordMap[data[i].name];\n        if (geoCoord) {\n            res.push({\n                name: data[i].name,\n                value: geoCoord.concat(data[i].value),\n                symbol: 'image://' + imgs[i]\n            });\n        }\n    }\n    return res;\n};\noption = {\n    backgroundColor: '#404a59',\n    title: {\n        text: '上海十大高楼',\n        left: 'center',\n        subtext:'源码',\n        sublink:'http://data-visual.cn/datav/demo.html#../test/bmap-test.html',\n        textStyle: {\n            color: '#fff'\n        }\n    },\n    tooltip: {\n        trigger: 'item'\n    },\n    bmap: bmap,\n    series: [{\n        name: '上海十大高楼',\n        type: 'scatter',\n        coordinateSystem: 'bmap',\n        data: convertData(data),\n        symbolSize: [40, 40],\n        label: {\n            normal: {\n                formatter: '{b}',\n                position: 'right',\n                show: false\n            },\n            emphasis: {\n                show: true\n            }\n        },\n        itemStyle: {\n            normal: {\n                color: '#ddb926'\n            }\n        }\n    }]\n};\nmyChart.setOption(option);\n\nsetTimeout(delay, 1000)\n\nfunction delay() {\n\n    var map = myChart.getModel().getComponent(\"bmap\").getBMap();\n\n    var bdary = new BMap.Boundary();\n    bdary.get(\"中国\", function(rs) { //获取行政区域 \n        var coordinates = [];\n        for (var item in geoCoordMap) {\n            coordinates.push(geoCoordMap[item]);\n        }\n        coordinates.push(coordinates[0]);\n\n        var innerCircle = coordinates.map(function(d) {\n                return d[0] + \",\" + d[1]\n            }).join(\";\") + \";\",\n            points = coordinates.map(function(d) {\n                return new BMap.Point(d[0], d[1]);\n            }); //console.log(points);\n\n        var p1 = innerCircle + rs.boundaries[0];\n\n        var ply1 = new BMap.Polygon(p1, {\n            strokeColor: \"none\",\n            fillColor: \"rgba(246,246,246,1)\",\n            strokeOpacity: 0,\n            fillOpacity:0.8\n        }); //建立多边形覆盖物\n        map.addOverlay(ply1);\n\n        //5. 给目标行政区划添加边框，其实就是给目标行政区划添加一个没有填充物的遮罩层\n        var ply = new BMap.Polygon(points, {\n            strokeWeight: 2,\n            strokeColor: \"#ff0000\",\n            fillColor: \"rgba(255,0,0,0.0)\"\n        });\n        map.addOverlay(ply);\n        map.setViewport(ply.getPath()); //调整视野\n        //loadCityMapInfo(map);\n\n        /*for(var i=0; i<coordinates.length; i++)\n        {\n        \tvar  marker=new BMap.Marker(new BMap.Point(coordinates[i][0],coordinates[i][1]), {title:i+\"---\"});\n        \tmap.addOverlay(marker);\n        }*/\n\n        /*var mapContent=$(\"#container\").children(0).children(1).children(0);\n        mapContent.each(function(d){\n        \tif($(this).css(\"zIndex\")==200)$(this).css(\"zIndex\",9000);\n        });*/\n    });\n}","html":"","externalScripts":"http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM,/dep/echarts/latest/extension/bmap.min.js","updaterUID":"bd-2500662229","theme":"","layout":"","viewCount":3217,"userName":"虚***顶","commentCount":0,"starCount":15,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xBJerZhlBe.png?v=1482895673491","isCustomThumbnail":1,"builtinTags":["category-work"],"customTags":["bmap","map"],"updaterUserName":"虚***顶"}}