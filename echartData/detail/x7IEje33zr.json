{"status":0,"data":{"cid":"x7IEje33zr","authorUid":"obd-o2DufMoxJbxk_RqyO_wnHm8y-mreZBp","authorUserName":"M***o","title":"自定义custom矩形","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2020-07-09T01:56:16.000Z","lastUpdateTime":"2020-07-09T01:56:16.000Z","auth":2,"uid":"obd-o2DufMoxJbxk_RqyO_wnHm8y-mreZBp","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-07-09T01:56:16.000Z","code":"option = {\r\n    tooltip: {\r\n        show: true,\r\n        formatter: function(val){\r\n            return val.value[3]\r\n        }\r\n    },\r\n    xAxis: [\r\n        {\r\n          type: 'time',\r\n          splitLine: {\r\n            show: false\r\n          },\r\n          min: new Date(\"2020-5-19 00:00:00\"),\r\n          max: new Date(\"2020-5-19 24:00:00\")\r\n        },\r\n        {\r\n          type: 'time',\r\n          splitLine: {\r\n            show: false\r\n          },\r\n          min: new Date(\"2020-5-19 00:00:00\"),\r\n          max: new Date(\"2020-5-19 24:00:00\")\r\n        },\r\n    ],\r\n    yAxis: [\r\n        {\r\n            type: 'category',\r\n            data: ['手术间一','手术间二']\r\n        }\r\n    ],\r\n    dataZoom: [\r\n        {\r\n          show: true,\r\n          type: 'slider',\r\n          height: 20,\r\n          bottom: 25,\r\n          xAxisIndex:[0,1],\r\n          textStyle: {\r\n            color: '#000'\r\n          },\r\n        },\r\n        {\r\n          show: true,\r\n          orient:'vertical',\r\n          type: 'slider',\r\n          right: 40,\r\n          width: 20,\r\n          start: 0,\r\n          end: 100,\r\n          textStyle: {\r\n            color: '#000'\r\n          },\r\n        }\r\n    ],\r\n    series: [\r\n        {\r\n            name:'背景板',\r\n            type: 'custom',\r\n            renderItem: renderItem,\r\n            encode: { \r\n                x: 1, \r\n                y: 0,\r\n                tooltip: 2,\r\n                label: 3 \r\n            },\r\n            z: 1,\r\n            itemStyle: {normal: {color: \"white\"}},\r\n            label: {\r\n                show: true,\r\n                position: 'insideTopLeft',\r\n                color:'red',\r\n                formatter: function(value){\r\n                    return '{a|}{b| '+value.value[3]+'}'\r\n                },\r\n                rich: {\r\n                    a: {\r\n                        borderWidth: 1,\r\n                        borderColor:'#4D4D4D'\r\n                    },\r\n                    b: {\r\n                        color:'black'\r\n                    }\r\n                }\r\n            },\r\n            data: [\r\n                {\r\n                    name:  \"手术1\",\r\n                    value: [0, new Date(\"2020-5-19 09:00:00\"), new Date(\"2020-5-19 15:00:00\"), '阑尾手术','肝胆内科 张医生'],\r\n                },\r\n                {\r\n                    name:  \"手术2\",\r\n                    value: [1, new Date(\"2020-5-19 09:00:00\"), new Date(\"2020-5-19 15:00:00\"), '阑尾手术','肝胆内科 张医生'],\r\n                },\r\n                {\r\n                    name:  \"手术3\",\r\n                    value: [1, new Date(\"2020-5-19 17:00:00\"), new Date(\"2020-5-19 22:00:00\"), '阑尾手术','肝胆内科 李医生'],\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            name:'折线背景',\r\n            type: 'custom',\r\n            renderItem: renderItem4,\r\n            encode: { \r\n                x: 1, \r\n                y: 0\r\n            },\r\n            z: 2,\r\n            itemStyle: {\r\n                color: \"#F0EFF5\"\r\n            },\r\n            data: [\r\n                {\r\n                    name:  \"手术1\",\r\n                    value: [0, new Date(\"2020-5-19 09:00:00\"), new Date(\"2020-5-19 15:00:00\")],\r\n                    \r\n                },\r\n                {\r\n                    name:  \"手术2\",\r\n                    value: [1, new Date(\"2020-5-19 09:00:00\"), new Date(\"2020-5-19 15:00:00\")],\r\n                    \r\n                },\r\n                {\r\n                    name:  \"手术3\",\r\n                    value: [1, new Date(\"2020-5-19 17:00:00\"), new Date(\"2020-5-19 22:00:00\")],\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            name:'顶部条',\r\n            type: 'custom',\r\n            renderItem: renderItem2,\r\n            tooltip:{\r\n              show: false  \r\n            },\r\n            encode: { x: 1, y: 0 },\r\n            itemStyle: {\r\n                color: \"#007AFF\"\r\n            },\r\n            data: [\r\n                {\r\n                    name:  \"手术1\",\r\n                    value: [0, new Date(\"2020-5-19 09:00:00\"), new Date(\"2020-5-19 15:00:00\")],\r\n                },\r\n                {\r\n                    name:  \"手术2\",\r\n                    value: [1, new Date(\"2020-5-19 09:00:00\"), new Date(\"2020-5-19 15:00:00\")],\r\n                },\r\n                {\r\n                    name:  \"手术3\",\r\n                    value: [1, new Date(\"2020-5-19 17:00:00\"), new Date(\"2020-5-19 22:00:00\")],\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            name:'底部文字',\r\n            type: 'custom',\r\n            renderItem: renderItem3,\r\n            encode: { x: 1, y: 0 },\r\n            z: 2,\r\n            itemStyle: {normal: {color: \"transparent\"}},\r\n            label: {\r\n                show: true,\r\n                position: 'insideBottomLeft',\r\n                color:'red',\r\n                formatter: function(value){\r\n                    return '{a|}{b| '+value.value[4]+'}'\r\n                },\r\n                rich: {\r\n                    a: {\r\n                        borderWidth: 1,\r\n                        borderColor:'#4D4D4D'\r\n                    },\r\n                    b: {\r\n                        color:'black',\r\n                    }\r\n                }\r\n            },\r\n            data: [\r\n                {\r\n                    name:  \"手术1\",\r\n                    value: [0, new Date(\"2020-5-19 09:00:00\"), new Date(\"2020-5-19 15:00:00\"), '阑尾手术','肝胆内科 张医生'],\r\n                },\r\n                {\r\n                    name:  \"手术2\",\r\n                    value: [1, new Date(\"2020-5-19 09:00:00\"), new Date(\"2020-5-19 15:00:00\"), '阑尾手术','肝胆内科 张医生'],\r\n                },\r\n                {\r\n                    name:  \"手术3\",\r\n                    value: [1, new Date(\"2020-5-19 17:00:00\"), new Date(\"2020-5-19 22:00:00\"), '阑尾手术','肝胆内科 李医生'],\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            name: '开始时间',\r\n            type: 'line',\r\n            symbol: 'circle' ,\r\n            symbolSize: 4,\r\n            z: 3,\r\n            itemStyle: {\r\n                color:'red'\r\n            },\r\n            lineStyle:{\r\n                color: 'rgba(0,0,0,0)'\r\n            },\r\n            tooltip:{\r\n              show:true,\r\n              formatter:function(value){\r\n                  return value.value[2];\r\n              }\r\n            },\r\n            data:[\r\n              [new Date('2020-5-19 10:00:00'), 0, 30],\r\n              [new Date(\"2020-5-19 10:00:00\"), 1, 30]\r\n            ]\r\n        },\r\n        {\r\n            name: '结束时间',\r\n            type: 'line',\r\n            symbol: 'circle' ,\r\n            symbolSize: 4,\r\n            z: 3,\r\n            itemStyle: {\r\n                color:'green'\r\n            },\r\n            lineStyle:{\r\n                color: 'rgba(0,0,0,0)'\r\n            },\r\n            data:[\r\n              [new Date('2020-5-19 11:00:00'), 0, 40],\r\n              [new Date(\"2020-5-19 11:00:00\"), 1, 40]\r\n            ]\r\n        },\r\n        {\r\n            name:'间隔时间',\r\n            type: 'custom',\r\n            renderItem: renderItem5,\r\n            encode: { \r\n                x: 1, \r\n                y: 0,\r\n                tooltip: 2,\r\n                label: 3 \r\n            },\r\n            z: 5,\r\n            itemStyle: { color: \"orange\" },\r\n            label: {\r\n                show:true,\r\n                position: 'inside',\r\n                color:'white'\r\n            },\r\n            data: [\r\n                {\r\n                    name:  \"手术1\",\r\n                    value: [0, new Date(\"2020-5-19 15:00:00\"), new Date(\"2020-5-19 17:00:00\"), '间隔时间','肝胆内科 张医生'],\r\n                },\r\n                {\r\n                    name:  \"手术2\",\r\n                    value: [1, new Date(\"2020-5-19 15:00:00\"), new Date(\"2020-5-19 17:00:00\"), '间隔时间','肝胆内科 张医生'],\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            name:'上班时间',\r\n            type: 'custom',\r\n            renderItem: renderItem6,\r\n            encode: { x: 1, y: 0 },\r\n            itemStyle: {color: \"red\"},\r\n            z: 4,\r\n            data: [\r\n                {\r\n                    name:  \"上班时间\",\r\n                    value: [0, new Date(\"2020-5-19 9:00:00\"), new Date(\"2020-5-19 9:02:00\")],\r\n                },\r\n                {\r\n                    name:  \"上班时间\",\r\n                    value: [1, new Date(\"2020-5-19 9:00:00\"), new Date(\"2020-5-19 9:02:00\")],\r\n                },\r\n            ]\r\n        },\r\n        {\r\n            name:'下班时间',\r\n            type: 'custom',\r\n            renderItem: renderItem6,\r\n            encode: { x: 1, y: 0 },\r\n            itemStyle: {color: \"green\"},\r\n            z: 4,\r\n            data: [\r\n                {\r\n                    name:  \"下班时间\",\r\n                    value: [0, new Date(\"2020-5-19 17:00:00\"), new Date(\"2020-5-19 17:02:00\")],\r\n                },\r\n                {\r\n                    name:  \"下班时间\",\r\n                    value: [1, new Date(\"2020-5-19 17:00:00\"), new Date(\"2020-5-19 17:02:00\")],\r\n                },\r\n            ]\r\n        },\r\n    ]\r\n};\r\n\r\nfunction renderItem6(params, api) {\r\n    var categoryIndex = api.value(0);  //获取data中的value参数为下标\r\n    var start = api.coord([api.value(1), categoryIndex]);\r\n    var end = api.coord([api.value(2), categoryIndex]);\r\n    var height = api.size([0, 1])[1] ;\r\n    var rectShape = echarts.graphic.clipRectByRect({\r\n            x: start[0],\r\n            y: start[1] - height / 2,\r\n            width: end[0] - start[0],\r\n            height: height\r\n        }, {\r\n            x: params.coordSys.x,\r\n            y: params.coordSys.y,\r\n            width: params.coordSys.width,\r\n            height: params.coordSys.height\r\n        });\r\n    return rectShape && {\r\n        type: 'rect',\r\n        shape: rectShape,\r\n        style: api.style()\r\n    };\r\n}\r\nfunction renderItem5(params, api) {\r\n    var categoryIndex = api.value(0);  //获取data中的value参数为下标\r\n    var start = api.coord([api.value(1), categoryIndex]);\r\n    var end = api.coord([api.value(2), categoryIndex]);\r\n    var allHeight = api.size([0, 1])[1];\r\n    var height = allHeight * 0.8;\r\n    var rectShape = echarts.graphic.clipRectByRect({\r\n            x: start[0],\r\n            y: start[1] - height / 2 - allHeight*0.02,\r\n            width: end[0] - start[0],\r\n            height: height + allHeight*0.02\r\n        }, {\r\n            x: params.coordSys.x,\r\n            y: params.coordSys.y,\r\n            width: params.coordSys.width,\r\n            height: params.coordSys.height\r\n        });\r\n    return rectShape && {\r\n        type: 'rect',\r\n        shape: rectShape,\r\n        style: api.style()\r\n    };\r\n}\r\nfunction renderItem4(params, api) {\r\n    var categoryIndex = api.value(0);  //获取data中的value参数为下标\r\n    var start = api.coord([api.value(1), categoryIndex]);\r\n    var end = api.coord([api.value(2), categoryIndex]);\r\n    var allHeight = api.size([0, 1])[1];\r\n    var height = allHeight * 0.2;\r\n    var rectShape = echarts.graphic.clipRectByRect({\r\n            x: start[0],\r\n            y: start[1] - height/2, //底部高度百分比一半加上自身高度\r\n            width: end[0] - start[0],\r\n            height: height\r\n        }, {\r\n            x: params.coordSys.x,\r\n            y: params.coordSys.y,\r\n            width: params.coordSys.width,\r\n            height: params.coordSys.height\r\n        });\r\n    return rectShape && {\r\n        type: 'rect',\r\n        shape: rectShape,\r\n        style: api.style()\r\n    };\r\n}\r\nfunction renderItem3(params, api) {\r\n    var categoryIndex = api.value(0);  //获取data中的value参数为下标\r\n    var start = api.coord([api.value(1), categoryIndex]);\r\n    var end = api.coord([api.value(2), categoryIndex]);\r\n    var allHeight = api.size([0, 1])[1];\r\n    var height = allHeight * 0.02;\r\n    var rectShape = echarts.graphic.clipRectByRect({\r\n            x: start[0],\r\n            y: start[1] - allHeight * -0.38, //底部高度百分比一半加上自身高度\r\n            width: end[0] - start[0],\r\n            height: height\r\n        }, {\r\n            x: params.coordSys.x,\r\n            y: params.coordSys.y,\r\n            width: params.coordSys.width,\r\n            height: params.coordSys.height\r\n        });\r\n    return rectShape && {\r\n        type: 'rect',\r\n        shape: rectShape,\r\n        style: api.style()\r\n    };\r\n}\r\nfunction renderItem2(params, api) {\r\n    var categoryIndex = api.value(0);  //获取data中的value参数为下标\r\n    var start = api.coord([api.value(1), categoryIndex]);\r\n    var end = api.coord([api.value(2), categoryIndex]);\r\n    var allHeight = api.size([0, 1])[1];\r\n    var height = allHeight * 0.02;\r\n    var rectShape = echarts.graphic.clipRectByRect({\r\n            x: start[0],\r\n            y: start[1] - allHeight * 0.42, //底部高度百分比一半加上自身高度\r\n            width: end[0] - start[0],\r\n            height: height\r\n        }, {\r\n            x: params.coordSys.x,\r\n            y: params.coordSys.y,\r\n            width: params.coordSys.width,\r\n            height: params.coordSys.height\r\n        });\r\n    return rectShape && {\r\n        type: 'rect',\r\n        shape: rectShape,\r\n        style: api.style()\r\n    };\r\n}\r\nfunction renderItem(params, api) {\r\n    var categoryIndex = api.value(0);  //获取data中的value参数为下标\r\n    var start = api.coord([api.value(1), categoryIndex]);\r\n    var end = api.coord([api.value(2), categoryIndex]);\r\n    var height = api.size([0, 1])[1] * 0.8;\r\n    var rectShape = echarts.graphic.clipRectByRect({\r\n            x: start[0],\r\n            y: start[1] - height / 2,\r\n            width: end[0] - start[0],\r\n            height: height\r\n        }, {\r\n            x: params.coordSys.x,\r\n            y: params.coordSys.y,\r\n            width: params.coordSys.width,\r\n            height: params.coordSys.height\r\n        });\r\n    return rectShape && {\r\n        type: 'rect',\r\n        shape: rectShape,\r\n        style: api.style()\r\n    };\r\n}","html":"","externalScripts":"","updaterUID":"obd-o2DufMoxJbxk_RqyO_wnHm8y-mreZBp","theme":"","layout":"","viewCount":158,"userName":"M***o","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x7IEje33zr.png?v=1594259776850","isCustomThumbnail":1,"builtinTags":["category-work","dataZoom","grid","series-custom","series-line","tooltip"],"customTags":["自定义"],"updaterUserName":"M***o"}}