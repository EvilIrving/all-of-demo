{"status":0,"data":{"cid":"xk8wBSDtaz","authorUid":"bd-2250429553","authorUserName":"桥***q","title":"2018全国各省人口数（万）","description":"data from chamiji","latestVersion":4,"alwaysLatest":1,"createTime":"2018-12-16T11:51:57.000Z","lastUpdateTime":"2018-12-16T11:51:57.000Z","auth":2,"uid":"bd-2250429553","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":4,"parentVersion":3,"echartsVersion":"4.2.0","versionCreateTime":"2018-12-16T12:03:49.000Z","code":"var data = [\r\n   { name:\"广东\",value:11169},\r\n   { name:\"山东\",value:10005.83},\r\n   { name:\"河南\" ,value:9559.13},\r\n   { name:\"四川\" ,value:8302},\r\n   { name:\"江苏\",value:8029.3},\r\n   { name:\"河北\",value:7519.52},\r\n   { name:\"湖南\",value:6860.2},\r\n   { name:\"安徽\",value:6254.8},\r\n   { name:\"湖北\",value:5902},\r\n   { name:\"浙江\",value:5657},\r\n   { name:\"广西\",value:4885},\r\n   { name:\"云南\",value:4800.5},\r\n   { name:\"江西\",value:4622.1},\r\n   { name:\"辽宁\",value:4368.9},\r\n   { name:\"福建\",value:3911},\r\n   { name:\"陕西\",value:3835.44},\r\n   { name:\"黑龙江\",value:3788.7},\r\n   { name:\"山西\",value:3702.35},\r\n   { name:\"贵州\",value:3580},\r\n   { name:\"重庆\",value:3048.43},\r\n   { name:\"吉林\",value:2717.43},\r\n   { name:\"甘肃\",value:2625.71},\r\n   { name:\"内蒙古\",value:2528.6},\r\n   { name:\"新疆\",value:2444.67},\r\n   { name:\"上海\",value:2418.33},\r\n   { name:\"台湾\",value:2369},\r\n   { name:\"北京\",value:2170.7},\r\n   { name:\"天津\",value:1556.87},\r\n   { name:\"海南\",value:925.76},\r\n   { name:\"香港\",value:743},\r\n   { name:\"宁夏\",value:681.79},\r\n   { name:\"青海\",value:598.38},\r\n   { name:\"西藏\",value:337.15},\r\n   { name:\"澳门\",value:63.2},\r\n\r\n\r\n\r\n];\r\n\r\nvar geoCoordMap = {\r\n   \"广东\":[113.23, 23.16],\r\n   \"山东\":[117, 36.65],\r\n   \"河南\":[113.65, 34.76],\r\n   \"四川\":[104.06, 30.67],\r\n   \"江苏\":[118.78, 32.04],\r\n   \"河北\":[114.48, 38.03],\r\n   \"湖南\":[113, 28.21],\r\n   \"安徽\":[117.27, 31.86],\r\n   \"湖北\":[114.31, 30.52],\r\n   \"浙江\":[120.19, 30.26],\r\n   \"广西\":[108.33, 22.84],\r\n   \"云南\":[102.73, 25.04],\r\n   \"江西\":[115.89, 28.68],\r\n   \"辽宁\":[123.38, 41.8],\r\n   \"福建\":[119.3, 26.08],\r\n   \"陕西\":[108.95, 34.27],\r\n   \"黑龙江\":[126.63, 45.75],\r\n   \"山西\":[112.53, 37.87],\r\n   \"贵州\":[106.71, 26.57],\r\n   \"重庆\":[106.54, 29.59],\r\n   \"吉林\":[125.35, 43.88],\r\n   \"甘肃\":[103.73, 36.03],\r\n   \"内蒙古\":[111.65, 40.82],\r\n   \"新疆\":[87.68, 43.77],\r\n   \"上海\":[121.48, 31.22],\r\n   \"台湾\":[121.30, 25.03],\r\n   \"北京\":[116.46, 39.92],\r\n   \"天津\":[117.2, 39.13],\r\n   \"海南\":[110.35, 20.02],\r\n   \"香港\":[114.17, 22.28],\r\n   \"宁夏\":[106.27, 38.47],\r\n   \"青海\":[101.74, 36.56],\r\n   \"西藏\":[91.11, 29.97],\r\n   \"澳门\":[113.54, 22.19],\r\n\r\n};\r\n\r\nvar convertData = function(data) {\r\n    var res = [];\r\n    for (var i = 0; i < data.length; i++) {\r\n        var geoCoord = geoCoordMap[data[i].name];\r\n        if (geoCoord) {\r\n            res.push({\r\n                name: data[i].name,\r\n                value: geoCoord.concat(data[i].value)\r\n            });\r\n        }\r\n    }\r\n    return res;\r\n};\r\n\r\nvar convertedData = [\r\n    convertData(data),\r\n    convertData(data.sort(function(a, b) {\r\n        return b.value - a.value;\r\n    }).slice(0, 6))\r\n];\r\ndata.sort(function(a, b) {\r\n    return a.value - b.value;\r\n})\r\n\r\nvar selectedItems = [];\r\nvar categoryData = [];\r\nvar barData = [];\r\n//   var maxBar = 30;\r\nvar sum = 0;\r\nvar count = data.length;\r\nfor (var i = 0; i < data.length; i++) {\r\n    categoryData.push(data[i].name);\r\n    barData.push(data[i].value);\r\n    sum += data[i].value;\r\n}\r\nconsole.log(categoryData);\r\nconsole.log(sum + \"   \" + count)\r\noption = {\r\n    backgroundColor: '#404a59',\r\n    animation: true,\r\n    animationDuration: 1000,\r\n    animationEasing: 'cubicInOut',\r\n    animationDurationUpdate: 1000,\r\n    animationEasingUpdate: 'cubicInOut',\r\n    title: [{\r\n        text: '2018全国各省人口数（万）',\r\n        link: 'http://www.chamiji.com/chinaprovincepopulation',\r\n        subtext: 'data from chamiji',\r\n        sublink: 'http://www.chamiji.com/chinaprovincepopulation',\r\n        left: 'center',\r\n        textStyle: {\r\n            color: '#fff'\r\n        }\r\n    }, {\r\n        id: 'statistic',\r\n        text: count ? '平均: ' + parseInt((sum / count).toFixed(4)) : '',\r\n        right: 120,\r\n        top: 40,\r\n        width: 100,\r\n        textStyle: {\r\n            color: '#fff',\r\n            fontSize: 16\r\n        }\r\n    }],\r\n    toolbox: {\r\n        iconStyle: {\r\n            normal: {\r\n                borderColor: '#fff'\r\n            },\r\n            emphasis: {\r\n                borderColor: '#b1e4ff'\r\n            }\r\n        },\r\n        feature: {\r\n            dataZoom: {},\r\n            brush: {\r\n                type: ['rect', 'polygon', 'clear']\r\n            },\r\n            saveAsImage: {\r\n                show: true\r\n            }\r\n        }\r\n    },\r\n    brush: {\r\n        outOfBrush: {\r\n            color: '#abc'\r\n        },\r\n        brushStyle: {\r\n            borderWidth: 2,\r\n            color: 'rgba(0,0,0,0.2)',\r\n            borderColor: 'rgba(0,0,0,0.5)',\r\n        },\r\n        seriesIndex: [0, 1],\r\n        throttleType: 'debounce',\r\n        throttleDelay: 300,\r\n        geoIndex: 0\r\n    },\r\n    geo: {\r\n        map: 'china',\r\n        left: '10',\r\n        right: '45%',\r\n        center: [104.06, 30.67],\r\n        zoom: 1.2,\r\n        label: {\r\n            emphasis: {\r\n                show: false\r\n            }\r\n        },\r\n        roam: true,\r\n        itemStyle: {\r\n            normal: {\r\n                areaColor: '#323c48',\r\n                borderColor: '#111'\r\n            },\r\n            emphasis: {\r\n                areaColor: '#2a333d'\r\n            }\r\n        }\r\n    },\r\n    tooltip: {\r\n        trigger: 'item'\r\n    },\r\n    grid: {\r\n        right: 40,\r\n        top: 100,\r\n        bottom: 40,\r\n        width: '30%'\r\n    },\r\n    xAxis: {\r\n        type: 'value',\r\n        scale: true,\r\n        position: 'top',\r\n        boundaryGap: false,\r\n        splitLine: {\r\n            show: false\r\n        },\r\n        axisLine: {\r\n            show: false\r\n        },\r\n        axisTick: {\r\n            show: false\r\n        },\r\n        axisLabel: {\r\n            margin: 2,\r\n            textStyle: {\r\n                color: '#aaa'\r\n            }\r\n        },\r\n    },\r\n    yAxis: {\r\n        type: 'category',\r\n        //  name: 'TOP 20',\r\n        nameGap: 16,\r\n        axisLine: {\r\n            show: true,\r\n            lineStyle: {\r\n                color: '#ddd'\r\n            }\r\n        },\r\n        axisTick: {\r\n            show: false,\r\n            lineStyle: {\r\n                color: '#ddd'\r\n            }\r\n        },\r\n        axisLabel: {\r\n            interval: 0,\r\n            textStyle: {\r\n                color: '#ddd'\r\n            }\r\n        },\r\n        data: categoryData\r\n    },\r\n    series: [{\r\n        // name: 'pm2.5',\r\n        type: 'scatter',\r\n        coordinateSystem: 'geo',\r\n        data: convertedData[0],\r\n        symbolSize: function(val) {\r\n            return Math.max(val[2] / 300, 8);\r\n        },\r\n        label: {\r\n            normal: {\r\n                formatter: '{b}',\r\n                position: 'right',\r\n                show: false\r\n            },\r\n            emphasis: {\r\n                show: true\r\n            }\r\n        },\r\n        itemStyle: {\r\n            normal: {\r\n                color: '#FF8C00',\r\n                position: 'right',\r\n                show: true\r\n            }\r\n        }\r\n    }, {\r\n        //  name: 'Top 5',\r\n        type: 'effectScatter',\r\n        coordinateSystem: 'geo',\r\n        data: convertedData[0],\r\n        symbolSize: function(val) {\r\n            return Math.max(val[2] / 500, 8);\r\n        },\r\n        showEffectOn: 'render',\r\n        rippleEffect: {\r\n            brushType: 'stroke'\r\n        },\r\n        hoverAnimation: true,\r\n        label: {\r\n            normal: {\r\n                formatter: '{b}',\r\n                position: 'right',\r\n                show: true\r\n            }\r\n        },\r\n        itemStyle: {\r\n            normal: {\r\n                color: '#f4e925',\r\n                shadowBlur: 50,\r\n                shadowColor: '#EE0000'\r\n            }\r\n        },\r\n        zlevel: 1\r\n    }, {\r\n        id: 'bar',\r\n        zlevel: 2,\r\n        type: 'bar',\r\n        symbol: 'none',\r\n        itemStyle: {\r\n            normal: {\r\n                color: '#ddb926'\r\n            }\r\n        },\r\n\r\n        data: data\r\n    }]\r\n};\r\n\r\n\r\n\r\nfunction renderBrushed(params) {\r\n    var mainSeries = params.batch[0].selected[0];\r\n\r\n    var selectedItems = [];\r\n    var categoryData = [];\r\n    var barData = [];\r\n    var maxBar = 30;\r\n    var sum = 0;\r\n    var count = 0;\r\n\r\n    for (var i = 0; i < mainSeries.dataIndex.length; i++) {\r\n        var rawIndex = mainSeries.dataIndex[i];\r\n        var dataItem = convertedData[0][rawIndex];\r\n        var pmValue = dataItem.value[2];\r\n\r\n        sum += pmValue;\r\n        count++;\r\n\r\n        selectedItems.push(dataItem);\r\n    }\r\n\r\n    selectedItems.sort(function(a, b) {\r\n        //   return b.value[2] - a.value[2];\r\n        return a.value - b.value;\r\n    });\r\n\r\n    for (var i = 0; i < Math.min(selectedItems.length, maxBar); i++) {\r\n        categoryData.push(selectedItems[i].name);\r\n        barData.push(selectedItems[i].value[2]);\r\n    }\r\n\r\n    this.setOption({\r\n        yAxis: {\r\n            data: categoryData\r\n        },\r\n        xAxis: {\r\n            axisLabel: {\r\n                show: !!count\r\n            }\r\n        },\r\n        title: {\r\n            id: 'statistic',\r\n            text: count ? '平均: ' + (sum / count).toFixed(4) : ''\r\n        },\r\n        series: {\r\n            id: 'bar',\r\n            //        sort:'descending',\r\n            data: barData\r\n        }\r\n    });\r\n}","html":"","externalScripts":"/dep/echarts/map/js/china.js","updaterUID":"bd-2250429553","theme":"","layout":"","viewCount":444,"userName":"桥***q","commentCount":0,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xk8wBSDtaz.png?v=1544961829950","isCustomThumbnail":0,"builtinTags":["brush","category-work","dataZoom","geo","grid","series-bar","series-effectScatter","series-scatter","title","toolbox","tooltip"],"customTags":[],"updaterUserName":"桥***q"}}