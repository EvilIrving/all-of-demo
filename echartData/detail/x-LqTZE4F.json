{"status":0,"data":{"cid":"x-LqTZE4F","authorUid":"bd-1606641265","authorUserName":"你***1","title":"堆叠柱状图label显示总数","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2019-11-22T02:32:51.000Z","lastUpdateTime":"2019-11-22T02:32:51.000Z","auth":2,"uid":"bd-1606641265","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.4.0","versionCreateTime":"2019-11-22T02:32:51.000Z","code":"option = {\n    title: {\n        text: '堆叠柱状图label显示总数'\n    },\n    xAxis: {\n        data: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']\n    },\n    legend:{\n        \n    },\n    yAxis: {},\n    series: [{\n        name: 's1',\n        type: 'bar',\n        stack: '1',\n        data:[220, 182, 191, 234, 290, 330, 310],\n        label: {\n            show: false,\n            position: 'top',\n            color: '#333',\n            formatter: function(params){\n                params.value\n            }\n        }\n    },{\n        name: 's2',\n        type: 'bar',\n        stack: '1',\n        data:[220, 182, 191, 234, 290, 330, 310],\n        label: {\n            show: false,\n            position: 'top',\n            color: '#333',\n            formatter: function(params){\n                params.value\n            }\n        }\n    }]\n};\n\nvar series = option[\"series\"];\nvar fun = function (params) {\n    var datavalue = 0;\n    for (var i = 0; i < series.length; i++) {\n        datavalue += series[i].data[params.dataIndex]\n    }\n    return datavalue;\n}\n\nif (series[series.length - 1]) {\n    series[series.length - 1][\"label\"][\"show\"] = true;\n    series[series.length - 1][\"label\"][\"formatter\"] = fun;\n}\n\nmyChart.on(\"legendselectchanged\", function(obj){\n    var b = obj.selected,//图例的选中情况，key是图例的name，value是true或false\n        d=[];//选中的series的index列表\n    for(var key in b){\n        if(b[key]){//选中的图例\n            for(var i = 0; i < series.length; i++){\n                var changename = series[i][\"name\"];\n                if(changename == key){\n                    d.push(i);//选中的series的index列表\n                }\n            }\n        }\n    }\n    \n    var fn = function(params){\n        var datavalue = 0;\n        for(var i = 0; i < d.length; i++){\n            for(var j =0; j < series.length; j++){\n                if(d[i] == j){\n                    datavalue += series[j].data[params.dataIndex];\n                }\n            }\n        }\n        return datavalue;\n    }\n    \n    for(var i = 0; i < series.length; i++){\n        series[i][\"label\"][\"show\"] = false;\n    }\n    \n    var l_s = series[d[d.length-1]];//选中的series的最后一个\n    l_s[\"label\"][\"show\"] = true;//显示label\n    l_s[\"label\"][\"formatter\"] = fn;//绑定formatter\n    \n    myChart.setOption(option)\n})\n\n\n\n","html":"","externalScripts":"","updaterUID":"bd-1606641265","theme":"","layout":"","viewCount":822,"userName":"你***1","commentCount":0,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x-LqTZE4F.png?v=1574389971922","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","title"],"customTags":[],"updaterUserName":"你***1"}}