{"status":0,"data":{"cid":"xcLUF3K7vP","authorUid":"bd-4240785066","authorUserName":"小***丶","title":"航线图","description":"航线图echarts图","latestVersion":1,"alwaysLatest":0,"createTime":"2021-11-10T03:20:09.000Z","lastUpdateTime":"2021-11-10T03:20:09.000Z","auth":2,"uid":"bd-4240785066","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"5.2.2","versionCreateTime":"2021-11-10T03:20:09.000Z","code":"var geoJson = {};\ngetGeoJson(420000);\n\nfunction getGeoJson(adcode) {\n    AMapUI.loadUI(['geo/DistrictExplorer'], (DistrictExplorer) => {\n        var districtExplorer = new DistrictExplorer();\n        districtExplorer.loadAreaNode(adcode, function (error, areaNode) {\n            if (error) {\n                console.error(error);\n                return;\n            }\n            let Json = areaNode.getSubFeatures();\n            if (Json.length > 0) {\n                parentJson = Json;\n            } else if (Json.length === 0) {\n                Json = parentJson.filter((item) => {\n                    if (item.properties.adcode == adcode) {\n                        return item;\n                    }\n                });\n                if (Json.length === 0) return;\n            }\n            //去获取数据\n            geoJson = Json;\n            getMapData();\n        });\n    });\n}\n\nfunction getMapData() {\n    const data = geoJson;\n    const mapData = geoJson.map((item) => {\n        return {\n            name: item.properties.name,\n            value: [\n              item.properties.center[0],\n              item.properties.center[1],\n              parseFloat((Math.random(0.1, 1) * 1000).toFixed(2)),\n            ],\n            adcode: item.properties.adcode,\n            level: item.properties.level,\n        };\n    });\n    initEcharts(mapData);\n}\n\nfunction initEcharts(data) {\n    let mapJson = { features: geoJson };\n    echarts.registerMap('map', mapJson);\n    const mapData = data.sort((a, b) => {\n        return b.value[2] - a.value[2];\n    });\n\n    let toCity = mapData[0];\n    let lineData = mapData.slice(1).map((item) => {\n        return {\n            fromName: item.name,\n            toName: toCity.name,\n            coords: [\n                [item.value[0], item.value[1]],\n                [toCity.value[0], toCity.value[1]],\n            ],\n        };\n    });\n    \n    myChart.setOption({\n        backgroundColor:'#001a3a',\n        tooltip: {},\n\n        geo: {\n            map: 'map',\n            roam: true,\n            itemStyle: {\n                normal: {\n                    areaColor: '#17439a',\n                    borderColor: '#53D9FF',\n                    borderWidth: 1.3,\n                    shadowBlur: 15,\n                    shadowColor: 'rgb(58,115,192)',\n                    shadowOffsetX: 7,\n                    shadowOffsetY: 6,\n                },\n                emphasis: {\n                    areaColor: '#17439a',\n                },\n            },\n            label: {\n                normal: {\n                    show: true,\n                    color: '#fff',\n                },\n                emphasis: {\n                    show: true,\n                    color: '#fff',\n                },\n            },\n            zoom: 1,\n        },\n        series: [\n            {\n                name: '城市',\n                type: 'effectScatter',\n                data: mapData.slice(1),\n                coordinateSystem: 'geo',\n                symbolSize: 10,\n                label: {\n                    normal: {\n                        show: false,\n                    },\n                    emphasis: {\n                        show: false,\n                    },\n                },\n                showEffectOn: 'render',\n                rippleEffect: {\n                    brushType: 'stroke',\n                },\n                itemStyle: {\n                    normal: {\n                        color: 'rgb(29,233,182)',\n                        shadowBlur: 10,\n                        shadowColor: 'rgb(58,115,192)',\n                    },\n                },\n                layoutCenter: ['50%', '50%'],\n                layoutSize: 430,\n            },\n            {\n                name: 'No.1',\n                type: 'effectScatter',\n                data: mapData.slice(0, 1),\n                coordinateSystem: 'geo',\n                symbolSize: 25,\n                label: {\n                    normal: {\n                        show: false,\n                    },\n                    emphasis: {\n                        show: false,\n                    },\n                },\n                showEffectOn: 'render',\n                rippleEffect: {\n                    brushType: 'stroke',\n                },\n                itemStyle: {\n                    normal: {\n                        color: '#f4e925', //地图点的颜色\n                        shadowBlur: 10,\n                        shadowColor: 'rgb(58,115,192)',\n                    },\n                },\n                layoutCenter: ['50%', '50%'],\n                layoutSize: 430,\n            },\n            {\n                name: '航线',\n                type: 'lines',\n                tooltip: {\n                    formatter: (params) => {\n                        return params.marker + params.data.fromName + '-' + params.data.toName;\n                    },\n                },\n                zlevel: 2,\n                effect: {\n                    show: true,\n                    period: 5, //值越小 速度越快\n                    trailLength: 0, // 0-1  值越大，越拖\n                    symbol: 'arrow', //箭头图标\n                    symbolSize: 6, //图标大小\n                },\n                lineStyle: {\n                    normal: {\n                        color: '#f4e925',\n                        width: 1,\n                        opacity: 1,\n                        curveness: 0.3, //线值的程度  0为直线\n                    },\n                },\n                data: lineData,\n            },\n        ],\n    });\n}\n","html":"","externalScripts":"https://webapi.amap.com/maps?v=1.3&key=73cddabc2173e0166a622f4483d3592a&plugin=AMap.DistrictSearch,https://webapi.amap.com/maps?v=1.3&key=73cddabc2173e0166a622f4483d3592a,https://webapi.amap.com/ui/1.0/main.js","updaterUID":"bd-4240785066","theme":"","layout":"","viewCount":0,"userName":"小***丶","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xcLUF3K7vP.png?v=1636514410120","isCustomThumbnail":0,"builtinTags":["category-work","geo","series-effectScatter","series-lines","tooltip"],"customTags":[],"updaterUserName":"小***丶"}}