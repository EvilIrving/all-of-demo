{"status":0,"data":{"cid":"xSkqZYYGem","authorUid":"bd-3778831175","authorUserName":"m***i","title":"8W+  polygons  ","description":"8万+   房屋数据绘制测试","latestVersion":5,"alwaysLatest":1,"createTime":"2018-06-04T09:40:17.000Z","lastUpdateTime":"2018-06-04T09:40:17.000Z","auth":2,"uid":"bd-3778831175","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":5,"parentVersion":4,"echartsVersion":"4.2.0","versionCreateTime":"2019-01-09T11:05:09.000Z","code":"var urls = [\n    '/asset/get/s/data-1528099243844-ByEhZOMgX.json',\n    '/asset/get/s/data-1528099260361-S1Va-_MeQ.json',\n    '/asset/get/s/data-1528099274823-r1Q0bdfgm.json',\n    '/asset/get/s/data-1528099287938-Hkx1Guzlm.json',\n    '/asset/get/s/data-1528099301932-B1R1zOfxX.json',\n    '/asset/get/s/data-1528101820599-ByBpjdfl7.json',\n    '/asset/get/s/data-1528101944280-rJeBh_MxQ.json',\n    '/asset/get/s/data-1528101954050-ry9Sn_zl7.json',\n    '/asset/get/s/data-1528101964787-SySIhuMeX.json',\n    '/asset/get/s/data-1528101975345-rkkwn_Mxm.json',\n    '/asset/get/s/data-1528101988096-BJ2Pn_GeX.json',\n    '/asset/get/s/data-1528102643426-rkieyKGlX.json',\n    '/asset/get/s/data-1528102648674-SJ-W1YfeQ.json',\n    '/asset/get/s/data-1528102652152-r1N-kKfx7.json',\n    '/asset/get/s/data-1528102655390-BkPW1FzlQ.json',\n    '/asset/get/s/data-1528102658435-Hkq-ktfxm.json',\n    '/asset/get/s/data-1528102661925-B1RZJtfeX.json',\n    '/asset/get/s/data-1528102666161-HJfMyFflQ.json',\n    '/asset/get/s/data-1528102669885-H1Iz1FzgX.json',\n    '/asset/get/s/data-1528102673301-BkYG1Ffg7.json',\n    '/asset/get/s/data-1528102677514-Bk6G1KGg7.json',\n    '/asset/get/s/data-1528102810109-r1fsJFfgX.json',\n    '/asset/get/s/data-1528102818771-r1oikYMgQ.json',\n    '/asset/get/s/data-1528102825569-BkznkFMeX.json',\n    '/asset/get/s/data-1528102832030-HydhJFfx7.json',\n    '/asset/get/s/data-1528102837631-HkRhyKfg7.json',\n    '/asset/get/s/data-1528102843760-Hk46JKGxX.json',\n    '/asset/get/s/data-1528102850877-Sko6JFGg7.json',\n    '/asset/get/s/data-1528102858017-rkG01tzgX.json',\n    '/asset/get/s/data-1528102864954-S1K01FGl7.json',\n    '/asset/get/s/data-1528102868542-SyTCJYzxm.json',\n    '/asset/get/s/data-1528103054785-HJvclFGgQ.json',\n    '/asset/get/s/data-1528103063150-SkJigFMeQ.json',\n    '/asset/get/s/data-1528103068133-Sk4ieFfe7.json',\n    '/asset/get/s/data-1528103072887-rJKsxFGlm.json',\n    '/asset/get/s/data-1528103077348-S16jgKfxm.json',\n    '/asset/get/s/data-1528103083606-HyN3lKzxm.json',\n    '/asset/get/s/data-1528103091422-S1sneKMgX.json',\n    '/asset/get/s/data-1528103097901-ByzTxFflQ.json',\n    '/asset/get/s/data-1528103118931-HJwAgtMxm.json',\n\n    '/asset/get/s/data-1528103464104-S1lNMYfeX.json',\n    '/asset/get/s/data-1528103471074-rkDNGKGe7.json',\n    '/asset/get/s/data-1528103478006-SJCEfKzlQ.json',\n    '/asset/get/s/data-1528103483095-rymSGtGxm.json',\n    '/asset/get/s/data-1528103490427-Hy9BMtfeQ.json',\n    '/asset/get/s/data-1528103496827-HJZLMFzxm.json',\n    '/asset/get/s/data-1528103503893-rJ_UGFMeQ.json',\n    '/asset/get/s/data-1528103508857-SJ6LzKGg7.json',\n    '/asset/get/s/data-1528103517126-H1rPGYfx7.json',\n    '/asset/get/s/data-1528103527927-HkgOGtMlX.json',\n\n    '/asset/get/s/data-1528103707659-Hk47XFfxX.json',\n    '/asset/get/s/data-1528103710886-rJwmXYGxX.json',\n    '/asset/get/s/data-1528103715677-B13XmYGxm.json',\n    '/asset/get/s/data-1528103719545-r1l4QtMeQ.json',\n    '/asset/get/s/data-1528103722015-HJMEmKMxQ.json',\n    '/asset/get/s/data-1528103725852-HyIEQtGgQ.json',\n    '/asset/get/s/data-1528103730183-HkcEXKzl7.json',\n    '/asset/get/s/data-1528103733001-B1T4QYfgQ.json',\n    '/asset/get/s/data-1528103737427-Sk-BmtMlX.json',\n    '/asset/get/s/data-1528103741282-BkHBXtfeX.json',\n    '/asset/get/s/data-1528103745537-B15rXFGxm.json',\n    '/asset/get/s/data-1528103749852-SkASXKzlm.json',\n    '/asset/get/s/data-1528103753098-SkWU7tMgX.json',\n    '/asset/get/s/data-1528103756572-rJBUXtfgm.json',\n    '/asset/get/s/data-1528103760590-H1t8QKflX.json',\n    '/asset/get/s/data-1528103764750-rJp8QKze7.json',\n    '/asset/get/s/data-1528103768087-rylD7tGeX.json',\n    '/asset/get/s/data-1528103772478-Hk4DmYGlX.json',\n    '/asset/get/s/data-1528103777517-H1FvXtfgm.json',\n    '/asset/get/s/data-1528103783923-SkldQYGlX.json',\n    '/asset/get/s/data-1528103822566-S1v5mKzgm.json',\n    '/asset/get/s/data-1528103826987-SkjqQFMx7.json',\n    '/asset/get/s/data-1528103831216-BkkjmKGg7.json',\n    '/asset/get/s/data-1528103837049-BkBjmtGxm.json',\n    '/asset/get/s/data-1528103856949-SJY37FMlQ.json',\n    '/asset/get/s/data-1528103860006-r1nnmtzl7.json',\n    '/asset/get/s/data-1528103863181-rky6XKMg7.json',\n    '/asset/get/s/data-1528103868372-H1467YGx7.json',\n    '/asset/get/s/data-1528103873213-Hytp7tMgm.json',\n    '/asset/get/s/data-1528103876538-H1pTQFGx7.json',\n    '/asset/get/s/data-1528103882762-r1Q0XFGeX.json',\n    '/asset/get/s/data-1528104372138-Byn3HKGgQ.json',\n    '/asset/get/s/data-1528104362949-SkQ2HKfxX.json',\n    '/asset/get/s/data-1528104359151-SJ13Btzx7.json',\n    '/asset/get/s/data-1528104355551-S1hiStfeX.json',\n    '/asset/get/s/data-1528104351541-ByOjBFGeX.json',\n    '/asset/get/s/data-1528104348437-S1NjSFzem.json',\n    '/asset/get/s/data-1528104344786-S1-oHFzlm.json',\n    '/asset/get/s/data-1528104340595-rJa5SYGgm.json',\n    '/asset/get/s/data-1528104335442-ByDcHKMeQ.json',\n    '/asset/get/s/data-1528104329269-Syb5rKzgX.json',\n    '/asset/get/s/data-1528104325502-HyTKBFGlX.json',\n    '/asset/get/s/data-1528104321188-rkKtHYMxm.json',\n    '/asset/get/s/data-1528104493034-S1HVItGg7.json',\n    '/asset/get/s/data-1528104497859-SJq48Fzxm.json',\n    '/asset/get/s/data-1528104509697-SJUHItMeQ.json',\n    '/asset/get/s/data-1528104514467-SkcrIFfxX.json',\n    '/asset/get/s/data-1528104518161-SkAH8tMlX.json',\n    '/asset/get/s/data-1528104522845-HkmLLtzlm.json',\n    '/asset/get/s/data-1528104526809-r1v8IKGgm.json',\n    '/asset/get/s/data-1528104530741-SkjL8KzxQ.json',\n    '/asset/get/s/data-1528104786709-HkoLPKfxQ.json',\n    '/asset/get/s/data-1528104790885-ByJPPYMx7.json',\n    '/asset/get/s/data-1528104794516-ryzvDKGeQ.json',\n    '/asset/get/s/data-1528104797904-BkIvvFMlm.json',\n    '/asset/get/s/data-1528104801572-rJ5vvKfeQ.json',\n    '/asset/get/s/data-1528104805847-SyRwPKMeQ.json',\n    '/asset/get/s/data-1528104809437-r1WuvKzlX.json',\n    '/asset/get/s/data-1528104813204-SkBdDFzxQ.json',\n    '/asset/get/s/data-1528104745371-SkWNPFMl7.json',\n    '/asset/get/s/data-1528104729763-r1zXvFMxm.json',\n    '/asset/get/s/data-1528104725104-Hy6zvtMgX.json',\n    '/asset/get/s/data-1528104720471-HyuGDFfgm.json',\n    '/asset/get/s/data-1528104717608-SJLfvFfeX.json',\n    '/asset/get/s/data-1528104714719-SymGDtzlX.json',\n    '/asset/get/s/data-1528104710891-r1kMPKzgQ.json',\n    '/asset/get/s/data-1528175595366-Symx2c7eQ.json',\n    '/asset/get/s/data-1528175610930-HkmW2cQgQ.json',\n    '/asset/get/s/data-1528175614323-BkIW3cmxQ.json',\n    '/asset/get/s/data-1528175618963-SJoWhcml7.json',\n    '/asset/get/s/data-1528175623059-ryJzh9XlQ.json',\n    '/asset/get/s/data-1528175627850-rkEM2cXxQ.json',\n    '/asset/get/s/data-1528175632390-r1dGh9Qe7.json',\n    '/asset/get/s/data-1528175636929-HkTGhcXxm.json',\n    '/asset/get/s/data-1528175641739-rkMmnqXxQ.json',\n    '/asset/get/s/data-1528175647753-rkum29Xxm.json',\n    '/asset/get/s/data-1528175652003-Hy2XhcXxX.json',\n    '/asset/get/s/data-1528175656654-B1bV25Xx7.json',\n    '/asset/get/s/data-1528175661551-HJLN39XgX.json',\n]\n// var buildsData=[];\n\nvar len = urls.length;\nvar index = 0;\n\nfunction getJson(idx) {\n    var url = urls[idx];\n    $.getJSON(url, function(buildingsGeoJSON) {\n        var builds;\n        if (buildingsGeoJSON.features) {\n            buildingsGeoJSON = buildingsGeoJSON.features;\n            builds = buildingsGeoJSON.map(function(feature) {\n                feature.properties.name = feature.id;\n                return feature;\n\n            })\n        } else {\n            builds = buildingsGeoJSON.map(function(feature) {\n                return {\n                    \"type\": \"Feature\",\n                    \"properties\": {\n                        \"name\": Math.random().toString(),\n                        \"height\": feature.height || 100\n                    },\n                    \"geometry\": {\n                        \"type\": \"Polygon\",\n                        \"coordinates\": [feature.polygon]\n                    }\n                }\n            })\n        }\n        var regionsData = builds.map(function(feature) {\n            return {\n                name: feature.properties.name || feature.properties.id,\n                value: Math.random() * 1,\n                height: feature.properties.height || 20,\n                coords: feature.geometry.coordinates,\n                itemStyle: {\n                    color: '#0991A9',\n                    borderColor: 'red'\n                }\n            };\n        });\n        // buildsData=buildsData.concat(regionsData);\n        index++;\n        if (index < len) {\n            myChart.appendData({\n                seriesIndex: 0,\n                data: regionsData\n            });\n            getJson(index);\n        } else {\n            //initCharts(index);\n        }\n    })\n}\n\nfunction initCharts() {\n    myChart.hideLoading();\n    // console.log(buildsData.length)\n    myChart.setOption({\n        maptalks3D: {\n            center: [-73.95030490354111, 40.803038109236724],\n            zoom: 14,\n            pitch: 63.8,\n            bearing: -167.2,\n            urlTemplate: 'http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png',\n            postEffect: {\n                enable: true,\n                FXAA: {\n                    enable: true\n                }\n            },\n            light: {\n                main: {\n                    intensity: 1,\n                    shadow: false,\n                    shadowQuality: 'high'\n                },\n                ambient: {\n                    intensity: 0.\n                },\n                ambientCubemap: {\n                    texture: '/asset/get/s/data-1491838644249-ry33I7YTe.hdr',\n                    exposure: 1,\n                    diffuseIntensity: 0.5,\n                    specularIntensity: 2\n                }\n            }\n        },\n        series: [{\n            type: 'polygons3D',\n            coordinateSystem: 'maptalks3D',\n            // multiPolygon: true,\n            // map: 'buildings',\n            data: [], //buildsData,\n            shading: 'realistic',\n            instancing: true,\n            silent: true,\n            itemStyle: {\n                color: '#000000',\n                // borderColor: [0, 2, 10],\n                borderWidth: 1\n            },\n            realisticMaterial: {\n                metalness: 1,\n                roughness: 0.4\n            }\n\n        }]\n    });\n    window.addEventListener('resize', function() {\n        myChart.resize();\n    });\n\n}\ninitCharts();\n// myChart.showLoading();\ngetJson(0)","html":"","externalScripts":"https://deyihu.github.io/src/lib/echarts-gl.1.1.3.js?tdsourcetag=s_pctim_aiomsg,https://cdn.jsdelivr.net/npm/maptalks@0.40.1/dist/maptalks.min.js","updaterUID":"bd-3778831175","theme":"","layout":"","viewCount":1704,"userName":"m***i","commentCount":0,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xSkqZYYGem.png?v=1528105219407","isCustomThumbnail":1,"builtinTags":["category-work","maptalks3D","series-polygons3D"],"customTags":[],"updaterUserName":"m***i"}}