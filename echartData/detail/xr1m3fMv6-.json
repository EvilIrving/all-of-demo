{"status":0,"data":{"cid":"xr1m3fMv6-","authorUid":"bd-1916130272","authorUserName":"肆肆肆厮","title":"自定义toolbox修改series数据源","description":"","latestVersion":2,"alwaysLatest":1,"createTime":"2017-10-20T06:07:39.000Z","lastUpdateTime":"2017-10-20T06:07:39.000Z","auth":1,"uid":"bd-1916130272","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"3.7.2","versionCreateTime":"2017-10-20T09:56:23.000Z","code":"var isper=false;\r\nvar vdata=[[50,3,5,9,1],\r\n[9414,8109,5256,3587,67],\r\n[6159,6917,7361,8568,1356],\r\n[86,166,218,373,91],\r\n[2500,2924,3257,3936,605],\r\n[502496,521182,500378,531974,79274],\r\n[56018,61429,60980,58393,935],\r\n[1553,2005,2437,3018,548],\r\n[5578,6323,5945,5626,7535],\r\n[855213,912528,887463,878340,100220],\r\n[0,0,0,35,5],\r\n];\r\nvar xdata=['2013','2014','2015','2016','2017'];\r\nvar ydata=['','低五保','佛山居民医保','佛山生育保险','佛山职工医保','南海医保','南海特殊病种','广州医保','特定门诊','自费医疗','佛山工伤医保'];\r\nvar series=[];\r\n\r\n\r\n$.each(vdata,function(index,val){\r\n\r\n    var series_option={\r\n    name:ydata[index],\r\n    type:'bar',\r\n    itemStyle:{normal:{color:''}} ,\r\n    label: {normal: {show: true,position: 'top'}},\r\n    barWidth:'',\r\n    data:val\r\n};\r\n\r\n    series.push(series_option);\r\n})\r\n\r\n\r\noption = {\r\n           title:{text:'医保/非医保人次',right:'center'},\r\n         toolbox: {\r\n             feature: {\r\n                 myTool1: {\r\n                show: true,\r\n                title: '数值、百分比切换',\r\n                icon: 'path://M269.794 400.05c0-61.832 43.333-111.95 96.844-111.95s96.78 50.054 96.78 111.95-43.333 111.886-96.78 111.886-96.844-50.054-96.844-111.886z m145.234 0c0-34.372-21.635-62.216-48.39-62.216-26.692 0-48.39 27.844-48.39 62.216 0 34.308 21.698 62.152 48.39 62.152 26.755 0 48.39-27.844 48.39-62.152z m338.858 198.937c0 61.832-43.333 111.95-96.78 111.95-53.51 0-96.908-50.118-96.908-111.95S603.659 487.1 657.17 487.1c53.447 0 96.716 50.118 96.716 111.886z m-145.17 0c0 34.372 21.699 62.216 48.454 62.216s48.39-27.844 48.39-62.216c0-34.308-21.635-62.216-48.39-62.216s-48.454 27.908-48.454 62.216zM369.838 714.969l242.078-430.901 41.926 24.899-242.079 430.837-41.925-24.835zM512 1024c-122.831 0-235.165-43.717-323.304-115.918-15.106-15.042-27.46-32.068-12.738-48.07 24.003-26.18 51.654 6.848 51.654 6.848 77.962 62.6 176.727 100.173 284.452 100.173 251.423 0 455.097-203.802 455.097-455.097 0-251.36-203.738-455.097-455.097-455.097-251.36 0-455.097 203.738-455.097 455.097 0 83.018 22.595 160.596 61.384 227.548 0 0 5.76 21.7-14.338 29.828-28.996 11.714-50.054-29.828-50.054-29.828C19.714 670.932 0 593.866 0 512 0 229.213 229.277 0 512 0c282.787 0 512 229.213 512 512s-229.213 512-512 512z',\r\n                onclick: function (obj,e){\r\n                    debugger\r\n                    if(!isper){\r\n                    var newsdata=[];\r\n                    var newvdata=jQuery.extend(true,[], vdata);\r\n                    var sumdata=jQuery.extend(true,[], vdata);\r\n                    var array_sum=sumdata.reduce(function(a,b){\r\n                                        $.each(a,function(i,v){\r\n                                            a[i]+=b[i];\r\n                                        })\r\n                                        return a;\r\n                                    })\r\n                    $.each(newvdata,function(index,val){\r\n\r\n                        var perdata=[];\r\n                        newvdata[index].forEach(function(e,i){newvdata[index][i]=Math.round(e*10000/array_sum[i])/100})\r\n                        newsdata.push({data:newvdata[index]});\r\n                    });\r\n                    //echarts.getInstanceByDom(e.getDom()) = 实例\r\n                    //由于每个实例的实例名不确定，所有用dom获取实例\r\n\r\n                    echarts.getInstanceByDom(e.getDom()).setOption({\r\n                        series: newsdata\r\n                    })\r\n                        isper=!isper;\r\n                    }else{\r\n                        echarts.getInstanceByDom(e.getDom()).setOption({\r\n                            series: series\r\n                        })\r\n                        isper=!isper;\r\n                    }\r\n                }\r\n            },\r\n                 dataView: { show: true, readOnly: false },\r\n                 saveAsImage: { show: true,backgroundColor:'#ffffff' },\r\n             magicType: {\r\n                 type: ['stack', 'tiled']\r\n             },\r\n             restore:{}\r\n             }\r\n         },\r\n         legend: {\r\n             data: ydata ,type:'scroll',top:'8%'\r\n         },\r\n         tooltip: {\r\n             trigger: 'axis',\r\n             axisPointer: {         \r\n                 type: 'shadow'     \r\n             }\r\n         },\r\ngrid: {\r\n     top:'20%',\r\n    left: '5%',\r\n    right: '4%',\r\n    bottom: '12%',\r\n    containLabel: true\r\n },\r\n         xAxis: [\r\n             {\r\n                 type: 'category',axisLine:{lineStyle:{color:'#000'}},\r\n                 data: xdata,axisLabel: {interval: 0,rotate: 50,textStyle:{color:'#000'}}\r\n             }\r\n         ],\r\n         yAxis: [\r\n             {\r\n                 name:'',\r\n                 type: 'value',axisLine:{lineStyle:{color:'#000'}},\r\n                 axisLabel: {textStyle:{color:'#000'},\r\n                     formatter:function(value){if(value>=100000000){return value/100000000+' 亿'} else if(value>=1000000){return value/10000+' 万'} else {return value+''}},\r\n                 }\r\n             }\r\n         ],\r\n     dataZoom: [{\r\n         show: true,\r\n         height: 30,\r\n         bottom: 10,\r\n         start: 0,\r\n         end: 100,\r\n         handleSize: '110%',\r\n     }, {type: 'inside'}],\r\n         series: series\r\n     };\r\n","html":"","externalScripts":"/dep/echarts/map/js/china.js","updaterUID":"bd-1916130272","theme":"","layout":"","viewCount":293,"userName":"肆肆肆厮","commentCount":0,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xr1m3fMv6-.png?v=1508493383906","isCustomThumbnail":0,"builtinTags":["category-work","dataZoom","grid","legend","series-bar","title","toolbox","tooltip"],"customTags":[],"updaterUserName":"肆肆肆厮"}}