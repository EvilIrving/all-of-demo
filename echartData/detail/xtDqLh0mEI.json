{"status":0,"data":{"cid":"xtDqLh0mEI","authorUid":"bd-3071323166","authorUserName":"w***1","title":"bar 分割线","description":"","latestVersion":2,"alwaysLatest":1,"createTime":"2021-01-06T07:49:26.000Z","lastUpdateTime":"2021-01-06T07:49:26.000Z","auth":1,"uid":"bd-3071323166","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.8.0","versionCreateTime":"2021-01-06T08:24:43.000Z","code":"const mainCategoryMap = {\n    \"湿巾\": [{\n        \"sceneName\": \"基准场景\",\n        \"mainCategory\": \"湿巾\",\n        \"detailCategory\": \"便携装\",\n        \"totalValue\": 86.5,\n        \"totalCount\": 173,\n        \"totalWeight\": 17.3,\n        \"totalSquare\": 17.3\n    }, {\n        \"sceneName\": \"基准场景\",\n        \"mainCategory\": \"湿巾\",\n        \"detailCategory\": \"标准装\",\n        \"totalValue\": 388,\n        \"totalCount\": 388,\n        \"totalWeight\": 194,\n        \"totalSquare\": 194\n    }],\n    \"纸品\": [{\n        \"sceneName\": \"基准场景\",\n        \"mainCategory\": \"纸品\",\n        \"detailCategory\": \"厨房纸\",\n        \"totalValue\": 1601,\n        \"totalCount\": 370,\n        \"totalWeight\": 740,\n        \"totalSquare\": 1110\n    }, {\n        \"sceneName\": \"基准场景\",\n        \"mainCategory\": \"纸品\",\n        \"detailCategory\": \"抽纸\",\n        \"totalValue\": 1788,\n        \"totalCount\": 661,\n        \"totalWeight\": 1089,\n        \"totalSquare\": 1127\n    }],\n    \"笔\": [{\n        \"sceneName\": \"基准场景\",\n        \"mainCategory\": \"笔\",\n        \"detailCategory\": \"铅笔\",\n        \"totalValue\": 1601,\n        \"totalCount\": 370,\n        \"totalWeight\": 740,\n        \"totalSquare\": 1110\n    }, {\n        \"sceneName\": \"基准场景\",\n        \"mainCategory\": \"笔\",\n        \"detailCategory\": \"钢笔\",\n        \"totalValue\": 1788,\n        \"totalCount\": 661,\n        \"totalWeight\": 1089,\n        \"totalSquare\": 1127\n    }]\n}\n\nlet skuCount = 0\nlet productList = []\nfor (let key in mainCategoryMap) {\n    const dcArr = mainCategoryMap[key]\n    skuCount += dcArr.length\n    productList = productList.concat(dcArr)\n}\n\nlet series = []\nconst markLines = [\n    [{\n            symbol: 'none',\n            x: 0,\n            y: '0',\n            // coord: [0, '0'],\n        },\n        {\n            symbol: 'none',\n            x: '100%',\n            y: '0',\n            // coord: ['100%', '0'],\n        }\n    ],\n    [{\n            symbol: 'none',\n            x: 0,\n            y: '33.33%',\n            // coord: [0, '0'],\n        },\n        {\n            symbol: 'none',\n            x: '100%',\n            y: '33.33%',\n            // coord: ['100%', '0'],\n        }\n    ],\n    [{\n            symbol: 'none',\n            x: 0,\n            y: '66.66%',\n            // coord: [0, '0'],\n        },\n        {\n            symbol: 'none',\n            x: '100%',\n            y: '66.66%',\n            // coord: ['100%', '0'],\n        }\n    ],\n    [{\n            symbol: 'none',\n            x: 0,\n            y: '99%',\n            // coord: [0, '0'],\n        },\n        {\n            symbol: 'none',\n            x: '100%',\n            y: '99%',\n            // coord: ['100%', '0'],\n        }\n    ]\n]\nlet beUsed = 0\n\nfor (let key in mainCategoryMap) {\n    const num = mainCategoryMap[key].length\n    series.push({\n        name: '产品大类',\n        z: 0,\n        data: [{\n            name: key,\n            value: 1\n        }],\n        label: {\n            offset: [0, 0],\n            show: true,\n            position: 'insideLeft',\n            formatter: ({\n                name\n            }) => name.split('').join('\\n\\n'),\n            textStyle: {\n                fontSize: 14,\n                color: '#000',\n                fontWeight: 'bold',\n            }\n        },\n        type: 'bar',\n        barGap: 0,\n        barWidth: `${(num)/skuCount*100}%`,\n        itemStyle: {\n            normal: {\n                // color: (params) => {\n                //   console.log(params)\n                //   let colors = ['#4150d8', '#28bf7e', '#ed7c2f', '#f2a93b', '#f9cf36', '#4a5bdc', '#4cd698', '#f4914e', '#fcb75b', '#ffe180', '#b6c2ff', '#96edc1']\n                //   return colors[params.dataIndex]\n                // },\n                // opacity: 0.1,\n                color: 'rgba(0, 0, 0, 0)',\n                // borderColor: 'rgba(0, 0, 0, 0.2)',\n                // borderType: 'dashed',\n                // borderWidth: 1,\n            }\n        },\n        xAxisIndex: 1,\n        yAxisIndex: 1,\n    })\n\n\n}\n\nconst productNameList = productList.map(item => item.detailCategory)\nconst totalCountList = productList.map(item => item.totalCount)\nconst totalSquareList = productList.map(item => item.totalSquare)\nconst totalWeightList = productList.map(item => item.totalWeight)\nconst totalValueList = productList.map(item => item.totalValue)\n\noption = {\n    // title: {\n    //   text: productList[0].sceneName,\n    // },\n    // toolbox: {\n    //   feature: {\n    //     saveAsImage: {},\n    //     restore: {},\n    //   }\n    // },\n    tooltip: {\n        trigger: 'axis',\n        axisPointer: {\n            type: 'shadow'\n        },\n    },\n    axisPointer: {\n        link: {\n            xAxisIndex: 'all'\n        }\n    },\n    legend: {\n        data: ['总需求数量', '总需求体积', '总需求重量', '总价值'],\n        selectedMode: 'single',\n        top: 30,\n    },\n    grid: [{\n            top: 100,\n            bottom: 100,\n            right: 100,\n            left: 200,\n        },\n        {\n            top: 100,\n            bottom: 100,\n            right: 100,\n            left: 100,\n        },\n    ],\n    xAxis: [{\n            type: 'value',\n            gridIndex: 0,\n            minInterval: 1,\n            axisLabel: {\n                color: '#333',\n                // show: false,\n            },\n            splitLine: {\n                // show: false,\n            },\n            axisLine: {\n                lineStyle: {\n                    color: '#ccc'\n                }\n            },\n            axisTick: {\n                lineStyle: {\n                    color: '#ccc'\n                },\n                // show: false,\n            },\n            z: 1,\n        },\n        {\n            type: 'value',\n            gridIndex: 1,\n            axisLabel: {\n                show: false\n            },\n            axisLine: {\n                show: false\n            },\n            splitLine: {\n                show: false\n            },\n            axisTick: {\n                show: false\n            },\n            z: 0,\n        },\n    ],\n    yAxis: [{\n            type: 'category',\n            data: productNameList,\n            gridIndex: 0,\n            axisLabel: {\n                color: '#333',\n                margin: 4,\n            },\n            // axisLine: {\n            //   lineStyle: {\n            //     color: '#e7e7e7'\n            //   }\n            // },\n            axisTick: {\n                show: false,\n            },\n            z: 2,\n        },\n        {\n            type: 'category',\n            // data: [],\n            gridIndex: 1,\n            axisLine: {\n                show: false\n            },\n            axisTick: {\n                show: true,\n            },\n            z: 1,\n        },\n    ],\n    series: [{\n            z: 1,\n            name: '总需求数量',\n            data: totalCountList,\n            type: 'bar',\n            stack: 'total',\n            label: {\n                show: true,\n                position: 'insideLeft',\n                textStyle: {\n                    color: '#555'\n                }\n            },\n            itemStyle: {\n                normal: {\n                    color: '#5B9BD5',\n                }\n            },\n            xAxisIndex: 0,\n            yAxisIndex: 0,\n            // barWidth: '100%',\n            markLine: {\n                silent: true,\n                lineStyle: {\n                    type: 'solid',\n                    color: 'red',\n                },\n                data: markLines\n            },\n        },\n        {\n            z: 1,\n            name: '总需求体积',\n            data: totalSquareList,\n            type: 'bar',\n            stack: 'total',\n            label: {\n                show: true,\n                position: 'insideLeft',\n                textStyle: {\n                    color: '#555'\n                }\n            },\n            itemStyle: {\n                normal: {\n                    color: '#5B9BD5',\n                }\n            },\n            xAxisIndex: 0,\n            yAxisIndex: 0,\n            // barWidth: '100%',\n            markLine: {\n              silent: true,\n              lineStyle: {\n                type: 'solid',\n                color: 'red',\n              },\n              data: markLines\n            },\n        },\n        {\n            z: 1,\n            name: '总需求重量',\n            data: totalWeightList,\n            type: 'bar',\n            stack: 'total',\n            label: {\n                show: true,\n                position: 'insideLeft',\n                textStyle: {\n                    color: '#555'\n                }\n            },\n            itemStyle: {\n                normal: {\n                    color: '#5B9BD5',\n                }\n            },\n            xAxisIndex: 0,\n            yAxisIndex: 0,\n            // barWidth: '100%',\n            markLine: {\n              silent: true,\n              lineStyle: {\n                type: 'solid',\n                color: 'red',\n              },\n              data: markLines\n            },\n        },\n        {\n            z: 1,\n            name: '总价值',\n            data: totalValueList,\n            type: 'bar',\n            stack: 'total',\n            label: {\n                show: true,\n                position: 'insideLeft',\n                textStyle: {\n                    color: '#555'\n                }\n            },\n            itemStyle: {\n                normal: {\n                    color: '#5B9BD5',\n                }\n            },\n            xAxisIndex: 0,\n            yAxisIndex: 0,\n            // barWidth: '100%',\n            markLine: {\n              silent: true,\n              lineStyle: {\n                type: 'solid',\n                color: 'red',\n              },\n              data: markLines\n            },\n        },\n        ...series,\n    ]\n};","html":"","externalScripts":"","updaterUID":"bd-3071323166","theme":"","layout":"","viewCount":93,"userName":"w***1","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xtDqLh0mEI.png?v=1609921484012","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","markLine","series-bar","tooltip"],"customTags":[],"updaterUserName":"w***1"}}