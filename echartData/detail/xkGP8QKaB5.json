{"status":0,"data":{"cid":"xkGP8QKaB5","authorUid":"obd-oPqKoiqdMbnNlWB7uDUQZpFTsYcOK9w","authorUserName":"优***n","title":"这是真的阿饼","description":"","latestVersion":11,"alwaysLatest":1,"createTime":"2020-04-14T12:59:20.000Z","lastUpdateTime":"2020-04-14T12:59:20.000Z","auth":2,"uid":"obd-oPqKoiqdMbnNlWB7uDUQZpFTsYcOK9w","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":11,"parentVersion":10,"echartsVersion":"4.7.0","versionCreateTime":"2020-04-17T01:28:20.000Z","code":"var data = [{\r\n        value: 10,\r\n        name: 'IDS',\r\n        label: {\r\n            color: '#fff'\r\n        },\r\n        itemStyle: {\r\n\r\n        },\r\n        emphasis: {\r\n            itemStyle: {\r\n\r\n            }\r\n        }\r\n    },\r\n    {\r\n        value: 5,\r\n        name: 'VPN',\r\n        label: {\r\n            color: '#fff'\r\n        },\r\n        itemStyle: {\r\n\r\n        },\r\n        emphasis: {\r\n            itemStyle: {\r\n\r\n            }\r\n        }\r\n    },\r\n    {\r\n        value: 15,\r\n        name: '交换机',\r\n        label: {\r\n            color: '#fff'\r\n        },\r\n        itemStyle: {\r\n\r\n        },\r\n        emphasis: {\r\n            itemStyle: {\r\n\r\n            }\r\n        }\r\n    },\r\n    {\r\n        value: 25,\r\n        name: '防火墙',\r\n        label: {\r\n            color: '#fff'\r\n        },\r\n        itemStyle: {\r\n\r\n        },\r\n        emphasis: {\r\n            itemStyle: {\r\n\r\n            }\r\n        }\r\n    },\r\n    {\r\n        value: 20,\r\n        name: 'WAF',\r\n        label: {\r\n            color: '#fff'\r\n        },\r\n        itemStyle: {\r\n\r\n        },\r\n        emphasis: {\r\n            itemStyle: {\r\n\r\n            }\r\n        }\r\n    },\r\n    {\r\n        value: 35,\r\n        name: '堡垒机',\r\n        label: {\r\n            color: '#fff'\r\n        },\r\n        itemStyle: {\r\n\r\n        },\r\n        emphasis: {\r\n            itemStyle: {\r\n\r\n            }\r\n        }\r\n    }\r\n]\r\n\r\nfunction angleText(i, num) {\r\n    //每个元素的角度\r\n    var everyAngle = 360 / num;\r\n    //文字现在所在的角度\r\n    var currentAngle = i * everyAngle + everyAngle / 2\r\n    //文字所在模块的所占角度\r\n    var currentArea = (i + 1) * everyAngle\r\n    console.log(currentAngle)\r\n    if (currentAngle <= 90) {\r\n        //console.log('here'+currentAngle)\r\n        return -currentAngle\r\n    } else if (currentAngle <= 180 && currentAngle > 90) {\r\n        //console.log('here'+currentAngle)\r\n        return 180 - currentAngle\r\n    } else if (currentAngle < 270 && currentAngle > 180) {\r\n        // console.log('here'+currentAngle)\r\n        return 180 - currentAngle\r\n    } else if (currentAngle < 360 && currentAngle >= 270) {\r\n        //console.log('here'+currentAngle)\r\n        return 360 - currentAngle\r\n    }\r\n}\r\n\r\n//有值的色图的正切处理\r\nvar data3 = []\r\ndata3 = JSON.parse(JSON.stringify(data))\r\nfor (var i = 0; i < data3.length; i++) {\r\n    if (i === 0) {\r\n        data3[i]['label']['color'] = '#333'\r\n        data3[i]['itemStyle']['color'] = 'rgba(25, 255, 224)'\r\n        data3[i]['emphasis']['itemStyle']['color'] = 'rgba(25, 255, 224)'\r\n        data3[i]['label']['rotate'] = angleText(i, data3.length)\r\n    } else {\r\n        data3[i]['label']['color'] = '#fff'\r\n        data3[i]['itemStyle']['color'] = '#4169E1'\r\n        data3[i]['emphasis']['itemStyle']['color'] = '#6A5ACD'\r\n        data3[i]['label']['rotate'] = angleText(i, data3.length)\r\n    }\r\n}\r\n\r\n\r\n//最外层大圈的数据\r\nvar data1 = []\r\n\r\ndata1 = JSON.parse(JSON.stringify(data))\r\nfor (var i = 0; i < data1.length; i++) {\r\n    data1[i].value = 1\r\n    data1[i]['label']['rotate'] = angleText(i, data1.length)\r\n    if (i === 0) {\r\n        data1[i]['label']['color'] = 'rgba(25, 255, 224)'\r\n    }\r\n}\r\n\r\n//透明饼图的数据\r\nvar data2 = []\r\n\r\nfor (var i = 0; i < data.length; i++) {\r\n    if (i === 0) {\r\n        data2.push({\r\n            value: 1,\r\n            itemStyle: {\r\n                color: 'rgba(25, 255, 224,0.05)',\r\n            }\r\n        })\r\n    } else {\r\n        data2.push({\r\n            value: 1,\r\n            itemStyle: {\r\n                color: 'transparent',\r\n            }\r\n        })\r\n    }\r\n}\r\nvar option = {\r\n    backgroundColor: \"#0B1837\",\r\n    grid: {\r\n        // left: -100,\r\n        // top: 50,\r\n        // bottom: 10,\r\n        // right: 10,\r\n        // containLabel: true\r\n    },\r\n    polar: {},\r\n    angleAxis: {\r\n        interval: 1,\r\n        type: 'category',\r\n        data: [],\r\n\r\n    },\r\n    //中间画圈圈的坐标轴\r\n    radiusAxis: {\r\n        show: false\r\n    },\r\n    series: [{\r\n        type: 'pie',\r\n        radius: [\"80%\", \"90%\"],\r\n        hoverAnimation: false,\r\n        itemStyle: {\r\n            color: 'transparent'\r\n        },\r\n        labelLine: {\r\n            normal: {\r\n                show: false,\r\n                length: 30,\r\n                length2: 55\r\n            },\r\n        },\r\n        label: {\r\n            normal: {\r\n                position: 'inside',\r\n                align: 'right'\r\n            }\r\n        },\r\n        name: \"\",\r\n        data: data1\r\n    }, {\r\n        stack: 'a',\r\n        type: 'pie',\r\n        radius: ['80%', '60%'],\r\n        roseType: 'area',\r\n        zlevel: 10,\r\n        itemStyle: {\r\n            color: '#4169E1',\r\n        },\r\n        emphasis: {\r\n            itemStyle: {\r\n                color: '#6A5ACD'\r\n            }\r\n        },\r\n        label: {\r\n            normal: {\r\n                show: true,\r\n                formatter: \"{c}\",\r\n                textStyle: {\r\n                    fontSize: 12,\r\n                    color: '#fff'\r\n                },\r\n                position: 'inside',\r\n                rotate: 30,\r\n                align: 'right'\r\n\r\n            },\r\n            emphasis: {\r\n                show: true\r\n            }\r\n        },\r\n        animation: false,\r\n        data: data3\r\n    }, {\r\n        type: 'pie',\r\n        zlevel: 99,\r\n        radius: [\"20%\", \"90%\"],\r\n        selectedOffset: 0,\r\n        animation: false,\r\n        hoverAnimation: false,\r\n        label: {\r\n            normal: {\r\n                show: false,\r\n            }\r\n        },\r\n        data: data2\r\n    }]\r\n}\r\n\r\nmyChart.on('click', function(a) {\r\n    //最外层的字体颜色重置变色\r\n    for (var da1 = 0; da1 < option.series[0].data.length; da1++) {\r\n        option.series[0].data[da1].label.color = '#fff'\r\n    }\r\n\r\n    //色圈的字体颜色和选中颜色重置\r\n    for (var da2 = 0; da2 < option.series[1].data.length; da2++) {\r\n        option.series[1].data[da2].itemStyle.color = '#4169E1'\r\n        option.series[1].data[da2].label.color = '#fff'\r\n        //hover颜色重置\r\n        option.series[1].data[da2].emphasis.itemStyle.color = '#6A5ACD'\r\n\r\n    }\r\n\r\n    //背景的透明饼图的重置\r\n    for (var da3 = 0; da3 < option.series[2].data.length; da3++) {\r\n        option.series[2].data[da3].itemStyle.color = 'transparent'\r\n    }\r\n\r\n    option.series[1].data[a.dataIndex].itemStyle.color = 'rgba(25, 255, 224)'\r\n    option.series[1].data[a.dataIndex].label.color = '#333'\r\n    //hover 颜色改变\r\n    option.series[1].data[a.dataIndex].emphasis.itemStyle.color = 'rgba(25, 255, 224)'\r\n    option.series[0].data[a.dataIndex].label.color = 'rgba(25, 255, 224)'\r\n    option.series[2].data[a.dataIndex].itemStyle.color = 'rgba(25, 255, 224,0.05)'\r\n    //console.log(option)\r\n    myChart.setOption(option);\r\n})\r\n\r\nmyChart.on('mouseover', function(a) {\r\n    myChart.dispatchAction({\r\n        type: 'highlight',\r\n        seriesIndex: 1,\r\n        dataIndex: a.dataIndex\r\n    })\r\n})\r\n\r\nmyChart.on('mouseout', function(a) {\r\n    myChart.dispatchAction({\r\n        type: 'downplay',\r\n        seriesIndex: 1,\r\n        dataIndex: a.dataIndex\r\n    })\r\n})","html":"","externalScripts":"","updaterUID":"obd-oPqKoiqdMbnNlWB7uDUQZpFTsYcOK9w","theme":"","layout":"","viewCount":289,"userName":"优***n","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xkGP8QKaB5.png?v=1587086900261","isCustomThumbnail":0,"builtinTags":["category-work","polar","series-pie"],"customTags":[],"updaterUserName":"优***n"}}