{"status":0,"data":{"cid":"xj3UrbJoKd","authorUid":"obd-oM988GWCz1Es751MOXxrh3YQGFrx224","authorUserName":"余***你","title":"关系图、拓扑图","description":"使用关系图画拓扑图","latestVersion":1,"alwaysLatest":1,"createTime":"2021-01-05T10:05:10.000Z","lastUpdateTime":"2021-01-05T10:05:10.000Z","auth":2,"uid":"obd-oM988GWCz1Es751MOXxrh3YQGFrx224","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2021-01-05T10:05:10.000Z","code":"var data = {\n    \"children\": [{\n        \"children\": [{\n            \"ifend\": \"1\",\n            \"name\": \"节点二1\",\n            \"number\": \".18\"\n        }],\n        \"name\": \"节点一1\",\n        \"number\": \"0\"\n    }, {\n        \"ifend\": \"1\",\n        \"name\": \"节点一2\",\n        \"number\": \".87\"\n    }, {\n        \"ifend\": \"1\",\n        \"name\": \"节点一3\",\n        \"number\": \".92\"\n    }, {\n        \"ifend\": \"1\",\n        \"name\": \"节点一4\",\n        \"number\": \"1.68\"\n    }, {\n        \"children\": [{\n            \"code\": \"2\",\n            \"ifend\": \"1\",\n            \"name\": \"节点二10\",\n            \"number\": \"10.01\"\n        }, {\n            \"ifend\": \"1\",\n            \"name\": \"节点二11\",\n            \"number\": \"0.31\"\n        }, {\n            \"code\": \"2\",\n            \"ifend\": \"1\",\n            \"name\": \"节点二12\",\n            \"number\": \"-.92\"\n        }, {\n            \"code\": \"2\",\n            \"name\": \"节点二2\",\n            \"number\": \"100\"\n        }, {\n            \"ifend\": \"1\",\n            \"name\": \"节点二3\",\n            \"number\": \".05\"\n        }, {\n            \"ifend\": \"1\",\n            \"name\": \"节点二4\",\n            \"number\": \"1.53\"\n        }, {\n            \"ifend\": \"1\",\n            \"name\": \"节点二5\",\n            \"number\": \"1.14\"\n        }, {\n            \"ifend\": \"1\",\n            \"name\": \"节点二6\",\n            \"number\": \"1.98\"\n        }, {\n            \"ifend\": \"1\",\n            \"name\": \"节点二7\",\n            \"number\": \".02\"\n        }, {\n            \"ifend\": \"1\",\n            \"name\": \"节点二8\",\n            \"number\": \"1.03\"\n        }, {\n            \"ifend\": \"1\",\n            \"name\": \"节点二9\",\n            \"number\": \"3.05\"\n        }],\n        \"name\": \"节点一5\",\n        \"number\": \".16\"\n    }, {\n        \"ifend\": \"1\",\n        \"name\": \"节点一6\",\n        \"number\": \"2.33\"\n    }],\n    \"name\": \"节点\",\n    \"number\": \".46\"\n};\n\nfunction format(data) {\n    data.x = 0;\n    data.y = 0;\n    if (!data.hasOwnProperty(\"children\")) {\n        data.len = [1, -1];\n        data.leny = [1, 9];\n        return data;\n    }\n    var l2 = data.children;\n    var hi = parseInt(l2.length / 2);\n    var xi = l2.length - hi;\n    var his = getSum(l2, 0, hi);\n    var xis = getSum(l2, xi - 1, l2.length);\n    l2 = sortData(l2, hi, xi);\n    data.children = l2;\n    var jhi = (hi > 9 || his === 0) ? 300 : 200;\n    var jxi = (xi > 9 || xis === 0) ? 300 : 200;\n    var maxmin = [-100000, 100000];\n    var maxminy = [-100000, 100000];\n    for (var i = 0; i < l2.length; i++) {\n        if (i < hi) {\n            l2[i].x = getLoction(hi, data.x, i + 1);\n            l2[i].y = data.y + jhi;\n            l2[i].fx = getFX(hi, i, false);\n        } else {\n            l2[i].x = getLoction(xi, data.x, i - hi + 1);\n            l2[i].y = data.y - jxi;\n            l2[i].fx = getFX(xi, i - hi, true);\n        }\n        getMaxMin(maxmin, l2[i].x);\n        getMaxMin(maxminy, l2[i].y);\n        if (!l2[i].hasOwnProperty(\"children\")) {\n            continue;\n        }\n        var l3 = l2[i].children;\n        for (var j = 0; j < l3.length; j++) {\n            if (i < hi) {\n                l3[j].x = getLoction(l3.length, l2[i].x, j + 1);\n                l3[j].y = l2[i].y + 200;\n                l3[j].fx = getFX(l3.length, j, false);\n            } else {\n                l3[j].x = getLoction(l3.length, l2[i].x, j + 1);\n                l3[j].y = l2[i].y - 200;\n                l3[j].fx = getFX(l3.length, j, true);\n            }\n            getMaxMin(maxmin, l3[j].x);\n            getMaxMin(maxminy, l3[j].y);\n        }\n    }\n    var c;\n    if (hi % 2 === 0) {\n        c = hi / 2;\n        if (l2[c].hasOwnProperty(\"children\")) {\n            if (l2[c - 1].hasOwnProperty(\"children\") &&\n                l2[c].children[0].x < l2[c].x - 50) {\n                var tem = 50 - l2[c].children[0].x;\n                for (var j = 0; j < l2[c].children.length; j++) {\n                    l2[c].children[j].x = l2[c].children[j].x + tem;\n                    getMaxMin(maxmin, l2[c].children[j].x);\n                }\n                l2[c].x = getLoction2(l2[c].children);\n            }\n        }\n    } else {\n        c = parseInt(hi / 2);\n    }\n    for (var i = c + 1; i < hi; i++) {\n        if (l2[i].hasOwnProperty(\"children\")) {\n            if (l2[i - 1].hasOwnProperty(\"children\") &&\n                l2[i - 1].children[l2[i - 1].children.length - 1].x - l2[i].children[0].x > -100) {\n                var tem = l2[i - 1].children[l2[i - 1].children.length - 1].x + 100 - l2[i].children[0].x;\n                for (var j = 0; j < l2[i].children.length; j++) {\n                    l2[i].children[j].x = l2[i].children[j].x + tem;\n                    getMaxMin(maxmin, l2[i].children[j].x);\n                }\n                l2[i].x = getLoction2(l2[i].children);\n            }\n        }\n    }\n    for (var i = c - 1; i >= 0; i--) {\n        if (l2[i].hasOwnProperty(\"children\")) {\n            if (l2[i + 1].hasOwnProperty(\"children\") &&\n                l2[i + 1].children[0].x - l2[i].children[l2[i].children.length - 1].x < 100) {\n                var tem = l2[i].children[l2[i].children.length - 1].x - (l2[i + 1].children[0].x - 100);\n                for (var j = 0; j < l2[i].children.length; j++) {\n                    l2[i].children[j].x = l2[i].children[j].x - tem;\n                    getMaxMin(maxmin, l2[i].children[j].x);\n                }\n                l2[i].x = getLoction2(l2[i].children);\n            }\n        }\n    }\n\n    if (xi % 2 === 0) {\n        c = xi / 2 + hi;\n        if (l2[c].hasOwnProperty(\"children\")) {\n            if (l2[c - 1].hasOwnProperty(\"children\") &&\n                l2[c].children[0].x < l2[c].x - 50) {\n                var tem = 50 - l2[c].children[0].x;\n                for (var j = 0; j < l2[c].children.length; j++) {\n                    l2[c].children[j].x = l2[c].children[j].x + tem;\n                    getMaxMin(maxmin, l2[c].children[j].x);\n                }\n                l2[c].x = getLoction2(l2[c].children);\n            }\n        }\n    } else {\n        c = parseInt(xi / 2) + hi;\n    }\n    for (var i = c + 1; i < l2.length; i++) {\n        if (l2[i].hasOwnProperty(\"children\")) {\n            if (l2[i - 1].hasOwnProperty(\"children\") &&\n                l2[i - 1].children[l2[i - 1].children.length - 1].x - l2[i].children[0].x > -100) {\n                var tem = l2[i - 1].children[l2[i - 1].children.length - 1].x + 100 - l2[i].children[0].x;\n                for (var j = 0; j < l2[i].children.length; j++) {\n                    l2[i].children[j].x = l2[i].children[j].x + tem;\n                    getMaxMin(maxmin, l2[i].children[j].x);\n                }\n                l2[i].x = getLoction2(l2[i].children);\n            }\n        }\n    }\n    for (var i = c - 1; i >= hi; i--) {\n        if (l2[i].hasOwnProperty(\"children\")) {\n            if (l2[i + 1].hasOwnProperty(\"children\") &&\n                l2[i + 1].children[0].x - l2[i].children[l2[i].children.length - 1].x < 100) {\n                var tem = l2[i].children[l2[i].children.length - 1].x - (l2[i + 1].children[0].x - 100);\n                for (var j = 0; j < l2[i].children.length; j++) {\n                    l2[i].children[j].x = l2[i].children[j].x - tem;\n                    getMaxMin(maxmin, l2[i].children[j].x);\n                }\n                l2[i].x = getLoction2(l2[i].children);\n            }\n        }\n    }\n    // data.x = (maxmin[0] - maxmin[1]) / 2 + maxmin[1];\n    if (maxmin[0] - maxmin[1] <= 400) {\n        maxmin[0] = maxmin[0] + 100;\n        maxmin[1] = maxmin[1] - 100;\n    }\n    data.len = maxmin;\n    data.leny = maxminy;\n    return data;\n}\n\nfunction format2(data) {\n    if (!data.hasOwnProperty(\"children\")) {\n        return data;\n    }\n    var l2 = data.children;\n    var hi = parseInt(l2.length / 2);\n    var xi = l2.length - hi;\n    var maxmin = data.len;\n    for (var i = 0; i < l2.length; i++) {\n        if (!l2[i].hasOwnProperty(\"children\")) {\n            if (i > 0 && (i != hi) && l2[i - 1].hasOwnProperty(\"children\") && l2[i - 1].children.length > 5) {\n                var tem = (l2[i - 1].children.length - 5) / 2;\n                l2[i].x = l2[i].x + 100 * tem;\n                var len, flag = false;\n                if (i < hi) {\n                    len = hi;\n                } else {\n                    len = l2.length;\n                }\n                for (var j = i + 1; j < len; j++) {\n                    flag = true;\n                    l2[j].x = l2[j].x + 100 * tem;\n                    if (l2[j].hasOwnProperty(\"children\")) {\n                        var children = l2[j].children;\n                        for (var k = 0; k < children.length; k++) {\n                            children[k].x = children[k].x + 100 * tem;\n                            getMaxMin(maxmin, children[k].x);\n                        }\n                    }\n                    getMaxMin(maxmin, l2[j].x);\n                }\n                if (flag) {\n                    l2[i].x = l2[i].x > maxmin[0] ? maxmin[0] : l2[i].x;\n                }\n            } else if (i < l2.length - 1 && l2[i + 1].hasOwnProperty(\"children\") && l2[i + 1].children.length > 5) {\n                var tem = (l2[i + 1].children.length - 5) / 2;\n                l2[i].x = l2[i].x - 100 * tem;\n                var len, flag = false;\n                if (i < hi) {\n                    len = 0;\n                } else {\n                    len = hi;\n                }\n                for (var j = i - 1; j >= len; j--) {\n                    flag = true;\n                    l2[j].x = l2[j].x - 100 * tem;\n                    if (l2[j].hasOwnProperty(\"children\")) {\n                        var children = l2[j].children;\n                        for (var k = 0; k < children.length; k++) {\n                            children[k].x = children[k].x - 100 * tem;\n                            getMaxMin(maxmin, children[k].x);\n                        }\n                    }\n                    getMaxMin(maxmin, l2[j].x);\n                }\n                if (flag) {\n                    l2[i].x = l2[i].x < maxmin[1] ? maxmin[1] : l2[i].x;\n                }\n            }\n        }\n    }\n    // data.x = (maxmin[0] - maxmin[1]) / 2 + maxmin[1];\n    if (maxmin[0] - maxmin[1] <= 400) {\n        maxmin[0] = maxmin[0] + 100;\n        maxmin[1] = maxmin[1] - 100;\n    }\n    data.len = maxmin;\n    return data;\n}\n\nfunction getLoction(num, x, index) {\n    if (num % 2 === 0) {\n        var c = num / 2 - index;\n        x = x - 50 - 100 * c;\n    } else {\n        var c = parseInt(num / 2 + 1) - index;\n        x = x - 100 * c;\n    }\n    return x;\n}\n\n/*function getLoction2(data) {\n\tvar len = data.length;\n\tvar x;\n\tif (len % 2 === 0) {\n\t\tvar c = len / 2;\n\t\tx = data[c - 1].x + 50;\n\t} else {\n\t\tvar c = parseInt(len / 2 + 1);\n\t\tx = data[c - 1].x;\n\t}\n\treturn x;\n}*/\n\nfunction getFX(len, index, fx) {\n    var x, c;\n    if (len < 1) {\n        return 1;\n    }\n    c = (len % 2 === 0) ? len / 2 : (parseInt(len / 2) + 1);\n    x = (index < c) ? 1 : -1;\n    if (fx) {\n        x = -x;\n    }\n    return x;\n}\n\nfunction getSum(data, st, ed) {\n    if (ed > data.length) {\n        ed = data.length;\n    }\n    var count = 0;\n    for (var i = st; i < ed; i++) {\n        if (!data[i].hasOwnProperty(\"children\")) {\n            continue;\n        }\n        var l3 = data[i].children;\n        count = count + l3.length;\n    }\n    return count;\n}\n\nfunction sortData(data, hi, xi) {\n    var res = [];\n    var len = hi - 1;\n    var pos = 0;\n    for (var i = 0; i < hi - 1; i++) {\n        var flag = 1;\n        for (var j = 0; j < len; j++) {\n            var dx = !data[j].hasOwnProperty(\"children\") ? 0 : data[j].children.length,\n                dx1 = !data[j + 1].hasOwnProperty(\"children\") ? 0 : data[j + 1].children.length;\n            if (dx > dx1) {\n                var tem = data[j];\n                data[j] = data[j + 1];\n                data[j + 1] = tem;\n                flag = 0;\n                pos = j;\n            }\n        }\n        len = pos;\n        if (flag === 1) {\n            break;\n        }\n    }\n    for (var i = 0; i < hi; i++) {\n        if (i % 2 === 0) {\n            res[i / 2] = data[i];\n        } else {\n            res[hi - (i + 1) / 2] = data[i];\n        }\n    }\n\n    len = data.length - 1;\n    pos = 0;\n    for (var i = hi; i < data.length - 1; i++) {\n        var flag = 1;\n        for (var j = hi; j < len; j++) {\n            var dx = !data[j].hasOwnProperty(\"children\") ? 0 : data[j].children.length,\n                dx1 = !data[j + 1].hasOwnProperty(\"children\") ? 0 : data[j + 1].children.length;\n            if (dx > dx1) {\n                var tem = data[j];\n                data[j] = data[j + 1];\n                data[j + 1] = tem;\n                flag = 0;\n                pos = j;\n            }\n        }\n        len = pos;\n        if (flag === 1) {\n            break;\n        }\n    }\n    for (var i = 0; i < xi; i++) {\n        if (i % 2 === 0) {\n            res[i / 2 + hi] = data[i + hi];\n        } else {\n            res[xi - (i + 1) / 2 + hi] = data[i + hi];\n        }\n    }\n    return res;\n}\n\nfunction getMaxMin(maxmin, x) {\n    if (maxmin[0] < x) {\n        maxmin[0] = x;\n    }\n    if (maxmin[1] > x) {\n        maxmin[1] = x;\n    }\n    return maxmin;\n}\n\nfunction initCharts(returninfo) {\n    var res = {};\n    var links = [];\n    var lines = [];\n    var yiji = 'image://data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAgCAYAAABO6BuSAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFMzhFMDM4REEwQUYxMUVBQkY1NEIzNTg4MTM4RjIxOCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFMzhFMDM4RUEwQUYxMUVBQkY1NEIzNTg4MTM4RjIxOCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkUzOEUwMzhCQTBBRjExRUFCRjU0QjM1ODgxMzhGMjE4IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkUzOEUwMzhDQTBBRjExRUFCRjU0QjM1ODgxMzhGMjE4Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+ZMccrwAACbZJREFUeNrkWUtvJFcV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';\n    var erji = yiji;\n    var sanji = erji;\n    returninfo.number = (returninfo.number === undefined) ? '--' : returninfo.number + '%';\n    returninfo.number = (returninfo.number.startsWith('.')) ? '0' + returninfo.number : returninfo.number;\n    returninfo.number = (returninfo.number.startsWith('-.')) ? returninfo.number.replace('-.', '-0.') : returninfo.number;\n    var url = '${pageContext.request.requestURL}'.replace('${pageContext.request.requestURI}', '');\n    var data = [{\n        name: returninfo.name + \"：\" + returninfo.number,\n        tooltip: {\n            formatter: \"{b}\"\n        },\n        symbol: yiji,\n        symbolSize: [60, 40],\n        value: [returninfo.x, returninfo.y],\n        datadate: returninfo.datadate,\n        spid: returninfo.id\n    }];\n    if (\"children\" in returninfo) {\n        var l2 = returninfo.children;\n        var curveness, colork, colorn, xs;\n        for (var i = 0; i < l2.length; i++) {\n            curveness = l2[i].fx === 1 ? 0.1 : -0.1;\n            l2[i].number = (l2[i].number === undefined) ? '--' : l2[i].number + '%';\n            l2[i].number = (l2[i].number.startsWith('.')) ? '0' + l2[i].number : l2[i].number;\n            l2[i].number = (l2[i].number.startsWith('-.')) ? l2[i].number.replace('-.', '-0.') : l2[i].number;\n            colork = (l2[i].code === '2' || l2[i].code === 2) ? '#C75050' : '#53B5EA';\n            var link = {\n                source: returninfo.name + \"：\" + returninfo.number,\n                target: l2[i].name + \"：\\n\" + l2[i].number,\n                lineStyle: {\n                    curveness: curveness,\n                    color: colork\n                }\n            };\n            links.push(link);\n            colorn = (l2[i].code === '2' || l2[i].code === 2) ? 'rgba(199,80,80,0.5)' : 'rgba(55,155,255,0.5)';\n            var line = {\n                coords: [\n                    [returninfo.x, returninfo.y],\n                    [l2[i].x, l2[i].y]\n                ],\n                lineStyle: {\n                    curveness: curveness,\n                    color: colorn\n                }\n            };\n            lines.push(line);\n            var node = {\n                name: l2[i].name + \"：\\n\" + l2[i].number,\n                tooltip: {\n                    formatter: \"{b}\"\n                },\n                symbol: erji,\n                symbolSize: [60, 40],\n                value: [l2[i].x, l2[i].y],\n                datadate: l2[i].datadate,\n                ifend: l2[i].ifend,\n                spid: l2[i].id\n            };\n            data.push(node);\n            if (\"children\" in l2[i]) {\n                var l3 = l2[i].children;\n                for (var j = 0; j < l3.length; j++) {\n                    curveness = l3[j].fx === 1 ? 0.1 : -0.1;\n                    l3[j].number = (l3[j].number === undefined) ? '--' : l3[j].number + '%';\n                    l3[j].number = (l3[j].number.startsWith('.')) ? '0' + l3[j].number : l3[j].number;\n                    l3[j].number = (l3[j].number.startsWith('-.')) ? l3[j].number.replace('-.', '-0.') : l3[j].number;\n                    colork = (l3[j].code === '2' || l3[j].code === 2) ? '#C75050' : '#53B5EA';\n                    var link = {\n                        source: l2[i].name + \"：\\n\" + l2[i].number,\n                        target: l3[j].name + \"：\\n\" + l3[j].number,\n                        lineStyle: {\n                            curveness: curveness,\n                            color: colork\n                        }\n                    };\n                    links.push(link);\n                    colorn = (l3[j].code === '2' || l3[j].code === 2) ? 'rgba(199,80,80,0.5)' : 'rgba(55,155,255,0.5)';\n                    var line = {\n                        coords: [\n                            [l2[i].x, l2[i].y],\n                            [l3[j].x, l3[j].y]\n                        ],\n                        lineStyle: {\n                            curveness: curveness,\n                            color: colorn\n                        }\n                    };\n                    lines.push(line);\n                    node = {\n                        name: l3[j].name + \"：\\n\" + l3[j].number,\n                        tooltip: {\n                            formatter: \"{b}\"\n                        },\n                        symbol: sanji,\n                        symbolSize: [60, 40],\n                        value: [l3[j].x, l3[j].y],\n                        datadate: l3[j].datadate,\n                        ifend: l3[j].ifend,\n                        spid: l3[j].id\n                    };\n                    data.push(node);\n                }\n            }\n        }\n    }\n    res.data = data;\n    res.links = links;\n    res.lines = lines;\n    res.len = returninfo.len;\n    res.leny = returninfo.leny;\n    return res;\n}\nvar jsons = format(data);\ndebugger;\njsons = format2(jsons);\nvar returninfo = initCharts(jsons);\noption = {\n    backgroundColor: \"#f5f5f5\",\n    grid: {\n        left: '5%',\n        right: '5%'\n    },\n    xAxis: {\n        show: false,\n        type: \"value\",\n        max: returninfo.len[0],\n        min: returninfo.len[1]\n    },\n    yAxis: {\n        show: false,\n        type: \"value\",\n        max: returninfo.leny[0],\n        min: returninfo.leny[1] - 10\n    },\n    tooltip: {},\n    series: [{\n        type: \"graph\",\n        zlevel: 5,\n        draggable: false,\n        coordinateSystem: \"cartesian2d\", //使用二维的直角坐标系（也称笛卡尔坐标系）\n        label: {\n            show: true,\n            color: \"#000\",\n            position: 'bottom',\n        },\n        data: returninfo.data,\n        links: returninfo.links,\n        lineStyle: {\n            opacity: 1,\n            width: 2\n        }\n    }, {\n        type: \"lines\",\n        coordinateSystem: \"cartesian2d\",\n        zlevel: 1,\n        animation: false,\n        effect: {\n            show: true,\n            period: 5,\n            trailLength: 0.01,\n            symbolSize: 12,\n            symbol: \"pin\",\n            loop: true\n        },\n        data: returninfo.lines,\n        lineStyle: {\n            width: 0\n        }\n    }, {\n        type: \"lines\",\n        coordinateSystem: \"cartesian2d\",\n        zlevel: 1,\n        animation: false,\n        effect: {\n            show: true,\n            period: 6,\n            trailLength: 0.01,\n            symbolSize: 12,\n            symbol: \"pin\",\n            loop: true\n        },\n        data: returninfo.lines,\n        lineStyle: {\n            width: 0\n        }\n    }, {\n        type: \"lines\",\n        coordinateSystem: \"cartesian2d\",\n        zlevel: 1,\n        animation: false,\n        effect: {\n            show: true,\n            period: 8,\n            trailLength: 0.01,\n            symbolSize: 12,\n            symbol: \"pin\",\n            loop: true\n        },\n        data: returninfo.lines,\n        lineStyle: {\n            width: 0\n        }\n    }]\n};\n\n/*myChart.on('click', function(params) {\n            if (params.dataType === 'node') {\n                var data = params.data;\n                if (data.ifend === '1' || data.ifend === 1) {\n                    var sp_id = data.spid;\n                    var data_date = data.datadate;\n                    var url = getUrlByParams(\"/branchLineLoss/getMeterJson?sp_id=\" +\n                        sp_id + \"&data_date=\" + data_date, null);\n                    createRespone('楼层结构', url, null, null, '650px', '600px');\n                }\n            }\n        }*/","html":"","externalScripts":"","updaterUID":"obd-oM988GWCz1Es751MOXxrh3YQGFrx224","theme":"","layout":"","viewCount":1164,"userName":"余***你","commentCount":0,"starCount":37,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xj3UrbJoKd.png?v=1609841110986","isCustomThumbnail":0,"builtinTags":["category-work","grid","series-graph","series-lines","tooltip"],"customTags":[],"updaterUserName":"余***你"}}