{"status":0,"data":{"cid":"xdxtRzpidd","authorUid":"obd-o-xe63CCY7-j2x7camMzPwQIU7WkvAY","authorUserName":"中***机","title":"时间区域甘特图","description":"","latestVersion":7,"alwaysLatest":1,"createTime":"2021-03-03T08:13:06.000Z","lastUpdateTime":"2021-03-03T08:13:06.000Z","auth":2,"uid":"obd-o-xe63CCY7-j2x7camMzPwQIU7WkvAY","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":7,"parentVersion":6,"echartsVersion":"4.9.0","versionCreateTime":"2021-06-18T07:11:16.000Z","code":"let series = ['故障', '换模', '换刀'];\nlet startTimeAll = new Date('2021-03-01 00:00:00').getTime();\nlet endTimeAll = new Date('2021-03-04 00:00:00').getTime();\nlet categories = ['A', 'B', 'C'];\nlet seriesValue = [];\n\nlet jsonData = [\n    {\n        category: 'A',\n        series: '故障',\n        startTime: '2021-03-01 08:00:00',\n        endTime: '2021-03-01 18:00:00',\n    },\n    {\n        category: 'A',\n        series: '换刀',\n        startTime: '2021-03-01 18:00:00',\n        endTime: '2021-03-02 14:00:00',\n    },\n    {\n        category: 'A',\n        series: '换模',\n        startTime: '2021-03-03 10:00:00',\n        endTime: '2021-03-03 18:00:00',\n    },\n    {\n        category: 'B',\n        series: '故障',\n        startTime: '2021-03-01 08:00:00',\n        endTime: '2021-03-01 13:00:00',\n    },\n    {\n        category: 'C',\n        series: '故障',\n        startTime: '2021-03-01 08:00:00',\n        endTime: '2021-03-01 16:00:00',\n    },\n    {\n        category: 'C',\n        series: '换模',\n        startTime: '2021-03-02 04:00:00',\n        endTime: '2021-03-02 19:00:00',\n    },\n];\n\nfunction getXDate(time) {\n    let year = time.getFullYear();\n    let month = parseInt(time.getMonth()) + 1;\n    let day = time.getDate();\n    let hour = time.getHours();\n    let minutes = time.getMinutes();\n    let seconds = time.getSeconds();\n    return year + '-' + month + '-' + day + ' ' + hour + ':' + minutes + ':' + seconds;\n}\n\n// Generate mock data\necharts.util.each(categories, function (category, index) {\n    let cgory = categories[index];\n    series.forEach((itemS, indexS) => {\n        jsonData.forEach((itemj, indexj) => {\n            if (itemj.category == cgory) {\n                let data = [];\n                let startTime = new Date(itemj.startTime).getTime();\n                let endTime = new Date(itemj.endTime).getTime();\n                let duration = endTime - startTime;\n                if (itemj.series == itemS) {\n                    data.push({\n                        name: itemj.series,\n                        value: [index, startTime, endTime, duration],\n                        itemStyle: {\n                            normal: {\n                                //color: '#7b9ce1',\n                            },\n                        },\n                    });\n                    seriesValue.push({\n                        name: itemS,\n                        type: 'custom',\n                        renderItem: renderItem,\n                        itemStyle: {\n                            normal: {\n                                opacity: 0.8,\n                            },\n                        },\n                        encode: {\n                            x: [1, 2],\n                            y: 0,\n                        },\n                        data: data,\n                    });\n                }\n            }\n        });\n    });\n});\n\nfunction renderItem(params, api) {\n    let categoryIndex = api.value(0);\n    let start = api.coord([api.value(1), categoryIndex]);\n    let end = api.coord([api.value(2), categoryIndex]);\n    let height = api.size([0, 1])[1] * 0.6;\n\n    let rectShape = echarts.graphic.clipRectByRect(\n        {\n            x: start[0],\n            y: start[1] - height / 2,\n            width: end[0] - start[0],\n            height: height,\n        },\n        {\n            x: params.coordSys.x,\n            y: params.coordSys.y,\n            width: params.coordSys.width,\n            height: params.coordSys.height,\n        }\n    );\n\n    return (\n        rectShape && {\n            type: 'rect',\n            shape: rectShape,\n            style: api.style(),\n        }\n    );\n}\n\noption = {\n    legend: {\n        type: 'scroll',\n        data: ['故障', '换模', '换刀'],\n        show: true,\n        orient: 'vertical',\n        align: 'auto',\n        top: '10%',\n        right: '2%',\n    },\n    tooltip: {\n        formatter: function (params) {\n            return params.marker + params.name + ': ' + params.value[3] / 1000 / 60 / 60 + ' h';\n        },\n    },\n    title: {\n        text: '报警时长',\n        left: 'center',\n    },\n    grid: {\n        height: 300,\n    },\n    xAxis: [\n        {\n            min: startTimeAll,\n            max: endTimeAll,\n            interval: 3600 * 24 * 1000,\n            axisLabel: {\n                show: true,\n                formatter: function (val) {\n                    let dateTime = new Date(val);\n                    return getXDate(dateTime);\n                },\n            },\n        },\n        {\n            data: ['2021-03-01', '2021-03-02', '2021-03-03'],\n        },\n    ],\n    yAxis: {\n        data: categories,\n        splitLine: {\n            show: true,\n        },\n    },\n    series: seriesValue\n};\n","html":"","externalScripts":"","updaterUID":"obd-o-xe63CCY7-j2x7camMzPwQIU7WkvAY","theme":"","layout":"","viewCount":102,"userName":"中***机","commentCount":0,"starCount":8,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xdxtRzpidd.png?v=1624000276960","isCustomThumbnail":0,"builtinTags":["category-work","dataZoom","grid","series-custom","title","tooltip"],"customTags":[],"updaterUserName":"中***机"}}