{"status":0,"data":{"cid":"x7ufqbRYyk","authorUid":"obd-o2TqhU5V49yi28tSjDqysoIw4zUTi6H","authorUserName":"m***h","title":"待确定","description":"","latestVersion":2,"alwaysLatest":1,"createTime":"2020-12-10T05:38:49.000Z","lastUpdateTime":"2020-12-10T05:38:49.000Z","auth":2,"uid":"obd-o2TqhU5V49yi28tSjDqysoIw4zUTi6H","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.8.0","versionCreateTime":"2020-12-10T07:56:34.000Z","code":"// 待确定后再修改\nvar data = [{\n    name: '家庭关系',\n    value: [{\n            name: '张大海',\n            relaDetail: '父亲'\n        },\n        {\n            name: '李梅',\n            relaDetail: '母亲'\n        }\n    ]\n}, {\n    name: '舍友关系',\n    value: [{\n        name: '张三',\n        relaDetail: '舍友',\n        major: '19级化学类'\n    }, {\n        name: '李四',\n        relaDetail: '舍友',\n        major: '18级食品类'\n    }, {\n        name: '王五',\n        relaDetail: '舍友',\n        major: '17级技术类'\n    }]\n}, {\n    name: '师生关系',\n    value: [{\n        name: '李慧珍',\n        relaDetail: '授课教师',\n        post: '研究员',\n        lesson: '工业生产应用有机化学'\n    }, {\n        name: '王沥川',\n        relaDetail: '授课教师',\n        post: '研究员',\n        lesson: '工业生产应用有机化学'\n    }, {\n        name: '赵雪琴',\n        relaDetail: '授课教师',\n        post: '研究员',\n        lesson: '工业生产应用有机化学'\n    }, {\n        name: '李晨曦',\n        relaDetail: '授课教师',\n        post: '研究员',\n        lesson: '工业生产应用有机化学'\n    }, {\n        name: '张铭轩',\n        relaDetail: '授课教师',\n        post: '研究员',\n        lesson: '工业生产应用有机化学'\n    }]\n}]\n\n\n\n\nfunction calcPosition(data) {\n    let flag = data.length>1;\n    var y = flag ? (data.length - 1) / 2 * 5 : 1\n    var seriesOption = [];\n    var linesData = data.length ? [{\n            coords: [\n                [8, y],\n                [10, y],\n            ]\n        }]:[];\n    var scatterData = data.length ? [\n        [8,y]\n    ]:[];\n    data.map((item, index) => {\n        let data = []\n        let value = []\n        item.value.map((it, id) => {\n            data[id] = {\n                ...it,\n                value: [15 + id * 8, flag ? index * 5:1]\n            }\n        })\n        seriesOption.push({\n            name: item.name,\n            type: 'graph',\n            coordinateSystem: 'cartesian2d',\n            draggable: false,\n            symbol: 'rect',\n            symbolSize: [80, 40],\n            label: {\n                show: true,\n            },\n            hoverAnimation: false,\n            tooltip: {\n                backgroundColor: '#fff',\n                formatter: params => {\n                    if (params.seriesName === '家庭关系') {\n                        return `\n                    <span style=\"font-size:16px;color:#333\">${params.name}</span><br/>\n                    关系：${params.data.relaDetail}\n                    `\n                    } else if (params.seriesName === '舍友关系') {\n                        return `\n                    <span style=\"font-size:16px;color:#333\">${params.name}</span><br/>\n                    关系：${params.data.relaDetail}<br/>\n                    年级专业：${params.data.major}\n                    `\n                    } else if (params.seriesName === '师生关系') {\n                        return `\n                    <span style=\"font-size:16px;color:#333\">${params.name}</span><br/>\n                    关系：${params.data.relaDetail}<br/>\n                    专业技术职务：${params.data.post}<br/>\n                    授课课程：${params.data.lesson}\n                    `\n                    }\n                },\n                textStyle: {\n                    color: '#666'\n                }\n            },\n            data: data\n        })\n        \n        linesData.push({\n            coords:[\n                    [10,y],\n                    [10,flag ? index*5 : 1],\n                    [12,flag ? index*5 : 1]\n                ]\n        })\n        scatterData.push([12,flag ? index*5 : 1])\n    })\n    console.log(linesData)\n\n    let option = {\n        legend: {\n            data: [\n                '家庭关系',\n                '舍友关系',\n                '师生关系'\n            ]\n        },\n        tooltip: {\n            type: 'item'\n        },\n        title: {\n            text: 'Awesome Chart',\n            show:false\n        },\n        xAxis: {\n            type: 'value',\n            max:flag?'auto':50,\n            show:false\n        },\n        yAxis: {\n            type: 'value',\n            max:flag?(data.length -1)/2*10 : 2,\n            show:false\n        },\n        series: [{\n                type: 'graph',\n                coordinateSystem: 'cartesian2d',\n                draggable: false,\n                symbol: 'rect',\n                symbolSize: [80, 40],\n                label: {\n                    show: true,\n                },\n                hoverAnimation: false,\n                tooltip: {\n                    show: false\n                },\n                data: [{\n                    name: '张子山',\n                    value: [5, data.length>1 ? (data.length - 1) / 2 * 5:1]\n                }]\n            },\n            {\n                type: 'lines',\n                polyline: true,\n                coordinateSystem: 'cartesian2d',\n                lineStyle: {\n                    normal: {\n                        width: 2,\n                    }\n                },\n                symbol: 'circle',\n                symbolSize: 5,\n                data:linesData\n            },\n            {\n                type: 'scatter',\n                coordinateSystem: 'cartesian2d',\n                lineStyle: {\n                    normal: {\n                        width: 2,\n                    }\n                },\n                symbol: 'circle',\n                symbolSize: 10,\n                itemStyle: {\n                    opacity: 1,\n                    color: 'rgba(255,255,255,1)',\n                    borderColor: 'red'\n                },\n                data: scatterData\n            },\n            ...seriesOption\n        ]\n    };\n    return option;\n}\n\n\nlet option = calcPosition(data)\nmyChart.setOption(option);\n\n\nmyChart.on('legendselectchanged', function(obj) {\n    const selectedList = []\n    data.forEach((item, i) => {\n        if (obj['selected'][item['name']]) {\n            selectedList.push(item)\n        }\n    })\n    var option = calcPosition(selectedList)\n    myChart.setOption(option);\n});","html":"","externalScripts":"","updaterUID":"obd-o2TqhU5V49yi28tSjDqysoIw4zUTi6H","theme":"","layout":"","viewCount":704,"userName":"m***h","commentCount":0,"starCount":5,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x7ufqbRYyk.png?v=1607586994972","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-graph","series-lines","series-scatter","title","tooltip"],"customTags":[],"updaterUserName":"m***h"}}