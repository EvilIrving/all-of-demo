{"status":0,"data":{"cid":"x1CLML4AMH","authorUid":"bd-810990206","authorUserName":"小***园","title":"自定义","description":"","latestVersion":6,"alwaysLatest":0,"createTime":"2021-09-09T07:43:16.000Z","lastUpdateTime":"2021-11-24T05:06:26.000Z","auth":2,"uid":"bd-810990206","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":6,"parentVersion":5,"echartsVersion":"4.8.0","versionCreateTime":"2021-11-24T05:06:26.000Z","code":"var data = [];\nvar dataCount = 20;\nvar startTime = +new Date();\nvar categories = ['深睡', '浅睡', 'REM','清醒'];\nvar types = [\n    {name: '深睡', color: '#764497'},\n    {name: '浅睡', color: '#4CBAEB'},\n    {name: 'REM', color: '#F0843E'},\n    {name: '清醒', color: '#F1D31E'},\n];\n\n// Generate mock data\n    var baseTime = startTime;\n    const linedata = []\n    let pre = null\n    const indexFn = ()=>{\n        const index = Math.round(Math.random()*3)\n        if(index===pre)return indexFn()\n        else return index\n    }\n    for (var i = 0; i < dataCount; i++) {\n        const index = indexFn()\n        pre=index\n        const typeItem = types[index];\n        const duration = Math.round(Math.random() * 1000*60+1000)*Math.round(Math.random()*30+50);\n        data.push({\n            name: typeItem.name,\n            value: [\n                index,\n                baseTime,\n                baseTime + duration,\n                duration\n            ],\n            itemStyle: {\n                normal: {\n                    color:typeItem.color\n                }\n            }\n        });\n        linedata.push([baseTime,typeItem.name,index])\n        linedata.push([baseTime+duration,typeItem.name,index])\n        baseTime += duration;\n    }\n\nfunction renderItem(params, api) {\n    var categoryIndex = api.value(0);\n    var start = api.coord([api.value(1), categoryIndex]);\n    var end = api.coord([api.value(2), categoryIndex]);\n    var height = api.size([0, 1])[1] * 0.5;\n\n    var rectShape = echarts.graphic.clipRectByRect({\n        x: start[0],\n        y: start[1] - height / 2,\n        width: end[0] - start[0],\n        height: height\n    }, {\n        x: params.coordSys.x,\n        y: params.coordSys.y,\n        width: params.coordSys.width,\n        height: params.coordSys.height\n    });\n\n    return rectShape && {\n        type: 'rect',\n        transition: ['shape'],\n        shape: rectShape,\n        style: api.style()\n    };\n}\n\nlinedata.pop();\nlinedata.shift();\nconst newData = []\nlinedata.forEach((it,i,)=>{\n    if(i%2===0){\n      newData.push([it,linedata[i+1]])\n    }\n})\nconsole.log(moment(startTime).format('HH:mm'))\noption = {\n    tooltip: {\n        formatter: function (params) {\n            console.log(params)\n            const h = moment.duration(params.value[3]).hours();\n            const m = moment.duration(params.value[3]).minutes();\n            let time= ''\n            if(h>0) time = h+'小时'+m+'分钟'\n            else time= m+'分钟'\n            console.log(moment(params.value[1]).format('HH:mm'))\n            return params.marker+moment(params.value[1]).format('HH:mm')+'-'+moment(params.value[2]).format('HH:mm')+ ' | '+ params.name + ': ' + time;\n        }\n    },\n    title: {\n        text: 'Profile',\n        left: 'center'\n    },\n    // dataZoom: [{\n    //     type: 'slider',\n    //     filterMode: 'weakFilter',\n    //     showDataShadow: false,\n    //     top: 400,\n    //     labelFormatter: ''\n    // }, {\n    //     type: 'inside',\n    //     filterMode: 'weakFilter'\n    // }],\n    grid: {\n        height: 200\n    },\n    xAxis: {\n        min: startTime,\n        scale: true,\n        interval:600000*5,\n        axisLine:{\n            show:false\n        },\n        axisTick:{\n            show:false\n        },\n        splitLine:{\n            show:false\n        },\n        axisLabel: {\n            formatter: function (val) {\n                return  moment(val).format('HH:mm');\n            }\n        }\n    },\n    yAxis: {\n        data: categories,\n        axisTick:{\n            show:false\n        },\n        axisLine:{\n            show:false\n        }\n    },\n    series: [{\n        type: 'custom',\n        renderItem: renderItem,\n        itemStyle: {\n            opacity: 1\n        },\n        encode: {\n            x: [1, 2],\n            y: 0\n        },\n        data: data\n    }\n    ,...newData.map((item,i)=>{\n        let start = types.find(it=>it.name===item[0][1]).color\n        let end = types.find(it=>it.name===item[1][1]).color\n        if(item[0][2]>item[1][2]){\n            const temp = start;\n            start = end;\n            end = temp;\n        }\n        item[0][0] = item[0][0] -30000\n        item[1][0] = item[1][0] +30000\n        console.log(item,'--')\n        return {\n            type: 'line',\n            symbol:'none',\n            smooth:true,\n            lineStyle:{\n                width:3,\n                color:{\n                    type: 'linear',\n                  x: 0,\n                  y: 0,\n                  x2: 0,\n                  y2: 1,\n                  colorStops: [{\n                      offset: 1, color:start   // 0% 处的颜色\n                  },{\n                      offset: 0.8, color:start   // 0% 处的颜色\n                  }\n                  , {\n                      offset: 0.2, color:end  // 100% 处的颜色\n                  }, {\n                      offset: 0, color:end  // 100% 处的颜色\n                  }],\n                  global: false // 缺省为 false\n                }\n            },\n            data: item\n        }\n    })\n    ]\n};","html":"","externalScripts":"https://cdn.bootcdn.net/ajax/libs/moment.js/2.29.1/moment.js","updaterUID":"bd-810990206","theme":"","layout":"","viewCount":0,"userName":"小***园","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x1CLML4AMH.png?v=1637730386832","isCustomThumbnail":0,"builtinTags":["category-work","dataZoom","grid","series-custom","title","tooltip"],"customTags":[],"updaterUserName":"小***园"}}