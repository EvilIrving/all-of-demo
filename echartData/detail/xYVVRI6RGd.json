{"status":0,"data":{"cid":"xYVVRI6RGd","authorUid":"obd-otKTIeBvi9tS0P8LLP05EiPqQnnTu8Z","authorUserName":"a***y","title":"geo+循环","description":"","latestVersion":3,"alwaysLatest":1,"createTime":"2020-04-25T12:26:42.000Z","lastUpdateTime":"2020-04-25T12:26:42.000Z","auth":2,"uid":"obd-otKTIeBvi9tS0P8LLP05EiPqQnnTu8Z","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":3,"parentVersion":2,"echartsVersion":"4.7.0","versionCreateTime":"2020-04-25T14:23:26.000Z","code":"// http://datav.aliyun.com/tools/atlas 阿里云地图选择器 下载需要的数据包\n// 左上角 导入数据 插入到代码\n\nvar uploadedDataURL = \"/asset/get/s/data-1565258572056-CxztNlcgK.json\";\n\n\n// 标记点\nvar chinaGeoCoordMap = {\n    '黑龙江': [127.9688, 45.368],\n    '加拿大': [-106.346771, 56.130366],\n    '内蒙古': [110.3467, 41.4899],\n    \"吉林\": [125.8154, 44.2584],\n    '北京市': [116.4551, 40.2539],\n    \"辽宁\": [123.1238, 42.1216],\n    \"河北\": [114.4995, 38.1006],\n    \"天津\": [117.4219, 39.4189],\n    \"山西\": [112.3352, 37.9413],\n    \"陕西\": [109.1162, 34.2004],\n    \"甘肃\": [103.5901, 36.3043],\n    \"宁夏\": [106.3586, 38.1775],\n    \"青海\": [101.4038, 36.8207],\n    \"新疆\": [87.9236, 43.5883],\n    \"西藏\": [91.11, 29.97],\n    \"四川\": [103.9526, 30.7617],\n    \"重庆\": [108.384366, 30.439702],\n    \"山东\": [117.1582, 36.8701],\n    \"河南\": [113.4668, 34.6234],\n    \"江苏\": [118.8062, 31.9208],\n    \"安徽\": [117.29, 32.0581],\n    \"湖北\": [114.3896, 30.6628],\n    \"浙江\": [119.5313, 29.8773],\n    \"福建\": [119.4543, 25.9222],\n    \"江西\": [116.0046, 28.6633],\n    \"湖南\": [113.0823, 28.2568],\n    \"贵州\": [106.6992, 26.7682],\n    \"云南\": [102.9199, 25.4663],\n    \"广东\": [113.12244, 23.009505],\n    \"广西\": [108.479, 23.1152],\n    \"海南\": [110.3893, 19.8516],\n    '上海': [121.4648, 31.2891]\n};\nvar chinaDatas = [\n    [{\n        name: '黑龙江',\n        value: 10\n    }, {\n        name: \"天津\",\n    }],\n    [{\n        name: '天津',\n        value: 20\n    }, {\n        name: \"黑龙江\",\n    }],\n    [{\n        name: '吉林',\n        value: 30\n    }, {\n        name: \"加拿大\",\n    }],\n    [{\n        name: '辽宁',\n        value: 40\n    }, {\n        name: \"上海\",\n    }],\n    [{\n        name: '河北',\n        value: 50\n    }, {\n        name: \"上海\",\n    }],\n    [{\n        name: '天津',\n        value: 60\n    }, {\n        name: \"上海\",\n    }],\n    [{\n        name: '山西',\n        value: 70\n    }, {\n        name: \"上海\",\n    }],\n    [{\n        name: '陕西',\n        value: 80\n    }, {\n        name: \"上海\",\n    }],\n    [{\n        name: '甘肃',\n        value: 90\n    }, {\n        name: \"上海\",\n    }],\n    [{\n        name: '宁夏',\n        value: 100\n    }, {\n        name: \"上海\",\n    }],\n    [{\n        name: '青海',\n        value: 110\n    }, {\n        name: \"上海\",\n    }],\n    [{\n        name: '新疆',\n        value: 120\n    }, {\n        name: \"青海\",\n    }]\n];\n\n//function randomValue() {\n//    return Math.ceil(Math.random() * 10000 + 1)\n//}\n\n// 输出json对象数组res,包含source,target,value\nvar convertData = function(data) {\n    var res = [];\n    for (var i = 0; i < data.length; i++) {\n        var dataItem = data[i];\n        var fromCoord = chinaGeoCoordMap[dataItem[0].name];\n        var toCoord = chinaGeoCoordMap[dataItem[1].name];\n        if (fromCoord && toCoord) {\n            res.push([{\n                coord: fromCoord,\n                // value: dataItem[0].value\n                value: dataItem[0].value\n            }, {\n                coord: toCoord,\n            }]);\n        }\n    }\n    return res;\n};\nvar series = [];\n\n\n//控制整个贸易数据的显示，删除后图片只有地图\n[\n    ['北京市', chinaDatas]\n].forEach(function(item, i) {\n    series.push({\n            // 设置连线\n            type: 'lines',\n            zlevel: 2,\n            effect: {\n                show: true,\n                period: 0, //箭头指向速度，值越小速度越快\n                trailLength: 0.02, //特效尾迹长度[0,1]值越大，尾迹越长重\n                symbol: 'arrow', //箭头图标\n                symbolSize: 5, //图标大小\n            },\n            lineStyle: {\n                normal: {\n                    width: 1, //尾迹线条宽度\n                    opacity: 1, //尾迹线条透明度\n                    curveness: .3 //尾迹线条曲直度\n                }\n            },\n            data: convertData(item[1])   //读数据\n        }, {\n            //设置节点\n            type: 'effectScatter',\n            coordinateSystem: 'geo',\n            zlevel: 2,\n            rippleEffect: { //涟漪特效\n                //period: 4, //动画时间，值越小速度越快\n                brushType: 'stroke', //波纹绘制方式 stroke, fill\n                //scale: 4 //波纹圆环最大限制，值越大波纹越大\n            },\n            // 设置节点标签\n            label: {\n                normal: {\n                    show: true,\n                    position: 'right', //显示位置\n                    offset: [2, 0], //偏移设置\n                    formatter: function(params) { //圆环显示文字\n                        return params.data.name;\n                    },\n                    fontSize: 10\n                },\n                emphasis: {\n                    show: true\n                }\n            },\n            symbol: 'circle',\n            symbolSize: function(val) {\n                return 1 + val[2] / 6000; //圆环大小\n            },\n            // symbolSize: 8,\n            itemStyle: {\n                normal: {\n                    show: false,\n                    color: '#f00'\n                }\n            },\n            data: item[1].map(function(dataItem) {\n                return {\n                    name: dataItem[0].name,\n                    value: chinaGeoCoordMap[dataItem[0].name].concat([dataItem[0].value])\n                };\n            }),\n        },\n        //设置bj节点的显示\n        {\n            type: 'scatter',\n            coordinateSystem: 'geo',\n            zlevel: 2,\n            rippleEffect: {\n                period: 4,\n                brushType: 'stroke',\n                scale: 4\n            },\n            label: {\n                normal: {\n                    show: true,\n                    position: 'left',\n                    //offset:[5, 0],\n                    color: '#0f0',\n                    formatter: '{b}',\n                    textStyle: {\n                        color: \"#0f0\"\n                    }\n                },\n                emphasis: {\n                    show: true,\n                    color: \"#f60\"\n                }\n            },\n            symbol: 'pin',\n            symbolSize: 50,\n            data: [{\n                name: item[0],\n                value: chinaGeoCoordMap[item[0]].concat([item[0].value]),  \n            }],\n        }\n    );\n});\n\n// 解析地图数据包\n$.get(uploadedDataURL, function(json){\n\t// 注册地图，传入数据\n\techarts.registerMap('world', json);\n    console.log(json)\n    \n    option = {\n        tooltip: {\n            trigger: 'item',\n            backgroundColor: 'rgba(166, 200, 76, 0.82)',\n            borderColor: '#FFFFCC',\n            showDelay: 0,\n            hideDelay: 0,\n            enterable: true,\n            transitionDuration: 0,\n            extraCssText: 'z-index:100',\n            formatter: function(params) {\n                //根据业务自己拓展要显示的内容\n                var res = \"\";\n                var name = params.name;\n                var value = params.value[params.seriesIndex + 1];\n                res = \"<span style='color:#fff;'>\" + name + \"</span><br/>数据：\" + params.value;   //鼠标移动显示标签\n                return res;\n            }\n        },\n        backgroundColor: \"#013954\",\n        visualMap: { //图例值控制\n            min: 0,\n            max: 10000,\n            calculable: true,\n            show: true,\n            color: ['#f44336', '#fc9700', '#ffde00', '#ffde00', '#00eaff'],\n            textStyle: {\n                color: '#fff'\n            }\n        },\n        \n        geo: {\n            map: 'world',\n            zoom: 5,\n            center: [104.2978515625, 35.8544921875],\n            label: {\n                emphasis: {\n                    show: false\n                }\n            },\n            roam: true, //是否允许缩放\n            itemStyle: {\n                normal: {\n                    color: 'rgba(51, 69, 89, .5)', //地图背景色\n                    borderColor: '#516a89', //省市边界线00fcff 516a89\n                    borderWidth: 1\n                },\n                emphasis: {\n                    color: 'rgba(37, 43, 61, .5)' //悬浮背景\n                }\n            },\n            \n        },\n        series: series\n    };\n    myChart.setOption(option)\n})\n","html":"","externalScripts":"","updaterUID":"obd-otKTIeBvi9tS0P8LLP05EiPqQnnTu8Z","theme":"","layout":"","viewCount":599,"userName":"a***y","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xYVVRI6RGd.png?v=1587824606192","isCustomThumbnail":0,"builtinTags":["category-work","geo","series-effectScatter","series-lines","series-scatter","tooltip","visualMap"],"customTags":[],"updaterUserName":"a***y"}}