{"status":0,"data":{"cid":"xGLwWQ9mZZ","authorUid":"bd-1044119663","authorUserName":"brokencolor","title":"实时数据折线图","description":"","latestVersion":2,"alwaysLatest":1,"createTime":"2019-05-08T05:26:45.000Z","lastUpdateTime":"2019-05-08T05:26:45.000Z","auth":2,"uid":"bd-1044119663","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.2.1","versionCreateTime":"2019-05-08T05:30:17.000Z","code":"\n        var dataObj={\n            categories:[],\n            legendData:['动态曲线'],\n            yAxisData:[],\n            yAxisName: \"次\",\n            wangge:[]\n        };\n        dataObj.categories=(function() {\n            var now = new Date();\n            var res = [0,2,4,6,8,10,12,14,16,18,20,22,24];\n            var len = 12;\n            while (len--) {\n            // var m=now.getMinutes()<10?'0'+now.getMinutes():now.getMinutes(),t=now.getSeconds()<10?'0'+now.getSeconds():now.getSeconds();\n            var time=now.getHours();\n            res.unshift(time);\n            now = new Date(now - 7200000);\n            }\n            return res;\n        })();\n        // dataObj.wangge= (function() {\n        //     var res = [];\n        //     var len = 60;\n        //     while (len--) {\n        //         res.push(100);\n        //     }\n        //     return res;\n        // })();\n        dataObj.yAxisData=(function() {\n            var res = [0, 0, 0, 0, 0, 33, 35, 28, 25, 28, 10, 0, 0];\n            var len = 0;\n            while (len < 12) {\n                res.push('');\n                len++;\n            }\n            return res;\n        })();\n\n      var option=anlysis(myChart,dataObj); //初始化绘图\n        setInterval(function() {\n           var axisData = (new Date()).getHours();\n\n            var data0 = dataObj.wangge;//模拟网格\n            var data1 =  dataObj.yAxisData;\n            // data0.shift();\n            // data0.push(100);\n            data1.shift();\n            data1.push(Math.round(Math.random()*10));\n\n            dataObj.categories.shift();\n            dataObj.categories.push(axisData);\n\n            myChart.setOption({\n                xAxis: [{\n                    data: dataObj.categories\n                }, {\n                    data: dataObj.categories\n                }],\n                series: [{\n                    data: data0\n                }, {\n                    data: data1\n                }]\n            });\n        }, 1000);\n        \n        \nfunction anlysis(chartObj,dataArray) {\n       var option = {\n        title: {\n            show:false\n        },\n        grid:{\n            top: '12%',\n            left: '10px',\n            right: '10px',\n            bottom: '2%',\n            containLabel: true,\n        },\n        tooltip: {\n            trigger: 'axis',\n            formatter: function (params) {\n                if(params[0].data !== ''){\n                    var s = '<span style=\"display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:' + params[0].color + '\"></span>'+params[0].seriesName+\"：\"+params[0].data;\n                    return s;\n                }\n            },\n        },\n        legend: {\n            data: dataArray.legendData,\n            textStyle: {\n                color: '#555',\n            },\n            top:'10',\n            right:'20',\n        },\n        xAxis: [{\n            type: 'category',\n            boundaryGap: true,\n            axisLine:{\n                lineStyle:{color:'#fff'}    // x轴坐标轴颜色\n            },\n            axisTick:{\n                lineStyle:{color:'#fff'}    // x轴刻度的颜色\n            },\n            axisLabel:{\n                color:'#555',\n                rotate:'20',\n                interval:6,\n                formatter:function(value){\n                    var res=value;\n                    if(res.length>10){\n                        res = res.substring(0, 9) + \"..\";\n                    }\n                    return res;\n                }\n            },\n            data: dataArray.categories\n        },\n            {\n                type: 'category',\n                boundaryGap: true,\n                axisLine:{\n                    lineStyle:{color:'#fff'}    // x轴坐标轴颜色\n                },\n                axisTick:{\n                    lineStyle:{color:'#fff'}    // x轴刻度的颜色\n                },\n                data:dataArray.categories,\n                show:false\n            }\n        ],\n        yAxis: [{\n            type: 'value',\n            scale: true,\n            name:dataArray.yAxisName,\n            min: 0,\n            boundaryGap: [0.1, 0.2],\n            splitLine: {\n                show: true,\n                lineStyle: {\n                    color:'#007fff'\n                }\n            },\n            axisLabel:{\n                color:'#555',\n            },\n            axisLine:{\n                lineStyle:{color:'#fff'},\n                // show:false\n            },\n            axisTick: {\n                lineStyle:{color:'#007fff'}\n            }\n        },\n            {\n                type: 'value',\n                scale: true,\n                // name: '模拟网格',\n                max: 100,\n                min: 0,\n                boundaryGap: 0,\n                splitLine: {\n                    show: false,\n                },\n                axisLabel:{\n                    show:false\n                },\n                axisLine:{\n                    lineStyle:{color:'#fff'}    // y轴坐标轴颜色\n                },\n                axisTick:{\n                    show:false\n                },\n            }],\n        series: [{   //网格\n            // name: dataArray.legendData,\n            type: 'bar',\n            xAxisIndex: 1,\n            yAxisIndex: 1,\n            barGap: '-100%',\n            barCategoryGap: '0%',\n            itemStyle: {\n                normal: {\n                    color: 'rgba(0,0,0,0)',\n                    borderRightWidth: '1',\n                    borderColor: '#007fff'\n                }\n            },\n            data:dataArray.wangge,\n        },\n            {\n                name: dataArray.legendData,\n                type: 'line',\n                smooth: true,//折线平滑参数\n                showAllSymbol: true,\n                symbol:'circle',\n                symbolSize: 0,\n                itemStyle: {\n                    normal: {\n                        color:'#000',\n                    }\n                },\n                lineStyle:{\n                    shadowColor: '#fff',\n                    shadowBlur: 8,\n                    shadowOffsetX:'3',\n                    shadowOffsetY:'4'\n                },\n                markPoint: {\n                    data: [{name: '峰值',\n                        type:'max',\n                        label: {\n                            normal: {\n                                position: 'top',\n                                formatter: function(params){\n                                    var xAxisCategories=dataArray.categories[params.data.coord[0]];//坐标点获取x轴类目名称\n                                    return params.name+ ':'+params.value+'次'+'（'+xAxisCategories+''+'）';\n                                },\n                                background:'#ddd'\n                            }\n                        }\n                    }],\n                    symbol:'pin',\n                    symbolSize:15,\n                    symbolOffset:[0,-6]\n                },\n                data:dataArray.yAxisData,\n                animationDurationUpdate: function (idx) {\n                    return idx * 100;\n                },\n            }\n        ],\n        animationEasing: 'exponentialOut',\n        animationEasingUpdate:'exponentialOut'\n    };\n  \n    chartObj.hideLoading();\n    chartObj.setOption(option);\n}\n\n\n        \n        \n        \n        ","html":"","externalScripts":"","updaterUID":"bd-1044119663","theme":"","layout":"","viewCount":242,"userName":"brokencolor","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xGLwWQ9mZZ.png?v=1557293417738","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","markPoint","series-bar","series-line","title","tooltip"],"customTags":[],"updaterUserName":"brokencolor"}}