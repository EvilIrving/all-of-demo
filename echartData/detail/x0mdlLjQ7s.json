{"status":0,"data":{"cid":"x0mdlLjQ7s","authorUid":"bd-1711283719","authorUserName":"p***3","title":"江苏迁徙","description":"迁徙图，可切换地市","latestVersion":13,"alwaysLatest":1,"createTime":"2018-12-27T02:53:49.000Z","lastUpdateTime":"2018-12-27T02:53:49.000Z","auth":2,"uid":"bd-1711283719","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":13,"parentVersion":12,"echartsVersion":"4.2.0","versionCreateTime":"2019-01-08T01:55:19.000Z","code":"//var jiangsu = \"/asset/get/s/data-1545717074162-HoS4KynOn.json\";\nvar jiangsu = \"/asset/get/s/data-1528969864934-BJ-qchkWQ.json\";\n// $(function() {\n// var myChart = echarts.init(document.getElementById('echar'));\n$.get(jiangsu, function(tjJson) {\n    echarts.registerMap('jiangsu', tjJson);\n    myChart.setOption({\n        series: [{\n            type: 'map',\n            map: 'jiangsu'\n        }]\n    });\n\n    var geoCoordMap = {\n        '南京': [118.8062, 31.9208],\n        '无锡': [120.3442, 31.5527],\n        '徐州': [117.5208, 34.3268],\n        '常州': [119.4543, 31.5582],\n        '苏州': [120.6519, 31.3989],\n        '南通': [121.1023, 32.1625],\n        '连云港': [119.1248, 34.552],\n        '淮安': [118.927, 33.4039],\n        '盐城': [120.2234, 33.5577],\n        '扬州': [119.4653, 32.8162],\n        '镇江': [119.4763, 31.9702],\n        '泰州': [120.0586, 32.5525],\n        '宿迁': [118.5535, 33.7775],\n    };\n\n    var goData = [{\n            name: '苏州',\n            value: 32689\n        },{\n            name: '徐州',\n            value: 24084\n        },{\n            name: '宿迁',\n            value: 20878\n        },{\n            name: '扬州',\n            value: 18907\n        },{\n            name: '淮安',\n            value: 18755\n        },{\n            name: '常州',\n            value: 18544\n        },{\n            name: '镇江',\n            value: 17152\n        },{\n            name: '南通',\n            value: 16921\n        },{\n            name: '无锡',\n            value: 15592\n        },\n        {\n            name: '盐城',\n            value: 15189\n        },\n        {\n            name: '连云港',\n            value: 13950\n        },{\n            name: '泰州',\n            value: 10870\n        }\n    ];\n    var goTotal=0;//计算总人数\n    goData.forEach(function(item,i){\n        goTotal+=item.value;\n    })\n    //值控制圆点大小\n    var backData = [{\n        name: '常州',\n        value: 75\n    }, {\n        name: '南通',\n        value: 95\n    }];\n\n    var planePath = 'arrow';\n\n    var convertData = function(name, data) {\n        var res = [];\n        for (var i = 0; i < data.length; i++) {\n            var fromCoord = geoCoordMap[name];\n            var toCoord = geoCoordMap[data[i].name];\n            if (fromCoord && toCoord) {\n                res.push({\n                    //对换即可调整方向\n                    coords: [fromCoord, toCoord]\n                });\n            }\n        }\n        return res;\n    };\n    var series = [];\n    [\n        ['南京', goData],\n       // ['徐州', backData],\n\n    ].forEach(function(item, i) {\n        series.push({\n            name: item[0],\n            type: 'lines',\n            zlevel: 2,\n            //线特效配置\n            effect: {\n                show: true,\n                period: 6,\n                trailLength: 0.1,\n                symbol: planePath, //标记类型\n                symbolSize: 10\n            },\n            lineStyle: {\n                normal: {\n                    width: 1,\n                    opacity: 0.4,\n                    curveness: 0.2, //弧线角度\n                    color: '#9B2428'\n                }\n            },\n            data: convertData(item[0], item[1])\n        }, {  //终点\n            name: item[0],\n            type: 'scatter',\n            coordinateSystem: 'geo',\n            zlevel: 2,\n            label: {\n                normal: {\n                    show: true,\n                    color: '#9B2428',\n                    position: 'right',\n                    formatter: '{b}'\n                }\n            },\n            symbol: 'circle',\n            //圆点大小\n            symbolSize: function(val) {\n                return val[2]*100 / goTotal;\n            },\n            itemStyle: {\n                normal: {\n                    show: true\n                }\n            },\n            data: item[1].map(function(dataItem) {\n                console.log(dataItem)\n                return {\n                    name: dataItem.name,\n                    value: geoCoordMap[dataItem.name].concat([dataItem.value])\n                };\n            })\n\n        }, {//起点\n            name: 'item[0]',\n            type: 'scatter',\n            coordinateSystem: 'geo',\n            zlevel: 2,\n            label: {\n                normal: {\n                    show: true,\n                    position: 'right',\n                    formatter: '{b}'\n                }\n            },\n            symbolSize: function(val) {\n                return 25;\n            },\n            symbol: 'circle',\n\n            itemStyle: {\n                normal: {\n                    show: true\n                }\n            },\n            data: [{\n                name: item[0],\n                value: geoCoordMap[item[0]].concat([100])\n            }]\n\n        })\n\n    });\n\n\n    option = {\n        backgroundColor: '#FDF7F2',\n        title: {\n            text: '江苏迁徙',\n            subtext: '',\n            left: 'center',\n            textStyle: {\n                color: '#9B2428'\n            }\n        },\n        legend: {\n            orient: 'vertical',\n            top: 'bottom',\n            left: 'right',\n            data: ['南京', '徐州'],\n            textStyle: {\n                color: '#9B2428'\n            },\n            selectedMode: 'single'\n        },\n        tooltip: {\n            trigger: 'item',\n            formatter: \"{b}\"\n        },\n        //线颜色及飞行轨道颜色\n        visualMap: {\n            show: false,\n            min: 0,\n            max: 100,\n            color: ['#9B2428']\n        },\n        //地图相关设置\n        geo: {\n            map: 'jiangsu',\n            //视角缩放比例\n            zoom: 1,\n            //显示文本样式\n            label: {\n                normal: {\n                    show: false,\n                    textStyle: {\n                        color: '#9B2428'\n                    }\n                },\n                emphasis: {\n                    textStyle: {\n                        color: '#9B2428'\n                    }\n                }\n            },\n            //鼠标缩放和平移\n            roam: true,\n            itemStyle: {\n                normal: {\n                    //          \tcolor: '#ddd',\n                    borderColor: '#D14424',\n                    borderWidth: 1,\n                    areaColor: {\n                        type: 'radial',\n                        x: 0.5,\n                        y: 0.5,\n                        r: 0.8,\n                        colorStops: [{\n                            offset: 0,\n                            color: '#FDF0B8' // 0% 处的颜色\n                        }, {\n                            offset: 1,\n                            color: '#FDF0B8' // 100% 处的颜色\n                        }],\n                        globalCoord: false // 缺省为 false\n                    },\n                    shadowColor: '#E9777B',\n                    // shadowColor: 'rgba(255, 255, 255, 1)',\n                    shadowOffsetX: -1,\n                    shadowOffsetY: 1,\n                    shadowBlur: 5\n                },\n                emphasis: {\n                    areaColor: '#D55E2C',\n                    borderWidth: 0\n                }\n            }\n        },\n        series: series\n    };\n    myChart.setOption(option);\n})\n// })","html":"","externalScripts":"","updaterUID":"bd-1711283719","theme":"","layout":"","viewCount":1772,"userName":"p***3","commentCount":1,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x0mdlLjQ7s.png?v=1546912519357","isCustomThumbnail":0,"builtinTags":["category-work","geo","legend","series-lines","series-scatter","title","tooltip","visualMap"],"customTags":[],"updaterUserName":"p***3"}}