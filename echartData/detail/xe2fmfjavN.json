{"status":0,"data":{"cid":"xe2fmfjavN","authorUid":"obd-ol2fTna3SRj9iAHbPE8FHq2s0B6vf0V","authorUserName":"q***l","title":"蓝天日历","description":"","latestVersion":2,"alwaysLatest":1,"createTime":"2020-12-01T19:34:19.000Z","lastUpdateTime":"2020-12-01T19:34:19.000Z","auth":2,"uid":"obd-ol2fTna3SRj9iAHbPE8FHq2s0B6vf0V","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":2,"parentVersion":1,"echartsVersion":"4.8.0","versionCreateTime":"2020-12-01T19:37:06.000Z","code":"var cellSize = [70, 40];\r\nvar pieRadius = 15;//圆环半径设置\r\n\r\nfunction getVirtulData() {\r\n    var date = +echarts.number.parseDate('2017-02-01');\r\n    var end = +echarts.number.parseDate('2017-03-01');\r\n    var dayTime = 3600 * 24 * 1000;\r\n    var data = [];\r\n    for (var time = date; time < end; time += dayTime) {\r\n        data.push([\r\n            echarts.format.formatTime('yyyy-MM-dd', time),\r\n            Math.floor(Math.random() * 10000)\r\n        ]);\r\n    }\r\n    return data;\r\n}\r\n\r\nfunction getPieSeries(scatterData, chart) {\r\n    return echarts.util.map(scatterData, function (item, index) {\r\n        //确认饼图中心\r\n        var center = chart.convertToPixel('calendar', item);\r\n        //步骤一：通过scatterData获取到realValue数组\r\n        //----此处省略与后端接口连接的代码----\r\n        var thisDate=echarts.format.formatTime('d', item[0]);\r\n        //thisDate为当前item对应的日期\r\n        var realType=[0,0,1,2,3,4,5,5,4,3,2,1,0,0,0,1,2,3,4,5,5,4,3,4,5,5,4,3];\r\n        var realvalue=[100,100,101,102,103,104,5,5,4,3,2,1,0,0,0,1,2,3,4,5,5,4,3,4,5,5,4,3];\r\n        //realValue为获取的存放真实数值的数组\r\n        //realType为获取的存放真实数值对应的类别的数组\r\n        //realType与realValue长度应与scatterData的长度相同。\r\n        //步骤二：根据realValue数组来输入值\r\n        var inputData=[{name: '优', value: 100}];//设置一个初始值以防出错\r\n        \r\n        var matchIndex=thisDate-1;//当前日期对应的当前类别索引\r\n        console.log()\r\nswitch (realType[matchIndex]) {\r\ncase 0:inputData=[{name: '优',value: realvalue[matchIndex]}];break;\r\ncase 1:inputData=[{name: '良',value: realvalue[matchIndex]}];break;\r\ncase 2:inputData=[{name: '轻度',value: realvalue[matchIndex]}];break;\r\ncase 3:inputData=[{name: '中度',value: realvalue[matchIndex]}];break;\r\ncase 4:inputData=[{name: '重度',value: realvalue[matchIndex]}];break;\r\ncase 5:inputData=[{name: ' 严重',value: realvalue[matchIndex]}];break;\r\ndefault :break;\r\n}\r\n        return {\r\n            id: index + 'pie',\r\n            type: 'pie',\r\n            center: center,\r\n            label: {\r\n                normal: {\r\n                    formatter: '',\r\n                    position: 'inside'\r\n                }\r\n            },\r\n            radius: pieRadius,\r\n            data: inputData\r\n        };\r\n    });\r\n}\r\n\r\nfunction getPieSeriesUpdate(scatterData, chart) {\r\n    return echarts.util.map(scatterData, function (item, index) {\r\n        var center = chart.convertToPixel('calendar', item);\r\n        return {\r\n            id: index + 'pie',\r\n            center: center\r\n        };\r\n    });\r\n}\r\n\r\nvar scatterData = getVirtulData();\r\n\r\noption = {\r\n    tooltip : {},\r\n    legend: {\r\n        data: [{\r\n    name: '优',\r\n    // 强制设置图形为圆。\r\n    icon: 'circle',\r\n    // 设置文本为红色\r\n    textStyle: {\r\n        color: 'white'\r\n    }\r\n},{\r\n    name: '良',\r\n    // 强制设置图形为圆。\r\n    icon: 'circle',\r\n    // 设置文本为红色\r\n    textStyle: {\r\n        color: 'white'\r\n    }\r\n},{\r\n    name: '轻度',\r\n    // 强制设置图形为圆。\r\n    icon: 'circle',\r\n    // 设置文本为红色\r\n    textStyle: {\r\n        color: 'white'\r\n    }\r\n},{\r\n    name: '中度',\r\n    // 强制设置图形为圆。\r\n    icon: 'circle',\r\n    // 设置文本为红色\r\n    textStyle: {\r\n        color: 'white'\r\n    }\r\n},{\r\n    name: '重度',\r\n    // 强制设置图形为圆。\r\n    icon: 'circle',\r\n    // 设置文本为红色\r\n    textStyle: {\r\n        color: 'white'\r\n    }\r\n},{\r\n    name: '严重',\r\n    // 强制设置图形为圆。\r\n    icon: 'circle',\r\n    // 设置文本为红色\r\n    textStyle: {\r\n        color: 'white'\r\n    }\r\n},],\r\n        bottom: 20\r\n    },\r\n    calendar: {\r\n        top: 'middle',\r\n        left: 'center',\r\n        orient: 'vertical',\r\n        cellSize: cellSize,\r\n        yearLabel: {\r\n            show: false,\r\n            textStyle: {\r\n                fontSize: 30\r\n            }\r\n        },\r\n        dayLabel: {\r\n            margin: 20,\r\n            firstDay: 1,\r\n            nameMap: ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六']\r\n        },\r\n        monthLabel: {\r\n            show: false\r\n        },\r\n        range: ['2017-02']\r\n    },\r\n    series: [{\r\n        id: 'label',\r\n        type: 'scatter',\r\n        coordinateSystem: 'calendar',\r\n        symbolSize: 1,\r\n        label: {\r\n            normal: {\r\n                show: true,\r\n                formatter: function (params) {\r\n                    return echarts.format.formatTime('dd', params.value[0]);\r\n                },\r\n                // offset: [-cellSize[0] / 2 + 10, -cellSize[1] / 2 + 10],\r\n                textStyle: {\r\n                    color: '#000',\r\n                    fontSize: 14\r\n                }\r\n            }\r\n        },\r\n        data: scatterData\r\n    }]\r\n};\r\n\r\nvar pieInitialized;\r\nsetTimeout(function () {\r\n    pieInitialized = true;\r\n    myChart.setOption({\r\n        series: getPieSeries(scatterData, myChart)\r\n    });\r\n}, 10);\r\n\r\napp.onresize = function () {\r\n    if (pieInitialized) {\r\n        myChart.setOption({\r\n            series: getPieSeriesUpdate(scatterData, myChart)\r\n        });\r\n    }\r\n};\r\n","html":"","externalScripts":"","updaterUID":"obd-ol2fTna3SRj9iAHbPE8FHq2s0B6vf0V","theme":"","layout":"","viewCount":244,"userName":"q***l","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xe2fmfjavN.png?v=1606851426338","isCustomThumbnail":0,"builtinTags":["calendar","category-work","legend","series-pie","series-scatter","tooltip"],"customTags":[],"updaterUserName":"q***l"}}