{"status":0,"data":{"cid":"xFBazU7Q4l","authorUid":"obd-o2rThgBTGasPAjmoA3qsw1XcyG0pX66","authorUserName":"薛***1","title":"中国地图-热力图","description":"热力图 散点图 数据多重处理","latestVersion":1,"alwaysLatest":1,"createTime":"2020-10-22T06:51:01.000Z","lastUpdateTime":"2020-10-22T06:51:01.000Z","auth":2,"uid":"obd-o2rThgBTGasPAjmoA3qsw1XcyG0pX66","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.8.0","versionCreateTime":"2020-10-22T06:51:01.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1603348199465-jUA2uMD54.json\";\n\nvar data = [{\n    \"name\": \"天津市\",\n    \"value\": [185, 88, 34, 20, 34]\n}, {\n    \"name\": \"江苏省\",\n    \"value\": [875, 636, 659, 37, 659]\n}, {\n    \"name\": \"海南省\",\n    \"value\": [134, 102, 148, 14, 148]\n}, {\n    \"name\": \"湖南省\",\n    \"value\": [857, 559, 591, 47, 591]\n}, {\n    \"name\": \"内蒙古自治区\",\n    \"value\": [279, 211, 192, 21, 192]\n}, {\n    \"name\": \"上海市\",\n    \"value\": [282, 190, 182, 14, 182]\n}, {\n    \"name\": \"山西省\",\n    \"value\": [441, 342, 321, 25, 321]\n}, {\n    \"name\": \"重庆市\",\n    \"value\": [671, 441, 424, 47, 424]\n}, {\n    \"name\": \"湖北省\",\n    \"value\": [1011, 771, 750, 59, 750]\n}, {\n    \"name\": \"陕西省\",\n    \"value\": [323, 212, 207, 19, 207]\n}, {\n    \"name\": \"西藏自治区\",\n    \"value\": [0, 0, 0, 0, 1]\n}, {\n    \"name\": \"浙江省\",\n    \"value\": [312, 217, 213, 18, 213]\n}, {\n    \"name\": \"山东省\",\n    \"value\": [1852, 1380, 1351, 90, 1351]\n}, {\n    \"name\": \"北京市\",\n    \"value\": [183, 121, 113, 15, 113]\n}, {\n    \"name\": \"安徽省\",\n    \"value\": [636, 460, 441, 33, 441]\n}, {\n    \"name\": \"广东省\",\n    \"value\": [1299, 784, 819, 83, 819]\n}, {\n    \"name\": \"甘肃省\",\n    \"value\": [206, 132, 132, 12, 132]\n}, {\n    \"name\": \"宁夏回族自治区\",\n    \"value\": [18, 12, 13, 1, 13]\n}, {\n    \"name\": \"福建省\",\n    \"value\": [577, 392, 414, 33, 414]\n}, {\n    \"name\": \"青海省\",\n    \"value\": [26, 13, 11, 2, 11]\n}, {\n    \"name\": \"河南省\",\n    \"value\": [1089, 813, 794, 58, 794]\n}, {\n    \"name\": \"新疆维吾尔自治区\",\n    \"value\": [0, 0, 0, 0, 0]\n}, {\n    \"name\": \"云南省\",\n    \"value\": [231, 151, 143, 16, 143]\n}, {\n    \"name\": \"黑龙江省\",\n    \"value\": [518, 426, 401, 27, 401]\n}, {\n    \"name\": \"辽宁省\",\n    \"value\": [1270, 810, 792, 52, 792]\n}, {\n    \"name\": \"贵州省\",\n    \"value\": [337, 251, 266, 21, 266]\n}, {\n    \"name\": \"广西壮族自治区\",\n    \"value\": [262, 154, 174, 13, 174]\n}, {\n    \"name\": \"四川省\",\n    \"value\": [1046, 677, 643, 60, 643]\n}, {\n    \"name\": \"河北省\",\n    \"value\": [1058, 740, 724, 50, 724]\n}, {\n    \"name\": \"江西省\",\n    \"value\": [280, 191, 214, 17, 214]\n}, {\n    \"name\": \"吉林省\",\n    \"value\": [155, 124, 118, 7, 118]\n}]\nvar resp = [{\n    \"name\": \"山东省\",\n    \"value\": 1351\n}, {\n    \"name\": \"广东省\",\n    \"value\": 819\n}, {\n    \"name\": \"河南省\",\n    \"value\": 794\n}, {\n    \"name\": \"辽宁省\",\n    \"value\": 792\n}, {\n    \"name\": \"湖北省\",\n    \"value\": 750\n}, {\n    \"name\": \"河北省\",\n    \"value\": 724\n}, {\n    \"name\": \"江苏省\",\n    \"value\": 659\n}, {\n    \"name\": \"四川省\",\n    \"value\": 643\n}, {\n    \"name\": \"湖南省\",\n    \"value\": 591\n}, {\n    \"name\": \"安徽省\",\n    \"value\": 441\n}, {\n    \"name\": \"重庆市\",\n    \"value\": 424\n}, {\n    \"name\": \"福建省\",\n    \"value\": 414\n}, {\n    \"name\": \"黑龙江省\",\n    \"value\": 401\n}, {\n    \"name\": \"山西省\",\n    \"value\": 321\n}, {\n    \"name\": \"贵州省\",\n    \"value\": 266\n}, {\n    \"name\": \"江西省\",\n    \"value\": 214\n}, {\n    \"name\": \"浙江省\",\n    \"value\": 213\n}, {\n    \"name\": \"陕西省\",\n    \"value\": 207\n}, {\n    \"name\": \"内蒙古自治区\",\n    \"value\": 192\n}, {\n    \"name\": \"上海市\",\n    \"value\": 182\n}, {\n    \"name\": \"广西壮族自治区\",\n    \"value\": 174\n}, {\n    \"name\": \"海南省\",\n    \"value\": 148\n}, {\n    \"name\": \"云南省\",\n    \"value\": 143\n}, {\n    \"name\": \"甘肃省\",\n    \"value\": 132\n}, {\n    \"name\": \"吉林省\",\n    \"value\": 118\n}, {\n    \"name\": \"北京市\",\n    \"value\": 113\n}, {\n    \"name\": \"天津市\",\n    \"value\": 84\n}, {\n    \"name\": \"宁夏回族自治区\",\n    \"value\": 13\n}, {\n    \"name\": \"青海省\",\n    \"value\": 11\n}, {\n    \"name\": \"西藏自治区\",\n    \"value\": 1\n}, {\n    \"name\": \"新疆维吾尔自治区\",\n    \"value\": 0\n}]\nvar provinceCoordMap = {\n    '上海': [121.4648, 31.2891],\n    '山西': [112.549248, 37.857014],\n    '新疆': [84.738775, 40.791562],\n    '甘肃': [103.5901, 36.3043],\n    '内蒙古': [110.3467, 41.4899],\n    '北京': [116.4551, 40.2539],\n    '广西': [108.80244, 23.776873],\n    '江西': [115.278288, 27.937219],\n    '合肥': [117.29, 32.0581],\n    '陕西': [108.4131, 34.8706],\n    '黑龙江': [128.569752, 47.108444],\n    '天津': [117.4219, 39.4189],\n    '安徽': [117.0123, 32.2121],\n    '四川': [101.848261, 30.646339],\n    '西藏': [88.786181, 30.963961],\n    '云南': [101.811467, 24.956574],\n    '湖南': [111.598829, 28.328652],\n    '青海': [96.8038, 36.2207],\n    '贵州': [106.6992, 26.7682],\n    '重庆': [107.293861, 29.719279],\n    '吉林': [125.8154, 43.6584],\n    '香港': [115.1215, 22.1235],\n    '澳门': [112.1211, 22.2111],\n    '台湾省': [120.1111, 23.2435],\n    '湖北': [112.077158, 30.995665],\n    '河南': [113.475353, 34.233691],\n    '江苏': [119.546461, 32.223755],\n    '山东': [117.485964, 36.106822],\n    '福建': [118.001088, 26.224563],\n    '浙江': [119.693639, 29.397571],\n    '河北': [114.983931, 38.168723],\n    '广东': [113.144202, 22.825228],\n    '辽宁': [122.82118, 41.43163],\n    '海南': [109.611921, 19.093147],\n    '宁夏': [105.969256, 37.497501],\n\n    '上海市': [121.4648, 31.2891],\n    '山西省': [112.549248, 37.857014],\n    '新疆维吾尔自治区': [84.738775, 40.791562],\n    '甘肃省': [103.5901, 36.3043],\n    '内蒙古自治区': [110.3467, 41.4899],\n    '北京市': [116.4551, 40.2539],\n    '广西壮族自治区': [108.80244, 23.776873],\n    '江西省': [115.278288, 27.937219],\n    '陕西省': [108.4131, 34.8706],\n    '黑龙江省': [128.569752, 47.108444],\n    '天津市': [117.4219, 39.4189],\n    '安徽省': [117.0123, 32.2121],\n    '四川省': [101.848261, 30.646339],\n    '西藏自治区': [88.786181, 30.963961],\n    '云南省': [101.811467, 24.956574],\n    '湖南省': [111.598829, 28.328652],\n    '青海省': [96.8038, 36.2207],\n    '贵州省': [106.6992, 26.7682],\n    '重庆市': [107.293861, 29.719279],\n    '吉林省': [125.8154, 43.6584],\n    '香港特别行政区': [115.1215, 22.1235],\n    '澳门特别行政区': [112.1211, 22.2111],\n    '台湾': [120.1111, 23.2435],\n    '湖北省': [112.077158, 30.995665],\n    '河南省': [113.475353, 34.233691],\n    '江苏省': [119.546461, 32.223755],\n    '山东省': [117.485964, 36.106822],\n    '福建省': [118.001088, 26.224563],\n    '浙江省': [119.693639, 29.397571],\n    '河北省': [114.983931, 38.168723],\n    '广东省': [113.144202, 22.825228],\n    '辽宁省': [122.82118, 41.43163],\n    '海南省': [109.611921, 19.093147],\n    '宁夏回族自治区': [105.969256, 37.497501]\n}\nvar provinceNameMap = [{\n        en: 'anhui',\n        cn: '安徽省',\n        cn_short: '安徽'\n    },\n    {\n        en: 'aomen',\n        cn: '澳门',\n        cn_short: '澳门'\n    },\n    {\n        en: 'beijing',\n        cn: '北京市',\n        cn_short: '北京'\n    },\n    {\n        en: 'chongqing',\n        cn: '重庆市',\n        cn_short: '重庆'\n    },\n    {\n        en: 'fujian',\n        cn: '福建省',\n        cn_short: '福建'\n    },\n    {\n        en: 'gansu',\n        cn: '甘肃省',\n        cn_short: '甘肃'\n    },\n    {\n        en: 'guangdong',\n        cn: '广东省',\n        cn_short: '广东'\n    },\n    {\n        en: 'guangxi',\n        cn: '广西壮族自治区',\n        cn_short: '广西'\n    },\n    {\n        en: 'guizhou',\n        cn: '贵州省',\n        cn_short: '贵州'\n    },\n    {\n        en: 'hainan',\n        cn: '海南省',\n        cn_short: '海南'\n    },\n    {\n        en: 'hebei',\n        cn: '河北省',\n        cn_short: '河北'\n    },\n    {\n        en: 'heilongjiang',\n        cn: '黑龙江省',\n        cn_short: '黑龙江'\n    },\n    {\n        en: 'henan',\n        cn: '河南省',\n        cn_short: '河南'\n    },\n    {\n        en: 'hubei',\n        cn: '湖北省',\n        cn_short: '湖北'\n    },\n    {\n        en: 'hunan',\n        cn: '湖南省',\n        cn_short: '湖南'\n    },\n    {\n        en: 'jiangsu',\n        cn: '江苏省',\n        cn_short: '江苏'\n    },\n    {\n        en: 'jiangxi',\n        cn: '江西省',\n        cn_short: '江西'\n    },\n    {\n        en: 'jilin',\n        cn: '吉林省',\n        cn_short: '吉林'\n    },\n    {\n        en: 'liaoning',\n        cn: '辽宁省',\n        cn_short: '辽宁'\n    },\n    {\n        en: 'neimenggu',\n        cn: '内蒙古自治区',\n        cn_short: '内蒙古'\n    },\n    {\n        en: 'ningxia',\n        cn: '宁夏回族自治区',\n        cn_short: '宁夏'\n    },\n    {\n        en: 'qinghai',\n        cn: '青海省',\n        cn_short: '青海'\n    },\n    {\n        en: 'shandong',\n        cn: '山东省',\n        cn_short: '山东'\n    },\n    {\n        en: 'shanghai',\n        cn: '上海市',\n        cn_short: '上海'\n    },\n    {\n        en: 'shaanxi',\n        cn: '陕西省',\n        cn_short: '陕西'\n    },\n    {\n        en: 'shanxi',\n        cn: '山西省',\n        cn_short: '山西'\n    },\n    {\n        en: 'sichuan',\n        cn: '四川省',\n        cn_short: '四川'\n    },\n    {\n        en: 'taiwan',\n        cn: '台湾',\n        cn_short: '台湾'\n    },\n    {\n        en: 'tianjin',\n        cn: '天津市',\n        cn_short: '天津'\n    },\n    {\n        en: 'xianggang',\n        cn: '香港',\n        cn_short: '香港'\n    },\n    {\n        en: 'xinjiang',\n        cn: '新疆维吾尔自治区',\n        cn_short: '新疆'\n    },\n    {\n        en: 'xizang',\n        cn: '西藏自治区',\n        cn_short: '西藏'\n    },\n    {\n        en: 'yunnan',\n        cn: '云南省',\n        cn_short: '云南'\n    },\n    {\n        en: 'zhejiang',\n        cn: '浙江省',\n        cn_short: '浙江'\n    }\n]\nvar top1 = []\nvar res = []\nvar numlist = []\nvar max = 0\nvar lastMonthTop10 = []\nvar hotmap = []\nresp.forEach(ele => {\n    var obj = {}\n    var name_show = provinceNameMap.filter((item) => item.cn === ele.name)[0] ? provinceNameMap.filter((item) => item.cn === ele.name)[0].cn_short : ele.name\n    obj = {\n        name: name_show,\n        value: ele.value\n    }\n    numlist.push(ele.value)\n    res.push(obj)\n})\nnumlist.sort(function(a, b) {\n    return a - b\n}) // 排序\nmax = numlist[numlist.length - 1] // 最大值\nlastMonthTop10 = res\nhotmap = res\n\nfunction convertData(data) {\n    var res = []\n    for (var i = 0; i < data.length; i++) {\n        var geoCoord = provinceCoordMap[data[i].name]\n        if (geoCoord) {\n            res.push({\n                name: data[i].name,\n                value: geoCoord.concat(data[i].value[1])\n            })\n        }\n    }\n    return res\n}\n\nfunction getprovinceName(type, oldname) {\n    let name\n    let res\n    switch (type) {\n        case 'cn':\n            res = provinceNameMap.filter((item) => item.en === oldname)[0]\n            name = res.cn\n            break;\n        case 'cn_short':\n            res = provinceNameMap.filter((item) => item.cn === oldname)[0]\n            name = res.cn_short\n            break;\n        case 'en':\n            res = provinceNameMap.filter((item) => item.cn === oldname)[0]\n            name = res.en\n            break;\n    }\n    return name\n}\nvar datares = data\ndatares = convertData(datares)\ndatares.sort(function(a, b) {\n    return b.value[2] - a.value[2]\n})\ntop1 = datares.slice(0, 1)\n$.getJSON(uploadedDataURL, function(geoJson) {\n    $('body').css({\n        'background': '#2a6d87',\n        'position': 'fixed',\n        'top': 0,\n        'left': 0,\n        'width': '100%',\n        'height': '100%',\n        'background-size': 'cover',\n        '-webkit-background-size': 'cover',\n        '-o-background-size': 'cover',\n        'background-position': 'center 0',\n        //'writing-mode': 'vertical-rl'\n    });\n\n    echarts.registerMap('china', geoJson);\n    option = {\n        title: {\n            text: '中国地图-热力图',\n            textStyle: {\n                color: '#fff',\n                fontSize: 25\n            }\n        },\n        tooltip: {\n            trigger: 'item',\n            formatter: function(params) {\n                if (params.seriesType === 'map') {\n                    let tooltip_show = data.filter((item) => getprovinceName('cn_short', item.name) === params.name)\n                    if (tooltip_show.length > 0) {\n                        tooltip_show = tooltip_show[0]\n                        return '今日' + tooltip_show.name + ': <br>' + '数值1：' + tooltip_show.value[0] + '<br>' + '数值2：' + tooltip_show.value[1] + '<br>' + '数值3：' + tooltip_show.value[2] + '<br>' + '数值4：' + tooltip_show.value[3]\n                    } else {\n                        return '今日' + params.name + ': <br>数值1：暂无 <br>数值2：暂无<br>数值3：暂无<br>数值4：暂无'\n                    }\n                }\n            }\n        },\n        geo: {\n            map: 'china',\n            label: {\n                normal: {\n                    show: false, // 是否显示对应地名\n                    textStyle: {\n                        color: '#fff'\n                    }\n                },\n                emphasis: {\n                    show: true,\n                    textStyle: {\n                        color: '#fff'\n                    }\n                }\n            },\n            roam: false, // 是否开启鼠标缩放和平移漫游\n            zoom: 1.2,\n            aspectScale: 0.85, // 地图长宽比例\n            itemStyle: {\n                normal: {\n                    // areaColor: '#012a74',\n                    areaColor: {\n                        type: 'radial',\n                        x: 0.5,\n                        y: 0.5,\n                        r: 0.8,\n                        colorStops: [{\n                            offset: 0,\n                            color: 'rgba(147, 235, 248, 0)' // 0% 处的颜色\n                        }, {\n                            offset: 1,\n                            color: 'rgba(147, 235, 248, .2)' // 100% 处的颜色\n                        }],\n                        globalCoord: false // 缺省为 false\n                    },\n                    borderColor: '#00ebff',\n                    shadowColor: 'rgba(255, 255, 255, .5)',\n                    shadowOffsetX: -2,\n                    shadowOffsetY: -2,\n                    shadowBlur: 15\n                },\n                emphasis: {\n                    areaColor: '#389BB7'\n                }\n            }\n        },\n        visualMap: {\n            min: 0,\n            max: max || 5,\n            left: 'left',\n            top: 'bottom',\n            itemWidth: 15,\n            itemHeight: 100,\n            text: ['高', '低'],\n            calculable: true,\n            seriesIndex: '0',\n            show: true,\n            inRange: {\n                color: [\n                    '#1488CC', '#2B32B2', '#ba00ff', '#ff0066'\n                ],\n                colorAlpha: 0.8\n            },\n            textStyle: {\n                color: '#fff'\n            }\n        },\n        series: [{\n                type: 'map',\n                map: 'china',\n                zoom: 1.2,\n                aspectScale: 0.85,\n                label: {\n                    normal: {\n                        show: false\n                    },\n                    emphasis: {\n                        show: true,\n                        textStyle: {\n                            color: '#fff'\n                        }\n                    }\n                },\n                itemStyle: {\n                    normal: {\n                        areaColor: {\n                            type: 'radial',\n                            x: 0.5,\n                            y: 0.5,\n                            r: 0.8,\n                            colorStops: [{\n                                offset: 1,\n                                color: 'rgba(147, 235, 248, 0)' // 0% 处的颜色\n                            }, {\n                                offset: 0,\n                                color: 'rgba(147, 235, 248, .5)' // 100% 处的颜色\n                            }],\n                            globalCoord: false // 缺省为 false\n                        },\n                        borderColor: 'rgba(93, 255, 249, .6)',\n                        shadowColor: 'rgba(255, 255, 255, .5)',\n                        shadowOffsetX: -2,\n                        shadowOffsetY: -2,\n                        shadowBlur: 20\n                    },\n                    emphasis: {\n                        areaColor: '#389BB7'\n                    }\n                }\n            },\n            {\n                // 区域热力值\n                name: '样式',\n                type: 'map',\n                map: 'china',\n                zoom: 1.2,\n                aspectScale: 0.85, // 地图长宽比例\n                label: {\n                    normal: {\n                        show: false\n                    },\n                    emphasis: {\n                        show: true,\n                        textStyle: {\n                            color: '#fff'\n                        }\n                    }\n                },\n                itemStyle: {\n                    normal: {\n                        areaColor: 'rgba(93, 255, 249, 0)',\n                        borderColor: '#00ebff'\n                    },\n                    emphasis: {\n                        areaColor: '#389BB7'\n                    }\n                },\n                data: hotmap\n            },\n            {\n                type: 'effectScatter',\n                coordinateSystem: 'geo',\n                zlevel: 2,\n                rippleEffect: {\n                    brushType: 'stroke',\n                    scale: 4, // 波纹缩放比例\n                    period: 3 // 速度\n                },\n                itemStyle: {\n                    normal: {\n                        color: '#f4e925',\n                        shadowBlur: 10,\n                        shadowColor: '#f4e925'\n                    }\n                },\n                symbolSize: this.symbolSizeSmall || 10,\n                data: data.map(function(dataItem) {\n                    if (dataItem.value[1] > 0) {\n                        return {\n                            name: dataItem.name,\n                            // 经纬度 授权码 携入申请量 完成 待携转 今日携转量\n                            value: provinceCoordMap[dataItem.name].concat(dataItem.value)\n                        }\n                    }\n                }) || []\n            },\n            {\n                name: 'Top 1',\n                type: 'effectScatter',\n                coordinateSystem: 'geo',\n                data: top1,\n                symbolSize: this.symbolSizeBig || 20,\n                showEffectOn: 'render',\n                rippleEffect: {\n                    brushType: 'stroke'\n                },\n                hoverAnimation: true,\n                label: {\n                    normal: {\n                        formatter: '{b}',\n                        position: 'left',\n                        show: false\n                    }\n                },\n                itemStyle: {\n                    normal: {\n                        color: '#0cef70',\n                        shadowBlur: 10,\n                        shadowColor: '#0cef70'\n                    }\n                },\n                zlevel: 2\n            }\n        ]\n    };\n    myChart.setOption(option);\n});","html":"","externalScripts":"","updaterUID":"obd-o2rThgBTGasPAjmoA3qsw1XcyG0pX66","theme":"","layout":"","viewCount":463,"userName":"薛***1","commentCount":1,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xFBazU7Q4l.png?v=1603349461602","isCustomThumbnail":0,"builtinTags":["category-work","geo","series-effectScatter","series-map","title","tooltip","visualMap"],"customTags":[],"updaterUserName":"薛***1"}}