{"status":0,"data":{"cid":"xFVkSNEXea","authorUid":"obd-o2qqSzONRvLWuynWsOMrTyOBr-9wM6Q","authorUserName":"弖***","title":"成都市房价分布图","description":"展示成都是不同地区的房价分布图","latestVersion":3,"alwaysLatest":1,"createTime":"2020-12-22T15:29:55.000Z","lastUpdateTime":"2020-12-22T15:29:55.000Z","auth":2,"uid":"obd-o2qqSzONRvLWuynWsOMrTyOBr-9wM6Q","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":3,"parentVersion":2,"echartsVersion":"4.8.0","versionCreateTime":"2020-12-22T15:33:31.000Z","code":"//成都市地图，包含子区\nvar hzmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510100_full.json\";\n//都江堰市\nvar yhmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510181.json\";\n//彭州市\nvar xsmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510182.json\";\n//崇州市\nvar xhmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510184.json\";\n//温江区\nvar xcmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510115.json\";\n//郫都区\nvar tlmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510117.json\";\n//新都区\nvar scmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510114.json\";\n//青白江区\nvar lamap = \"https://geo.datav.aliyun.com/areas_v2/bound/510113.json\";\n//金堂县\nvar jgmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510121.json\";\n//龙泉驿区\nvar jdmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510112.json\";\n//成华区\nvar gsmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510108.json\";\n//金牛区\nvar fymap = \"https://geo.datav.aliyun.com/areas_v2/bound/510106.json\";\n//青羊区\nvar camap = \"https://geo.datav.aliyun.com/areas_v2/bound/510105.json\";\n//锦江区\nvar bjmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510104.json\";\n//武侯区\nvar whmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510107.json\";\n//双流区\nvar slmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510116.json\";\n//大邑县\nvar dyxmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510129.json\";\n//邛崃市\nvar qxsmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510183.json\";\n//蒲江县\nvar pjxmap = \"httpshttps://geo.datav.aliyun.com/areas_v2/bound/510131.json\";\n//新津区\nvar xjqmap = \"httpshttps://geo.datav.aliyun.com/areas_v2/bound/510118.json\";\n//简阳市\nvar jysmap = \"https://geo.datav.aliyun.com/areas_v2/bound/510185.json\";\n\n\nvar mapname = hzmap\nvar mapJson = [\n    {\n        name: \"简阳市\",\n        json: jysmap\n    },\n    {\n        name: \"新津区\",\n        json: xjqmap\n    },\n    {\n        name: \"蒲江县\",\n        json: pjxmap\n    },\n    {\n        name: \"邛崃市\",\n        json: qxsmap\n    },\n    {\n        name: \"大邑县\",\n        json: dyxmap\n    },\n    {\n        name: \"双流区\",\n        json: slmap\n    },\n    {\n        name: \"武侯区\",\n        json: whmap\n    },\n    {\n        name: \"锦江区\",\n        json: bjmap\n    },\n    {\n        name: \"青羊区\",\n        json: camap\n    },\n    {\n        name: \"金牛区\",\n        json: fymap\n    },\n    {\n        name: \"成华区\",\n        json: gsmap\n    },\n    {\n        name: \"龙泉驿区\",\n        json: jdmap\n    },\n    {\n        name: \"金堂县\",\n        json: jgmap\n    },\n    {\n        name: \"青白江区\",\n        json: lamap\n    },\n    {\n        name: \"新都区\",\n        json: scmap\n    },\n    {\n        name: \"郫都区\",\n        json: tlmap\n    },\n    {\n        name: \"温江区\",\n        json: xcmap\n    },\n    {\n        name: \"崇州市\",\n        json: xhmap\n    },\n    {\n        name: \"彭州市\",\n        json: xsmap\n    },\n    {\n        name: \"都江堰市\",\n        json: yhmap\n    }\n]\n\nvar mapDate = [{\n        name: '江干区',\n        value: [120.185, 30.274, 29999]\n    },\n    {\n        name: '拱墅区',\n        value: [120.182, 30.351, 29999]\n    },\n    {\n        name: '西湖区',\n        value: [120.091, 30.27, 29999]\n    },\n    {\n        name: '滨江区',\n        value: [120.21, 30.209, 29999]\n    },\n    {\n        name: '萧山区',\n        value: [120.254, 30.159, 29999]\n    },\n    {\n        name: '余杭区',\n        value: [120.295, 30.427, 29999]\n    },\n    {\n        name: '富阳区',\n        value: [119.956, 30.05, 29999]\n    },\n    {\n        name: '桐庐县',\n        value: [119.675, 29.784, 29999]\n    },\n    {\n        name: '淳安县',\n        value: [119.058, 29.613, 29999]\n    },\n    {\n        name: '建德市',\n        value: [119.28, 29.464, 29999]\n    },\n    {\n        name: '临安区',\n        value: [119.712, 30.227, 29999]\n    },\n    {\n        name: '钱塘新区',\n        value: [120.485, 30.284, 29999]\n    }\n];\n/**\n此版本通过设置geoindex && seriesIndex: [1] 属性来实现geo和map共存，来达到hover散点和区域显示tooltip的效果\n\n默认情况下，map series 会自己生成内部专用的 geo 组件。但是也可以用这个 geoIndex 指定一个 geo 组件。这样的话，map 和 其他 series（例如散点图）就可以共享一个 geo 组件了。并且，geo 组件的颜色也可以被这个 map series 控制，从而用 visualMap 来更改。\n当设定了 geoIndex 后，series-map.map 属性，以及 series-map.itemStyle 等样式配置不再起作用，而是采用 geo 中的相应属性。\n\nhttp://echarts.baidu.com/option.html#series-map.geoIndex\n\n并且加了pin气泡图标以示数值大小\n*/\n\nmyChart.showLoading();\nlet index = -1;\n//定时\nvar timer = setInterval(function() {\n    // 隐藏提示框\n    myChart.dispatchAction({\n        type: 'hideTip',\n        seriesIndex: 0,\n        dataIndex: index\n    });\n    // 显示提示框\n    myChart.dispatchAction({\n        type: 'showTip',\n        seriesIndex: 0,\n        dataIndex: index + 1\n    });\n    // 取消高亮指定的数据图形\n    myChart.dispatchAction({\n        type: 'downplay',\n        seriesIndex: 0,\n        dataIndex: index\n    });\n    // 高亮指定的数据图形\n    myChart.dispatchAction({\n        type: 'highlight',\n        seriesIndex: 0,\n        dataIndex: index + 1\n    });\n    index++;\n    if (index > 13) {\n        index = -1;\n    }\n}, 2000);\n\n\nmyChart.on('mousemove', function(e) {\n    clearInterval(timer);\n    myChart.dispatchAction({\n        type: 'downplay',\n        seriesIndex: 0\n    });\n    myChart.dispatchAction({\n        type: 'highlight',\n        seriesIndex: 0,\n        dataIndex: e.dataIndex\n    });\n    myChart.dispatchAction({\n        type: 'showTip',\n        seriesIndex: 0,\n        dataIndex: e.dataIndex\n    });\n}); //---------------------------------------------鼠标移入静止播放\nmyChart.on('mouseout', function(e) {\n    clearInterval(timer);\n    myChart.dispatchAction({\n        type: 'downplay',\n        seriesIndex: 0,\n        dataIndex: e.dataIndex\n    }); //鼠标移出后先把上次的高亮取消\n    timer = setInterval(function() {\n        // 隐藏提示框\n        myChart.dispatchAction({\n            type: 'hideTip',\n            seriesIndex: 0,\n            dataIndex: index\n        });\n        // 显示提示框\n        myChart.dispatchAction({\n            type: 'showTip',\n            seriesIndex: 0,\n            dataIndex: index + 1\n        });\n        // 取消高亮指定的数据图形\n        myChart.dispatchAction({\n            type: 'downplay',\n            seriesIndex: 0,\n            dataIndex: index\n        });\n        // 高亮指定的数据图形\n        myChart.dispatchAction({\n            type: 'highlight',\n            seriesIndex: 0,\n            dataIndex: index + 1\n        });\n        index++;\n        if (index > 13) {\n            index = -1;\n        }\n    }, 2000);\n});\nmyChart.on('click', function(e) {\n    console.log(e)\n    var chooseName = mapJson.filter(item => {\n        return item.name == e.name\n    })\n    console.log(chooseName)\n    mapname = chooseName[0].json\n\n    console.log(mapname, '选择地图')\n\n    mapDate = []\n    $('<div class=\"back\">返回成都市</div>').appendTo(\n        $('#chart-panel')\n    );\n\n    $('.back').css({\n        'position': 'absolute',\n        'left': '17px',\n        'top': '25px',\n        'color': 'rgb(222,222,222)',\n        'font-size': '15px',\n        cursor: 'pointer',\n        'z-index': '100'\n    })\n    $('.back').click(function() {\n        mapname = hzmap\n        mapDate = [{\n                name: '江干区',\n                value: [120.185, 30.274, 29999]\n            },\n            {\n                name: '拱墅区',\n                value: [120.182, 30.351, 29999]\n            },\n            {\n                name: '西湖区',\n                value: [120.091, 30.27, 29999]\n            },\n            {\n                name: '滨江区',\n                value: [120.21, 30.209, 29999]\n            },\n            {\n                name: '萧山区',\n                value: [120.254, 30.159, 29999]\n            },\n            {\n                name: '余杭区',\n                value: [120.295, 30.427, 29999]\n            },\n            {\n                name: '富阳区',\n                value: [119.956, 30.05, 29999]\n            },\n            {\n                name: '桐庐县',\n                value: [119.675, 29.784, 29999]\n            },\n            {\n                name: '淳安县',\n                value: [119.058, 29.613, 29999]\n            },\n            {\n                name: '建德市',\n                value: [119.28, 29.464, 29999]\n            },\n            {\n                name: '临安区',\n                value: [119.712, 30.227, 29999]\n            },\n            {\n                name: '钱塘新区',\n                value: [120.485, 30.284, 29999]\n            }\n        ];\n        $('.back').css({\n            'position': 'absolute',\n            'left': '17px',\n            'top': '-25px',\n            'color': 'rgb(222,222,222)',\n            'font-size': '15px',\n            cursor: 'pointer',\n            'z-index': '100'\n        })\n\n        mapInit()\n    })\n    mapInit()\n})\nsetTimeout(function() {\n    mapInit()\n}, 1000);\nvar mapInit = () => {\n    console.log('我来了', mapname)\n    $.getJSON(mapname, function(geoJson) {\n        echarts.registerMap('hanzhou', geoJson);\n        myChart.hideLoading();\n        option = {\n            backgroundColor: '#020933',\n            title: {\n                top: 20,\n                text: '成都市房价分布图',\n                subtext: '',\n                x: 'center',\n                textStyle: {\n                    color: '#ccc'\n                }\n            },\n\n            // tooltip: {\n            //     trigger: 'item',\n            //     formatter: function(params) {\n            //         console.log(params)\n            //             return params.name + ' : ' + params.value[2];\n            //     }\n            // },\n            visualMap: {\n                min: 0,\n                max: 1000000,\n                right: 100,\n                seriesIndex: 1,\n                type: 'piecewise',\n                bottom: 100,\n                textStyle: {\n                    color: '#FFFF'\n                },\n                splitList: [\n                    // {\n                    //     gt: 50000,\n                    //     color: '#F5222D',\n                    //     label: '困难人数大于5万人'\n                    // }, //大于5万人\n                    // {\n                    //     gte: 30000,\n                    //     lte: 50000,\n                    //     color: '#FA541C ',\n                    //     label: '困难人数3-5万人'\n                    // }, //3-5万人\n                    // {\n                    //     gte: 10000,\n                    //     lte: 30000,\n                    //     color: '#FA8C16',\n                    //     label: '困难人数1-3万人'\n                    // }, //1-3万人\n                    // {\n                    //     lte: 10000,\n                    //     color: '#fbe1d6',\n                    //     label: '困难人数小于1万人'\n                    // }\n                ]\n            },\n            geo: {\n                map: 'hanzhou',\n                aspectScale: 0.75, //长宽比\n                zoom: 1.1,\n                roam: false,\n                itemStyle: {\n                    normal: {\n                        areaColor: '#013C62',\n                        shadowColor: '#182f68',\n                        shadowOffsetX: 0,\n                        shadowOffsetY: 25\n                    },\n                    emphasis: {\n                        areaColor: '#2AB8FF',\n                        borderWidth: 0,\n                        color: 'green',\n                        label: {\n                            show: false\n                        }\n                    }\n                }\n            },\n            series: [{\n                    type: 'map',\n                    roam: true,\n                    label: {\n                        normal: {\n                            show: true,\n                            textStyle: {\n                                color: '#fff'\n                            }\n                        },\n                        emphasis: {\n                            textStyle: {\n                                color: '#fff'\n                            }\n                        }\n                    },\n\n                    itemStyle: {\n                        normal: {\n                            borderColor: '#2ab8ff',\n                            borderWidth: 1.5,\n                            areaColor: '#12235c'\n                        },\n                        emphasis: {\n                            areaColor: '#2AB8FF',\n                            borderWidth: 0,\n                            color: 'green'\n                        }\n                    },\n                    zoom: 1.1,\n                    roam: false,\n                    map: 'hanzhou' //使用\n                    // data: this.difficultData //热力图数据   不同区域 不同的底色\n                },\n                {\n                    type: 'effectScatter',\n                    coordinateSystem: 'geo',\n                    showEffectOn: 'render',\n                    rippleEffect: {\n                        period: 15,\n                        scale: 4,\n                        brushType: 'fill'\n                    },\n                    hoverAnimation: true,\n                    itemStyle: {\n                        normal: {\n                            color: '#ffff',\n                            shadowBlur: 10,\n                            shadowColor: '#333'\n                        }\n                    },\n                    data: mapDate\n                }\n\n            ]\n        };\n        myChart.setOption(option);\n    });\n}","html":"","externalScripts":"","updaterUID":"obd-o2qqSzONRvLWuynWsOMrTyOBr-9wM6Q","theme":"","layout":"","viewCount":178,"userName":"弖***","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xFVkSNEXea.png?v=1608651211869","isCustomThumbnail":0,"builtinTags":["category-work","geo","series-effectScatter","series-map","title","visualMap"],"customTags":[],"updaterUserName":"弖***"}}