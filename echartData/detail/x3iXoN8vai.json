{"status":0,"data":{"cid":"x3iXoN8vai","authorUid":"bd-3913771301","authorUserName":"因***凡","title":"演示睡眠分析（单位:小时）","description":"从睡觉到起床\n根据睡眠时间来决定柱子的不同颜色","latestVersion":3,"alwaysLatest":1,"createTime":"2020-11-12T12:07:52.000Z","lastUpdateTime":"2020-11-12T12:07:52.000Z","auth":1,"uid":"bd-3913771301","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":3,"parentVersion":2,"echartsVersion":"4.8.0","versionCreateTime":"2020-12-01T07:18:34.000Z","code":"    var xArray = [\"星期一\", \"星期二\", \"星期三\", \"星期四\", \"星期五\", \"星期六\", \"星期日\"]; //X轴线数据\r\n    var sleepStartArray = [23, 22, 23, 5, 20, 4, 21]; //睡眠开始时间\r\n    var sleepEndArray = [8.5, 9, 7.2, 8.1, 8.8, 7.8, 9.4]; //睡眠结束时间\r\n    var blockbottomData = [1, 3.5]; //下块\r\n    var blocktopData = [8.8, 10.8]; //上块\r\n    \r\n    var flag1 = (blocktopData[0] - blockbottomData[1]).toFixed(2);\r\n    var flag2 = (blocktopData[1] - blockbottomData[0]).toFixed(2);;\r\n\r\n      var zdata = []; //如果出现0点之后睡觉的情况 用此数据进行垫底\r\n      var hideData = []; //0点之前睡觉 用此数据进行垫底\r\n      var flag = 0; //判断是否出现0点之后睡觉的情况\r\n      for (var i = 0; i < sleepStartArray.length; i++) {\r\n        //将起床时间和睡眠时间相比  如果起床时间大于睡眠时间则是0点之后睡觉 反则是0点之前\r\n        if (sleepStartArray[i]*1 > sleepEndArray[i]*1) {\r\n          hideData.push(sleepStartArray[i] * 1 - 24 * 1);\r\n          sleepEndArray[i] = (24 - sleepStartArray[i] *1) + sleepEndArray[i] * 1;\r\n          zdata.push(\"-\");\r\n        } else {\r\n          hideData.push(\"-\");\r\n          //跨了0点了！！\r\n          flag = 1;\r\n          zdata.push(sleepStartArray[i] * 1);\r\n          //因为是堆叠 所以需要减去堆的值\r\n          sleepEndArray[i] = ((sleepEndArray[i] * 1 - sleepStartArray[i] * 1).toFixed(1))*1;\r\n        }\r\n      }\r\n\r\n      function getBarColor(index, params) {\r\n            var _v;\r\n        if (params == \"yc\") {\r\n            _v = sleepEndArray[index]*1;\r\n          if (_v <= flag1) {\r\n            return '#e0b01e';   //橙色\r\n          } else if (_v <= flag2) {\r\n            return '#73bd1e';   //绿色\r\n          } else {\r\n            return '#343e75';   //深蓝色\r\n          }\r\n        } else {\r\n            _v = params.value;\r\n          if (_v <= flag1) {\r\n            return '#e0b01e';\r\n          } else if (_v <= flag2) {\r\n            return '#73bd1e';\r\n          } else {\r\n            return '#343e75';\r\n          }\r\n        }\r\n      }\r\n      var option = {\r\n        title: {\r\n          text: '演示睡眠分析（单位:小时）',\r\n          subtext: '起床时间',\r\n          sublink: 'https://www.cnblogs.com/lightmusic/p/12761239.html'\r\n        },\r\n        tooltip: {\r\n          trigger: 'axis',\r\n          axisPointer: {\r\n            type: 'shadow'\r\n          },\r\n          formatter: function (params) {\r\n            var tar = params[1];\r\n            return tar.name + '<br/>' + tar.seriesName + ' : ' + tar.value + '小时';\r\n          }\r\n        },\r\n        grid: {\r\n          left: '3%',\r\n          right: '6%',\r\n          bottom: '3%',\r\n          containLabel: true\r\n        },\r\n        xAxis: [{\r\n          type: 'category',\r\n          axisLabel: {\r\n            color: '#ADADAD',\r\n            fontSize: \"11\"\r\n          },\r\n          axisLine: {\r\n            lineStyle: {\r\n              color: '#ADADAD',\r\n            }\r\n          },\r\n          axisTick: {\r\n            show: false,\r\n            lineStyle: {\r\n              color: \"#ADADAD\"\r\n            }\r\n          },\r\n          data: xArray\r\n        }],\r\n        yAxis: [{\r\n          type: 'value',\r\n          // min:-1,\r\n          // max:15,\r\n          // splineNumber:4,\r\n          splitLine: {\r\n            show: true,\r\n            lineStyle: {\r\n              color: '#ADADAD'\r\n            },\r\n          },\r\n          axisLabel: {\r\n            show: true,\r\n            interval: 'auto',\r\n            color: '#ADADAD',\r\n            fontSize: \"11\"\r\n          },\r\n          axisLine: {\r\n            lineStyle: {\r\n              color: '#ADADAD',\r\n              width: 1\r\n            },\r\n          },\r\n          axisTick: {\r\n            show: false\r\n          },\r\n          axisLabel: {\r\n            formatter: function (value, index) {\r\n                console.log(value,index);\r\n              if (value * 1 < 0) { //如果小于0 则进行替换\r\n                return 24 - (Math.abs(value * 1))+ ' :00';\r\n              }\r\n              return value+ ':00';\r\n            }\r\n          }\r\n        }],\r\n        series: [{\r\n            name: '睡觉时间0点之前',\r\n            type: 'bar',\r\n            stack: '总量',\r\n            itemStyle: {\r\n              normal: {\r\n                color: function (params) {\r\n                  return getBarColor(params.dataIndex, 'yc');\r\n                }\r\n              }\r\n            },\r\n            data: hideData\r\n          },\r\n          {\r\n            name: \"遮挡数据0点之后\",\r\n            stack:\"总量\",\r\n            type: \"bar\",\r\n            barGap: '-100%',\r\n            itemStyle: {\r\n                color: '#f3f3f3',\r\n                borderColor: \"#f3f3f3\"\r\n            },\r\n            tooltip: {\r\n                show: false\r\n            },\r\n            z: 0,\r\n            data: zdata  \r\n          },\r\n          {\r\n            name: '睡眠时长',\r\n            type: 'bar',\r\n            stack: '总量',\r\n            itemStyle: {\r\n              // color:'#343e75',\r\n              normal: {\r\n                color: function (params) {\r\n                  //三重判断 1 2.5 - 9.3 10.8\r\n                  return getBarColor(null, params);\r\n                }\r\n              }\r\n            },\r\n            label: {\r\n              show: true,\r\n              position: 'inside',\r\n            //   formatter:function(item){\r\n            //       console.log(item);\r\n            //     return item.value*1 + Math.abs(hideData[item.dataIndex])*1;\r\n            //   }\r\n            },\r\n            tooltip: {\r\n              show: true,\r\n            //   formatter:function(item,index){\r\n            //       console.log(item,index);\r\n            //   }\r\n            },\r\n            data: sleepEndArray,\r\n            z:0,\r\n            markArea: {\r\n              silent: false,\r\n              itemStyle: {\r\n                color: \"rgba(45,105,132,.4)\",\r\n              },\r\n              label: {\r\n                show: true,\r\n                position: 'right',\r\n                rotate: \"-60\",\r\n                fontSize: \"10\"\r\n              },\r\n              data: [\r\n                [{\r\n                    name: \"标域一\",\r\n                    x: \"星期一\",\r\n                    yAxis: blocktopData[0]\r\n                  },\r\n                  {\r\n                    x: \"星期日  \",\r\n                    yAxis: blocktopData[1]\r\n\r\n                  }\r\n                ],\r\n                [{\r\n                    name: \"标域二\",\r\n                    x: \"星期一\",\r\n                    yAxis: blockbottomData[0]\r\n                  },\r\n                  {\r\n                    x: \"星期日\",\r\n                    yAxis: blockbottomData[1]\r\n\r\n                  }\r\n                ]\r\n              ]\r\n            }\r\n          }\r\n        ]\r\n      };\r\n      console.log(\"垫底的数据\", hideData);\r\n      console.log(\"结束时间\", sleepEndArray);\r\n      console.log(\"zdata\", zdata);\r\n      console.log(\"标值\", flag1,flag2);","html":"","externalScripts":"","updaterUID":"bd-3913771301","theme":"","layout":"","viewCount":689,"userName":"因***凡","commentCount":0,"starCount":3,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/x3iXoN8vai.png?v=1606807114703","isCustomThumbnail":0,"builtinTags":["category-work","grid","markArea","series-bar","title","tooltip"],"customTags":["bar"],"updaterUserName":"因***凡"}}