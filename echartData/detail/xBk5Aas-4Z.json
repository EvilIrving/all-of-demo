{"status":0,"data":{"cid":"xBk5Aas-4Z","authorUid":"bd-1023445549","authorUserName":"宋***和","title":"TGraph Development among the Releases of Neo4j","description":"Data from Github (2017-06-29)","latestVersion":4,"alwaysLatest":1,"createTime":"2017-06-28T22:29:38.000Z","lastUpdateTime":"2017-06-28T22:29:38.000Z","auth":2,"uid":"bd-1023445549","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":4,"parentVersion":3,"echartsVersion":"3.8.0","versionCreateTime":"2018-03-26T00:53:04.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1522024906757-SymAbpBqz.json\";\n\n//2017.6 var uploadedDataURL = \"/asset/get/s/data-1498660933156-SkaSxrb4Z.json\";\n\n\napp.title = '笛卡尔坐标系上的热力图';\n\n\nvar time=[];\n\nfor(var year=2012;year<=2018;year++){\n    for(var month=1;month<=12;month++){\n        time.push(year+'.'+month);\n    }\n}\n\nvar branches = [];\n\nvar repoData = [];\n\nvar tagData = [];\n\nvar whereWeAre = [];\n\nfunction getReleases(){\n    $.get( uploadedDataURL, function(data){\n        // console.log(typeof data)\n        data = JSON.parse(data)\n        // console.log(typeof data)\n        // console.log(data)\n        var branchMap = {}\n        data.map(function(item){\n            var r = releaseInfo(item)\n            if(r===false) return;\n            if(!branchMap.hasOwnProperty(r.branch)){\n                branchMap[r.branch]={}\n            }\n            if(!branchMap[r.branch].hasOwnProperty(r.time)){\n                branchMap[r.branch][r.time] = []\n            }\n            branchMap[r.branch][r.time].push(r)\n        })\n        branches = _.keys(branchMap).sort()\n        console.log(branches)\n        console.log(time)\n        for(var j in time){\n            var t = time[j]\n            for(var b in branches){\n                var bb = branches[b]\n                if(bb<'1.9') continue;\n                if(branchMap[bb].hasOwnProperty(t)){\n                    var len = branchMap[bb][t].length\n                    if(len==1){\n                        var item = branchMap[bb][t][0]\n                        if(item.isTag){\n                            if(item.name=='2.2.3'){\n                                whereWeAre.push([ parseInt(j), parseInt(b), 1, item.name])\n                            }else{\n                                tagData.push([ parseInt(j), parseInt(b), 1, item.name])\n                            }\n                        }else{\n                            if(item.name=='2.3.12'){\n                                whereWeAre.push([ parseInt(j), parseInt(b), 1, item.name])\n                            }else{\n                                repoData.push([ parseInt(j), parseInt(b), 1, item.name])\n                            }\n                        }\n                    }else{\n                        repoData.push([ parseInt(j), parseInt(b), branchMap[bb][t].length, ''])\n                    }\n                }\n                // else{\n                //     repoData.push([ parseInt(j), parseInt(b), 0, ''])\n                // }\n            }\n        }\n        \n        console.log(JSON.stringify(repoData))\n        myChart.setOption(option);\n    })\n}\n\ngetReleases()\n// var data = [[0,0,5],[0,1,1],[0,2,0],[0,3,0],[0,4,0],[0,5,0],[0,6,0],[0,7,0],[0,8,0],[0,9,0],[0,10,0],[0,11,2],[0,12,4],[0,13,1],[0,14,1],[0,15,3],[0,16,4],[0,17,6],[0,18,4],[0,19,4],[0,20,3],[0,21,3],[0,22,2],[0,23,5],[1,0,7],[1,1,0],[1,2,0],[1,3,0],[1,4,0],[1,5,0],[1,6,0],[1,7,0],[1,8,0],[1,9,0],[1,10,5],[1,11,2],[1,12,2],[1,13,6],[1,14,9],[1,15,11],[1,16,6],[1,17,7],[1,18,8],[1,19,12],[1,20,5],[1,21,5],[1,22,7],[1,23,2],[2,0,1],[2,1,1],[2,2,0],[2,3,0],[2,4,0],[2,5,0],[2,6,0],[2,7,0],[2,8,0],[2,9,0],[2,10,3],[2,11,2],[2,12,1],[2,13,9],[2,14,8],[2,15,10],[2,16,6],[2,17,5],[2,18,5],[2,19,5],[2,20,7],[2,21,4],[2,22,2],[2,23,4],[3,0,7],[3,1,3],[3,2,0],[3,3,0],[3,4,0],[3,5,0],[3,6,0],[3,7,0],[3,8,1],[3,9,0],[3,10,5],[3,11,4],[3,12,7],[3,13,14],[3,14,13],[3,15,12],[3,16,9],[3,17,5],[3,18,5],[3,19,10],[3,20,6],[3,21,4],[3,22,4],[3,23,1],[4,0,1],[4,1,3],[4,2,0],[4,3,0],[4,4,0],[4,5,1],[4,6,0],[4,7,0],[4,8,0],[4,9,2],[4,10,4],[4,11,4],[4,12,2],[4,13,4],[4,14,4],[4,15,14],[4,16,12],[4,17,1],[4,18,8],[4,19,5],[4,20,3],[4,21,7],[4,22,3],[4,23,0],[5,0,2],[5,1,1],[5,2,0],[5,3,3],[5,4,0],[5,5,0],[5,6,0],[5,7,0],[5,8,2],[5,9,0],[5,10,4],[5,11,1],[5,12,5],[5,13,10],[5,14,5],[5,15,7],[5,16,11],[5,17,6],[5,18,0],[5,19,5],[5,20,3],[5,21,4],[5,22,2],[5,23,0],[6,0,1],[6,1,0],[6,2,0],[6,3,0],[6,4,0],[6,5,0],[6,6,0],[6,7,0],[6,8,0],[6,9,0],[6,10,1],[6,11,0],[6,12,2],[6,13,1],[6,14,3],[6,15,4],[6,16,0],[6,17,0],[6,18,0],[6,19,0],[6,20,1],[6,21,2],[6,22,2],[6,23,6]];\n// data = data.map(function (item) {\n//     return [item[1], item[0], item[2] || '-'];\n// });\n\n\nfunction releaseInfo(release){\n    var b = release[1].match(/^(\\d+\\.\\d+)\\./)\n    var t = new Date(Date.parse(release[0]))\n    if(b){\n        return {\n            branch:b[1],\n            name: release[1],\n            date: release[0],\n            time: t.getFullYear()+'.'+(t.getMonth()+1),\n            isTag: release[2]=='tag'\n        }\n    }else{\n        return false\n    }\n}\n\nvar now = new Date()\n\noption = {\n    title: {\n        text: 'TGraph Development among the Releases of Neo4j',\n        subtext: 'Data from Github '+now.getFullYear()+'.'+(now.getMonth()+1),\n        link: 'https://github.com/neo4j/neo4j/releases'\n    },\n    // backgroundColor: '#404a59',\n    color: [\n        '#40c1BE', '#fec42c', '#dd4444'\n    ],\n    legend: {\n        data: ['Release','Tag', 'We Are Here'],\n        left: 'right'\n    },\n    tooltip: {\n        position: 'top',\n        formatter: function (params) {\n            if(params.value[2]==1){\n                return 'Releases: ' + params.value[3] + ' at ' + time[params.value[0]];\n            }else{\n                return params.value[2] + ' releases in ' + branches[params.value[1]] + ' on ' + time[params.value[0]];\n            }\n        }\n    },\n    grid: {\n        left: 2,\n        bottom: 10,\n        right: 10,\n        containLabel: true\n    },\n    xAxis: {\n        type: 'category',\n        data: time,\n        boundaryGap: false,\n        splitLine: {\n            show: true,\n            lineStyle: {\n                color: '#999',\n                type: 'dashed'\n            }\n        },\n        axisLine: {\n            show: false\n        }\n    },\n    yAxis: {\n        type: 'category',\n        data: branches,\n        axisLine: {\n            show: true\n        }\n    },\n    series: [{\n        name: 'Release',\n        type: 'scatter',\n        symbolSize: function (val) {\n            return val[2]?(val[2]*4+8):0;\n        },\n        showEffectOn: 'click',\n        rippleEffect: {\n            brushType: 'stroke'\n        },\n        data: repoData\n    },{\n        name: 'Tag',\n        type: 'scatter',\n        symbolSize: function (val) {\n            return val[2]?(val[2]*4+8):0;\n        },\n        rippleEffect: {\n            brushType: 'stroke'\n        },\n        showEffectOn: 'click',\n        data: tagData\n    },{\n        name: 'We Are Here',\n        type: 'effectScatter',\n        symbolSize: function (val) {\n            return val[2]?(val[2]*4+8):0;\n        },\n        // rippleEffect: {\n        //     brushType: 'stroke'\n        // },\n        showEffectOn: 'click',\n        itemStyle: {\n            normal: {\n                shadowBlur: 6,\n                shadowColor: '#333'\n            }\n        },\n        zlevel: 1,\n        data: whereWeAre\n    }]\n};","html":"","externalScripts":"http://cdn.bootcss.com/underscore.js/1.8.3/underscore-min.js","updaterUID":"bd-1023445549","theme":"infographic","layout":"","viewCount":1019,"userName":"宋***和","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xBk5Aas-4Z.png?v=1522025584806","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-effectScatter","series-scatter","title","tooltip"],"customTags":["github"],"updaterUserName":"宋***和"}}