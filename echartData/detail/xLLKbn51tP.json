{"status":0,"data":{"cid":"xLLKbn51tP","authorUid":"bd-1624748243","authorUserName":"l***3","title":"动态饼图","description":"动态饼图+中间部分动态显示饼图参数","latestVersion":1,"alwaysLatest":0,"createTime":"2021-12-03T02:24:24.000Z","lastUpdateTime":"2021-12-03T02:24:24.000Z","auth":2,"uid":"bd-1624748243","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"5.2.2","versionCreateTime":"2021-12-03T02:24:24.000Z","code":"let num = 0;\nlet colors = ['#FF9532', '#FF375F', '#6BBFFF'];\nlet index = 0;\nlet pieData = [\n    {\n        name: '林业碳汇',\n        value: 7.76,\n    },\n    {\n        name: '甲烷利用',\n        value: 4.53,\n    },\n    {\n        name: '可再生资源',\n        value: 87.71,\n    },\n];\noption = {\n    backgroundColor: '#111',\n    legend: {\n        orient: 'vertical',\n        icon: 'rect',\n        x: '60%',\n        y: 'center',\n        itemWidth: 15,\n        itemHeight: 15,\n        itemGap: 10,\n        align: 'left',\n        textStyle: {\n            color: 'rgb(132,159,186)',\n            fontSize: 15,\n            padding: [0, 0, 0, 10],\n        },\n        formatter(name) {\n            let then = option.series[0].data; //获取series中的data\n            // let total = 0;\n\n            // for (let i = 0; i < then.length; i++) {\n            //     if (then[i].name != '' && then[i].name != null && then[i].name != undefined) {\n            //         total += parseInt(then[i].value);\n            //     }\n            // }\n            // var str = '';\n\n            // var p = 0;\n            for (let i = 0; i < then.length; i++) {\n                if (then[i].name == name) {\n                    // p = (then[i].value / total) * 100;\n                    str = name + '       ' + then[i].value + '%';\n                }\n            }\n            return str;\n        },\n    },\n    polar: {\n        radius: ['44%', '50%'],\n        center: ['13%', '50%'],\n    },\n    angleAxis: {\n        max: 100,\n        show: false,\n    },\n    radiusAxis: {\n        type: 'category',\n        show: true,\n        axisLabel: {\n            show: false,\n        },\n        axisLine: {\n            show: false,\n        },\n        axisTick: {\n            show: false,\n        },\n    },\n    series: [\n        {\n            type: 'pie',\n            center: ['33%', '50%'],\n            radius: ['30%', '40%'],\n            clockwise: true,\n            avoidLabelOverlap: true,\n            startAngle: 180, //起始角度\n            hoverOffset: 1,\n            zlevel: 15,\n            emphasis: {\n                label: {\n                    show: true,\n                    fontSize: '30',\n                    fontWeight: 'bold',\n                    formatter: ['{a|{d}%}', '{b|{b}}'].join('\\n'),\n                    rich: {\n                        a: {\n                            color: '#fff',\n                            fontSize: 32,\n                            lineHeight: 46,\n                            verticalAlign: 'bottom',\n                        },\n                        b: {\n                            color: '#a7a9c7',\n                            fontSize: 12,\n                            lineHeight: 24,\n                        },\n                    },\n                },\n            },\n            itemStyle: {\n                normal: {\n                    color: function (params) {\n                        return colors[params.dataIndex];\n                    },\n                },\n            },\n            label: {\n                show: true,\n                position: 'center',\n                color: 'rgba(13, 17, 29,0)',\n            },\n            data: pieData,\n        },\n        {\n            type: 'gauge', //旋转小点下面指示盘lh\n            name: '',\n            radius: '50%',\n            startAngle: '0',\n            endAngle: '-359.99',\n            splitNumber: '200',\n            center: ['33%', '50%'],\n            pointer: {\n                show: false,\n            },\n            title: {\n                show: false,\n            },\n            detail: {\n                show: false,\n            },\n            data: [\n                {\n                    value: 95,\n                    name: '',\n                },\n            ],\n            axisLine: {\n                lineStyle: {\n                    width: 20,\n                    opacity: 0,\n                },\n            },\n            axisTick: {\n                show: false,\n            },\n            splitLine: {\n                show: true,\n                length: 13,\n                lineStyle: {\n                    color: {\n                        type: 'linear',\n                        x: 1,\n                        y: 0,\n                        x2: 0,\n                        y2: 0,\n                        colorStops: [\n                            {\n                                offset: 0,\n                                color: '#111',\n                            },\n                            {\n                                offset: 0.5,\n                                color: 'rgba(66, 66, 66, 1)',\n                            },\n                            {\n                                offset: 1,\n                                color: '#111',\n                            },\n                        ],\n                        globalCoord: false,\n                    },\n                    width: 1,\n                    type: 'solid',\n                },\n            },\n            axisLabel: {\n                show: false,\n            },\n        },\n        {\n            name: '', //外层光晕\n            type: 'pie',\n            startAngle: 90,\n            radius: ['51%', '53%'],\n            hoverAnimation: false,\n            center: ['33%', '50%'],\n            itemStyle: {\n                normal: {\n                    labelLine: {\n                        show: false,\n                    },\n                    color: 'rgba(66, 66, 66, .4)',\n                    shadowBlur: 10,\n                    shadowColor: 'rgba(253, 249, 20, .3)',\n                },\n            },\n            data: [\n                {\n                    value: 100,\n                },\n            ],\n        },\n        {\n            name: '', //外层光晕\n            type: 'pie',\n            startAngle: 90,\n            radius: ['51.5%', '55%'],\n            hoverAnimation: false,\n            center: ['33%', '50%'],\n            itemStyle: {\n                normal: {\n                    labelLine: {\n                        show: false,\n                    },\n                    color: 'rgba(66, 66, 66, .3)',\n                    shadowBlur: 10,\n                    shadowColor: 'rgba(253, 249, 20, .3)',\n                },\n            },\n            data: [\n                {\n                    value: 100,\n                },\n            ],\n        },\n        {\n            name: '', //外层光晕\n            type: 'pie',\n            startAngle: 90,\n            radius: ['55.5%', '56.8%'],\n            hoverAnimation: false,\n            center: ['33%', '50%'],\n            itemStyle: {\n                normal: {\n                    labelLine: {\n                        show: false,\n                    },\n                    color: 'rgba(66, 66, 66, .2)',\n                    shadowBlur: 10,\n                    shadowColor: 'rgba(253, 249, 20, .3)',\n                },\n            },\n            data: [\n                {\n                    value: 100,\n                },\n            ],\n        },\n        {\n            name: '', //外层光晕\n            type: 'pie',\n            startAngle: 90,\n            radius: ['57.5%', '58.5%'],\n            hoverAnimation: false,\n            center: ['33%', '50%'],\n            itemStyle: {\n                normal: {\n                    labelLine: {\n                        show: false,\n                    },\n                    color: 'rgba(66, 66, 66, .1)',\n                    shadowBlur: 10,\n                    shadowColor: 'rgba(253, 249, 20, .3)',\n                },\n            },\n            data: [\n                {\n                    value: 100,\n                },\n            ],\n        },\n        {\n            name: '', //旋转小圆点 lh\n            type: 'custom',\n            coordinateSystem: 'none',\n            renderItem: function (params, api) {\n                return {\n                    type: 'arc',\n                    shape: {\n                        cx: api.getWidth() / 3,\n                        cy: api.getHeight() / 2,\n                        r: (Math.min(api.getWidth(), api.getHeight()) / 2.21) * 0.545,\n                        startAngle: ((0 + num) * Math.PI) / 180,\n                        endAngle: ((1 + num) * Math.PI) / 180,\n                    },\n                    style: {\n                        stroke: '#fdf914',\n                        fill: 'transparent',\n                        lineWidth: 5,\n                        align: 'left',\n                    },\n                    silent: true,\n                };\n            },\n            data: [0],\n        },\n    ],\n};\nfunction fun() {\n    var timer = setInterval(function () {\n        console.log(index);\n        // option.title[0]. = pieData[index].name;\n        myChart.dispatchAction({\n            type: 'hideTip',\n            seriesIndex: 0,\n            dataIndex: index,\n        });\n        // 取消高亮指定的数据图形\n        myChart.dispatchAction({\n            type: 'downplay',\n            seriesIndex: 0,\n            dataIndex: index == 0 ? 2 : index - 1,\n        });\n        myChart.dispatchAction({\n            type: 'highlight',\n            seriesIndex: 0,\n            dataIndex: index,\n        });\n        index++;\n        if (index > 2) {\n            index = 0;\n        }\n    }, 3000);\n}\nfun();\nfunction numb() {\n    num = num + 5;\n    myChart.setOption(option, true);\n}\nsetInterval(function () {\n    numb();\n}, 100);\n","html":"","externalScripts":"","updaterUID":"bd-1624748243","theme":"","layout":"","viewCount":0,"userName":"l***3","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xLLKbn51tP.png?v=1638498264577","isCustomThumbnail":0,"builtinTags":["category-work","legend","polar","series-custom","series-gauge","series-pie"],"customTags":[],"updaterUserName":"l***3"}}