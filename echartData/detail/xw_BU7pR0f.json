{"status":0,"data":{"cid":"xw_BU7pR0f","authorUid":"obd-oj1PHXb2eozseltxXKHH3iMbDILchDC","authorUserName":"葳***潊","title":"Disk Usage","description":"动态切换数据的矩形树图","latestVersion":1,"alwaysLatest":0,"createTime":"2021-12-03T02:40:50.000Z","lastUpdateTime":"2021-12-03T02:40:50.000Z","auth":1,"uid":"obd-oj1PHXb2eozseltxXKHH3iMbDILchDC","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"5.2.2","versionCreateTime":"2021-12-03T02:40:50.000Z","code":"myChart.showLoading()\r\n  diskData = [\r\n    {\r\n      name: '用户基本属性标签',\r\n      value: 1,\r\n      children: [\r\n        {\r\n          name: '性别标签',\r\n          value: 1\r\n        },\r\n        {\r\n          name: '年龄标签',\r\n          value: 1\r\n        },\r\n        {\r\n          name: '星座标签',\r\n          value: 1\r\n        },\r\n        {\r\n          name: '属相标签',\r\n          value: 1\r\n        },\r\n        {\r\n          name: '地区标签',\r\n          value: 1\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      name: '用户偏好标签',\r\n      value: 1,\r\n      children: [\r\n        {\r\n          name: '时间偏好',\r\n          value: 1\r\n        },\r\n        {\r\n          name: '功能偏好',\r\n          value: 1\r\n        },\r\n        {\r\n          name: '活动偏好',\r\n          value: 1\r\n        },\r\n        {\r\n          name: '发帖偏好',\r\n          value: 1\r\n        },\r\n        {\r\n          name: '建言偏好',\r\n          value: 1\r\n        },\r\n        {\r\n          name: '内容偏好',\r\n          value: 1\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      name: '生命周期标签',\r\n      value: 1,\r\n      children: [\r\n        {\r\n          name: '新手上路',\r\n          value: 1\r\n        },\r\n        {\r\n          name: '忠实粉丝',\r\n          value: 1\r\n        },\r\n        {\r\n          name: '种子用户',\r\n          value: 1\r\n        },\r\n        {\r\n          name: '重点留存用户',\r\n          value: 1\r\n        },\r\n        {\r\n          name: '潜在用户',\r\n          value: 1\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n  myChart.hideLoading()\r\n  const formatUtil = echarts.format\r\n  function getLevelOption () {\r\n    return [\r\n      {\r\n        itemStyle: {\r\n          borderWidth: 0,\r\n          gapWidth: 20\r\n        }\r\n      },\r\n      {\r\n        itemStyle: {\r\n          gapWidth: 1\r\n        }\r\n      },\r\n      {\r\n        colorSaturation: [0.35, 0.5],\r\n        itemStyle: {\r\n          gapWidth: 1,\r\n          borderColorSaturation: 0.6\r\n        }\r\n      }\r\n    ]\r\n  }\r\n  myChart.setOption(\r\n    (option = {\r\n      color: ['#6E35FF80', '#0522A780', '#7222A780'],\r\n      title: {\r\n        text: 'Disk Usage',\r\n        left: 'center'\r\n      },\r\n      tooltip: {\r\n        formatter: function (info) {\r\n          const value = info.value\r\n          const treePathInfo = info.treePathInfo\r\n          const treePath = []\r\n          for (let i = 1; i < treePathInfo.length; i++) {\r\n            treePath.push(treePathInfo[i].name)\r\n          }\r\n          return [\r\n            '<div class=\"tooltip-title\">' +\r\n              formatUtil.encodeHTML(treePath.join('/')) +\r\n              '</div>',\r\n            'Disk Usage: ' + formatUtil.addCommas(value) + ' KB'\r\n          ].join('')\r\n        }\r\n      },\r\n      series: [\r\n        {\r\n          name: 'Disk Usage',\r\n          type: 'treemap',\r\n          visibleMin: 300,\r\n          label: {\r\n            show: true,\r\n            formatter: '{b}'\r\n          },\r\n          itemStyle: {\r\n            borderWidth: 0,\r\n            borderColor: 'transparent',\r\n            gapWidth: 0\r\n          },\r\n          levels: getLevelOption(),\r\n          data: diskData\r\n        }\r\n      ]\r\n    })\r\n  )\r\n\r\n  // ---\r\n  const sliceIndex = [\r\n    [0, 4],\r\n    [0, 4],\r\n    [0, 4]\r\n  ]\r\n  setInterval(function () {\r\n    const tags = JSON.parse(JSON.stringify(diskData))\r\n    for (let i = 0; i < tags.length; i++) {\r\n      let tag = tags[i].children\r\n      const tagLength = tag.length\r\n\r\n      const sliceItem = sliceIndex[i]\r\n\r\n      tag = [...tag, ...tag]\r\n\r\n      tags[i].children = tag.slice(sliceItem[0], sliceItem[1])\r\n      sliceItem[0] += 1\r\n      if (sliceItem[0] > tagLength) {\r\n        sliceItem[0] = 0\r\n        sliceItem[1] = 4\r\n      } else {\r\n        sliceItem[1] += 1\r\n      }\r\n      sliceIndex[i] = sliceItem\r\n    }\r\n    const option = myChart.getOption()\r\n    option.series[0].data = tags\r\n    myChart.setOption(option)\r\n\r\n    function randomRange (min, max) {\r\n      return Math.floor(Math.random() * (max - min)) + min\r\n    }\r\n  }, 1500)\r\n","html":"","externalScripts":"","updaterUID":"obd-oj1PHXb2eozseltxXKHH3iMbDILchDC","theme":"","layout":"","viewCount":0,"userName":"葳***潊","commentCount":0,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xw_BU7pR0f.png?v=1638499251060","isCustomThumbnail":0,"builtinTags":["category-work","series-treemap","title","tooltip"],"customTags":[],"updaterUserName":"葳***潊"}}