{"status":0,"data":{"cid":"xytHDM4fC","authorUid":"bd-3399672888","authorUserName":"卅***同","title":"k线图（奇怪的需求）","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2019-10-22T12:02:14.000Z","lastUpdateTime":"2019-10-22T12:02:14.000Z","auth":2,"uid":"bd-3399672888","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.4.0","versionCreateTime":"2019-10-22T12:02:14.000Z","code":"var upColor = '#ec0000';\nvar upBorderColor = '#8A0000';\nvar downColor = '#00da3c';\nvar downBorderColor = '#008F28';\n\n\n// 数据意义：开盘(open)，收盘(close)，最低(lowest)，最高(highest)\nvar data0 = splitData([\n    ['2013/1/24', 2320.26, 2420.26, 2320.26, 2420.26],\n    ['2013/1/25', 2300, 2291.3, 2288.26, 2308.38],\n    ['2013/1/28', 2295.35, 2346.5, 2295.35, 2346.92],\n    ['2013/1/29', 2347.22, 2358.98, 2337.35, 2363.8],\n    ['2013/1/30', 2360.75, 2382.48, 2347.89, 2383.76],\n    ['2013/1/31', 2383.43, 2385.42, 2371.23, 2391.82],\n    ['2013/2/1', 2377.41, 2419.02, 2369.57, 2421.15],\n    ['2013/2/4', 2425.92, 2428.15, 2417.58, 2440.38],\n    ['2013/2/5', 2411, 2433.13, 2403.3, 2437.42],\n    ['2013/2/6', 2432.68, 2434.48, 2427.7, 2441.73],\n    ['2013/2/7', 2430.69, 2418.53, 2394.22, 2433.89],\n    ['2013/2/8', 2416.62, 2432.4, 2414.4, 2443.03],\n    ['2013/2/18', 2441.91, 2421.56, 2415.43, 2444.8],\n    ['2013/2/19', 2420.26, 2382.91, 2373.53, 2427.07],\n    ['2013/2/20', 2383.49, 2397.18, 2370.61, 2397.94],\n    ['2013/2/21', 2378.82, 2325.95, 2309.17, 2378.82],\n    ['2013/2/22', 2322.94, 2314.16, 2308.76, 2330.88],\n    ['2013/2/25', 2320.62, 2325.82, 2315.01, 2338.78],\n    ['2013/2/26', 2313.74, 2293.34, 2289.89, 2340.71],\n    ['2013/2/27', 2297.77, 2313.22, 2292.03, 2324.63],\n    ['2013/2/28', 2322.32, 2365.59, 2308.92, 2366.16],\n    ['2013/3/1', 2364.54, 2359.51, 2330.86, 2369.65],\n    ['2013/3/4', 2332.08, 2273.4, 2259.25, 2333.54],\n    ['2013/3/5', 2274.81, 2326.31, 2270.1, 2328.14],\n    ['2013/3/6', 2333.61, 2347.18, 2321.6, 2351.44],\n    ['2013/3/7', 2340.44, 2324.29, 2304.27, 2352.02],\n    ['2013/3/8', 2326.42, 2318.61, 2314.59, 2333.67],\n    ['2013/3/11', 2314.68, 2310.59, 2296.58, 2320.96],\n    ['2013/3/12', 2309.16, 2286.6, 2264.83, 2333.29],\n    ['2013/3/13', 2282.17, 2263.97, 2253.25, 2286.33],\n    ['2013/3/14', 2255.77, 2270.28, 2253.31, 2276.22],\n    ['2013/3/15', 2269.31, 2278.4, 2250, 2312.08],\n    ['2013/3/18', 2267.29, 2240.02, 2239.21, 2276.05],\n    ['2013/3/19', 2244.26, 2257.43, 2232.02, 2261.31],\n    ['2013/3/20', 2257.74, 2317.37, 2257.42, 2317.86],\n    ['2013/3/21', 2318.21, 2324.24, 2311.6, 2330.81],\n    ['2013/3/22', 2321.4, 2328.28, 2314.97, 2332],\n    ['2013/3/25', 2334.74, 2326.72, 2319.91, 2344.89],\n    ['2013/3/26', 2318.58, 2297.67, 2281.12, 2319.99],\n    ['2013/3/27', 2299.38, 2301.26, 2289, 2323.48],\n    ['2013/3/28', 2273.55, 2236.3, 2232.91, 2273.55],\n    ['2013/3/29', 2238.49, 2236.62, 2228.81, 2246.87],\n    ['2013/4/1', 2229.46, 2234.4, 2227.31, 2243.95],\n    ['2013/4/2', 2234.9, 2227.74, 2220.44, 2253.42],\n    ['2013/4/3', 2232.69, 2225.29, 2217.25, 2241.34],\n    ['2013/4/8', 2196.24, 2211.59, 2180.67, 2212.59],\n    ['2013/4/9', 2215.47, 2225.77, 2215.47, 2234.73],\n    ['2013/4/10', 2224.93, 2226.13, 2212.56, 2233.04],\n    ['2013/4/11', 2236.98, 2219.55, 2217.26, 2242.48],\n    ['2013/4/12', 2218.09, 2206.78, 2204.44, 2226.26],\n    ['2013/4/15', 2199.91, 2181.94, 2177.39, 2204.99],\n    ['2013/4/16', 2169.63, 2194.85, 2165.78, 2196.43],\n    ['2013/4/17', 2195.03, 2193.8, 2178.47, 2197.51],\n    ['2013/4/18', 2181.82, 2197.6, 2175.44, 2206.03],\n    ['2013/4/19', 2201.12, 2244.64, 2200.58, 2250.11],\n    ['2013/4/22', 2236.4, 2242.17, 2232.26, 2245.12],\n    ['2013/4/23', 2242.62, 2184.54, 2182.81, 2242.62],\n    ['2013/4/24', 2187.35, 2218.32, 2184.11, 2226.12],\n    ['2013/4/25', 2213.19, 2199.31, 2191.85, 2224.63],\n    ['2013/4/26', 2203.89, 2177.91, 2173.86, 2210.58]\n]);\n\n\nfunction splitData(rawData) {\n    var categoryData = [];\n    var values = []\n    for (var i = 0; i < rawData.length; i++) {\n        categoryData.push(rawData[i].splice(0, 1)[0]);\n        values.push(rawData[i])\n    }\n    return {\n        categoryData: categoryData,\n        values: values\n    };\n}\n\nfunction getCloseData() {\n    return data0.values.map(item => item[1])\n}\n\n/*\n   令2350及以上变红色，2200及一下变绿色\n*/\n\nfunction getData(data, high, low) {\n    // 开盘(open)，收盘(close)，最低(lowest)，最高(highest)\n\n    return data.map((item) => {\n        let colorStop = getColorStop(item[3], item[2], high, low)\n        console.log(colorStop, item[3], item[2])\n        return {\n            value: item,\n            itemStyle: {\n                color: {\n                    type: 'linear',\n                    x: 0,\n                    y: 0,\n                    x2: 0,\n                    y2: 1,\n                    colorStops: colorStop\n                },\n                color0: {\n                    type: 'linear',\n                    x: 0,\n                    y: 0,\n                    x2: 0,\n                    y2: 1,\n                    colorStops: colorStop\n                },\n                borderColor: '',\n                borderColor0: ''\n            }\n        }\n    })\n}\n\nfunction getColorStop(dataHigh, dataLow, high, low) {\n    let delta = dataHigh - dataLow\n    // console.log(dataHigh, dataLow, high, low)\n    switch (true) {\n        case dataLow > high:\n            return [{\n                offset: 0,\n                color: 'red'\n            }];\n        case dataHigh < low:\n            return [{\n                offset: 0,\n                color: 'green'\n            }];\n        case high > dataHigh && low < dataLow:\n            return [{\n                offset: 0,\n                color: '#eee'\n            }];\n        case dataHigh > high && dataLow < low:\n            return [{\n                    offset: 0,\n                    color: 'red'\n                },\n                {\n                    offset: (dataHigh - high) / delta,\n                    color: 'red'\n                },\n                {\n                    offset: (dataHigh - high) / delta,\n                    color: '#eee'\n                },\n                {\n                    offset: (dataLow - low) / delta,\n                    color: 'green'\n                },\n                {\n                    offset: 1,\n                    color: 'green'\n                }\n            ];\n        case dataHigh > high:\n            return [{\n                    offset: 0,\n                    color: 'red'\n                },\n                {\n                    offset: (dataHigh - high) / delta,\n                    color: 'red'\n                },\n                {\n                    offset: (dataHigh - high) / delta,\n                    color: '#eee'\n                },\n                {\n                    offset: 1,\n                    color: '#eee'\n                }\n            ];\n        case dataHigh < high:\n            return [{\n                    offset: 0,\n                    color: '#eee'\n                },\n                {\n                    offset: (dataHigh - low) / delta,\n                    color: '#eee'\n                },\n                {\n                    offset: (dataHigh - low) / delta,\n                    color: 'green'\n                },\n                {\n                    offset: 1,\n                    color: 'green'\n                }\n            ];\n    }\n}\n\noption = {\n    grid: {\n        left: '10%',\n        right: '10%',\n        bottom: '15%'\n    },\n    backgroundColor: '#ddd',\n    xAxis: {\n        show: false,\n        type: 'category',\n        data: data0.categoryData,\n        scale: true,\n        boundaryGap: true,\n        axisLine: {\n            onZero: false\n        },\n        splitLine: {\n            show: false\n        },\n        splitNumber: 20,\n        min: 'dataMin',\n        max: 'dataMax'\n    },\n    yAxis: {\n        scale: true,\n        splitArea: {\n            show: false\n        }\n    },\n    visualMap: {\n        show: false,\n        dimension: 1,\n        seriesIndex: 1,\n        pieces: [{\n                gte: 0,\n                lte: 2200,\n                color: 'yellow'\n            },\n            {\n                gte: 2200,\n                lte: 2350,\n                color: '#666'\n            },\n            {\n                gte: 2350,\n                lte: 2500,\n                color: 'rgba(255,72,74,0.5)'\n            }\n        ]\n    },\n    series: [{\n            name: '日K',\n            type: 'candlestick',\n            animation: false,\n            hoverAnimation: false,\n            data: getData(data0.values, 2350, 2200),\n            itemStyle: {\n                normal: {\n                    color: upColor,\n                    color0: downColor,\n                    borderColor: upBorderColor,\n                    borderColor0: downBorderColor\n                }\n            }\n        },\n        {\n            type: 'line',\n            animation: false,\n            hoverAnimation: false,\n            smooth: true,\n            data: getCloseData(),\n            z: 4,\n            itemStyle: {\n\n            },\n            lineStyle: {\n                width: 1\n            },\n            markArea: {\n                data: [\n                    [\n                        {\n                            yAxis: 2350\n                        },\n                        {\n                            type: 'Max',\n                            itemStyle: {\n                                color: {\n                                    type: 'linear',\n                                    x: 0,\n                                    y: 0,\n                                    x2: 0,\n                                    y2: 1,\n                                    colorStops: [{\n                                        offset: 0,\n                                        color: '#ddd' // 0% 处的颜色\n                                    }, {\n                                        offset: 1,\n                                        color: '#FFD1D1' // 100% 处的颜色\n                                    }]\n                                }\n                            }\n                        }\n                    ],\n                    [\n                    \n                        {\n                            type: 'Min'\n                        },\n                        {\n                            yAxis: 2200,\n                             itemStyle: {\n                                color: {\n                                    type: 'linear',\n                                    x: 0,\n                                    y: 0,\n                                    x2: 0,\n                                    y2: 1,\n                                    colorStops: [{\n                                        offset: 0,\n                                        color: '#3AD235' // 0% 处的颜色\n                                    }, {\n                                        offset: 1,\n                                        color: '#ddd' // 100% 处的颜色\n                                    }]\n                                }\n                            }\n                        }\n                    ]\n                ]\n            }\n        }\n\n    ]\n};","html":"","externalScripts":"","updaterUID":"bd-3399672888","theme":"","layout":"","viewCount":510,"userName":"卅***同","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xytHDM4fC.png?v=1571745734279","isCustomThumbnail":0,"builtinTags":["category-work","grid","markArea","series-candlestick","series-line","visualMap"],"customTags":[],"updaterUserName":"卅***同"}}