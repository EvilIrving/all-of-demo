{"status":0,"data":{"cid":"xvVSF9BiqI","authorUid":"bd-1903777778","authorUserName":"r***r","title":"堆叠柱状图求和","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2020-03-30T09:18:27.000Z","lastUpdateTime":"2020-03-30T09:18:27.000Z","auth":2,"uid":"bd-1903777778","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"4.7.0","versionCreateTime":"2020-03-30T09:18:27.000Z","code":"option = {\r\n    title: {\r\n        text: '分类销量（堆叠柱状图求和）'\r\n    },\r\n    legend: {\r\n        y: \"bottom\",\r\n        data: ['百货', '电子', '服装']\r\n    },\r\n    xAxis: [{\r\n        type: \"category\",\r\n        data: [\r\n            20190612,\r\n            20190613,\r\n            20190614,\r\n            20190615\r\n        ]\r\n    }],\r\n    yAxis: [{\r\n        type: \"value\"\r\n    }],\r\n    series: [{\r\n            name: \"百货\",\r\n            type: \"bar\",\r\n            stack: \"1\",\r\n            data: [\r\n                10,\r\n                14,\r\n                17,\r\n                8\r\n            ],\r\n            label: {\r\n                show: false,\r\n                position: 'top',\r\n                color: 'black',\r\n                formatter: function(params) {\r\n                    return params.value\r\n                }\r\n            }\r\n        },\r\n        {\r\n            name: \"电子\",\r\n            type: \"bar\",\r\n            stack: \"1\",\r\n            data: [\r\n                1,\r\n                12,\r\n                9,\r\n                22\r\n            ],\r\n            label: {\r\n                show: false,\r\n                position: 'top',\r\n                color: 'black',\r\n                formatter: function(params) {\r\n                    return params.value\r\n                }\r\n            }\r\n        },\r\n        {\r\n            name: \"服装\",\r\n            type: \"bar\",\r\n            stack: \"1\",\r\n            data: [\r\n                1,\r\n                8,\r\n                13,\r\n                20\r\n            ],\r\n            label: {\r\n                show: true,\r\n                position: 'top',\r\n                color: 'black',\r\n                formatter: function(params) {\r\n                    return params.value\r\n                }\r\n            }\r\n        }\r\n    ]\r\n}\r\n////求和\r\nvar series = option[\"series\"];\r\nvar fun = function(params) {\r\n    var datavalue = 0;\r\n    for (var i = 0; i < series.length; i++) {\r\n        datavalue += series[i].data[params.dataIndex]\r\n    }\r\n    return datavalue;\r\n}\r\n\r\nif(series[series.length - 1]){\r\n  series[series.length - 1][\"label\"][\"formatter\"] = fun;  \r\n}\r\n\r\n//点击图例求和\r\nmyChart.on(\"legendselectchanged\", function(obj) {\r\n    var b = obj.selected,\r\n        d = [];\r\n    for (var key in b) {\r\n        if (b[key]) {\r\n            for (var i = 0, l = series.length; i < l; i++) {\r\n                var changename = series[i][\"name\"];\r\n                if (changename == key) {\r\n                    d.push(i);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    var fun = function(params) {\r\n        var datavalue = 0;\r\n        for (var i = 0; i < d.length; i++) {\r\n            for (var j = 0; j < series.length; j++) {\r\n                if (d[i] == j) {\r\n                    datavalue += series[j].data[params.dataIndex]\r\n                }\r\n            }\r\n        }\r\n        return datavalue\r\n    }\r\n    for (var i = 0; i < series.length; i++) {\r\n        series[i][\"label\"][\"show\"] = false;\r\n    }\r\n    for (var i = series.length - 1; i >= 0; i--) {\r\n        var name = series[i][\"name\"];\r\n        if (obj[\"selected\"][name]) {\r\n            series[i][\"label\"][\"formatter\"] = fun\r\n            series[i][\"label\"][\"show\"] = true\r\n            break;\r\n        }\r\n    }\r\n    myChart.setOption(option);\r\n})","html":"","externalScripts":"","updaterUID":"bd-1903777778","theme":"","layout":"","viewCount":110,"userName":"r***r","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xvVSF9BiqI.png?v=1585559907286","isCustomThumbnail":0,"builtinTags":["category-work","grid","legend","series-bar","title"],"customTags":[],"updaterUserName":"r***r"}}