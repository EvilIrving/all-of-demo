{"status":0,"data":{"cid":"xSJ_qeYj4Z","authorUid":"bd-3796128407","authorUserName":"王***响","title":"circle packing-line","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2017-07-06T09:19:12.000Z","lastUpdateTime":"2020-01-09T03:09:00.000Z","auth":2,"uid":"bd-3796128407","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"3.6.2","versionCreateTime":"2017-07-06T09:19:12.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1498994055008-rJJ5SUU4W.csv\";\n\n\nvar stratify = d3.stratify()\n    .parentId(function(d) {\n        return d.id.substring(0, d.id.lastIndexOf(\".\"));\n    });\n\n\nd3.csv(uploadedDataURL, function(error, rawData) {\n    if (error) throw error;\n\n    var root = stratify(rawData)\n        .sum(function(d) {\n            return d.value;\n        })\n        .sort(function(a, b) {\n            return b.value - a.value;\n        });\n    var maxDepth = 0;\n    var seriesData = root.descendants().map(function(node) {\n        maxDepth = Math.max(maxDepth, node.depth);\n        return [\n            node.value,\n            node.depth,\n            node.id\n        ];\n    });\n    var pieces = [];\n    for (var i = 0; i <= maxDepth; i++) {\n        pieces.push({\n            value: i,\n            label: 'Level ' + i\n        });\n    }\n\n    function renderItem(params, api) {\n        var context = params.context;\n        if (!context.layout) {\n\n            d3.pack()\n                .size([api.getWidth() - 2, api.getHeight() - 2])\n                .padding(3)(root);\n\n            context.layout = {};\n            root.descendants().forEach(function(node) {\n                context.layout[node.id] = {\n                    x: node.x,\n                    y: node.y,\n                    r: node.r,\n                    isLeaf: !node.children || !node.children.length\n                };\n            });\n        }\n\n        var nodePath = api.value(2);\n        var itemLayout = context.layout[nodePath];\n\n        var nodeName = '';\n        var textFont = api.font({\n            fontSize: 10,\n            fontFamily: 'Arial'\n        });\n\n        if (itemLayout.isLeaf && itemLayout.r > 10) {\n            nodeName = nodePath.slice(nodePath.lastIndexOf('.') + 1).split(/(?=[A-Z][^A-Z])/g).join('\\n');\n            nodeName = echarts.format.truncateText(nodeName, itemLayout.r, textFont, '.');\n        }\n\n        return {\n            type: 'circle',\n            shape: {\n                cx: itemLayout.x,\n                cy: itemLayout.y,\n                r: itemLayout.r\n            },\n            z2: api.value(1) * 2,\n            style: api.style({\n                text: nodeName,\n                textFont: textFont,\n                textPosition: 'inside',\n                fill: 'transparent',\n                stroke: '#fff',\n                lineDash: [1, 3]\n            }),\n            styleEmphasis: api.style({\n                text: nodeName,\n                textPosition: 'inside',\n                textFont: textFont,\n                // stroke: 'rgba(0,0,0,0.5)',\n                fill: 'rgba(255,255,255,0.65)',\n                lineWidth: 0\n            })\n        };\n    }\n\n    var option = {\n        backgroundColor:\"#000000\",\n        xAxis: {\n            axisLine: {\n                show: false\n            },\n            axisTick: {\n                show: false\n            },\n            axisLabel: {\n                show: false\n            },\n            splitLine: {\n                show: false\n            }\n        },\n        yAxis: {\n            axisLine: {\n                show: false\n            },\n            axisTick: {\n                show: false\n            },\n            axisLabel: {\n                show: false\n            },\n            splitLine: {\n                show: false\n            }\n        },\n        tooltip: {},\n        visualMap: {\n            show: false,\n            type: 'piecewise',\n            bottom: 40,\n            pieces: pieces,\n            dimension: 1,\n            inRange: {\n                color: ['#000000', '#ffffff']\n            }\n        },\n        series: {\n            type: 'custom',\n            renderItem: renderItem,\n            encode: {\n                tooltip: 0,\n                itemName: 2\n            },\n            data: seriesData\n        }\n    };\n\n    myChart.setOption(option);\n\n});\n","html":"","externalScripts":"https://d3js.org/d3.v4.min.js","updaterUID":"bd-3796128407","theme":"default","layout":"","viewCount":327,"userName":"王***响","commentCount":1,"starCount":0,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xSJ_qeYj4Z.png?v=1578539340981","isCustomThumbnail":1,"builtinTags":["category-work","grid","series-custom","tooltip","visualMap"],"customTags":[],"updaterUserName":"王***响"}}