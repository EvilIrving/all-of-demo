{"status":0,"data":{"cid":"xiU2K8QuJM","authorUid":"obd-ol9f3DqOv3X6lVLwrc4tIDRua0oOR0d","authorUserName":"帅***鱼","title":"ditu","description":"","latestVersion":4,"alwaysLatest":0,"createTime":"2021-06-15T10:20:49.000Z","lastUpdateTime":"2021-06-15T10:20:49.000Z","auth":2,"uid":"obd-ol9f3DqOv3X6lVLwrc4tIDRua0oOR0d","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":4,"parentVersion":3,"echartsVersion":"5.1.2","versionCreateTime":"2021-06-16T09:27:01.000Z","code":"// myChart.showLoading();\nvar parentJson = null;\nvar parentInfo = [\n    {\n        cityName: '全国',\n        level: 'china',\n        code: 320000,\n    },\n];\ngetGeoJson(320000);\nfunction getGeoJson(adcode) {\n    AMapUI.loadUI(['geo/DistrictExplorer'], (DistrictExplorer) => {\n        var districtExplorer = new DistrictExplorer();\n        districtExplorer.loadAreaNode(adcode, function (error, areaNode) {\n            if (error) {\n                console.error(error);\n                return;\n            }\n            let Json = areaNode.getSubFeatures();\n            if (Json.length > 0) {\n                parentJson = Json;\n            } else if (Json.length === 0) {\n                Json = parentJson.filter((item) => {\n                    if (item.properties.adcode == adcode) {\n                        return item;\n                    }\n                });\n                if (Json.length === 0) return;\n            }\n            //去获取数据\n            getMapData(Json);\n        });\n    });\n}\n\n//获取数据，这里我们用随机数模拟数据\nfunction getMapData(Json) {\n    let mapData = Json.map((item) => {\n        var value = parseInt(Math.random() * 100);\n        return {\n            value: value,\n            label: {\n                color: value < 50 ? '#000' : '#fff',\n            },\n            name: item.properties.name,\n            level: item.properties.level,\n            cityCode: item.properties.adcode,\n        };\n    });\n    let mapJson = {};\n    //geoJson必须这种格式\n    mapJson.features = Json;\n    //去渲染echarts\n    initChart(mapData, mapJson);\n}\n\n\nfunction initChart(mapData, geoJson) {\n    myChart.showLoading();\n    echarts.registerMap('Map', geoJson);\n\n    var option = {\n        tooltip: {\n            trigger: 'item',\n            formatter: (p) => {\n                let val = p.value;\n                if (window.isNaN(val)) {\n                    val = 0;\n                }\n                let txtCon = p.name + '<br>' + '<hr>' + '数值 : ' + val.toFixed(2);\n                return txtCon;\n            },\n        },\n        legend: {\n            show: false,\n        },\n        visualMap: {\n            type: 'continuous',\n            min: 0,\n            max: 100,\n            itemWidth: 20,\n            itemHeight: 300,\n            // text: ['多', '少'],\n            seriesIndex: [0, 2],\n            dimension: 0,\n            realtime: false,\n            left: '30%',\n            top: '10%',\n            orient: 'horizontal',\n            // itemWidth: 18,\n            // itemHeight: 1000,\n            calculable: true,\n            inRange: {\n                color: ['#fff', '#009999'],\n                symbolSize: [100, 100],\n            },\n            outOfRange: {\n                color: ['#eeeeee'],\n                symbolSize: [100, 100],\n            },\n        },\n        series: [\n            {\n                name: '地图下钻',\n                type: 'map',\n                map: 'Map', // 自定义扩展图表类型\n                aspectScale: 1,\n                zoom: 1, //缩放\n                showLegendSymbol: false,\n                top: '10%',\n                label: {\n                    show: true,\n                    fontSize: 20,\n                    fontWeight: 'bold',\n                    formatter: '{c}\\n{b}',\n                },\n                emphasis: {\n                    label: {\n                        show: true,\n                    },\n                    itemStyle: {\n                        areaColor: '#FFD181',\n                        borderColor: '#fff',\n                        borderWidth: 1,\n                    },\n                },\n                layoutCenter: ['50%', '50%'],\n                layoutSize: '100%',\n                markPoint: {\n                    symbol: 'none',\n                },\n                data: mapData,\n            },\n        ],\n    };\n    myChart.setOption(option);\n    myChart.hideLoading();\n    //点击前解绑，防止点击事件触发多次\n    myChart.off('click');\n    myChart.on('click', echartsMapClick);\n}\n\nfunction echartsMapClick(params) {\n    console.log(params);\n    //如果当前是最后一级，那就直接return\n    // if (parentInfo[parentInfo.length - 1].code == params.data.cityCode) {\n    //     return\n    // }\n    let data = params.data;\n    if (data.level !== 'city') return;\n    // parentInfo.push({\n    //     cityName: data.name,\n    //     level: data.level,\n    //     code: data.cityCode\n    // })\n    getGeoJson(data.cityCode);\n}\n\nfunction getDetail() {\n    var opt = {\n        xAxis: {\n            type: 'category',\n            data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],\n        },\n        yAxis: {\n            type: 'value',\n        },\n        series: [\n            {\n                data: [120, 200, 150, 80, 70, 110, 130],\n                type: 'bar',\n            },\n            {\n                data: [120, 200, 150, 80, 70, 110, 130],\n                type: 'bar',\n            },\n        ],\n    };\n    myChart.setOption(opt);\n}\n// getDetail()\n","html":"","externalScripts":"https://webapi.amap.com/maps?v=1.4.15&key=73cddabc2173e0166a622f4483d3592a&plugin=AMap.DistrictSearch,https://webapi.amap.com/maps?v=1.4.15&key=73cddabc2173e0166a622f4483d3592a,https://webapi.amap.com/ui/1.0/main.js","updaterUID":"obd-ol9f3DqOv3X6lVLwrc4tIDRua0oOR0d","theme":"","layout":"","viewCount":0,"userName":"帅***鱼","commentCount":3,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xiU2K8QuJM.png?v=1623835621966","isCustomThumbnail":0,"builtinTags":["category-work","legend","markPoint","series-map","tooltip","visualMap"],"customTags":[],"updaterUserName":"帅***鱼"}}