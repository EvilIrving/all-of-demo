{"status":0,"data":{"cid":"xrJDKzwZQ","authorUid":"bd-2215764494","authorUserName":"p***g","title":"2015 年上证指数","description":"","latestVersion":1,"alwaysLatest":1,"createTime":"2016-05-24T05:11:26.000Z","lastUpdateTime":"2016-05-24T05:11:26.000Z","auth":2,"uid":"bd-2215764494","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":1,"parentVersion":-1,"echartsVersion":"3.1.10","versionCreateTime":"2016-05-24T05:11:26.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1464010965793-ByCCuFlX.csv\";\n\nfunction calculateMA(dayCount, data) {\n    var result = [];\n    for (var i = 0, len = data.length; i < len; i++) {\n        if (i < dayCount) {\n            result.push('-');\n            continue;\n        }\n        var sum = 0;\n        for (var j = 0; j < dayCount; j++) {\n            sum += data[i - j][1];\n        }\n        result.push(sum / dayCount);\n    }\n    return result;\n}\n\nmyChart.showLoading();\n$.get(uploadedDataURL, function (csvStr) {\n    myChart.hideLoading();\n    \n    var res = Papa.parse(csvStr).data.slice(2);\n    \n    console.log(Papa.parse(csvStr));\n    \n    res = res.reverse();\n    \n    var dates = res.map(function (item) {\n        return item[0];\n    });\n    \n    var data = res.map(function (item) {\n        return [+item[1], +item[2], +item[5], +item[6]];\n    });\n    \n    myChart.setOption(option = {\n        legend: {\n            data: ['日K', 'MA5', 'MA10', 'MA20', 'MA30']\n        },\n        tooltip: {\n            trigger: 'axis'  \n        },\n        xAxis: {\n            type: 'category',\n            data: dates\n        },\n        yAxis: {\n            scale: true,\n            scale: true\n        },\n        dataZoom: [{\n            \n        }, {\n            type: 'inside'\n        }],\n        animation: false,\n        series: [\n            {\n                type: 'candlestick',\n                name: '日K',\n                data: data\n            },\n            {\n                name: 'MA5',\n                type: 'line',\n                data: calculateMA(5, data),\n                smooth: true,\n                lineStyle: {\n                    normal: {\n                        width: 1\n                    }\n                }\n            },\n            {\n                name: 'MA10',\n                type: 'line',\n                data: calculateMA(10, data),\n                smooth: true,\n                lineStyle: {\n                    normal: {\n                        width: 1\n                    }\n                }\n            },\n            {\n                name: 'MA20',\n                type: 'line',\n                data: calculateMA(20, data),\n                smooth: true,\n                lineStyle: {\n                    normal: {\n                        width: 1\n                    }\n                }\n            },\n            {\n                name: 'MA30',\n                type: 'line',\n                data: calculateMA(30, data),\n                smooth: true,\n                lineStyle: {\n                    normal: {\n                        width: 1\n                    }\n                }\n            }\n        ]\n    });\n});","html":"","externalScripts":"https://cdn.bootcss.com/PapaParse/4.1.2/papaparse.min.js","updaterUID":"bd-2215764494","theme":"","layout":"","viewCount":3571,"userName":"p***g","commentCount":0,"starCount":1,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xrJDKzwZQ.png?v=1464066686953","isCustomThumbnail":0,"builtinTags":["category-work","dataZoom","grid","legend","series-candlestick","series-line","tooltip"],"customTags":[],"updaterUserName":"p***g"}}