{"status":0,"data":{"cid":"xSkbbjTVTl","authorUid":"bd-3087329461","authorUserName":"giszpp","title":"custom kbar","description":"","latestVersion":4,"alwaysLatest":1,"createTime":"2017-04-07T08:16:57.000Z","lastUpdateTime":"2017-04-07T08:16:57.000Z","auth":2,"uid":"bd-3087329461","publishedVersion":0,"forkFrom":"-","isSpam":0,"version":4,"parentVersion":3,"echartsVersion":"3.5.1","versionCreateTime":"2017-04-07T11:04:33.000Z","code":"var uploadedDataURL = \"/asset/get/s/data-1491553645373-H1H_Ta4pe.json\";\nfunction format(date, fmt) {\n    var o = {\n        \"M+\": date.getMonth() + 1, //月份 \n        \"d+\": date.getDate(), //日 \n        \"h+\": date.getHours(), //小时 \n        \"m+\": date.getMinutes(), //分 \n        \"s+\": date.getSeconds(), //秒 \n        \"q+\": Math.floor((date.getMonth() + 3) / 3), //季度 \n        \"S\": date.getMilliseconds() //毫秒 \n    };\n    if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (date.getFullYear() + \"\").substr(4 - RegExp.$1.length));\n    for (var k in o)\n        if (new RegExp(\"(\" + k + \")\").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : ((\"00\" + o[k]).substr((\"\" + o[k]).length)));\n    return fmt;\n}\n\n$.get(uploadedDataURL, function(data) {\n    data = JSON.parse(data)['data'];\n    var base_start = data[0]['open'];\n    //alert(base_start);\n    //\n    var date_tm = [];\n    var data_ohlc = [];\n    var data_percent = [];\n    var data_ma5 = [];\n    var data_ma10 = [];\n    var data_ma20 = [];\n    var data_ma30 = [];\n    for(var idx=1; idx<data.length; idx++)\n    {\n        var item = data[idx];\n        var tm = new Date(item.time);\n        var str_tm = format(tm, 'hh:mm');\n        //if( str_tm.substr(3) == '30' || str_tm.substr(3) == '00')\n        date_tm.push(str_tm);\n        //date_tm.push(Date.parse(tm));\n        data_percent.push( (item.close-base_start)*100/base_start);\n        data_ohlc.push([item.open, item.high, item.low, item.close]);\n        data_ma5.push(item.ma5);\n        data_ma10.push(item.ma10);\n        data_ma20.push(item.ma20);\n        data_ma30.push(item.ma30);\n    }\n    //\n    myChart.setOption(option = {\n        animation: false,\n        //backgroundColor: '#fff',\n        tooltip: {\n            trigger: 'axis',\n            axisPointer: {\n                type: 'cross',\n                crossStyle: {\n                    type: 'solid',\n                }\n            },\n            textStyle: {\n                fontSize: '.24rem'\n            },\n            hideDelay: 0,\n            position:[80, 10],\n            formatter: function (params) {\n                //alert(JSON.stringify(params));\n                var cur_val = base_start + params[0].value * base_start / 100.0;\n                //alert(cur_val);\n                var res = '价格: ' + cur_val;\n                return res;\n            }\n        },\n        xAxis: {\n            type: 'category',\n            data: date_tm,\n            \n        },\n        yAxis: {\n            name: '涨幅(%)',\n            max: 5,\n            min: -5,\n            axisLine: {\n                lineStyle: {\n                    color: '#ccc'\n                }\n            },\n            nameTextStyle: {\n                color: '#333'\n            },\n            axisLabel: {\n                textStyle: {\n                    color: '#333'\n                }\n            },\n            interval: 1,\n            splitLine: {\n                lineStyle: {\n                    type: 'dashed',\n                    color: '#e2e6a'\n\n                }\n            },\n            splitArea: {\n                show: true,\n                areaStyle: {\n                    color: ['#fbfbfb', '#fbfbfb']\n                }\n            }\n        },\n        visualMap: {\n            show: false,\n            pieces: [{\n                gt: -5,\n                lte: -1.5,\n                color: '#096'\n            }, {\n                gt: -1.5,\n                lte: -0.5,\n                color: '#32b6cf'\n            }, {\n                gt: 0.5,\n                lte: 1.5,\n                color: '#fea621'\n            }, {\n                gt: 1.5,\n                lte: 5,\n                color: '#f72c2e'\n            }],\n            outOfRange: {\n                color: '#999'\n            }\n        },\n        legend: {\n            show: false\n        },\n        graphic: [\n            {\n                type: 'text',\n                left: 'center',\n                top: 'center',\n                z: 10,\n                style: {\n                    fill: 'rgba(128,128,128,0.1)',\n                    text: 'miaoji',\n                    font: '90px Microsoft YaHei'\n                }\n            }\n        ],\n        series: [{\n            name: '价格',\n            type: 'line',\n            hoverAnimation: false,\n            lineStyle: {\n                normal: {\n                    width: 1\n                }\n            },\n            itemStyle: {\n                normal: {\n                    opacity: 0\n                }\n            },\n            data: data_percent,\n            areaStyle: {\n                normal: {\n                    color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [{\n                        offset: 1,\n                        color: '#c5c5e1' // 0% 处的颜色\n                    }, {\n                        offset: 0,\n                        color: '#f9fafb' // 100% 处的颜色\n                    }], false),\n                    opacity: 0.4\n                }\n            }\n        }],\n    });\n});","html":"","externalScripts":"","updaterUID":"bd-3087329461","theme":"","layout":"","viewCount":276,"userName":"giszpp","commentCount":0,"starCount":2,"isStared":0,"thumbnailURL":"https://www.makeapie.com/ecg-storage/ec_gallery_thumbnail/xSkbbjTVTl.png?v=1491563073606","isCustomThumbnail":0,"builtinTags":["axisPointer","category-work","graphic","grid","legend","series-line","tooltip","visualMap"],"customTags":[],"updaterUserName":"giszpp"}}