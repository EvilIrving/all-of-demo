<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dcy.datamanage.biz.mapper.DataAssessDeptMapper">

    <insert id="batchReplace" parameterType="com.dcy.datamanage.api.model.DataAssessDeptRel">
        REPLACE INTO data_assess_dept_rel(id,data_source_id,`table_name`,dept_id,user_id)
        VALUE
        <foreach collection="list" item="item" separator=",">
            (#{item.id},#{item.dataSourceId},#{item.tableName},#{item.deptId},#{item.userId})
        </foreach>
    </insert>

    <select id="list" resultType="com.dcy.datamanage.biz.dto.output.DataAssessDeptSearchOutputDTO"
            parameterType="com.dcy.datamanage.biz.dto.input.DataAssessDeptSearchInputDTO">
        SELECT
            id,data_source_id,
            `table_name`,dept_id,user_id
        FROM
            data_assess_dept_rel
        WHERE
            data_source_id = #{dataSourceId}
            <if test="tableName != null and tableName != ''">
                AND `table_name` = #{tableName}
            </if>
            <if test="tableNameList != null and tableNameList.size > 0">
                AND `table_name` IN
                <foreach collection="tableNameList" open="(" item="item" separator="," close=")">
                    #{item}
                </foreach>
            </if>

    </select>
</mapper>
