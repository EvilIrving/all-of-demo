<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ygkj.digitization.mapper.FloodRiskDisasterDataMapper">

    <resultMap id="BaseResultMap" type="com.ygkj.digitization.model.FloodRiskDisasterData" >
        <result column="id" property="id" />
        <result column="name" property="name" />
        <result column="design_standard" property="designStandard" />
        <result column="flooded_area" property="floodedArea" />
        <result column="submerged_population" property="submergedPopulation" />
        <result column="flood_loss" property="floodLoss" />
        <result column="del_flag" property="delFlag" />
    </resultMap>

    <sql id="Base_Column_List">
        id,
        name,
        design_standard,
        flooded_area,
        submerged_population,
        flood_loss,
        del_flag
    </sql>

    <select id="loadPage" resultType="com.ygkj.digitization.vo.response.FloodRiskDisasterDataRespVo">
        SELECT tbl.*,( SELECT SUM( flooded_area ) FROM `flood_risk_disaster_data` WHERE `design_standard` = #{designStandard} ) floodedAreaTotal ,
               ( SELECT SUM( submerged_population ) FROM `flood_risk_disaster_data` WHERE `design_standard` = #{designStandard} )
        submergedPopulationTotal ,( SELECT SUM( flood_loss ) FROM `flood_risk_disaster_data`
        WHERE`design_standard` = #{designStandard} ) floodLossTotal  FROM `flood_risk_disaster_data` tbl where tbl.del_flag = 0
        <if test="designStandard!=null and designStandard!=''">
            and tbl.design_standard = #{designStandard}
        </if>
        <if test="basin!=null and basin!=''">
            and tbl.name = #{basin}
        </if>
    </select>

</mapper>