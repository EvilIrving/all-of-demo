<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ygkj.water.project.mapper.WarningWaterRainMapper">

    <select id="listSt" resultType="com.ygkj.gragh.model.AttStBase" parameterType="String">
        SELECT
            st_code,st_name,st_type
        FROM
            att_st_base
        WHERE
            FIND_IN_SET(st_code,#{stCodes})
    </select>

    <select id="listZz" resultType="com.ygkj.gragh.model.StRiverR" parameterType="com.ygkj.project.vo.request.WarningWaterRainReqVo">
        SELECT * FROM
            (
                SELECT
                    stcd,tm,z
                FROM
                    st_river_r_${ym}
                WHERE
                    stcd IN
                    <foreach collection="stList" open="(" item="item" separator="," close=")">
                        #{item}
                    </foreach>
                    AND tm &gt;= #{date}
                HAVING 1
                ORDER BY tm DESC
            ) a
        GROUP BY stcd
    </select>

    <select id="listRr" resultType="com.ygkj.gragh.model.StRsvrR" parameterType="com.ygkj.project.vo.request.WarningWaterRainReqVo">
        SELECT * FROM
            (
                SELECT
                    stcd,tm,rz
                FROM
                    st_rsvr_r_${ym}
                WHERE
                    stcd IN
                    <foreach collection="stList" open="(" item="item" separator="," close=")">
                        #{item}
                    </foreach>
                    AND tm &gt;= #{date}
                HAVING 1
                ORDER BY tm DESC
            ) a
        GROUP BY stcd
    </select>

    <select id="listTt" resultType="com.ygkj.gragh.model.StTideR" parameterType="com.ygkj.project.vo.request.WarningWaterRainReqVo">
        SELECT * FROM
            (
                SELECT
                    stcd,tm,tdz
                FROM
                    st_tide_r_${ym}
                WHERE
                    stcd IN
                    <foreach collection="stList" open="(" item="item" separator="," close=")">
                        #{item}
                    </foreach>
                    AND tm &gt;= #{date}
                HAVING 1
                ORDER BY tm DESC
            ) a
        GROUP BY stcd
    </select>

    <select id="listDd" resultType="com.ygkj.gragh.model.StWasR" parameterType="com.ygkj.project.vo.request.WarningWaterRainReqVo">
        SELECT * FROM
            (
                SELECT
                    stcd,tm,UPZ,DWZ,LL
                FROM
                    st_was_r_${ym}
                WHERE
                    stcd IN
                    <foreach collection="stList" open="(" item="item" separator="," close=")">
                        #{item}
                    </foreach>
                    AND tm &gt;= #{date}
                HAVING 1
                ORDER BY tm DESC
            ) a
        GROUP BY stcd
    </select>

    <select id="listPp" resultType="com.ygkj.gragh.model.StPptnR" parameterType="com.ygkj.project.vo.request.WarningWaterRainReqVo">
        SELECT * FROM
            (
                SELECT
                    stcd,tm,drp
                FROM
                    st_pptn_r_${ym}
                WHERE
                    stcd IN
                    <foreach collection="stList" open="(" item="item" separator="," close=")">
                        #{item}
                    </foreach>
                    AND tm &gt;= #{date}
                HAVING 1
                ORDER BY tm DESC
            ) a
        GROUP BY stcd
    </select>

</mapper>
