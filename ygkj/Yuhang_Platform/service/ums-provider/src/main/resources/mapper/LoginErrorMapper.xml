<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ygkj.mapper.LoginErrorMapper">

    <insert id="insert" parameterType="com.ygkj.entity.LoginError">
        INSERT INTO sys_login_error
            ( ip_addr, phone,last_err_time,count_num,total_num)
        VALUES
           (inet_aton(#{ipAddr}),#{phone},now(),1,1)
    </insert>


    <update id="updateById" parameterType="com.ygkj.entity.LoginError">
        UPDATE
            sys_login_error
        SET
            ip_addr = inet_aton(#{ipAddr}),
            phone = #{phone},
            last_err_time = #{lastErrTime},
            count_num = #{countNum},
            total_num = #{totalNum},
            unlock_time = #{unlockTime}
        WHERE
            id = #{id}
    </update>

    <select id="getLoginError" resultType="com.ygkj.entity.LoginError">
        SELECT
            id,inet_ntoa(ip_addr) ipAddr,phone,last_err_time,
            count_num,total_num,unlock_time
        FROM
            sys_login_error
        WHERE
            ip_addr = inet_aton(#{ipAddr})
            AND phone = #{phone}
    </select>
</mapper>